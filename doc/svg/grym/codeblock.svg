<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4866pt" height="3380pt"
 viewBox="0.00 0.00 4866.00 3380.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3376.2048)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-3376.2048 4862,-3376.2048 4862,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="996.5" cy="-3354.2048" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="996.5" y="-3350.0048" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 157</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="996.5" cy="-3282.2048" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="996.5" y="-3278.0048" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;15</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M996.5,-3336.0361C996.5,-3328.3357 996.5,-3319.1791 996.5,-3310.6214"/>
<polygon fill="#000000" stroke="#000000" points="1000.0001,-3310.618 996.5,-3300.618 993.0001,-3310.6181 1000.0001,-3310.618"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="718.5" cy="-3099.8046" rx="99.1626" ry="18"/>
<text text-anchor="middle" x="718.5" y="-3095.6046" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Code Block Module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M943.3095,-3273.3376C907.971,-3265.5983 861.7638,-3251.7915 826.5,-3228.2048 786.5191,-3201.4629 753.1808,-3155.7964 734.5505,-3126.7459"/>
<polygon fill="#000000" stroke="#000000" points="737.3075,-3124.5545 729.0288,-3117.9429 731.3775,-3128.2741 737.3075,-3124.5545"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="881.5" cy="-3099.8046" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="881.5" y="-3095.6046" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;6</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973.4564,-3265.4451C961.2417,-3255.6568 946.6976,-3242.4484 936.5,-3228.2048 914.0932,-3196.9076 898.3286,-3155.0609 889.5832,-3127.7773"/>
<polygon fill="#000000" stroke="#000000" points="892.8824,-3126.5994 886.5759,-3118.086 886.1969,-3128.6741 892.8824,-3126.5994"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="996.5" cy="-3099.8046" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="996.5" y="-3095.6046" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 7&#45;15</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M996.5,-3264.0487C996.5,-3232.2274 996.5,-3166.1673 996.5,-3128.2374"/>
<polygon fill="#000000" stroke="#000000" points="1000.0001,-3127.8872 996.5,-3117.8872 993.0001,-3127.8873 1000.0001,-3127.8872"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1416.5" cy="-3099.8046" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1416.5" y="-3095.6046" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;77</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.8704,-3267.2782C1106.6111,-3234.3851 1287.836,-3155.6816 1372.0641,-3119.1025"/>
<polygon fill="#000000" stroke="#000000" points="1373.5805,-3122.2598 1381.3586,-3115.066 1370.792,-3115.8392 1373.5805,-3122.2598"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="2020.5,-3228.105 1500.5,-3228.105 1500.5,-2971.5041 2020.5,-2971.5041 2020.5,-3228.105"/>
<text text-anchor="middle" x="1760.5" y="-3213.0048" font-family="Inconsolata" font-size="14.00" fill="#000000"> * Code Block Module</text>
<text text-anchor="middle" x="1760.5" y="-3165.6047" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Code blocks are the motivating object for Grimoire. &#160;Perforce they</text>
<text text-anchor="middle" x="1760.5" y="-3150.2047" font-family="Inconsolata" font-size="14.00" fill="#000000"> will do a lot of the heavy lifting.</text>
<text text-anchor="middle" x="1760.5" y="-3118.8047" font-family="Inconsolata" font-size="14.00" fill="#000000"> From the compiler&#39;s perspective, Code, Structure, and Prose are the</text>
<text text-anchor="middle" x="1760.5" y="-3103.4047" font-family="Inconsolata" font-size="14.00" fill="#000000"> three basic genres of Grimmorian text. &#160;In this implementation,</text>
<text text-anchor="middle" x="1760.5" y="-3088.0046" font-family="Inconsolata" font-size="14.00" fill="#000000"> you may think of Code as a clade diverged early from both Structure</text>
<text text-anchor="middle" x="1760.5" y="-3072.6046" font-family="Inconsolata" font-size="14.00" fill="#000000"> and Prose, with some later convergence toward the former. </text>
<text text-anchor="middle" x="1760.5" y="-3057.2046" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1760.5" y="-3041.8045" font-family="Inconsolata" font-size="14.00" fill="#000000"> Specifically, Structure and Prose will actually inherit from Block, and</text>
<text text-anchor="middle" x="1760.5" y="-3026.4045" font-family="Inconsolata" font-size="14.00" fill="#000000"> Code block, name notwithstanding, merely imitates some behaviours.</text>
<text text-anchor="middle" x="1760.5" y="-3011.0045" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1760.5" y="-2979.6044" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- section_1&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>section_1&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1055.7829,-3278.2413C1164.9258,-3270.5463 1394.5436,-3252.4042 1490.7766,-3228.1635"/>
<polygon fill="#000000" stroke="#000000" points="1491.7254,-3231.5328 1500.481,-3225.5671 1489.9162,-3224.7706 1491.7254,-3231.5328"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="499,-2476.804 0,-2476.804 0,-2406.2033 499,-2406.2033 499,-2476.804"/>
<text text-anchor="middle" x="249.5" y="-2429.7037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Code blocks are the motivating object for Grimoire. &#160;Perforce they</text>
<text text-anchor="middle" x="249.5" y="-2414.3037" font-family="Inconsolata" font-size="14.00" fill="#000000"> will do a lot of the heavy lifting.</text>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M879.3924,-3081.3663C875.0541,-3052.7135 862.3062,-2998.0309 826.5,-2971.4044 712.363,-2886.5289 625.8704,-3015.7492 508.5,-2935.4044 348.9947,-2826.2166 280.7542,-2586.9511 258.439,-2486.8978"/>
<polygon fill="#000000" stroke="#000000" points="261.8511,-2486.1172 256.3005,-2477.0927 255.0119,-2487.6089 261.8511,-2486.1172"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="1037.5,-2507.2041 517.5,-2507.2041 517.5,-2375.8033 1037.5,-2375.8033 1037.5,-2507.2041"/>
<text text-anchor="middle" x="777.5" y="-2491.9038" font-family="Inconsolata" font-size="14.00" fill="#000000"> From the compiler&#39;s perspective, Code, Structure, and Prose are the</text>
<text text-anchor="middle" x="777.5" y="-2476.5038" font-family="Inconsolata" font-size="14.00" fill="#000000"> three basic genres of Grimmorian text. &#160;In this implementation,</text>
<text text-anchor="middle" x="777.5" y="-2461.1037" font-family="Inconsolata" font-size="14.00" fill="#000000"> you may think of Code as a clade diverged early from both Structure</text>
<text text-anchor="middle" x="777.5" y="-2445.7037" font-family="Inconsolata" font-size="14.00" fill="#000000"> and Prose, with some later convergence toward the former. </text>
<text text-anchor="middle" x="777.5" y="-2430.3037" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="777.5" y="-2414.9036" font-family="Inconsolata" font-size="14.00" fill="#000000"> Specifically, Structure and Prose will actually inherit from Block, and</text>
<text text-anchor="middle" x="777.5" y="-2399.5036" font-family="Inconsolata" font-size="14.00" fill="#000000"> Code block, name notwithstanding, merely imitates some behaviours.</text>
<text text-anchor="middle" x="777.5" y="-2384.1036" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- block_4&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M990.5287,-3081.8552C963.6462,-3001.0479 852.9794,-2668.3903 802.6382,-2517.0676"/>
<polygon fill="#000000" stroke="#000000" points="805.8889,-2515.751 799.4111,-2507.3671 799.2468,-2517.9607 805.8889,-2515.751"/>
</g>
<!-- header_8 -->
<g id="node9" class="node">
<title>header_8</title>
<ellipse fill="none" stroke="#000000" cx="1101.5" cy="-2441.5037" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1101.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_5&#45;&gt;header_8 -->
<g id="edge8" class="edge">
<title>section_5&#45;&gt;header_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1373.5917,-3086.0387C1313.812,-3064.4021 1207.1217,-3016.3396 1156.5,-2935.4044 1061.0252,-2782.7572 1084.6596,-2550.7767 1096.6576,-2470.2392"/>
<polygon fill="#000000" stroke="#000000" points="1100.1864,-2470.3223 1098.2597,-2459.9041 1093.269,-2469.2499 1100.1864,-2470.3223"/>
</g>
<!-- block_9 -->
<g id="node10" class="node">
<title>block_9</title>
<ellipse fill="none" stroke="#000000" cx="1221.5" cy="-2441.5037" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1221.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 16&#45;21</text>
</g>
<!-- section_5&#45;&gt;block_9 -->
<g id="edge9" class="edge">
<title>section_5&#45;&gt;block_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1397.1412,-3082.286C1367.7175,-3054.3919 1312.4285,-2996.737 1286.5,-2935.4044 1216.544,-2769.9269 1217.32,-2547.7965 1220.0999,-2469.9115"/>
<polygon fill="#000000" stroke="#000000" points="1223.5978,-2470.0311 1220.4983,-2459.8998 1216.6033,-2469.7527 1223.5978,-2470.0311"/>
</g>
<!-- block_10 -->
<g id="node11" class="node">
<title>block_10</title>
<ellipse fill="none" stroke="#000000" cx="1351.5" cy="-2441.5037" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1351.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 22&#45;35</text>
</g>
<!-- section_5&#45;&gt;block_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;block_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1414.6937,-3081.5108C1405.6552,-2989.9712 1365.3362,-2581.6322 1354.3004,-2469.8652"/>
<polygon fill="#000000" stroke="#000000" points="1357.7633,-2469.3167 1353.2976,-2459.7091 1350.7972,-2470.0046 1357.7633,-2469.3167"/>
</g>
<!-- block_11 -->
<g id="node12" class="node">
<title>block_11</title>
<ellipse fill="none" stroke="#000000" cx="1481.5" cy="-2441.5037" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1481.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 36&#45;50</text>
</g>
<!-- section_5&#45;&gt;block_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;block_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1418.3063,-3081.5108C1427.3448,-2989.9712 1467.6638,-2581.6322 1478.6996,-2469.8652"/>
<polygon fill="#000000" stroke="#000000" points="1482.2028,-2470.0046 1479.7024,-2459.7091 1475.2367,-2469.3167 1482.2028,-2470.0046"/>
</g>
<!-- block_12 -->
<g id="node13" class="node">
<title>block_12</title>
<ellipse fill="none" stroke="#000000" cx="1637.5" cy="-2441.5037" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1637.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 51&#45;53</text>
</g>
<!-- section_5&#45;&gt;block_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;block_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1423.9416,-3081.4804C1435.4144,-3054.8834 1459.4886,-3005.0884 1491.5,-2971.4044 1511.6258,-2950.227 1530.3255,-2959.7338 1546.5,-2935.4044 1647.4648,-2783.535 1644.1925,-2550.127 1639.6154,-2469.8019"/>
<polygon fill="#000000" stroke="#000000" points="1643.089,-2469.2701 1638.9716,-2459.5081 1636.1027,-2469.7071 1643.089,-2469.2701"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1970.5" cy="-2441.5037" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1970.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 54&#45;77</text>
</g>
<!-- section_5&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1421.6929,-3081.4642C1430.7866,-3052.9456 1452.4454,-2998.4434 1491.5,-2971.4044 1569.7164,-2917.2522 1625.146,-2990.7816 1702.5,-2935.4044 1870.7887,-2814.9276 1944.2048,-2554.9364 1964.4175,-2469.4065"/>
<polygon fill="#000000" stroke="#000000" points="1967.8335,-2470.1686 1966.672,-2459.6377 1961.0128,-2468.5944 1967.8335,-2470.1686"/>
</g>
<!-- section_14 -->
<g id="node15" class="node">
<title>section_14</title>
<ellipse fill="none" stroke="#000000" cx="3018.5" cy="-2441.5037" rx="70.655" ry="18"/>
<text text-anchor="middle" x="3018.5" y="-2437.3037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 78&#45;157</text>
</g>
<!-- section_5&#45;&gt;section_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;section_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1421.2351,-3081.4526C1429.805,-3052.3986 1450.8869,-2996.5348 1491.5,-2971.4044 1594.525,-2907.6551 1918.6025,-2967.2338 2035.5,-2935.4044 2436.4139,-2826.2418 2865.8412,-2545.9199 2985.7767,-2464.1881"/>
<polygon fill="#000000" stroke="#000000" points="2987.9159,-2466.9653 2994.1941,-2458.431 2983.9641,-2461.1875 2987.9159,-2466.9653"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3641.5,-2935.3052 3107.5,-2935.3052 3107.5,-1947.7022 3641.5,-1947.7022 3641.5,-2935.3052"/>
<text text-anchor="middle" x="3374.5" y="-2920.2044" font-family="Inconsolata" font-size="14.00" fill="#000000"> ** Fields</text>
<text text-anchor="middle" x="3374.5" y="-2872.8044" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Codeblock inherits from Node directly, and is born with these </text>
<text text-anchor="middle" x="3374.5" y="-2857.4043" font-family="Inconsolata" font-size="14.00" fill="#000000"> additional fields:</text>
<text text-anchor="middle" x="3374.5" y="-2826.0043" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; level &#160;: &#160;The number of !s, which is the number of / needed to close</text>
<text text-anchor="middle" x="3374.5" y="-2810.6043" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the block.</text>
<text text-anchor="middle" x="3374.5" y="-2795.2042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; header : &#160;The line after # and at least one !.</text>
<text text-anchor="middle" x="3374.5" y="-2779.8042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; footer : &#160;The line closing the block. Optional, as a code block may</text>
<text text-anchor="middle" x="3374.5" y="-2764.4042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end a file without a closing line.</text>
<text text-anchor="middle" x="3374.5" y="-2749.0042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lines &#160;: &#160;Array containing the lines of code. &#160;Header and footer</text>
<text text-anchor="middle" x="3374.5" y="-2733.6041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;are not included.</text>
<text text-anchor="middle" x="3374.5" y="-2718.2041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_first : &#160;The first (header) line of the block. </text>
<text text-anchor="middle" x="3374.5" y="-2702.8041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_last &#160;: &#160;The closing line of the block. Note that code blocks also</text>
<text text-anchor="middle" x="3374.5" y="-2687.404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collect blank lines and may have a clinging tag. </text>
<text text-anchor="middle" x="3374.5" y="-2672.004" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="3374.5" y="-2656.604" font-family="Inconsolata" font-size="14.00" fill="#000000"> To be added:</text>
<text text-anchor="middle" x="3374.5" y="-2641.2039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [ ] lang : The language, derived from the header line.</text>
<text text-anchor="middle" x="3374.5" y="-2609.8039" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="3374.5" y="-2594.4039" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2563.0038" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2531.6038" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2500.2038" font-family="Inconsolata" font-size="14.00" fill="#000000">local CB = setmetatable({}, Node)</text>
<text text-anchor="middle" x="3374.5" y="-2484.8037" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.id = &quot;codeblock&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2453.4037" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__index = CB</text>
<text text-anchor="middle" x="3374.5" y="-2422.0037" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__tostring = function() return &quot;codeblock&quot; end</text>
<text text-anchor="middle" x="3374.5" y="-2406.6037" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="3374.5" y="-2375.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a .val field which is the union of all lines.</text>
<text text-anchor="middle" x="3374.5" y="-2359.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> Useful in visualization. </text>
<text text-anchor="middle" x="3374.5" y="-2328.4036" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="3374.5" y="-2313.0035" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toValue(codeblock)</text>
<text text-anchor="middle" x="3374.5" y="-2297.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.val = &quot;&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2282.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(codeblock.lines) do</text>
<text text-anchor="middle" x="3374.5" y="-2266.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;codeblock.val = codeblock.val .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2251.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3374.5" y="-2220.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock.val</text>
<text text-anchor="middle" x="3374.5" y="-2204.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3374.5" y="-2173.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toMarkdown(codeblock)</text>
<text text-anchor="middle" x="3374.5" y="-2157.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; hardcode lua</text>
<text text-anchor="middle" x="3374.5" y="-2142.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &quot;```&quot; .. codeblock.lang .. &quot;\n&quot; </text>
<text text-anchor="middle" x="3374.5" y="-2127.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. codeblock:toValue() .. &quot;```\n&quot;</text>
<text text-anchor="middle" x="3374.5" y="-2111.6032" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3374.5" y="-2080.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.dotLabel(codeblock)</text>
<text text-anchor="middle" x="3374.5" y="-2064.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;code block &quot; .. tostring(codeblock.line_first)</text>
<text text-anchor="middle" x="3374.5" y="-2049.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(codeblock.line_last)</text>
<text text-anchor="middle" x="3374.5" y="-2034.0031" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3374.5" y="-2002.603" font-family="Inconsolata" font-size="14.00" fill="#000000">local cb = {}</text>
<text text-anchor="middle" x="3374.5" y="-1987.203" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="3374.5" y="-1955.803" font-family="Inconsolata" font-size="14.00" fill="#000000">*</text>
</g>
<!-- section_5&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>section_5&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1420.9756,-3081.72C1429.2812,-3052.5125 1450.1253,-2995.7729 1491.5,-2971.4044 1645.3923,-2880.7664 2945.4788,-3027.5054 3098.5,-2935.4044 3098.592,-2935.349 3098.6841,-2935.2936 3098.7761,-2935.2381"/>
<polygon fill="#000000" stroke="#000000" points="3100.6153,-2938.2159 3107.25,-2929.9558 3096.9123,-2932.2756 3100.6153,-2938.2159"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="687,-1330.1023 216,-1330.1023 216,-1259.5016 687,-1259.5016 687,-1330.1023"/>
<text text-anchor="middle" x="451.5" y="-1283.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Codeblock inherits from Node directly, and is born with these </text>
<text text-anchor="middle" x="451.5" y="-1267.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> additional fields:</text>
</g>
<!-- block_9&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>block_9&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1226.0785,-2423.2162C1243.0947,-2350.4205 1294.8558,-2078.8462 1156.5,-1947.6029 1082.1101,-1877.0372 779.0236,-1972.4572 696.5,-1911.6029 505.6624,-1770.876 463.3214,-1457.8249 454.0536,-1340.4371"/>
<polygon fill="#000000" stroke="#000000" points="457.5357,-1340.0652 453.3017,-1330.3532 450.5551,-1340.5858 457.5357,-1340.0652"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1239.5,-1399.0024 705.5,-1399.0024 705.5,-1190.6014 1239.5,-1190.6014 1239.5,-1399.0024"/>
<text text-anchor="middle" x="972.5" y="-1383.7021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; level &#160;: &#160;The number of !s, which is the number of / needed to close</text>
<text text-anchor="middle" x="972.5" y="-1368.3021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the block.</text>
<text text-anchor="middle" x="972.5" y="-1352.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; header : &#160;The line after # and at least one !.</text>
<text text-anchor="middle" x="972.5" y="-1337.502" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; footer : &#160;The line closing the block. Optional, as a code block may</text>
<text text-anchor="middle" x="972.5" y="-1322.102" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end a file without a closing line.</text>
<text text-anchor="middle" x="972.5" y="-1306.702" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lines &#160;: &#160;Array containing the lines of code. &#160;Header and footer</text>
<text text-anchor="middle" x="972.5" y="-1291.302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;are not included.</text>
<text text-anchor="middle" x="972.5" y="-1275.9019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_first : &#160;The first (header) line of the block. </text>
<text text-anchor="middle" x="972.5" y="-1260.5019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_last &#160;: &#160;The closing line of the block. Note that code blocks also</text>
<text text-anchor="middle" x="972.5" y="-1245.1019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collect blank lines and may have a clinging tag. </text>
<text text-anchor="middle" x="972.5" y="-1229.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="972.5" y="-1214.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> To be added:</text>
<text text-anchor="middle" x="972.5" y="-1198.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [ ] lang : The language, derived from the header line.</text>
</g>
<!-- block_10&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>block_10&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1353.291,-2423.1891C1359.0662,-2355.6213 1372.1619,-2115.5589 1286.5,-1947.6029 1275.9299,-1926.8784 1261.9527,-1930.5834 1248.5,-1911.6029 1135.1642,-1751.6965 1052.2077,-1537.806 1008.2489,-1408.4977"/>
<polygon fill="#000000" stroke="#000000" points="1011.5399,-1407.3037 1005.0221,-1398.951 1004.9084,-1409.5452 1011.5399,-1407.3037"/>
</g>
<!-- codeblock_17 -->
<g id="node18" class="node">
<title>codeblock_17</title>
<ellipse fill="none" stroke="#000000" cx="1334.5" cy="-1294.8019" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1334.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 36&#45;49</text>
</g>
<!-- block_11&#45;&gt;codeblock_17 -->
<g id="edge17" class="edge">
<title>block_11&#45;&gt;codeblock_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1479.191,-2423.4917C1462.3913,-2292.4424 1359.0154,-1486.0394 1338.1636,-1323.3803"/>
<polygon fill="#000000" stroke="#000000" points="1341.6022,-1322.6773 1336.859,-1313.2036 1334.659,-1323.5675 1341.6022,-1322.6773"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1483.5,-1312.8019 1429.5,-1312.8019 1429.5,-1276.8019 1483.5,-1276.8019 1483.5,-1312.8019"/>
</g>
<!-- block_11&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>block_11&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1481.1073,-2423.4917C1478.2502,-2292.4424 1460.6693,-1486.0394 1457.1231,-1323.3803"/>
<polygon fill="#000000" stroke="#000000" points="1460.6184,-1323.1249 1456.9012,-1313.2036 1453.6201,-1323.2775 1460.6184,-1323.1249"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1875,-1314.1025 1502,-1314.1025 1502,-1275.5014 1875,-1275.5014 1875,-1314.1025"/>
<text text-anchor="middle" x="1688.5" y="-1299.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a .val field which is the union of all lines.</text>
<text text-anchor="middle" x="1688.5" y="-1283.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> Useful in visualization. </text>
</g>
<!-- block_12&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_12&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1638.3011,-2423.4917C1644.111,-2292.8602 1679.7663,-1491.1743 1687.1589,-1324.9556"/>
<polygon fill="#000000" stroke="#000000" points="1690.6752,-1324.6659 1687.623,-1314.5203 1683.6821,-1324.3548 1690.6752,-1324.6659"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="1970.5" cy="-1294.8019" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1970.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 54&#45;76</text>
</g>
<!-- block_13&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>block_13&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1970.5,-2423.4917C1970.5,-2292.4424 1970.5,-1486.0394 1970.5,-1323.3803"/>
<polygon fill="#000000" stroke="#000000" points="1974.0001,-1323.2035 1970.5,-1313.2036 1967.0001,-1323.2036 1974.0001,-1323.2035"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2119.5,-1312.8019 2065.5,-1312.8019 2065.5,-1276.8019 2119.5,-1276.8019 2119.5,-1312.8019"/>
</g>
<!-- block_13&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>block_13&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1974.1532,-2423.2925C1987.539,-2355.8213 2034.2773,-2113.5607 2056.5,-1911.6029 2081.365,-1685.6326 2089.7333,-1411.0724 2091.8775,-1323.2491"/>
<polygon fill="#000000" stroke="#000000" points="2095.3818,-1323.1037 2092.1192,-1313.0237 2088.3837,-1322.9381 2095.3818,-1323.1037"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2266.5" cy="-1294.8019" rx="50.8" ry="18"/>
<text text-anchor="middle" x="2266.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : asserts</text>
</g>
<!-- section_14&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_14&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2981.0117,-2426.0707C2860.7849,-2374.352 2483.585,-2194.3348 2326.5,-1911.6029 2214.6655,-1710.3159 2247.8893,-1414.4768 2261.7906,-1322.8756"/>
<polygon fill="#000000" stroke="#000000" points="2265.2518,-1323.3952 2263.3408,-1312.9742 2258.3361,-1322.3125 2265.2518,-1323.3952"/>
</g>
<!-- block_25 -->
<g id="node26" class="node">
<title>block_25</title>
<ellipse fill="none" stroke="#000000" cx="2391.5" cy="-1294.8019" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2391.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 78&#45;79</text>
</g>
<!-- section_14&#45;&gt;block_25 -->
<g id="edge25" class="edge">
<title>section_14&#45;&gt;block_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2989.7188,-2424.9624C2893.8901,-2368.1184 2584.4701,-2169.9649 2456.5,-1911.6029 2354.4309,-1705.533 2377.426,-1414.013 2387.8529,-1323.0362"/>
<polygon fill="#000000" stroke="#000000" points="2391.3463,-1323.2985 2389.0529,-1312.9549 2384.3954,-1322.471 2391.3463,-1323.2985"/>
</g>
<!-- block_26 -->
<g id="node27" class="node">
<title>block_26</title>
<ellipse fill="none" stroke="#000000" cx="2521.5" cy="-1294.8019" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2521.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 80&#45;88</text>
</g>
<!-- section_14&#45;&gt;block_26 -->
<g id="edge26" class="edge">
<title>section_14&#45;&gt;block_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3007.994,-2423.649C2969.2807,-2357.4226 2832.1502,-2118.9545 2741.5,-1911.6029 2644.5655,-1689.8769 2556.7378,-1410.467 2529.8829,-1322.5703"/>
<polygon fill="#000000" stroke="#000000" points="2533.1744,-1321.3644 2526.9136,-1312.8173 2526.4779,-1323.4032 2533.1744,-1321.3644"/>
</g>
<!-- block_27 -->
<g id="node28" class="node">
<title>block_27</title>
<ellipse fill="none" stroke="#000000" cx="2806.5" cy="-1294.8019" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2806.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 89&#45;97</text>
</g>
<!-- section_14&#45;&gt;block_27 -->
<g id="edge27" class="edge">
<title>section_14&#45;&gt;block_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3015.17,-2423.4917C2990.9161,-2292.3032 2841.5386,-1484.3247 2811.688,-1322.8639"/>
<polygon fill="#000000" stroke="#000000" points="2815.0824,-1321.9713 2809.8227,-1312.7742 2808.1991,-1323.2439 2815.0824,-1321.9713"/>
</g>
<!-- block_28 -->
<g id="node29" class="node">
<title>block_28</title>
<ellipse fill="none" stroke="#000000" cx="3018.5" cy="-1294.8019" rx="60.1864" ry="18"/>
<text text-anchor="middle" x="3018.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 98&#45;110</text>
</g>
<!-- section_14&#45;&gt;block_28 -->
<g id="edge28" class="edge">
<title>section_14&#45;&gt;block_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3018.5,-2423.4917C3018.5,-2292.4424 3018.5,-1486.0394 3018.5,-1323.3803"/>
<polygon fill="#000000" stroke="#000000" points="3022.0001,-1323.2035 3018.5,-1313.2036 3015.0001,-1323.2036 3022.0001,-1323.2035"/>
</g>
<!-- block_29 -->
<g id="node30" class="node">
<title>block_29</title>
<ellipse fill="none" stroke="#000000" cx="3200.5" cy="-1294.8019" rx="63.9154" ry="18"/>
<text text-anchor="middle" x="3200.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 111&#45;112</text>
</g>
<!-- section_14&#45;&gt;block_29 -->
<g id="edge29" class="edge">
<title>section_14&#45;&gt;block_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3021.3588,-2423.4917C3042.1584,-2292.4424 3170.1475,-1486.0394 3195.9642,-1323.3803"/>
<polygon fill="#000000" stroke="#000000" points="3199.4685,-1323.6286 3197.5794,-1313.2036 3192.555,-1322.5313 3199.4685,-1323.6286"/>
</g>
<!-- block_30 -->
<g id="node31" class="node">
<title>block_30</title>
<ellipse fill="none" stroke="#000000" cx="3493.5" cy="-1294.8019" rx="65.0229" ry="18"/>
<text text-anchor="middle" x="3493.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 113&#45;122</text>
</g>
<!-- section_14&#45;&gt;block_30 -->
<g id="edge30" class="edge">
<title>section_14&#45;&gt;block_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3014.9558,-2423.1339C3002.2252,-2351.1615 2966.2592,-2085.5596 3098.5,-1947.6029 3153.4487,-1890.2791 3213.5685,-1963.6952 3273.5,-1911.6029 3459.1776,-1750.2125 3488.1457,-1420.9689 3492.6648,-1322.9428"/>
<polygon fill="#000000" stroke="#000000" points="3496.1632,-1323.0497 3493.0769,-1312.9144 3489.1692,-1322.7622 3496.1632,-1323.0497"/>
</g>
<!-- block_31 -->
<g id="node32" class="node">
<title>block_31</title>
<ellipse fill="none" stroke="#000000" cx="3958.5" cy="-1294.8019" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="3958.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 123&#45;135</text>
</g>
<!-- section_14&#45;&gt;block_31 -->
<g id="edge31" class="edge">
<title>section_14&#45;&gt;block_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3014.5542,-2423.1232C3000.0432,-2349.9737 2957.4985,-2077.2349 3098.5,-1947.6029 3175.4503,-1876.8575 3477.9098,-1965.4534 3567.5,-1911.6029 3803.9062,-1769.505 3920.8827,-1423.481 3950.6876,-1322.7468"/>
<polygon fill="#000000" stroke="#000000" points="3954.0923,-1323.5733 3953.5259,-1312.9936 3947.3711,-1321.6173 3954.0923,-1323.5733"/>
</g>
<!-- block_32 -->
<g id="node33" class="node">
<title>block_32</title>
<ellipse fill="none" stroke="#000000" cx="4146.5" cy="-1294.8019" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="4146.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 136&#45;137</text>
</g>
<!-- section_14&#45;&gt;block_32 -->
<g id="edge32" class="edge">
<title>section_14&#45;&gt;block_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3014.515,-2423.4654C2999.5669,-2350.4683 2954.7279,-2074.8115 3098.5,-1947.6029 3176.3632,-1878.7101 3954.9309,-1979.6896 4033.5,-1911.6029 4211.9058,-1756.9995 4169.1486,-1421.7479 4151.8978,-1322.8205"/>
<polygon fill="#000000" stroke="#000000" points="4155.3407,-1322.1904 4150.1256,-1312.968 4148.4512,-1323.4297 4155.3407,-1322.1904"/>
</g>
<!-- block_33 -->
<g id="node34" class="node">
<title>block_33</title>
<ellipse fill="none" stroke="#000000" cx="4317.5" cy="-1294.8019" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="4317.5" y="-1290.6019" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 138&#45;157</text>
</g>
<!-- section_14&#45;&gt;block_33 -->
<g id="edge33" class="edge">
<title>section_14&#45;&gt;block_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3014.4921,-2423.4394C2999.4552,-2350.3415 2954.3191,-2074.348 3098.5,-1947.6029 3192.2637,-1865.1781 4127.9914,-1994.3171 4221.5,-1911.6029 4397.5225,-1755.9002 4344.2219,-1421.4117 4323.8018,-1322.7434"/>
<polygon fill="#000000" stroke="#000000" points="4327.2158,-1321.9709 4321.7133,-1312.9171 4320.3688,-1323.4263 4327.2158,-1321.9709"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="4858,-1911.404 4401,-1911.404 4401,-678.1999 4858,-678.1999 4858,-1911.404"/>
<text text-anchor="middle" x="4629.5" y="-1896.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">*** asserts</text>
<text text-anchor="middle" x="4629.5" y="-1865.0029" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="4629.5" y="-1849.6029" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.check(codeblock)</text>
<text text-anchor="middle" x="4629.5" y="-1834.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_first)</text>
<text text-anchor="middle" x="4629.5" y="-1818.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_last)</text>
<text text-anchor="middle" x="4629.5" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4629.5" y="-1788.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="4629.5" y="-1756.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> Matches a code block header line.</text>
<text text-anchor="middle" x="4629.5" y="-1725.2027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="4629.5" y="-1709.8027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str : &#160;The string to match against.</text>
<text text-anchor="middle" x="4629.5" y="-1694.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="4629.5" y="-1679.0026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="4629.5" y="-1663.6026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For header match</text>
<text text-anchor="middle" x="4629.5" y="-1648.2025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="4629.5" y="-1632.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
<text text-anchor="middle" x="4629.5" y="-1585.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="4629.5" y="-1570.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchHead(str)</text>
<text text-anchor="middle" x="4629.5" y="-1554.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codestart, str) then</text>
<text text-anchor="middle" x="4629.5" y="-1539.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax, str))</text>
<text text-anchor="middle" x="4629.5" y="-1523.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.zaps, trimmed) &#45; 1</text>
<text text-anchor="middle" x="4629.5" y="-1508.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.zaps, trimmed))</text>
<text text-anchor="middle" x="4629.5" y="-1493.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="4629.5" y="-1477.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="4629.5" y="-1462.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="4629.5" y="-1446.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4629.5" y="-1431.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4629.5" y="-1416.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="4629.5" y="-1384.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> Matches a code block footer line.</text>
<text text-anchor="middle" x="4629.5" y="-1353.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="4629.5" y="-1337.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str &#160;&#160;: &#160;The string to match against.</text>
<text text-anchor="middle" x="4629.5" y="-1322.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; level : &#160;Required level for a match.</text>
<text text-anchor="middle" x="4629.5" y="-1307.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="4629.5" y="-1291.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="4629.5" y="-1276.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For footer match</text>
<text text-anchor="middle" x="4629.5" y="-1260.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="4629.5" y="-1245.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
<text text-anchor="middle" x="4629.5" y="-1198.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="4629.5" y="-1182.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchFoot(str)</text>
<text text-anchor="middle" x="4629.5" y="-1167.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codefinish, str) then</text>
<text text-anchor="middle" x="4629.5" y="-1151.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax &#160;&#160;&#160;, str))</text>
<text text-anchor="middle" x="4629.5" y="-1136.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.fass, trimmed) &#45; 1</text>
<text text-anchor="middle" x="4629.5" y="-1121.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.fass, trimmed))</text>
<text text-anchor="middle" x="4629.5" y="-1105.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="4629.5" y="-1090.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="4629.5" y="-1074.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="4629.5" y="-1059.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4629.5" y="-1044.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4629.5" y="-1028.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="4629.5" y="-997.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> Constructor</text>
<text text-anchor="middle" x="4629.5" y="-965.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">#!!!lua</text>
<text text-anchor="middle" x="4629.5" y="-950.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Codeblock, level, headline, linum)</text>
<text text-anchor="middle" x="4629.5" y="-935.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local codeblock = setmetatable({}, CB)</text>
<text text-anchor="middle" x="4629.5" y="-919.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.level = level</text>
<text text-anchor="middle" x="4629.5" y="-904.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.header = headline</text>
<text text-anchor="middle" x="4629.5" y="-888.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lang = L.match(L.C(m.symbol), headline) or &quot;&quot;</text>
<text text-anchor="middle" x="4629.5" y="-873.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.footer = &quot;&quot;</text>
<text text-anchor="middle" x="4629.5" y="-858.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.line_first = linum</text>
<text text-anchor="middle" x="4629.5" y="-842.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lines = {}</text>
<text text-anchor="middle" x="4629.5" y="-811.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock</text>
<text text-anchor="middle" x="4629.5" y="-795.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4629.5" y="-748.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__call = new</text>
<text text-anchor="middle" x="4629.5" y="-733.001" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__index = cb</text>
<text text-anchor="middle" x="4629.5" y="-701.601" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, cb)</text>
<text text-anchor="middle" x="4629.5" y="-686.201" font-family="Inconsolata" font-size="14.00" fill="#000000">#///lua</text>
</g>
<!-- section_14&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>section_14&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3014.4771,-2423.4223C2999.3819,-2350.258 2954.0512,-2074.0426 3098.5,-1947.6029 3206.7282,-1852.868 4275.0939,-1994.6923 4392.5,-1911.6029 4392.5878,-1911.5408 4392.6755,-1911.4786 4392.7633,-1911.4164"/>
<polygon fill="#000000" stroke="#000000" points="4394.8173,-1914.2504 4400.828,-1905.5255 4390.6884,-1908.5978 4394.8173,-1914.2504"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1475,-572.901 1116,-572.901 1116,-377.3004 1475,-377.3004 1475,-572.901"/>
<text text-anchor="middle" x="1295.5" y="-557.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1295.5" y="-526.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1295.5" y="-495.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1295.5" y="-463.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local CB = setmetatable({}, Node)</text>
<text text-anchor="middle" x="1295.5" y="-448.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.id = &quot;codeblock&quot;</text>
<text text-anchor="middle" x="1295.5" y="-416.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__index = CB</text>
<text text-anchor="middle" x="1295.5" y="-385.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__tostring = function() return &quot;codeblock&quot; end</text>
</g>
<!-- codeblock_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>codeblock_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1333.6307,-1276.532C1329.3141,-1185.8057 1310.0171,-780.2199 1300.6434,-583.2053"/>
<polygon fill="#000000" stroke="#000000" points="1304.135,-582.9431 1300.1636,-573.1207 1297.1429,-583.2758 1304.135,-582.9431"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1915.5,-641.9013 1493.5,-641.9013 1493.5,-308.3001 1915.5,-308.3001 1915.5,-641.9013"/>
<text text-anchor="middle" x="1704.5" y="-626.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toValue(codeblock)</text>
<text text-anchor="middle" x="1704.5" y="-611.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.val = &quot;&quot;</text>
<text text-anchor="middle" x="1704.5" y="-596.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(codeblock.lines) do</text>
<text text-anchor="middle" x="1704.5" y="-580.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;codeblock.val = codeblock.val .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1704.5" y="-565.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1704.5" y="-533.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock.val</text>
<text text-anchor="middle" x="1704.5" y="-518.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1704.5" y="-487.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toMarkdown(codeblock)</text>
<text text-anchor="middle" x="1704.5" y="-471.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; hardcode lua</text>
<text text-anchor="middle" x="1704.5" y="-456.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &quot;```&quot; .. codeblock.lang .. &quot;\n&quot; </text>
<text text-anchor="middle" x="1704.5" y="-440.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. codeblock:toValue() .. &quot;```\n&quot;</text>
<text text-anchor="middle" x="1704.5" y="-425.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1704.5" y="-394.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.dotLabel(codeblock)</text>
<text text-anchor="middle" x="1704.5" y="-378.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;code block &quot; .. tostring(codeblock.line_first)</text>
<text text-anchor="middle" x="1704.5" y="-363.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(codeblock.line_last)</text>
<text text-anchor="middle" x="1704.5" y="-347.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1704.5" y="-316.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local cb = {}</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1971.6173,-1276.5921C1975.597,-1199.7693 1983.9115,-896.0726 1883.5,-678.0009 1879.3005,-668.8805 1874.5544,-659.8687 1869.3822,-651.0107"/>
<polygon fill="#000000" stroke="#000000" points="1872.2338,-648.9618 1864.0724,-642.2058 1866.2394,-652.5767 1872.2338,-648.9618"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="1987.5,-493.1007 1933.5,-493.1007 1933.5,-457.1007 1987.5,-457.1007 1987.5,-493.1007"/>
</g>
<!-- block_25&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>block_25&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2396.5395,-1276.8622C2418.476,-1194.492 2497.1179,-849.2455 2326.5,-678.0009 2222.3671,-573.4856 2106.0949,-740.7737 1996.5,-642.0009 1957.721,-607.0512 1955.2601,-541.1991 1957.5004,-503.504"/>
<polygon fill="#000000" stroke="#000000" points="1961.0138,-503.4545 1958.2708,-493.2209 1954.0334,-502.9315 1961.0138,-503.4545"/>
</g>
<!-- codeblock_35 -->
<g id="node36" class="node">
<title>codeblock_35</title>
<ellipse fill="none" stroke="#000000" cx="2082.5" cy="-475.1007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2082.5" y="-470.9007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 80&#45;85</text>
</g>
<!-- block_26&#45;&gt;codeblock_35 -->
<g id="edge35" class="edge">
<title>block_26&#45;&gt;codeblock_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2526.5508,-1276.6476C2548.3166,-1194.0537 2625.5804,-850.3869 2456.5,-678.0009 2366.1732,-585.9082 2274.2552,-715.8646 2168.5,-642.0009 2120.9897,-608.8178 2097.9914,-541.2294 2088.3732,-503.0268"/>
<polygon fill="#000000" stroke="#000000" points="2091.727,-502.0014 2086.0059,-493.084 2084.9173,-503.6228 2091.727,-502.0014"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="2431.5,-495.0028 2177.5,-495.0028 2177.5,-455.1986 2431.5,-455.1986 2431.5,-495.0028"/>
<text text-anchor="middle" x="2304.5" y="-463.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Matches a code block header line.</text>
</g>
<!-- block_26&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>block_26&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2523.0049,-1276.5704C2528.611,-1200.2744 2543.7273,-900.2705 2456.5,-678.0009 2428.5041,-606.6627 2368.2771,-538.505 2332.6127,-502.2016"/>
<polygon fill="#000000" stroke="#000000" points="2334.9301,-499.5685 2325.3955,-494.9487 2329.9681,-504.506 2334.9301,-499.5685"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="2879,-540.901 2450,-540.901 2450,-409.3003 2879,-409.3003 2879,-540.901"/>
<text text-anchor="middle" x="2664.5" y="-525.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="2664.5" y="-510.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str : &#160;The string to match against.</text>
<text text-anchor="middle" x="2664.5" y="-495.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="2664.5" y="-479.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="2664.5" y="-464.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For header match</text>
<text text-anchor="middle" x="2664.5" y="-448.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="2664.5" y="-433.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
</g>
<!-- block_27&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>block_27&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2803.335,-1276.532C2786.7078,-1180.5507 2709.0346,-732.1789 2677.6781,-551.1718"/>
<polygon fill="#000000" stroke="#000000" points="2681.1057,-550.4524 2675.9501,-541.1966 2674.2084,-551.6473 2681.1057,-550.4524"/>
</g>
<!-- codeblock_39 -->
<g id="node40" class="node">
<title>codeblock_39</title>
<ellipse fill="none" stroke="#000000" cx="2979.5" cy="-475.1007" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2979.5" y="-470.9007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 98&#45;109</text>
</g>
<!-- block_28&#45;&gt;codeblock_39 -->
<g id="edge39" class="edge">
<title>block_28&#45;&gt;codeblock_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3017.6307,-1276.532C3012.5854,-1170.4882 2987.0741,-634.2928 2980.8642,-503.7725"/>
<polygon fill="#000000" stroke="#000000" points="2984.3427,-503.237 2980.3713,-493.4147 2977.3506,-503.5697 2984.3427,-503.237"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="3133.5,-493.1007 3079.5,-493.1007 3079.5,-457.1007 3133.5,-457.1007 3133.5,-493.1007"/>
</g>
<!-- block_28&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>block_28&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3020.4614,-1276.532C3031.8573,-1170.3816 3089.5255,-633.2146 3103.464,-503.3802"/>
<polygon fill="#000000" stroke="#000000" points="3106.9464,-503.7312 3104.5339,-493.4147 3099.9864,-502.9839 3106.9464,-503.7312"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3405.5,-493.1007 3151.5,-493.1007 3151.5,-457.1007 3405.5,-457.1007 3405.5,-493.1007"/>
<text text-anchor="middle" x="3278.5" y="-471.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Matches a code block footer line.</text>
</g>
<!-- block_29&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>block_29&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3202.2385,-1276.532C3212.3394,-1170.3816 3263.4544,-633.2146 3275.809,-503.3802"/>
<polygon fill="#000000" stroke="#000000" points="3279.2942,-503.7013 3276.7573,-493.4147 3272.3257,-503.0381 3279.2942,-503.7013"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3853,-548.8011 3424,-548.8011 3424,-401.4003 3853,-401.4003 3853,-548.8011"/>
<text text-anchor="middle" x="3638.5" y="-533.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="3638.5" y="-518.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str &#160;&#160;: &#160;The string to match against.</text>
<text text-anchor="middle" x="3638.5" y="-502.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; level : &#160;Required level for a match.</text>
<text text-anchor="middle" x="3638.5" y="-487.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="3638.5" y="-471.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="3638.5" y="-456.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For footer match</text>
<text text-anchor="middle" x="3638.5" y="-441.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="3638.5" y="-425.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
</g>
<!-- block_30&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>block_30&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3496.7318,-1276.532C3513.4726,-1181.8946 3590.8155,-744.6664 3623.6709,-558.931"/>
<polygon fill="#000000" stroke="#000000" points="3627.1431,-559.395 3625.4386,-548.9382 3620.2501,-558.1756 3627.1431,-559.395"/>
</g>
<!-- codeblock_44 -->
<g id="node45" class="node">
<title>codeblock_44</title>
<ellipse fill="none" stroke="#000000" cx="3958.5" cy="-475.1007" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3958.5" y="-470.9007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 123&#45;134</text>
</g>
<!-- block_31&#45;&gt;codeblock_44 -->
<g id="edge44" class="edge">
<title>block_31&#45;&gt;codeblock_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3958.5,-1276.532C3958.5,-1170.4882 3958.5,-634.2928 3958.5,-503.7725"/>
<polygon fill="#000000" stroke="#000000" points="3962.0001,-503.4146 3958.5,-493.4147 3955.0001,-503.4147 3962.0001,-503.4146"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="4117.5,-493.1007 4063.5,-493.1007 4063.5,-457.1007 4117.5,-457.1007 4117.5,-493.1007"/>
</g>
<!-- block_31&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>block_31&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3961.4421,-1276.532C3978.5359,-1170.3816 4065.0382,-633.2146 4085.946,-503.3802"/>
<polygon fill="#000000" stroke="#000000" points="4089.4164,-503.8439 4087.5508,-493.4147 4082.5054,-502.731 4089.4164,-503.8439"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="4235.5,-493.1007 4135.5,-493.1007 4135.5,-457.1007 4235.5,-457.1007 4235.5,-493.1007"/>
<text text-anchor="middle" x="4185.5" y="-471.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Constructor</text>
</g>
<!-- block_32&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>block_32&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4147.3693,-1276.532C4152.4146,-1170.4882 4177.9259,-634.2928 4184.1358,-503.7725"/>
<polygon fill="#000000" stroke="#000000" points="4187.6494,-503.5697 4184.6287,-493.4147 4180.6573,-503.237 4187.6494,-503.5697"/>
</g>
<!-- codeblock_48 -->
<g id="node49" class="node">
<title>codeblock_48</title>
<ellipse fill="none" stroke="#000000" cx="4340.5" cy="-475.1007" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4340.5" y="-470.9007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 138&#45;156</text>
</g>
<!-- block_33&#45;&gt;codeblock_48 -->
<g id="edge48" class="edge">
<title>block_33&#45;&gt;codeblock_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4318.0126,-1276.532C4320.9881,-1170.4882 4336.0332,-634.2928 4339.6955,-503.7725"/>
<polygon fill="#000000" stroke="#000000" points="4343.2042,-503.5089 4339.9861,-493.4147 4336.2069,-503.3125 4343.2042,-503.5089"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="4499.5,-493.1007 4445.5,-493.1007 4445.5,-457.1007 4499.5,-457.1007 4499.5,-493.1007"/>
</g>
<!-- block_33&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>block_33&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4315.0726,-1276.6824C4305.5616,-1198.9709 4276.7918,-888.2845 4392.5,-678.0009 4404.6808,-655.8639 4423.3201,-663.5581 4436.5,-642.0009 4463.0537,-598.5695 4470.1818,-538.3 4471.9974,-503.3288"/>
<polygon fill="#000000" stroke="#000000" points="4475.4945,-503.4691 4472.4059,-493.3345 4468.5003,-503.1832 4475.4945,-503.4691"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2195.5,-170.7015 1969.5,-170.7015 1969.5,-101.4989 2195.5,-101.4989 2195.5,-170.7015"/>
<text text-anchor="middle" x="2082.5" y="-155.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.check(codeblock)</text>
<text text-anchor="middle" x="2082.5" y="-140.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_first)</text>
<text text-anchor="middle" x="2082.5" y="-124.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_last)</text>
<text text-anchor="middle" x="2082.5" y="-109.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_35&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>codeblock_35&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2082.5,-456.8745C2082.5,-405.123 2082.5,-256.1697 2082.5,-180.8486"/>
<polygon fill="#000000" stroke="#000000" points="2086.0001,-180.7269 2082.5,-170.7269 2079.0001,-180.7269 2086.0001,-180.7269"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3204.5,-217.1005 2754.5,-217.1005 2754.5,-55.0999 3204.5,-55.0999 3204.5,-217.1005"/>
<text text-anchor="middle" x="2979.5" y="-201.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchHead(str)</text>
<text text-anchor="middle" x="2979.5" y="-186.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codestart, str) then</text>
<text text-anchor="middle" x="2979.5" y="-171.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax, str))</text>
<text text-anchor="middle" x="2979.5" y="-155.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.zaps, trimmed) &#45; 1</text>
<text text-anchor="middle" x="2979.5" y="-140.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.zaps, trimmed))</text>
<text text-anchor="middle" x="2979.5" y="-124.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="2979.5" y="-109.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="2979.5" y="-94.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="2979.5" y="-78.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2979.5" y="-63.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_39&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>codeblock_39&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2979.5,-456.8745C2979.5,-414.4278 2979.5,-306.5905 2979.5,-227.6244"/>
<polygon fill="#000000" stroke="#000000" points="2983.0001,-227.1713 2979.5,-217.1713 2976.0001,-227.1714 2983.0001,-227.1713"/>
</g>
<!-- leaf_45 -->
<g id="node46" class="node">
<title>leaf_45</title>
<polygon fill="none" stroke="#c0c0c0" points="4147,-217.1005 3690,-217.1005 3690,-55.0999 4147,-55.0999 4147,-217.1005"/>
<text text-anchor="middle" x="3918.5" y="-201.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchFoot(str)</text>
<text text-anchor="middle" x="3918.5" y="-186.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codefinish, str) then</text>
<text text-anchor="middle" x="3918.5" y="-171.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax &#160;&#160;&#160;, str))</text>
<text text-anchor="middle" x="3918.5" y="-155.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.fass, trimmed) &#45; 1</text>
<text text-anchor="middle" x="3918.5" y="-140.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.fass, trimmed))</text>
<text text-anchor="middle" x="3918.5" y="-124.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="3918.5" y="-109.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="3918.5" y="-94.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="3918.5" y="-78.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3918.5" y="-63.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_44&#45;&gt;leaf_45 -->
<g id="edge45" class="edge">
<title>codeblock_44&#45;&gt;leaf_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3956.3494,-456.8745C3951.3307,-414.3412 3938.5649,-306.1501 3929.2423,-227.1413"/>
<polygon fill="#000000" stroke="#000000" points="3932.7137,-226.6923 3928.0659,-217.1713 3925.7619,-227.5126 3932.7137,-226.6923"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="4594,-272.3007 4165,-272.3007 4165,.1003 4594,.1003 4594,-272.3007"/>
<text text-anchor="middle" x="4379.5" y="-257.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Codeblock, level, headline, linum)</text>
<text text-anchor="middle" x="4379.5" y="-241.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local codeblock = setmetatable({}, CB)</text>
<text text-anchor="middle" x="4379.5" y="-226.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.level = level</text>
<text text-anchor="middle" x="4379.5" y="-210.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.header = headline</text>
<text text-anchor="middle" x="4379.5" y="-195.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lang = L.match(L.C(m.symbol), headline) or &quot;&quot;</text>
<text text-anchor="middle" x="4379.5" y="-180.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.footer = &quot;&quot;</text>
<text text-anchor="middle" x="4379.5" y="-164.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.line_first = linum</text>
<text text-anchor="middle" x="4379.5" y="-149.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lines = {}</text>
<text text-anchor="middle" x="4379.5" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock</text>
<text text-anchor="middle" x="4379.5" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4379.5" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__call = new</text>
<text text-anchor="middle" x="4379.5" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__index = cb</text>
<text text-anchor="middle" x="4379.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, cb)</text>
</g>
<!-- codeblock_48&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>codeblock_48&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4342.5968,-456.8745C4346.4121,-423.7112 4354.8194,-350.632 4362.6469,-282.5923"/>
<polygon fill="#000000" stroke="#000000" points="4366.1311,-282.9301 4363.797,-272.5956 4359.177,-282.13 4366.1311,-282.9301"/>
</g>
</g>
</svg>