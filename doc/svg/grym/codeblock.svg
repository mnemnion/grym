<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4018pt" height="1137pt"
 viewBox="0.00 0.00 4018.00 1137.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1133.2012)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1133.2012 4014,-1133.2012 4014,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="736.5" cy="-1111.2012" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="736.5" y="-1107.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 157</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="736.5" cy="-1039.2012" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="736.5" y="-1035.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;15</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M736.5,-1093.0325C736.5,-1085.3321 736.5,-1076.1755 736.5,-1067.6178"/>
<polygon fill="#000000" stroke="#000000" points="740.0001,-1067.6144 736.5,-1057.6145 733.0001,-1067.6145 740.0001,-1067.6144"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="546.5" cy="-967.2012" rx="99.1626" ry="18"/>
<text text-anchor="middle" x="546.5" y="-963.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Code Block Module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M698.9621,-1024.9763C670.4414,-1014.1685 630.8527,-999.1664 599.1644,-987.1582"/>
<polygon fill="#000000" stroke="#000000" points="600.196,-983.8063 589.6047,-983.5356 597.7155,-990.3521 600.196,-983.8063"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="695.5" cy="-967.2012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="695.5" y="-963.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.3652,-1021.4034C721.5632,-1012.9707 715.7315,-1002.7297 710.4358,-993.43"/>
<polygon fill="#000000" stroke="#000000" points="713.3667,-991.5037 705.3768,-984.5458 707.2838,-994.9676 713.3667,-991.5037"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="777.5" cy="-967.2012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="777.5" y="-963.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M746.6348,-1021.4034C751.4368,-1012.9707 757.2685,-1002.7297 762.5642,-993.43"/>
<polygon fill="#000000" stroke="#000000" points="765.7162,-994.9676 767.6232,-984.5458 759.6333,-991.5037 765.7162,-994.9676"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1379.5" cy="-967.2012" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1379.5" y="-963.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;77</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M793.562,-1032.8117C911.0183,-1019.6595 1179.5621,-989.5893 1308.2191,-975.1829"/>
<polygon fill="#000000" stroke="#000000" points="1308.8097,-978.6387 1318.3581,-974.0476 1308.0307,-971.6822 1308.8097,-978.6387"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="573.5,-913.2012 519.5,-913.2012 519.5,-877.2012 573.5,-877.2012 573.5,-913.2012"/>
</g>
<!-- header_2&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>header_2&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.5,-949.0325C546.5,-941.3321 546.5,-932.1755 546.5,-923.6178"/>
<polygon fill="#000000" stroke="#000000" points="550.0001,-923.6144 546.5,-913.6145 543.0001,-923.6145 550.0001,-923.6144"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="657.5" cy="-895.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="657.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M686.3013,-949.772C681.8203,-941.2818 676.3379,-930.894 671.3634,-921.4686"/>
<polygon fill="#000000" stroke="#000000" points="674.377,-919.6801 666.614,-912.4699 668.1863,-922.9474 674.377,-919.6801"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="777.5" cy="-895.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="777.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777.5,-949.0325C777.5,-941.3321 777.5,-932.1755 777.5,-923.6178"/>
<polygon fill="#000000" stroke="#000000" points="781.0001,-923.6144 777.5,-913.6145 774.0001,-923.6145 781.0001,-923.6144"/>
</g>
<!-- header_11 -->
<g id="node12" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="1086.5" cy="-895.2012" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1086.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_5&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1330.4584,-955.15C1276.3207,-941.8465 1189.6867,-920.5576 1135.5469,-907.2537"/>
<polygon fill="#000000" stroke="#000000" points="1136.3774,-903.8537 1125.8311,-904.8662 1134.7069,-910.6515 1136.3774,-903.8537"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="1213.5" cy="-895.2012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1213.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1344.2957,-951.9318C1316.1164,-939.7095 1276.7871,-922.651 1248.6279,-910.4374"/>
<polygon fill="#000000" stroke="#000000" points="1249.7371,-907.1035 1239.1702,-906.3352 1246.9516,-913.5254 1249.7371,-907.1035"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1311.5" cy="-895.2012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1311.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1363.0391,-949.772C1354.2689,-940.4859 1343.3547,-928.9296 1333.8307,-918.8454"/>
<polygon fill="#000000" stroke="#000000" points="1336.288,-916.3498 1326.8771,-911.4829 1331.1989,-921.1562 1336.288,-916.3498"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="1443.5" cy="-895.2012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1443.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 36&#45;49</text>
</g>
<!-- section_5&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1395.3202,-949.4034C1403.0126,-940.7495 1412.3978,-930.1912 1420.8344,-920.7"/>
<polygon fill="#000000" stroke="#000000" points="1423.6122,-922.8431 1427.64,-913.0437 1418.3803,-918.1926 1423.6122,-922.8431"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1624.5" cy="-895.2012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1624.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1424.4368,-953.9953C1470.8308,-940.3611 1542.4396,-919.3169 1586.2234,-906.4498"/>
<polygon fill="#000000" stroke="#000000" points="1587.316,-909.7768 1595.9234,-903.5992 1585.3423,-903.0608 1587.316,-909.7768"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="1842.5" cy="-895.2012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1842.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 54&#45;76</text>
</g>
<!-- section_5&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1436.7373,-958.3004C1520.224,-945.3175 1675.4814,-921.1738 1767.8484,-906.8101"/>
<polygon fill="#000000" stroke="#000000" points="1768.6205,-910.2322 1777.9639,-905.237 1767.5448,-903.3153 1768.6205,-910.2322"/>
</g>
<!-- section_17 -->
<g id="node18" class="node">
<title>section_17</title>
<ellipse fill="none" stroke="#000000" cx="2702.5" cy="-895.2012" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2702.5" y="-891.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 78&#45;157</text>
</g>
<!-- section_5&#45;&gt;section_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;section_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1444.2066,-963.6797C1664.1256,-951.7114 2382.4447,-912.6192 2623.1065,-899.5219"/>
<polygon fill="#000000" stroke="#000000" points="2623.3833,-903.0121 2633.1783,-898.9738 2623.0028,-896.0225 2623.3833,-903.0121"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="499,-717.6012 0,-717.6012 0,-631.0006 499,-631.0006 499,-717.6012"/>
<text text-anchor="middle" x="249.5" y="-654.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Code blocks are the motivating object for Grimoire. &#160;Perforce they</text>
<text text-anchor="middle" x="249.5" y="-639.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> will do a lot of the heavy lifting.</text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M632.5416,-888.0446C602.365,-878.9676 550.4112,-861.9693 508.5,-841.2012 440.1682,-807.341 367.6204,-759.4336 316.7438,-723.6253"/>
<polygon fill="#000000" stroke="#000000" points="318.6383,-720.6784 308.4528,-717.762 314.5965,-726.3936 318.6383,-720.6784"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1037.5,-748.0013 517.5,-748.0013 517.5,-600.6005 1037.5,-600.6005 1037.5,-748.0013"/>
<text text-anchor="middle" x="777.5" y="-716.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> From the compiler&#39;s perspective, Code, Structure, and Prose are the</text>
<text text-anchor="middle" x="777.5" y="-701.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> three basic genres of Grimmorian text. &#160;In this implementation,</text>
<text text-anchor="middle" x="777.5" y="-685.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> you may think of Code as a clade diverged early from both Structure</text>
<text text-anchor="middle" x="777.5" y="-670.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> and Prose, with some later convergence toward the former. </text>
<text text-anchor="middle" x="777.5" y="-655.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="777.5" y="-639.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> Specifically, Structure and Prose will actually inherit from Block, and</text>
<text text-anchor="middle" x="777.5" y="-624.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> Code block, name notwithstanding, merely imitates some behaviours.</text>
<text text-anchor="middle" x="777.5" y="-608.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777.5,-877.124C777.5,-851.1698 777.5,-801.6653 777.5,-758.0632"/>
<polygon fill="#000000" stroke="#000000" points="781.0001,-757.9954 777.5,-747.9954 774.0001,-757.9955 781.0001,-757.9954"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1109.5,-692.3009 1055.5,-692.3009 1055.5,-656.3009 1109.5,-656.3009 1109.5,-692.3009"/>
</g>
<!-- header_11&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>header_11&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1086.1727,-877.124C1085.4765,-838.6801 1083.8448,-748.5665 1083.0106,-702.499"/>
<polygon fill="#000000" stroke="#000000" points="1086.5068,-702.2531 1082.8262,-692.3181 1079.508,-702.3799 1086.5068,-702.2531"/>
</g>
<!-- raw_19 -->
<g id="node20" class="node">
<title>raw_19</title>
<ellipse fill="none" stroke="#000000" cx="1154.5" cy="-674.3009" rx="27" ry="18"/>
<text text-anchor="middle" x="1154.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_12&#45;&gt;raw_19 -->
<g id="edge19" class="edge">
<title>prose_12&#45;&gt;raw_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1204.9613,-877.5245C1200.1985,-867.1323 1194.4485,-853.6323 1190.5,-841.2012 1175.318,-793.403 1164.4792,-735.8848 1158.8741,-702.3718"/>
<polygon fill="#000000" stroke="#000000" points="1162.3077,-701.6811 1157.2393,-692.3773 1155.3995,-702.8111 1162.3077,-701.6811"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1226.5" cy="-674.3009" rx="27" ry="18"/>
<text text-anchor="middle" x="1226.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_13&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_13&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1293.5237,-879.9278C1282.9263,-869.9566 1270.1373,-856.0641 1262.5,-841.2012 1239.3953,-796.2375 1231.0977,-737.1115 1228.1326,-702.6475"/>
<polygon fill="#000000" stroke="#000000" points="1231.5993,-702.077 1227.3453,-692.3737 1224.6197,-702.612 1231.5993,-702.077"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1631,-772.1012 1272,-772.1012 1272,-576.5006 1631,-576.5006 1631,-772.1012"/>
<text text-anchor="middle" x="1451.5" y="-757.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1451.5" y="-725.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1451.5" y="-694.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1451.5" y="-662.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local CB = setmetatable({}, Node)</text>
<text text-anchor="middle" x="1451.5" y="-647.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.id = &quot;codeblock&quot;</text>
<text text-anchor="middle" x="1451.5" y="-616.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__index = CB</text>
<text text-anchor="middle" x="1451.5" y="-584.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">CB.__tostring = function() return &quot;codeblock&quot; end</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_14&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1444.1547,-877.124C1444.9222,-855.932 1446.2582,-819.039 1447.5823,-782.4782"/>
<polygon fill="#000000" stroke="#000000" points="1451.0907,-782.3085 1447.955,-772.1883 1444.0952,-782.0551 1451.0907,-782.3085"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1676.5" cy="-674.3009" rx="27" ry="18"/>
<text text-anchor="middle" x="1676.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_15&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1629.7384,-877.264C1632.7345,-866.785 1636.4845,-853.285 1639.5,-841.2012 1651.6256,-792.6111 1663.8413,-735.5647 1670.7603,-702.32"/>
<polygon fill="#000000" stroke="#000000" points="1674.2133,-702.9055 1672.8138,-692.4035 1667.3587,-701.486 1674.2133,-702.9055"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2143.5,-841.1015 1721.5,-841.1015 1721.5,-507.5003 2143.5,-507.5003 2143.5,-841.1015"/>
<text text-anchor="middle" x="1932.5" y="-826.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toValue(codeblock)</text>
<text text-anchor="middle" x="1932.5" y="-810.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.val = &quot;&quot;</text>
<text text-anchor="middle" x="1932.5" y="-795.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(codeblock.lines) do</text>
<text text-anchor="middle" x="1932.5" y="-779.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;codeblock.val = codeblock.val .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1932.5" y="-764.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1932.5" y="-733.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock.val</text>
<text text-anchor="middle" x="1932.5" y="-717.601" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1932.5" y="-686.201" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.toMarkdown(codeblock)</text>
<text text-anchor="middle" x="1932.5" y="-670.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; hardcode lua</text>
<text text-anchor="middle" x="1932.5" y="-655.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &quot;```&quot; .. codeblock.lang .. &quot;\n&quot; </text>
<text text-anchor="middle" x="1932.5" y="-640.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. codeblock:toValue() .. &quot;```\n&quot;</text>
<text text-anchor="middle" x="1932.5" y="-624.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1932.5" y="-593.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.dotLabel(codeblock)</text>
<text text-anchor="middle" x="1932.5" y="-577.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;code block &quot; .. tostring(codeblock.line_first)</text>
<text text-anchor="middle" x="1932.5" y="-562.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(codeblock.line_last)</text>
<text text-anchor="middle" x="1932.5" y="-547.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1932.5" y="-515.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local cb = {}</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_16&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.8651,-877.124C1852.8199,-869.8716 1856.5238,-860.7804 1860.7152,-850.493"/>
<polygon fill="#000000" stroke="#000000" points="1863.9855,-851.7422 1864.5174,-841.1607 1857.5029,-849.101 1863.9855,-851.7422"/>
</g>
<!-- header_27 -->
<g id="node28" class="node">
<title>header_27</title>
<ellipse fill="none" stroke="#000000" cx="2212.5" cy="-674.3009" rx="50.8" ry="18"/>
<text text-anchor="middle" x="2212.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : asserts</text>
</g>
<!-- section_17&#45;&gt;header_27 -->
<g id="edge27" class="edge">
<title>section_17&#45;&gt;header_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2633.8977,-890.5078C2519.6475,-882.1176 2300.1376,-863.3369 2272.5,-841.2012 2230.0648,-807.2136 2217.6236,-740.7119 2213.9885,-702.7165"/>
<polygon fill="#000000" stroke="#000000" points="2217.4453,-702.0413 2213.149,-692.3567 2210.4682,-702.6067 2217.4453,-702.0413"/>
</g>
<!-- prose_28 -->
<g id="node29" class="node">
<title>prose_28</title>
<ellipse fill="none" stroke="#000000" cx="2313.5" cy="-674.3009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2313.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_28 -->
<g id="edge28" class="edge">
<title>section_17&#45;&gt;prose_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2632.105,-893.1995C2542.5984,-889.1817 2394.9195,-877.1459 2355.5,-841.2012 2316.6166,-805.7453 2311.3553,-740.0834 2311.858,-702.5563"/>
<polygon fill="#000000" stroke="#000000" points="2315.3633,-702.4171 2312.1486,-692.3217 2308.3661,-702.2183 2315.3633,-702.4171"/>
</g>
<!-- codeblock_29 -->
<g id="node30" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="2441.5" cy="-674.3009" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2441.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 80&#45;85</text>
</g>
<!-- section_17&#45;&gt;codeblock_29 -->
<g id="edge29" class="edge">
<title>section_17&#45;&gt;codeblock_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2638.3908,-887.5776C2602.7402,-880.5408 2559.4584,-867.0451 2528.5,-841.2012 2484.2475,-804.2595 2459.6705,-738.974 2448.6663,-701.9522"/>
<polygon fill="#000000" stroke="#000000" points="2452.0243,-700.9644 2445.9174,-692.3066 2445.2923,-702.883 2452.0243,-700.9644"/>
</g>
<!-- prose_30 -->
<g id="node31" class="node">
<title>prose_30</title>
<ellipse fill="none" stroke="#000000" cx="2569.5" cy="-674.3009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2569.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_30 -->
<g id="edge30" class="edge">
<title>section_17&#45;&gt;prose_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2662.9779,-880.1914C2644.8079,-871.4077 2624.4611,-858.5772 2611.5,-841.2012 2580.658,-799.8535 2572.3133,-738.37 2570.1491,-702.7132"/>
<polygon fill="#000000" stroke="#000000" points="2573.6356,-702.3471 2569.6578,-692.5274 2566.6437,-702.6844 2573.6356,-702.3471"/>
</g>
<!-- codeblock_31 -->
<g id="node32" class="node">
<title>codeblock_31</title>
<ellipse fill="none" stroke="#000000" cx="2702.5" cy="-674.3009" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2702.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 98&#45;109</text>
</g>
<!-- section_17&#45;&gt;codeblock_31 -->
<g id="edge31" class="edge">
<title>section_17&#45;&gt;codeblock_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2702.5,-877.124C2702.5,-838.6801 2702.5,-748.5665 2702.5,-702.499"/>
<polygon fill="#000000" stroke="#000000" points="2706.0001,-702.3181 2702.5,-692.3181 2699.0001,-702.3181 2706.0001,-702.3181"/>
</g>
<!-- prose_32 -->
<g id="node33" class="node">
<title>prose_32</title>
<ellipse fill="none" stroke="#000000" cx="2853.5" cy="-674.3009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2853.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_32 -->
<g id="edge32" class="edge">
<title>section_17&#45;&gt;prose_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2740.8325,-879.8422C2758.9397,-870.9128 2779.5816,-858.0592 2793.5,-841.2012 2827.4331,-800.1014 2842.9092,-738.278 2849.3742,-702.5452"/>
<polygon fill="#000000" stroke="#000000" points="2852.8826,-702.7892 2851.1017,-692.3451 2845.9809,-701.6202 2852.8826,-702.7892"/>
</g>
<!-- prose_33 -->
<g id="node34" class="node">
<title>prose_33</title>
<ellipse fill="none" stroke="#000000" cx="2970.5" cy="-674.3009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2970.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_33 -->
<g id="edge33" class="edge">
<title>section_17&#45;&gt;prose_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2760.0128,-884.5805C2808.8907,-874.573 2874.2599,-858.557 2894.5,-841.2012 2936.9559,-804.7954 2956.9309,-739.7688 2965.287,-702.5401"/>
<polygon fill="#000000" stroke="#000000" points="2968.7903,-702.8896 2967.4323,-692.3821 2961.9414,-701.443 2968.7903,-702.8896"/>
</g>
<!-- codeblock_34 -->
<g id="node35" class="node">
<title>codeblock_34</title>
<ellipse fill="none" stroke="#000000" cx="3185.5" cy="-674.3009" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3185.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 123&#45;134</text>
</g>
<!-- section_17&#45;&gt;codeblock_34 -->
<g id="edge34" class="edge">
<title>section_17&#45;&gt;codeblock_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2767.9963,-888.292C2845.6827,-879.3149 2969.9004,-862.2692 3011.5,-841.2012 3078.7408,-807.1473 3137.4749,-738.4268 3166.4025,-700.6548"/>
<polygon fill="#000000" stroke="#000000" points="3169.5503,-702.2934 3172.7741,-692.201 3163.9602,-698.0802 3169.5503,-702.2934"/>
</g>
<!-- prose_35 -->
<g id="node36" class="node">
<title>prose_35</title>
<ellipse fill="none" stroke="#000000" cx="3429.5" cy="-674.3009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3429.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_35 -->
<g id="edge35" class="edge">
<title>section_17&#45;&gt;prose_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2771.875,-891.5912C2915.7541,-883.6925 3236.9825,-863.7681 3281.5,-841.2012 3344.0732,-809.4814 3392.197,-739.0829 3414.9893,-700.6273"/>
<polygon fill="#000000" stroke="#000000" points="3418.2456,-701.9887 3420.2315,-691.5816 3412.1891,-698.4787 3418.2456,-701.9887"/>
</g>
<!-- codeblock_36 -->
<g id="node37" class="node">
<title>codeblock_36</title>
<ellipse fill="none" stroke="#000000" cx="3734.5" cy="-674.3009" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3734.5" y="-670.1009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 138&#45;156</text>
</g>
<!-- section_17&#45;&gt;codeblock_36 -->
<g id="edge36" class="edge">
<title>section_17&#45;&gt;codeblock_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2773.1713,-894.6273C2937.7125,-892.5861 3342.1469,-883.306 3470.5,-841.2012 3565.7653,-809.9505 3661.136,-736.777 3706.7639,-698.5412"/>
<polygon fill="#000000" stroke="#000000" points="3709.0626,-701.181 3714.4338,-692.0485 3704.5399,-695.8382 3709.0626,-701.181"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="941,-378.6007 470,-378.6007 470,-292.0002 941,-292.0002 941,-378.6007"/>
<text text-anchor="middle" x="705.5" y="-315.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Codeblock inherits from Node directly, and is born with these </text>
<text text-anchor="middle" x="705.5" y="-300.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> additional fields:</text>
</g>
<!-- raw_19&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>raw_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1156.3871,-656.2972C1158.8854,-622.1596 1158.9804,-547.8264 1118.5,-507.4007 1064.4677,-453.4412 1021.9914,-498.2351 950.5,-471.4007 890.2472,-448.7847 826.8537,-413.207 779.6494,-384.0988"/>
<polygon fill="#000000" stroke="#000000" points="781.3695,-381.047 771.0281,-378.7435 777.6759,-386.9932 781.3695,-381.047"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1493.5,-447.5009 959.5,-447.5009 959.5,-223.1 1493.5,-223.1 1493.5,-447.5009"/>
<text text-anchor="middle" x="1226.5" y="-416.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; level &#160;: &#160;The number of !s, which is the number of / needed to close</text>
<text text-anchor="middle" x="1226.5" y="-400.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the block.</text>
<text text-anchor="middle" x="1226.5" y="-385.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; header : &#160;The line after # and at least one !.</text>
<text text-anchor="middle" x="1226.5" y="-370.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; footer : &#160;The line closing the block. Optional, as a code block may</text>
<text text-anchor="middle" x="1226.5" y="-354.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end a file without a closing line.</text>
<text text-anchor="middle" x="1226.5" y="-339.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lines &#160;: &#160;Array containing the lines of code. &#160;Header and footer</text>
<text text-anchor="middle" x="1226.5" y="-323.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;are not included.</text>
<text text-anchor="middle" x="1226.5" y="-308.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_first : &#160;The first (header) line of the block. </text>
<text text-anchor="middle" x="1226.5" y="-293.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line_last &#160;: &#160;The closing line of the block. Note that code blocks also</text>
<text text-anchor="middle" x="1226.5" y="-277.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collect blank lines and may have a clinging tag. </text>
<text text-anchor="middle" x="1226.5" y="-262.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1226.5" y="-246.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> To be added:</text>
<text text-anchor="middle" x="1226.5" y="-231.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [ ] lang : The language, derived from the header line.</text>
</g>
<!-- raw_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>raw_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1226.5,-656.0748C1226.5,-618.9687 1226.5,-531.8915 1226.5,-457.8143"/>
<polygon fill="#000000" stroke="#000000" points="1230.0001,-457.4545 1226.5,-447.4545 1223.0001,-457.4545 1230.0001,-457.4545"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1885,-362.6009 1512,-362.6009 1512,-308 1885,-308 1885,-362.6009"/>
<text text-anchor="middle" x="1698.5" y="-331.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a .val field which is the union of all lines.</text>
<text text-anchor="middle" x="1698.5" y="-316.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> Useful in visualization. </text>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1677.6828,-656.0748C1681.1535,-602.5939 1691.361,-445.3068 1696.0696,-372.7512"/>
<polygon fill="#000000" stroke="#000000" points="1699.5679,-372.8892 1696.7229,-362.6835 1692.5826,-372.4359 1699.5679,-372.8892"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="2014.5,-353.3005 1960.5,-353.3005 1960.5,-317.3005 2014.5,-317.3005 2014.5,-353.3005"/>
</g>
<!-- header_27&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>header_27&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2211.2954,-656.3035C2208.0254,-622.1768 2196.026,-547.8613 2152.5,-507.4007 2108.903,-466.874 2065.3036,-513.7748 2023.5,-471.4007 1995.094,-442.6069 1988.3697,-394.166 1987.1657,-363.5117"/>
<polygon fill="#000000" stroke="#000000" points="1990.664,-363.3922 1986.9436,-353.4721 1983.6657,-363.5471 1990.664,-363.3922"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2059.5" cy="-335.3005" rx="27" ry="18"/>
<text text-anchor="middle" x="2059.5" y="-331.1005" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_28&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_28&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2314.8185,-656.2002C2316.244,-621.8969 2314.0302,-547.2927 2272.5,-507.4007 2214.605,-451.7893 2153.8849,-526.4973 2095.5,-471.4007 2066.0831,-443.6405 2059.6549,-394.8969 2058.7866,-363.8993"/>
<polygon fill="#000000" stroke="#000000" points="2062.2849,-363.7024 2058.6828,-353.7387 2055.2852,-363.774 2062.2849,-363.7024"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2330.5,-369.9017 2104.5,-369.9017 2104.5,-300.6992 2330.5,-300.6992 2330.5,-369.9017"/>
<text text-anchor="middle" x="2217.5" y="-354.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">function CB.check(codeblock)</text>
<text text-anchor="middle" x="2217.5" y="-339.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_first)</text>
<text text-anchor="middle" x="2217.5" y="-324.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert(codeblock.line_last)</text>
<text text-anchor="middle" x="2217.5" y="-308.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>codeblock_29&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2433.4328,-656.1312C2419.2068,-624.7731 2387.9817,-558.9056 2354.5,-507.4007 2324.2468,-460.8621 2284.1842,-411.6918 2255.2033,-377.8802"/>
<polygon fill="#000000" stroke="#000000" points="2257.6375,-375.3434 2248.4577,-370.0537 2252.3352,-379.9135 2257.6375,-375.3434"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="2375.5" cy="-335.3005" rx="27" ry="18"/>
<text text-anchor="middle" x="2375.5" y="-331.1005" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_30&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_30&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2570.3297,-656.297C2570.8687,-622.4894 2567.0499,-549.1624 2527.5,-507.4007 2490.3816,-468.2063 2448.8541,-510.3705 2411.5,-471.4007 2383.6334,-442.3288 2376.7249,-394.3008 2375.3401,-363.7604"/>
<polygon fill="#000000" stroke="#000000" points="2378.8278,-363.2663 2375.0512,-353.3674 2371.8305,-363.4608 2378.8278,-363.2663"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="2870.5,-416.3008 2420.5,-416.3008 2420.5,-254.3001 2870.5,-254.3001 2870.5,-416.3008"/>
<text text-anchor="middle" x="2645.5" y="-401.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchHead(str)</text>
<text text-anchor="middle" x="2645.5" y="-385.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codestart, str) then</text>
<text text-anchor="middle" x="2645.5" y="-370.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax, str))</text>
<text text-anchor="middle" x="2645.5" y="-354.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.zaps, trimmed) &#45; 1</text>
<text text-anchor="middle" x="2645.5" y="-339.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.zaps, trimmed))</text>
<text text-anchor="middle" x="2645.5" y="-324.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="2645.5" y="-308.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="2645.5" y="-293.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="2645.5" y="-277.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2645.5" y="-262.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_31&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_31&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2699.4354,-656.0748C2692.2838,-613.5414 2674.0924,-505.3503 2660.8078,-426.3416"/>
<polygon fill="#000000" stroke="#000000" points="2664.2412,-425.6528 2659.1314,-416.3716 2657.3381,-426.8135 2664.2412,-425.6528"/>
</g>
<!-- raw_44 -->
<g id="node45" class="node">
<title>raw_44</title>
<ellipse fill="none" stroke="#000000" cx="2915.5" cy="-335.3005" rx="27" ry="18"/>
<text text-anchor="middle" x="2915.5" y="-331.1005" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_32&#45;&gt;raw_44 -->
<g id="edge44" class="edge">
<title>prose_32&#45;&gt;raw_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2856.8334,-656.0748C2867.0758,-600.0717 2898.1364,-430.2402 2910.421,-363.0709"/>
<polygon fill="#000000" stroke="#000000" points="2913.8691,-363.6718 2912.2254,-353.2053 2906.9833,-362.4124 2913.8691,-363.6718"/>
</g>
<!-- raw_46 -->
<g id="node47" class="node">
<title>raw_46</title>
<ellipse fill="none" stroke="#000000" cx="2987.5" cy="-335.3005" rx="27" ry="18"/>
<text text-anchor="middle" x="2987.5" y="-331.1005" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_33&#45;&gt;raw_46 -->
<g id="edge46" class="edge">
<title>prose_33&#45;&gt;raw_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2971.414,-656.0748C2974.2101,-600.3172 2982.6645,-431.727 2986.0628,-363.9602"/>
<polygon fill="#000000" stroke="#000000" points="2989.5762,-363.7795 2986.5815,-353.6167 2982.5849,-363.4288 2989.5762,-363.7795"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="3490,-416.3008 3033,-416.3008 3033,-254.3001 3490,-254.3001 3490,-416.3008"/>
<text text-anchor="middle" x="3261.5" y="-401.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">function cb.matchFoot(str)</text>
<text text-anchor="middle" x="3261.5" y="-385.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if str ~= &quot;&quot; and L.match(m.codefinish, str) then</text>
<text text-anchor="middle" x="3261.5" y="-370.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local trimmed = str:sub(L.match(m.WS * m.hax &#160;&#160;&#160;, str))</text>
<text text-anchor="middle" x="3261.5" y="-354.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local level = L.match(m.fass, trimmed) &#45; 1</text>
<text text-anchor="middle" x="3261.5" y="-339.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local bareline = trimmed:sub(L.match(m.fass, trimmed))</text>
<text text-anchor="middle" x="3261.5" y="-324.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, level, bareline</text>
<text text-anchor="middle" x="3261.5" y="-308.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="3261.5" y="-293.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, 0, &quot;&quot;</text>
<text text-anchor="middle" x="3261.5" y="-277.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3261.5" y="-262.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_34&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>codeblock_34&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3189.5861,-656.0748C3199.1216,-613.5414 3223.3768,-505.3503 3241.0896,-426.3416"/>
<polygon fill="#000000" stroke="#000000" points="3244.5524,-426.895 3243.3248,-416.3716 3237.7219,-425.3637 3244.5524,-426.895"/>
</g>
<!-- raw_49 -->
<g id="node50" class="node">
<title>raw_49</title>
<ellipse fill="none" stroke="#000000" cx="3535.5" cy="-335.3005" rx="27" ry="18"/>
<text text-anchor="middle" x="3535.5" y="-331.1005" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_35&#45;&gt;raw_49 -->
<g id="edge49" class="edge">
<title>prose_35&#45;&gt;raw_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3436.1255,-656.5319C3449.1066,-621.4212 3478.4546,-540.56 3499.5,-471.4007 3510.7937,-434.2874 3521.9218,-390.8767 3528.7483,-363.2443"/>
<polygon fill="#000000" stroke="#000000" points="3532.1621,-364.0184 3531.1453,-353.4725 3525.3636,-362.3507 3532.1621,-364.0184"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="4010,-471.5009 3581,-471.5009 3581,-199.1 4010,-199.1 4010,-471.5009"/>
<text text-anchor="middle" x="3795.5" y="-456.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Codeblock, level, headline, linum)</text>
<text text-anchor="middle" x="3795.5" y="-440.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local codeblock = setmetatable({}, CB)</text>
<text text-anchor="middle" x="3795.5" y="-425.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.level = level</text>
<text text-anchor="middle" x="3795.5" y="-410.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.header = headline</text>
<text text-anchor="middle" x="3795.5" y="-394.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lang = L.match(L.C(m.symbol), headline) or &quot;&quot;</text>
<text text-anchor="middle" x="3795.5" y="-379.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.footer = &quot;&quot;</text>
<text text-anchor="middle" x="3795.5" y="-363.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.line_first = linum</text>
<text text-anchor="middle" x="3795.5" y="-348.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;codeblock.lines = {}</text>
<text text-anchor="middle" x="3795.5" y="-317.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return codeblock</text>
<text text-anchor="middle" x="3795.5" y="-301.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3795.5" y="-254.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__call = new</text>
<text text-anchor="middle" x="3795.5" y="-238.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">cb.__index = cb</text>
<text text-anchor="middle" x="3795.5" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, cb)</text>
</g>
<!-- codeblock_36&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>codeblock_36&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3737.7796,-656.0748C3743.7471,-622.9114 3756.897,-549.8323 3769.1401,-481.7926"/>
<polygon fill="#000000" stroke="#000000" points="3772.6126,-482.2576 3770.9389,-471.7958 3765.7232,-481.0179 3772.6126,-482.2576"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2086.5,-99.6001 2032.5,-99.6001 2032.5,-63.6001 2086.5,-63.6001 2086.5,-99.6001"/>
</g>
<!-- raw_38&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_38&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2059.5,-317.055C2059.5,-273.3538 2059.5,-162.4281 2059.5,-109.9469"/>
<polygon fill="#000000" stroke="#000000" points="2063.0001,-109.6803 2059.5,-99.6803 2056.0001,-109.6803 2063.0001,-109.6803"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="2590,-155.4005 2161,-155.4005 2161,-7.7998 2590,-7.7998 2590,-155.4005"/>
<text text-anchor="middle" x="2375.5" y="-124.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="2375.5" y="-108.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str : &#160;The string to match against.</text>
<text text-anchor="middle" x="2375.5" y="-93.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="2375.5" y="-78.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="2375.5" y="-62.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For header match</text>
<text text-anchor="middle" x="2375.5" y="-47.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="2375.5" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2375.5,-317.055C2375.5,-285.7278 2375.5,-219.8557 2375.5,-165.7315"/>
<polygon fill="#000000" stroke="#000000" points="2379.0001,-165.4254 2375.5,-155.4255 2372.0001,-165.4255 2379.0001,-165.4254"/>
</g>
<!-- leaf_45 -->
<g id="node46" class="node">
<title>leaf_45</title>
<polygon fill="none" stroke="#c0c0c0" points="2941.5,-101.5022 2687.5,-101.5022 2687.5,-61.698 2941.5,-61.698 2941.5,-101.5022"/>
<text text-anchor="middle" x="2814.5" y="-70.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Matches a code block footer line.</text>
</g>
<!-- raw_44&#45;&gt;leaf_45 -->
<g id="edge45" class="edge">
<title>raw_44&#45;&gt;leaf_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2912.1989,-317.2319C2907.0295,-290.7271 2895.8901,-240.0272 2879.5,-199.2002 2866.7638,-167.4751 2847.3089,-133.5347 2833.0012,-110.3116"/>
<polygon fill="#000000" stroke="#000000" points="2835.8662,-108.2915 2827.6032,-101.6602 2829.9274,-111.997 2835.8662,-108.2915"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3389,-163.3005 2960,-163.3005 2960,.1002 3389,.1002 3389,-163.3005"/>
<text text-anchor="middle" x="3174.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #args</text>
<text text-anchor="middle" x="3174.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str &#160;&#160;: &#160;The string to match against.</text>
<text text-anchor="middle" x="3174.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; level : &#160;Required level for a match.</text>
<text text-anchor="middle" x="3174.5" y="-85.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="3174.5" y="-70.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return 3</text>
<text text-anchor="middle" x="3174.5" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; boolean : &#160;For footer match</text>
<text text-anchor="middle" x="3174.5" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; number &#160;: &#160;Level of header</text>
<text text-anchor="middle" x="3174.5" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; string &#160;: &#160;Header stripped of left whitespace and tars</text>
</g>
<!-- raw_46&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>raw_46&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2988.6385,-317.062C2991.1284,-289.4463 2998.9793,-236.3144 3023.5,-199.2002 3030.0825,-189.2371 3037.7926,-179.7538 3046.184,-170.8118"/>
<polygon fill="#000000" stroke="#000000" points="3048.9074,-173.0322 3053.3832,-163.4292 3043.8958,-168.1451 3048.9074,-173.0322"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="3585.5,-101.5022 3485.5,-101.5022 3485.5,-61.698 3585.5,-61.698 3585.5,-101.5022"/>
<text text-anchor="middle" x="3535.5" y="-70.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Constructor</text>
</g>
<!-- raw_49&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_49&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3535.5,-317.055C3535.5,-273.7938 3535.5,-164.6552 3535.5,-111.5499"/>
<polygon fill="#000000" stroke="#000000" points="3539.0001,-111.4118 3535.5,-101.4118 3532.0001,-111.4118 3539.0001,-111.4118"/>
</g>
</g>
</svg>