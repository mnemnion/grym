<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="8007pt" height="1810pt"
 viewBox="0.00 0.00 8007.19 1810.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1806.2032)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1806.2032 8003.187,-1806.2032 8003.187,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="93.187" cy="-1784.2032" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="93.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 412</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="93.187" cy="-901.1016" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="93.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;379</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M93.187,-1766.1628C93.187,-1655.1814 93.187,-1065.3154 93.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="96.6871,-929.1134 93.187,-919.1134 89.6871,-929.1134 96.6871,-929.1134"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="93.187" cy="-18" rx="93.3745" ry="18"/>
<text text-anchor="middle" x="93.187" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Section metatable</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M93.187,-883.0611C93.187,-772.0797 93.187,-182.2138 93.187,-46.0569"/>
<polygon fill="#000000" stroke="#000000" points="96.6871,-46.0118 93.187,-36.0118 89.6871,-46.0118 96.6871,-46.0118"/>
</g>
<!-- section_3 -->
<g id="node4" class="node">
<title>section_3</title>
<ellipse fill="none" stroke="#000000" cx="220.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="220.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_3</text>
</g>
<!-- header_10 -->
<g id="node5" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="220.187" cy="-901.1016" rx="43.082" ry="18"/>
<text text-anchor="middle" x="220.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Array</text>
</g>
<!-- section_3&#45;&gt;header_10 -->
<g id="edge3" class="edge">
<title>section_3&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M220.187,-1766.1628C220.187,-1655.1814 220.187,-1065.3154 220.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="223.6871,-929.1134 220.187,-919.1134 216.6871,-929.1134 223.6871,-929.1134"/>
</g>
<!-- section_4 -->
<g id="node6" class="node">
<title>section_4</title>
<ellipse fill="none" stroke="#000000" cx="334.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="334.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_4</text>
</g>
<!-- header_11 -->
<g id="node7" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="334.187" cy="-901.1016" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="334.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_4&#45;&gt;header_11 -->
<g id="edge4" class="edge">
<title>section_4&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M334.187,-1766.1628C334.187,-1655.1814 334.187,-1065.3154 334.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="337.6871,-929.1134 334.187,-919.1134 330.6871,-929.1134 337.6871,-929.1134"/>
</g>
<!-- section_12 -->
<g id="node8" class="node">
<title>section_12</title>
<ellipse fill="none" stroke="#000000" cx="453.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="453.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_12</text>
</g>
<!-- header_13 -->
<g id="node9" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="453.187" cy="-901.1016" rx="55.1697" ry="18"/>
<text text-anchor="middle" x="453.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Includes</text>
</g>
<!-- section_12&#45;&gt;header_13 -->
<g id="edge5" class="edge">
<title>section_12&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M453.187,-1766.1628C453.187,-1655.1814 453.187,-1065.3154 453.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="456.6871,-929.1134 453.187,-919.1134 449.6871,-929.1134 456.6871,-929.1134"/>
</g>
<!-- codeblock_14 -->
<g id="node10" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="681.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="681.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_14</text>
</g>
<!-- leaf_15 -->
<g id="node11" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="836.187,-982.9019 526.187,-982.9019 526.187,-819.3013 836.187,-819.3013 836.187,-982.9019"/>
<text text-anchor="middle" x="681.187" y="-967.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="681.187" y="-936.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="681.187" y="-905.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="681.187" y="-873.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Header = require &quot;grym/header&quot;</text>
<text text-anchor="middle" x="681.187" y="-858.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Block = require &quot;grym/block&quot;</text>
<text text-anchor="middle" x="681.187" y="-842.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Codeblock = require &quot;grym/codeblock&quot;</text>
<text text-anchor="middle" x="681.187" y="-827.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_15 -->
<g id="edge6" class="edge">
<title>codeblock_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M681.187,-1766.1628C681.187,-1668.0046 681.187,-1195.2332 681.187,-993.088"/>
<polygon fill="#000000" stroke="#000000" points="684.6871,-993.0847 681.187,-983.0847 677.6871,-993.0848 684.6871,-993.0847"/>
</g>
<!-- section_5 -->
<g id="node12" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="963.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="963.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_5</text>
</g>
<!-- header_16 -->
<g id="node13" class="node">
<title>header_16</title>
<ellipse fill="none" stroke="#000000" cx="963.187" cy="-901.1016" rx="108.8185" ry="18"/>
<text text-anchor="middle" x="963.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Metatable for sections</text>
</g>
<!-- section_5&#45;&gt;header_16 -->
<g id="edge7" class="edge">
<title>section_5&#45;&gt;header_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M963.187,-1766.1628C963.187,-1655.1814 963.187,-1065.3154 963.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="966.6871,-929.1134 963.187,-919.1134 959.6871,-929.1134 966.6871,-929.1134"/>
</g>
<!-- codeblock_17 -->
<g id="node14" class="node">
<title>codeblock_17</title>
<ellipse fill="none" stroke="#000000" cx="1259.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="1259.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_17</text>
</g>
<!-- leaf_20 -->
<g id="node15" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1428.187,-1013.4021 1090.187,-1013.4021 1090.187,-788.8011 1428.187,-788.8011 1428.187,-1013.4021"/>
<text text-anchor="middle" x="1259.187" y="-998.3018" font-family="Inconsolata" font-size="14.00" fill="#000000">local S, s = u.inherit(Node)</text>
<text text-anchor="middle" x="1259.187" y="-966.9018" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.__tostring(section)</text>
<text text-anchor="middle" x="1259.187" y="-951.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1259.187" y="-936.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(section) do</text>
<text text-anchor="middle" x="1259.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local repr = tostring(v)</text>
<text text-anchor="middle" x="1259.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if (repr ~= &quot;&quot; and repr ~= &quot;\n&quot;) then</text>
<text text-anchor="middle" x="1259.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write(&quot;repr: &quot; .. repr .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1259.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. repr .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1259.187" y="-859.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1259.187" y="-843.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1259.187" y="-812.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="1259.187" y="-796.9015" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_17&#45;&gt;leaf_20 -->
<g id="edge8" class="edge">
<title>codeblock_17&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1259.187,-1766.1628C1259.187,-1672.678 1259.187,-1239.4021 1259.187,-1023.7316"/>
<polygon fill="#000000" stroke="#000000" points="1262.6871,-1023.6282 1259.187,-1013.6283 1255.6871,-1023.6283 1262.6871,-1023.6282"/>
</g>
<!-- section_18 -->
<g id="node16" class="node">
<title>section_18</title>
<ellipse fill="none" stroke="#000000" cx="1536.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="1536.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_18</text>
</g>
<!-- header_21 -->
<g id="node17" class="node">
<title>header_21</title>
<ellipse fill="none" stroke="#000000" cx="1536.187" cy="-901.1016" rx="90.4762" ry="18"/>
<text text-anchor="middle" x="1536.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : dotLabel(section)</text>
</g>
<!-- section_18&#45;&gt;header_21 -->
<g id="edge9" class="edge">
<title>section_18&#45;&gt;header_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1536.187,-1766.1628C1536.187,-1655.1814 1536.187,-1065.3154 1536.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="1539.6871,-929.1134 1536.187,-919.1134 1532.6871,-929.1134 1539.6871,-929.1134"/>
</g>
<!-- codeblock_22 -->
<g id="node18" class="node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="1845.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="1845.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_22</text>
</g>
<!-- leaf_23 -->
<g id="node19" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2045.687,-935.7029 1644.687,-935.7029 1644.687,-866.5003 2045.687,-866.5003 2045.687,-935.7029"/>
<text text-anchor="middle" x="1845.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.dotLabel(section)</text>
<text text-anchor="middle" x="1845.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;section: &quot; .. tostring(section.line_first) </text>
<text text-anchor="middle" x="1845.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(section.line_last)</text>
<text text-anchor="middle" x="1845.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_23 -->
<g id="edge10" class="edge">
<title>codeblock_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1845.187,-1766.1628C1845.187,-1659.3072 1845.187,-1108.5114 1845.187,-946.1771"/>
<polygon fill="#000000" stroke="#000000" points="1848.6871,-946.055 1845.187,-936.0551 1841.6871,-946.0551 1848.6871,-946.055"/>
</g>
<!-- section_19 -->
<g id="node20" class="node">
<title>section_19</title>
<ellipse fill="none" stroke="#000000" cx="2168.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="2168.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_19</text>
</g>
<!-- header_24 -->
<g id="node21" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2168.187" cy="-901.1016" rx="104.4491" ry="18"/>
<text text-anchor="middle" x="2168.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : toMarkdown(section)</text>
</g>
<!-- section_19&#45;&gt;header_24 -->
<g id="edge11" class="edge">
<title>section_19&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2168.187,-1766.1628C2168.187,-1655.1814 2168.187,-1065.3154 2168.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="2171.6871,-929.1134 2168.187,-919.1134 2164.6871,-929.1134 2171.6871,-929.1134"/>
</g>
<!-- codeblock_25 -->
<g id="node22" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="2505.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="2505.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_25</text>
</g>
<!-- leaf_27 -->
<g id="node23" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2719.687,-998.0024 2290.687,-998.0024 2290.687,-804.2008 2719.687,-804.2008 2719.687,-998.0024"/>
<text text-anchor="middle" x="2505.187" y="-982.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.toMarkdown(section)</text>
<text text-anchor="middle" x="2505.187" y="-967.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2505.187" y="-951.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, node in ipairs(section) do</text>
<text text-anchor="middle" x="2505.187" y="-936.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="2505.187" y="-921.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="2505.187" y="-905.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else </text>
<text text-anchor="middle" x="2505.187" y="-890.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;no toMarkdown method in &quot; .. node.id)</text>
<text text-anchor="middle" x="2505.187" y="-874.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2505.187" y="-859.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2505.187" y="-828.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="2505.187" y="-812.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_27 -->
<g id="edge12" class="edge">
<title>codeblock_25&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2505.187,-1766.1628C2505.187,-1670.3703 2505.187,-1217.804 2505.187,-1008.1661"/>
<polygon fill="#000000" stroke="#000000" points="2508.6871,-1008.0644 2505.187,-998.0644 2501.6871,-1008.0644 2508.6871,-1008.0644"/>
</g>
<!-- section_26 -->
<g id="node24" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2788.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="2788.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_26</text>
</g>
<!-- header_28 -->
<g id="node25" class="node">
<title>header_28</title>
<ellipse fill="none" stroke="#000000" cx="2788.187" cy="-901.1016" rx="50.8" ry="18"/>
<text text-anchor="middle" x="2788.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : asserts</text>
</g>
<!-- section_26&#45;&gt;header_28 -->
<g id="edge13" class="edge">
<title>section_26&#45;&gt;header_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2788.187,-1766.1628C2788.187,-1655.1814 2788.187,-1065.3154 2788.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="2791.6871,-929.1134 2788.187,-919.1134 2784.6871,-929.1134 2791.6871,-929.1134"/>
</g>
<!-- codeblock_29 -->
<g id="node26" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="3061.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="3061.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_29</text>
</g>
<!-- leaf_30 -->
<g id="node27" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3265.187,-1028.5024 2857.187,-1028.5024 2857.187,-773.7008 3265.187,-773.7008 3265.187,-1028.5024"/>
<text text-anchor="middle" x="3061.187" y="-1013.1019" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.check(section)</text>
<text text-anchor="middle" x="3061.187" y="-997.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i, v in ipairs(section) do</text>
<text text-anchor="middle" x="3061.187" y="-982.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if (i == 1) then</text>
<text text-anchor="middle" x="3061.187" y="-966.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if section.header then</text>
<text text-anchor="middle" x="3061.187" y="-951.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assert(v.id == &quot;header&quot;)</text>
<text text-anchor="middle" x="3061.187" y="-936.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3061.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3061.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assert(v.id == &quot;section&quot; or v.id == &quot;block&quot;)</text>
<text text-anchor="middle" x="3061.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3061.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3061.187" y="-859.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.level)</text>
<text text-anchor="middle" x="3061.187" y="-843.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.id)</text>
<text text-anchor="middle" x="3061.187" y="-828.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.lines)</text>
<text text-anchor="middle" x="3061.187" y="-812.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.line_first)</text>
<text text-anchor="middle" x="3061.187" y="-797.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.line_last)</text>
<text text-anchor="middle" x="3061.187" y="-782.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_30 -->
<g id="edge14" class="edge">
<title>codeblock_29&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3061.187,-1766.1628C3061.187,-1674.7463 3061.187,-1258.4082 3061.187,-1038.3603"/>
<polygon fill="#000000" stroke="#000000" points="3064.6871,-1038.3552 3061.187,-1028.3553 3057.6871,-1038.3553 3064.6871,-1038.3552"/>
</g>
<!-- section_6 -->
<g id="node28" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="3392.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="3392.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_6</text>
</g>
<!-- header_31 -->
<g id="node29" class="node">
<title>header_31</title>
<ellipse fill="none" stroke="#000000" cx="3392.187" cy="-901.1016" rx="108.8358" ry="18"/>
<text text-anchor="middle" x="3392.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : addLine(section, line) </text>
</g>
<!-- section_6&#45;&gt;header_31 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;header_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3392.187,-1766.1628C3392.187,-1655.1814 3392.187,-1065.3154 3392.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="3395.6871,-929.1134 3392.187,-919.1134 3388.6871,-929.1134 3395.6871,-929.1134"/>
</g>
<!-- codeblock_32 -->
<g id="node30" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="3681.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="3681.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_32</text>
</g>
<!-- leaf_35 -->
<g id="node31" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3843.187,-935.7029 3519.187,-935.7029 3519.187,-866.5003 3843.187,-866.5003 3843.187,-935.7029"/>
<text text-anchor="middle" x="3681.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.addLine(section, line)</text>
<text text-anchor="middle" x="3681.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section.lines[#section.lines + 1] = line</text>
<text text-anchor="middle" x="3681.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return section</text>
<text text-anchor="middle" x="3681.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_35 -->
<g id="edge16" class="edge">
<title>codeblock_32&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3681.187,-1766.1628C3681.187,-1659.3072 3681.187,-1108.5114 3681.187,-946.1771"/>
<polygon fill="#000000" stroke="#000000" points="3684.6871,-946.055 3681.187,-936.0551 3677.6871,-946.0551 3684.6871,-946.055"/>
</g>
<!-- section_33 -->
<g id="node32" class="node">
<title>section_33</title>
<ellipse fill="none" stroke="#000000" cx="4037.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="4037.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_33</text>
</g>
<!-- header_36 -->
<g id="node33" class="node">
<title>header_36</title>
<ellipse fill="none" stroke="#000000" cx="4037.187" cy="-901.1016" rx="175.5244" ry="18"/>
<text text-anchor="middle" x="4037.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : addSection(section, newsection, linum)</text>
</g>
<!-- section_33&#45;&gt;header_36 -->
<g id="edge17" class="edge">
<title>section_33&#45;&gt;header_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4037.187,-1766.1628C4037.187,-1655.1814 4037.187,-1065.3154 4037.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="4040.6871,-929.1134 4037.187,-919.1134 4033.6871,-929.1134 4040.6871,-929.1134"/>
</g>
<!-- codeblock_37 -->
<g id="node34" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="4410.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="4410.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_37</text>
</g>
<!-- leaf_38 -->
<g id="node35" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="4589.687,-958.902 4230.687,-958.902 4230.687,-843.3012 4589.687,-843.3012 4589.687,-958.902"/>
<text text-anchor="middle" x="4410.187" y="-943.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.addSection(section, newsection, linum)</text>
<text text-anchor="middle" x="4410.187" y="-928.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if linum &gt; 0 then</text>
<text text-anchor="middle" x="4410.187" y="-913.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section.line_last = linum &#45; 1</text>
<text text-anchor="middle" x="4410.187" y="-897.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4410.187" y="-882.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section[#section + 1] = newsection</text>
<text text-anchor="middle" x="4410.187" y="-866.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return section</text>
<text text-anchor="middle" x="4410.187" y="-851.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_38 -->
<g id="edge18" class="edge">
<title>codeblock_37&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4410.187,-1766.1628C4410.187,-1663.9246 4410.187,-1155.2837 4410.187,-969.33"/>
<polygon fill="#000000" stroke="#000000" points="4413.6871,-969.1343 4410.187,-959.1343 4406.6871,-969.1344 4413.6871,-969.1343"/>
</g>
<!-- section_34 -->
<g id="node36" class="node">
<title>section_34</title>
<ellipse fill="none" stroke="#000000" cx="4745.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="4745.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_34</text>
</g>
<!-- header_39 -->
<g id="node37" class="node">
<title>header_39</title>
<ellipse fill="none" stroke="#000000" cx="4745.187" cy="-901.1016" rx="137.8106" ry="18"/>
<text text-anchor="middle" x="4745.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Helper Functions for Blocking</text>
</g>
<!-- section_34&#45;&gt;header_39 -->
<g id="edge19" class="edge">
<title>section_34&#45;&gt;header_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4745.187,-1766.1628C4745.187,-1655.1814 4745.187,-1065.3154 4745.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="4748.6871,-929.1134 4745.187,-919.1134 4741.6871,-929.1134 4748.6871,-929.1134"/>
</g>
<!-- codeblock_40 -->
<g id="node38" class="node">
<title>codeblock_40</title>
<ellipse fill="none" stroke="#000000" cx="5038.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="5038.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_40</text>
</g>
<!-- leaf_46 -->
<g id="node39" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="5175.687,-928.3021 4900.687,-928.3021 4900.687,-873.9011 5175.687,-873.9011 5175.687,-928.3021"/>
<text text-anchor="middle" x="5038.187" y="-913.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local function isTagline(line)</text>
<text text-anchor="middle" x="5038.187" y="-897.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return L.match(m.tagline_p, line)</text>
<text text-anchor="middle" x="5038.187" y="-882.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_40&#45;&gt;leaf_46 -->
<g id="edge20" class="edge">
<title>codeblock_40&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5038.187,-1766.1628C5038.187,-1657.6033 5038.187,-1090.8329 5038.187,-938.7112"/>
<polygon fill="#000000" stroke="#000000" points="5041.6871,-938.487 5038.187,-928.4871 5034.6871,-938.4871 5041.6871,-938.487"/>
</g>
<!-- codeblock_41 -->
<g id="node40" class="node">
<title>codeblock_41</title>
<ellipse fill="none" stroke="#000000" cx="5335.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="5335.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_41</text>
</g>
<!-- leaf_47 -->
<g id="node41" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="5476.187,-1028.5024 5194.187,-1028.5024 5194.187,-773.7008 5476.187,-773.7008 5476.187,-1028.5024"/>
<text text-anchor="middle" x="5335.187" y="-1013.1019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fwdBlanks(lines, linum)</text>
<text text-anchor="middle" x="5335.187" y="-997.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local fwd = 0</text>
<text text-anchor="middle" x="5335.187" y="-982.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local index = linum + 1</text>
<text text-anchor="middle" x="5335.187" y="-966.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if index &gt; #lines then </text>
<text text-anchor="middle" x="5335.187" y="-951.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return 0</text>
<text text-anchor="middle" x="5335.187" y="-936.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="5335.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for i = index, #lines do</text>
<text text-anchor="middle" x="5335.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if lines[i] == &quot;&quot; then</text>
<text text-anchor="middle" x="5335.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fwd = fwd + 1</text>
<text text-anchor="middle" x="5335.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="5335.187" y="-859.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break</text>
<text text-anchor="middle" x="5335.187" y="-843.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5335.187" y="-828.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5335.187" y="-812.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5335.187" y="-797.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return fwd</text>
<text text-anchor="middle" x="5335.187" y="-782.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_41&#45;&gt;leaf_47 -->
<g id="edge21" class="edge">
<title>codeblock_41&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5335.187,-1766.1628C5335.187,-1674.7463 5335.187,-1258.4082 5335.187,-1038.3603"/>
<polygon fill="#000000" stroke="#000000" points="5338.6871,-1038.3552 5335.187,-1028.3553 5331.6871,-1038.3553 5338.6871,-1038.3552"/>
</g>
<!-- section_42 -->
<g id="node42" class="node">
<title>section_42</title>
<ellipse fill="none" stroke="#000000" cx="5546.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="5546.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_42</text>
</g>
<!-- header_48 -->
<g id="node43" class="node">
<title>header_48</title>
<ellipse fill="none" stroke="#000000" cx="5546.187" cy="-901.1016" rx="52.2623" ry="18"/>
<text text-anchor="middle" x="5546.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : List line</text>
</g>
<!-- section_42&#45;&gt;header_48 -->
<g id="edge22" class="edge">
<title>section_42&#45;&gt;header_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5546.187,-1766.1628C5546.187,-1655.1814 5546.187,-1065.3154 5546.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="5549.6871,-929.1134 5546.187,-919.1134 5542.6871,-929.1134 5549.6871,-929.1134"/>
</g>
<!-- section_43 -->
<g id="node44" class="node">
<title>section_43</title>
<ellipse fill="none" stroke="#000000" cx="5676.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="5676.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_43</text>
</g>
<!-- header_49 -->
<g id="node45" class="node">
<title>header_49</title>
<ellipse fill="none" stroke="#000000" cx="5676.187" cy="-901.1016" rx="59.7106" ry="18"/>
<text text-anchor="middle" x="5676.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : Table line</text>
</g>
<!-- section_43&#45;&gt;header_49 -->
<g id="edge23" class="edge">
<title>section_43&#45;&gt;header_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5676.187,-1766.1628C5676.187,-1655.1814 5676.187,-1065.3154 5676.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="5679.6871,-929.1134 5676.187,-919.1134 5672.6871,-929.1134 5679.6871,-929.1134"/>
</g>
<!-- section_44 -->
<g id="node46" class="node">
<title>section_44</title>
<ellipse fill="none" stroke="#000000" cx="5809.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="5809.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_44</text>
</g>
<!-- header_50 -->
<g id="node47" class="node">
<title>header_50</title>
<ellipse fill="none" stroke="#000000" cx="5809.187" cy="-901.1016" rx="55.3589" ry="18"/>
<text text-anchor="middle" x="5809.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : Tag line </text>
</g>
<!-- section_44&#45;&gt;header_50 -->
<g id="edge24" class="edge">
<title>section_44&#45;&gt;header_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5809.187,-1766.1628C5809.187,-1655.1814 5809.187,-1065.3154 5809.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="5812.6871,-929.1134 5809.187,-919.1134 5805.6871,-929.1134 5812.6871,-929.1134"/>
</g>
<!-- section_45 -->
<g id="node48" class="node">
<title>section_45</title>
<ellipse fill="none" stroke="#000000" cx="5949.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="5949.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_45</text>
</g>
<!-- header_51 -->
<g id="node49" class="node">
<title>header_51</title>
<ellipse fill="none" stroke="#000000" cx="5949.187" cy="-901.1016" rx="66.779" ry="18"/>
<text text-anchor="middle" x="5949.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : Code block</text>
</g>
<!-- section_45&#45;&gt;header_51 -->
<g id="edge25" class="edge">
<title>section_45&#45;&gt;header_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5949.187,-1766.1628C5949.187,-1655.1814 5949.187,-1065.3154 5949.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="5952.6871,-929.1134 5949.187,-919.1134 5945.6871,-929.1134 5952.6871,-929.1134"/>
</g>
<!-- codeblock_52 -->
<g id="node50" class="node">
<title>codeblock_52</title>
<ellipse fill="none" stroke="#000000" cx="6325.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="6325.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_52</text>
</g>
<!-- leaf_53 -->
<g id="node51" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="6616.687,-1730.3048 6033.687,-1730.3048 6033.687,-71.8984 6616.687,-71.8984 6616.687,-1730.3048"/>
<text text-anchor="middle" x="6325.187" y="-1715.0032" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.block(section)</text>
<text text-anchor="middle" x="6325.187" y="-1699.6032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; There is always a header at [1], though it may be nil</text>
<text text-anchor="middle" x="6325.187" y="-1684.2032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; If there are other Nodes, they are sections and must be appended</text>
<text text-anchor="middle" x="6325.187" y="-1668.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; after the blocks.</text>
<text text-anchor="middle" x="6325.187" y="-1653.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local sub_sections = {}</text>
<text text-anchor="middle" x="6325.187" y="-1638.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i = 2, #section do</text>
<text text-anchor="middle" x="6325.187" y="-1622.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;sub_sections[#sub_sections + 1] = section[i]</text>
<text text-anchor="middle" x="6325.187" y="-1607.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section[i] = nil</text>
<text text-anchor="middle" x="6325.187" y="-1591.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-1560.4029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Every section gets at least one block, at [2], which may be empty.</text>
<text text-anchor="middle" x="6325.187" y="-1545.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local latest = Block(nil, section.line_first) &#45;&#45; current block</text>
<text text-anchor="middle" x="6325.187" y="-1529.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section[2] = latest</text>
<text text-anchor="middle" x="6325.187" y="-1498.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; State machine for blocking a section</text>
<text text-anchor="middle" x="6325.187" y="-1482.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local back_blanks = 0</text>
<text text-anchor="middle" x="6325.187" y="-1467.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; first set of blank lines in a section belong to the first block</text>
<text text-anchor="middle" x="6325.187" y="-1452.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local lead_blanks = true</text>
<text text-anchor="middle" x="6325.187" y="-1436.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Track code blocks in own logic</text>
<text text-anchor="middle" x="6325.187" y="-1421.2027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local code_block = false</text>
<text text-anchor="middle" x="6325.187" y="-1405.8027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Tags also</text>
<text text-anchor="middle" x="6325.187" y="-1390.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local tagging = false</text>
<text text-anchor="middle" x="6325.187" y="-1375.0026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i = 1, #section.lines do</text>
<text text-anchor="middle" x="6325.187" y="-1359.6026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local inset = i + section.line_first</text>
<text text-anchor="middle" x="6325.187" y="-1344.2025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local l = section.lines[i]</text>
<text text-anchor="middle" x="6325.187" y="-1328.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not code_block then</text>
<text text-anchor="middle" x="6325.187" y="-1313.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if l == &quot;&quot; then </text>
<text text-anchor="middle" x="6325.187" y="-1298.0024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; increment back blanks for clinging subsequent lines</text>
<text text-anchor="middle" x="6325.187" y="-1282.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;back_blanks = back_blanks + 1</text>
<text text-anchor="middle" x="6325.187" y="-1267.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; blank lines attach to the preceding block</text>
<text text-anchor="middle" x="6325.187" y="-1251.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest:addLine(l)</text>
<text text-anchor="middle" x="6325.187" y="-1236.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-1221.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local isCodeHeader, level, l_trim = Codeblock.matchHead(l)</text>
<text text-anchor="middle" x="6325.187" y="-1205.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if isCodeHeader then</text>
<text text-anchor="middle" x="6325.187" y="-1190.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;code_block = true</text>
<text text-anchor="middle" x="6325.187" y="-1174.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if not tagging then</text>
<text text-anchor="middle" x="6325.187" y="-1159.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; create a new block for the codeblock</text>
<text text-anchor="middle" x="6325.187" y="-1144.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest.line_last = inset &#45; 1</text>
<text text-anchor="middle" x="6325.187" y="-1128.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest = Block(nil, inset)</text>
<text text-anchor="middle" x="6325.187" y="-1113.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1] = Codeblock(level, l_trim, inset)</text>
<text text-anchor="middle" x="6325.187" y="-1097.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;section[#section + 1] = latest</text>
<text text-anchor="middle" x="6325.187" y="-1082.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-1067.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; preserve existing block and add codeblock</text>
<text text-anchor="middle" x="6325.187" y="-1051.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tagging = false</text>
<text text-anchor="middle" x="6325.187" y="-1036.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1] = Codeblock(level, l_trim, inset)</text>
<text text-anchor="middle" x="6325.187" y="-1020.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-1005.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif isTagline(l) then</text>
<text text-anchor="middle" x="6325.187" y="-990.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tagging = true</text>
<text text-anchor="middle" x="6325.187" y="-974.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; apply cling rule</text>
<text text-anchor="middle" x="6325.187" y="-959.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local fwd_blanks = fwdBlanks(section.lines, i)</text>
<text text-anchor="middle" x="6325.187" y="-943.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if fwd_blanks &gt; back_blanks then</text>
<text text-anchor="middle" x="6325.187" y="-928.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest:addLine(l)</text>
<text text-anchor="middle" x="6325.187" y="-913.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-897.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new block</text>
<text text-anchor="middle" x="6325.187" y="-882.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest.line_last = inset &#45; 1</text>
<text text-anchor="middle" x="6325.187" y="-866.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest = Block(l, inset)</text>
<text text-anchor="middle" x="6325.187" y="-851.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;section[#section + 1] = latest</text>
<text text-anchor="middle" x="6325.187" y="-836.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;back_blanks = 0</text>
<text text-anchor="middle" x="6325.187" y="-820.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="6325.187" y="-805.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-789.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if back_blanks &gt; 0 and lead_blanks == false then</text>
<text text-anchor="middle" x="6325.187" y="-774.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if not tagging then</text>
<text text-anchor="middle" x="6325.187" y="-759.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new block</text>
<text text-anchor="middle" x="6325.187" y="-743.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest.line_last = inset &#45; 1</text>
<text text-anchor="middle" x="6325.187" y="-728.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest = Block(l, inset)</text>
<text text-anchor="middle" x="6325.187" y="-712.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;section[#section + 1] = latest</text>
<text text-anchor="middle" x="6325.187" y="-697.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;back_blanks = 0</text>
<text text-anchor="middle" x="6325.187" y="-682.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-666.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest:addLine(l)</text>
<text text-anchor="middle" x="6325.187" y="-651.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tagging = false</text>
<text text-anchor="middle" x="6325.187" y="-635.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end </text>
<text text-anchor="middle" x="6325.187" y="-620.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-605.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; continuing a block</text>
<text text-anchor="middle" x="6325.187" y="-589.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;lead_blanks = false</text>
<text text-anchor="middle" x="6325.187" y="-574.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;back_blanks = 0</text>
<text text-anchor="middle" x="6325.187" y="-558.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest:addLine(l)</text>
<text text-anchor="middle" x="6325.187" y="-543.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-528.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-512.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-497.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-481.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Collecting a code block</text>
<text text-anchor="middle" x="6325.187" y="-466.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local isCodeFoot, level, l_trim = Codeblock.matchFoot(l)</text>
<text text-anchor="middle" x="6325.187" y="-451.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (isCodeFoot and level == latest[1].level) then</text>
<text text-anchor="middle" x="6325.187" y="-435.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;code_block = false</text>
<text text-anchor="middle" x="6325.187" y="-420.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1].footer = l_trim</text>
<text text-anchor="middle" x="6325.187" y="-404.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1].line_last = inset</text>
<text text-anchor="middle" x="6325.187" y="-389.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6325.187" y="-374.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1].lines[#latest[1].lines + 1] = l</text>
<text text-anchor="middle" x="6325.187" y="-358.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-343.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Continue in normal parse mode</text>
<text text-anchor="middle" x="6325.187" y="-327.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; This may add more lines to the code block</text>
<text text-anchor="middle" x="6325.187" y="-312.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-297.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-281.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Auto&#45;close a code block with no footer.</text>
<text text-anchor="middle" x="6325.187" y="-266.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if latest[1] and latest[1].id == &quot;codeblock&quot; and not latest[1].line_last then</text>
<text text-anchor="middle" x="6325.187" y="-250.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;latest[1].line_last = #section.lines</text>
<text text-anchor="middle" x="6325.187" y="-235.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-204.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Close last block</text>
<text text-anchor="middle" x="6325.187" y="-188.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;latest.line_last = section.line_last</text>
<text text-anchor="middle" x="6325.187" y="-157.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Append sections, if any, which follow our blocks</text>
<text text-anchor="middle" x="6325.187" y="-141.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(sub_sections) do</text>
<text text-anchor="middle" x="6325.187" y="-126.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section[#section + 1] = v</text>
<text text-anchor="middle" x="6325.187" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6325.187" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return section</text>
<text text-anchor="middle" x="6325.187" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_52&#45;&gt;leaf_53 -->
<g id="edge26" class="edge">
<title>codeblock_52&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6325.187,-1766.1628C6325.187,-1759.375 6325.187,-1750.796 6325.187,-1740.6389"/>
<polygon fill="#000000" stroke="#000000" points="6328.6871,-1740.4242 6325.187,-1730.4242 6321.6871,-1740.4242 6328.6871,-1740.4242"/>
</g>
<!-- section_7 -->
<g id="node52" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="6690.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="6690.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_7</text>
</g>
<!-- header_54 -->
<g id="node53" class="node">
<title>header_54</title>
<ellipse fill="none" stroke="#000000" cx="6690.187" cy="-901.1016" rx="55.6456" ry="18"/>
<text text-anchor="middle" x="6690.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Blocking</text>
</g>
<!-- section_7&#45;&gt;header_54 -->
<g id="edge27" class="edge">
<title>section_7&#45;&gt;header_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6690.187,-1766.1628C6690.187,-1655.1814 6690.187,-1065.3154 6690.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="6693.6871,-929.1134 6690.187,-919.1134 6686.6871,-929.1134 6693.6871,-929.1134"/>
</g>
<!-- section_55 -->
<g id="node54" class="node">
<title>section_55</title>
<ellipse fill="none" stroke="#000000" cx="6826.187" cy="-1784.2032" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="6826.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_55</text>
</g>
<!-- header_56 -->
<g id="node55" class="node">
<title>header_56</title>
<ellipse fill="none" stroke="#000000" cx="6826.187" cy="-901.1016" rx="61.9429" ry="18"/>
<text text-anchor="middle" x="6826.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : Prose line</text>
</g>
<!-- section_55&#45;&gt;header_56 -->
<g id="edge28" class="edge">
<title>section_55&#45;&gt;header_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6826.187,-1766.1628C6826.187,-1655.1814 6826.187,-1065.3154 6826.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="6829.6871,-929.1134 6826.187,-919.1134 6822.6871,-929.1134 6829.6871,-929.1134"/>
</g>
<!-- section_8 -->
<g id="node56" class="node">
<title>section_8</title>
<ellipse fill="none" stroke="#000000" cx="6987.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="6987.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_8</text>
</g>
<!-- header_57 -->
<g id="node57" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="6987.187" cy="-901.1016" rx="81.2629" ry="18"/>
<text text-anchor="middle" x="6987.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Section:weed()</text>
</g>
<!-- section_8&#45;&gt;header_57 -->
<g id="edge29" class="edge">
<title>section_8&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6987.187,-1766.1628C6987.187,-1655.1814 6987.187,-1065.3154 6987.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="6990.6871,-929.1134 6987.187,-919.1134 6983.6871,-929.1134 6990.6871,-929.1134"/>
</g>
<!-- codeblock_58 -->
<g id="node58" class="node">
<title>codeblock_58</title>
<ellipse fill="none" stroke="#000000" cx="7259.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="7259.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_58</text>
</g>
<!-- leaf_59 -->
<g id="node59" class="node">
<title>leaf_59</title>
<polygon fill="none" stroke="#c0c0c0" points="7431.687,-982.1019 7086.687,-982.1019 7086.687,-820.1013 7431.687,-820.1013 7431.687,-982.1019"/>
<text text-anchor="middle" x="7259.187" y="-966.9018" font-family="Inconsolata" font-size="14.00" fill="#000000">function S.weed(section)</text>
<text text-anchor="middle" x="7259.187" y="-951.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i, v in ipairs(section) do</text>
<text text-anchor="middle" x="7259.187" y="-936.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if v.id == &quot;block&quot; then</text>
<text text-anchor="middle" x="7259.187" y="-920.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if v[1] and v[1].id == &quot;codeblock&quot; </text>
<text text-anchor="middle" x="7259.187" y="-905.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or v[1].id == &quot;prose&quot; then</text>
<text text-anchor="middle" x="7259.187" y="-889.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;section[i] = v[1] &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="7259.187" y="-874.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7259.187" y="-859.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7259.187" y="-843.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7259.187" y="-828.3015" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_58&#45;&gt;leaf_59 -->
<g id="edge30" class="edge">
<title>codeblock_58&#45;&gt;leaf_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7259.187,-1766.1628C7259.187,-1667.9327 7259.187,-1194.5407 7259.187,-992.6444"/>
<polygon fill="#000000" stroke="#000000" points="7262.6871,-992.3629 7259.187,-982.363 7255.6871,-992.363 7262.6871,-992.3629"/>
</g>
<!-- section_9 -->
<g id="node60" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="7560.187" cy="-1784.2032" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="7560.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_9</text>
</g>
<!-- header_60 -->
<g id="node61" class="node">
<title>header_60</title>
<ellipse fill="none" stroke="#000000" cx="7560.187" cy="-901.1016" rx="110.7653" ry="18"/>
<text text-anchor="middle" x="7560.187" y="-896.9016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Section(header, linum)</text>
</g>
<!-- section_9&#45;&gt;header_60 -->
<g id="edge31" class="edge">
<title>section_9&#45;&gt;header_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7560.187,-1766.1628C7560.187,-1655.1814 7560.187,-1065.3154 7560.187,-929.1585"/>
<polygon fill="#000000" stroke="#000000" points="7563.6871,-929.1134 7560.187,-919.1134 7556.6871,-929.1134 7563.6871,-929.1134"/>
</g>
<!-- codeblock_61 -->
<g id="node62" class="node">
<title>codeblock_61</title>
<ellipse fill="none" stroke="#000000" cx="7844.187" cy="-1784.2032" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="7844.187" y="-1780.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_61</text>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="7999.187,-1051.8022 7689.187,-1051.8022 7689.187,-750.401 7999.187,-750.401 7999.187,-1051.8022"/>
<text text-anchor="middle" x="7844.187" y="-1036.5019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(section, header, linum)</text>
<text text-anchor="middle" x="7844.187" y="-1021.1019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local section = setmetatable({}, S)</text>
<text text-anchor="middle" x="7844.187" y="-1005.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if type(header) == &quot;number&quot; then</text>
<text text-anchor="middle" x="7844.187" y="-990.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; We have a virtual header</text>
<text text-anchor="middle" x="7844.187" y="-974.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section[1] = Header(&quot;&quot;, header)</text>
<text text-anchor="middle" x="7844.187" y="-959.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section.header = nil</text>
<text text-anchor="middle" x="7844.187" y="-944.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section.level = header</text>
<text text-anchor="middle" x="7844.187" y="-928.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="7844.187" y="-913.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section[1] = header</text>
<text text-anchor="middle" x="7844.187" y="-897.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section.header = header</text>
<text text-anchor="middle" x="7844.187" y="-882.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;section.level = header.level</text>
<text text-anchor="middle" x="7844.187" y="-867.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7844.187" y="-851.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section.line_first = linum</text>
<text text-anchor="middle" x="7844.187" y="-836.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section.lines = {}</text>
<text text-anchor="middle" x="7844.187" y="-820.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;section.id = &quot;section&quot;</text>
<text text-anchor="middle" x="7844.187" y="-805.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return section</text>
<text text-anchor="middle" x="7844.187" y="-790.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="7844.187" y="-758.7014" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(s, new)</text>
</g>
<!-- codeblock_61&#45;&gt;leaf_62 -->
<g id="edge32" class="edge">
<title>codeblock_61&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7844.187,-1766.1628C7844.187,-1677.9486 7844.187,-1287.1779 7844.187,-1062.1851"/>
<polygon fill="#000000" stroke="#000000" points="7847.6871,-1061.9303 7844.187,-1051.9303 7840.6871,-1061.9303 7847.6871,-1061.9303"/>
</g>
</g>
</svg>