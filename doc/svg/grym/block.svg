<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3520pt" height="562pt"
 viewBox="0.00 0.00 3520.48 562.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 558.2007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-558.2007 3516.4828,-558.2007 3516.4828,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="75.4828" cy="-536.2007" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="75.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 180</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="75.4828" cy="-277.1004" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="75.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;126</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M75.4828,-517.9813C75.4828,-473.4745 75.4828,-358.9609 75.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="78.9829,-305.2996 75.4828,-295.2997 71.9829,-305.2997 78.9829,-305.2996"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="75.4828" cy="-18" rx="75.4657" ry="18"/>
<text text-anchor="middle" x="75.4828" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Block module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M75.4828,-258.8809C75.4828,-214.3741 75.4828,-99.8605 75.4828,-46.3479"/>
<polygon fill="#000000" stroke="#000000" points="78.9829,-46.1993 75.4828,-36.1993 71.9829,-46.1993 78.9829,-46.1993"/>
</g>
<!-- section_3 -->
<g id="node4" class="node">
<title>section_3</title>
<ellipse fill="none" stroke="#000000" cx="214.4828" cy="-536.2007" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="214.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_3</text>
</g>
<!-- header_7 -->
<g id="node5" class="node">
<title>header_7</title>
<ellipse fill="none" stroke="#000000" cx="214.4828" cy="-277.1004" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="214.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : includes</text>
</g>
<!-- section_3&#45;&gt;header_7 -->
<g id="edge3" class="edge">
<title>section_3&#45;&gt;header_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M214.4828,-517.9813C214.4828,-473.4745 214.4828,-358.9609 214.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="217.9829,-305.2996 214.4828,-295.2997 210.9829,-305.2997 217.9829,-305.2996"/>
</g>
<!-- codeblock_8 -->
<g id="node6" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="442.4828" cy="-536.2007" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="442.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_8</text>
</g>
<!-- leaf_9 -->
<g id="node7" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="597.4828,-374.201 287.4828,-374.201 287.4828,-179.9997 597.4828,-179.9997 597.4828,-374.201"/>
<text text-anchor="middle" x="442.4828" y="-359.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="442.4828" y="-327.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="442.4828" y="-312.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Codeblock = require &quot;grym/codeblock&quot;</text>
<text text-anchor="middle" x="442.4828" y="-297.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Structure = require &quot;grym/structure&quot;</text>
<text text-anchor="middle" x="442.4828" y="-281.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Prose = require &quot;grym/prose&quot;</text>
<text text-anchor="middle" x="442.4828" y="-250.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot;</text>
<text text-anchor="middle" x="442.4828" y="-218.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="442.4828" y="-203.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">local util = require &quot;../lib/util&quot;</text>
<text text-anchor="middle" x="442.4828" y="-188.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">local freeze = util.freeze</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_9 -->
<g id="edge4" class="edge">
<title>codeblock_8&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M442.4828,-517.9813C442.4828,-490.1739 442.4828,-435.0387 442.4828,-384.5275"/>
<polygon fill="#000000" stroke="#000000" points="445.9829,-384.4963 442.4828,-374.4963 438.9829,-384.4964 445.9829,-384.4963"/>
</g>
<!-- section_4 -->
<g id="node8" class="node">
<title>section_4</title>
<ellipse fill="none" stroke="#000000" cx="718.4828" cy="-536.2007" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="718.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_4</text>
</g>
<!-- header_10 -->
<g id="node9" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="718.4828" cy="-277.1004" rx="102.5283" ry="18"/>
<text text-anchor="middle" x="718.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Metatable for Blocks</text>
</g>
<!-- section_4&#45;&gt;header_10 -->
<g id="edge5" class="edge">
<title>section_4&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M718.4828,-517.9813C718.4828,-473.4745 718.4828,-358.9609 718.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="721.9829,-305.2996 718.4828,-295.2997 714.9829,-305.2997 721.9829,-305.2996"/>
</g>
<!-- codeblock_11 -->
<g id="node10" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="1046.4828" cy="-536.2007" rx="64.0625" ry="18"/>
<text text-anchor="middle" x="1046.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_11</text>
</g>
<!-- leaf_12 -->
<g id="node11" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1253.9828,-428.5011 838.9828,-428.5011 838.9828,-125.6996 1253.9828,-125.6996 1253.9828,-428.5011"/>
<text text-anchor="middle" x="1046.4828" y="-413.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="1046.4828" y="-397.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">B.__index = B</text>
<text text-anchor="middle" x="1046.4828" y="-366.3005" font-family="Inconsolata" font-size="14.00" fill="#000000">B.__tostring = function(block) </text>
<text text-anchor="middle" x="1046.4828" y="-350.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;Block&quot;</text>
<text text-anchor="middle" x="1046.4828" y="-335.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1046.4828" y="-304.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.addLine(block, line)</text>
<text text-anchor="middle" x="1046.4828" y="-288.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if L.match(m.tagline_hash_p, line) then</text>
<text text-anchor="middle" x="1046.4828" y="-273.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = Structure(line, &quot;hashline&quot;)</text>
<text text-anchor="middle" x="1046.4828" y="-257.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.tagline_handle_p, line) then</text>
<text text-anchor="middle" x="1046.4828" y="-242.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = Structure(line, &quot;handleline&quot;)</text>
<text text-anchor="middle" x="1046.4828" y="-227.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Eventually Blocks won&#39;t have lines, meantime:</text>
<text text-anchor="middle" x="1046.4828" y="-211.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1046.4828" y="-196.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block.lines[#block.lines + 1] = line</text>
<text text-anchor="middle" x="1046.4828" y="-180.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1046.4828" y="-149.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="1046.4828" y="-134.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_12 -->
<g id="edge6" class="edge">
<title>codeblock_11&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1046.4828,-517.9813C1046.4828,-500.0262 1046.4828,-470.6775 1046.4828,-438.5368"/>
<polygon fill="#000000" stroke="#000000" points="1049.9829,-438.4819 1046.4828,-428.482 1042.9829,-438.482 1049.9829,-438.4819"/>
</g>
<!-- section_5 -->
<g id="node12" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1412.4828" cy="-536.2007" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="1412.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_5</text>
</g>
<!-- header_13 -->
<g id="node13" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1412.4828" cy="-277.1004" rx="140.2419" ry="18"/>
<text text-anchor="middle" x="1412.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Parse the prose within a block</text>
</g>
<!-- section_5&#45;&gt;header_13 -->
<g id="edge7" class="edge">
<title>section_5&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1412.4828,-517.9813C1412.4828,-473.4745 1412.4828,-358.9609 1412.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="1415.9829,-305.2996 1412.4828,-295.2997 1408.9829,-305.2997 1415.9829,-305.2996"/>
</g>
<!-- codeblock_14 -->
<g id="node14" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="1725.4828" cy="-536.2007" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="1725.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_14</text>
</g>
<!-- leaf_16 -->
<g id="node15" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1880.4828,-366.0012 1570.4828,-366.0012 1570.4828,-188.1996 1880.4828,-188.1996 1880.4828,-366.0012"/>
<text text-anchor="middle" x="1725.4828" y="-350.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.parseProse(block)</text>
<text text-anchor="middle" x="1725.4828" y="-335.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if block[1] then</text>
<text text-anchor="middle" x="1725.4828" y="-319.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if block[1].id == &quot;codeblock&quot; then</text>
<text text-anchor="middle" x="1725.4828" y="-304.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1725.4828" y="-289.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1725.4828" y="-273.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1725.4828" y="-258.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block[1] = Prose(block)</text>
<text text-anchor="middle" x="1725.4828" y="-242.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block.lines = nil</text>
<text text-anchor="middle" x="1725.4828" y="-227.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return block[1]</text>
<text text-anchor="middle" x="1725.4828" y="-212.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1725.4828" y="-196.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_16 -->
<g id="edge8" class="edge">
<title>codeblock_14&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.4828,-517.9813C1725.4828,-488.601 1725.4828,-428.7138 1725.4828,-376.006"/>
<polygon fill="#000000" stroke="#000000" points="1728.9829,-375.9147 1725.4828,-365.9147 1721.9829,-375.9147 1728.9829,-375.9147"/>
</g>
<!-- section_15 -->
<g id="node16" class="node">
<title>section_15</title>
<ellipse fill="none" stroke="#000000" cx="1950.4828" cy="-536.2007" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="1950.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_15</text>
</g>
<!-- header_17 -->
<g id="node17" class="node">
<title>header_17</title>
<ellipse fill="none" stroke="#000000" cx="1950.4828" cy="-277.1004" rx="51.9763" ry="18"/>
<text text-anchor="middle" x="1950.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : toValue</text>
</g>
<!-- section_15&#45;&gt;header_17 -->
<g id="edge9" class="edge">
<title>section_15&#45;&gt;header_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1950.4828,-517.9813C1950.4828,-473.4745 1950.4828,-358.9609 1950.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="1953.9829,-305.2996 1950.4828,-295.2997 1946.9829,-305.2997 1953.9829,-305.2996"/>
</g>
<!-- codeblock_18 -->
<g id="node18" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="2203.4828" cy="-536.2007" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="2203.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_18</text>
</g>
<!-- leaf_19 -->
<g id="node19" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2386.4828,-482.3011 2020.4828,-482.3011 2020.4828,-71.8996 2386.4828,-71.8996 2386.4828,-482.3011"/>
<text text-anchor="middle" x="2203.4828" y="-467.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.toString(block)</text>
<text text-anchor="middle" x="2203.4828" y="-451.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2203.4828" y="-436.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(block.lines) do</text>
<text text-anchor="middle" x="2203.4828" y="-420.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="2203.4828" y="-405.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2203.4828" y="-390.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="2203.4828" y="-374.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2203.4828" y="-343.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.toValue(block)</text>
<text text-anchor="middle" x="2203.4828" y="-327.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.val = block:toString()</text>
<text text-anchor="middle" x="2203.4828" y="-312.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block.val</text>
<text text-anchor="middle" x="2203.4828" y="-297.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2203.4828" y="-265.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.toMarkdown(block)</text>
<text text-anchor="middle" x="2203.4828" y="-250.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if block[1] and (block[1].id == &quot;codeblock&quot;</text>
<text text-anchor="middle" x="2203.4828" y="-234.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;or block[1].id == &quot;prose&quot;) then</text>
<text text-anchor="middle" x="2203.4828" y="-219.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return block[1]:toMarkdown()</text>
<text text-anchor="middle" x="2203.4828" y="-204.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2203.4828" y="-188.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return block:toString()</text>
<text text-anchor="middle" x="2203.4828" y="-173.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2203.4828" y="-157.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2203.4828" y="-126.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.dotLabel(block)</text>
<text text-anchor="middle" x="2203.4828" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;block &quot; .. tostring(block.line_first) </text>
<text text-anchor="middle" x="2203.4828" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(block.line_last)</text>
<text text-anchor="middle" x="2203.4828" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_19 -->
<g id="edge10" class="edge">
<title>codeblock_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2203.4828,-517.9813C2203.4828,-511.0268 2203.4828,-502.3629 2203.4828,-492.4896"/>
<polygon fill="#000000" stroke="#000000" points="2206.9829,-492.2315 2203.4828,-482.2316 2199.9829,-492.2316 2206.9829,-492.2315"/>
</g>
<!-- section_6 -->
<g id="node20" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2504.4828" cy="-536.2007" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="2504.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_6</text>
</g>
<!-- header_20 -->
<g id="node21" class="node">
<title>header_20</title>
<ellipse fill="none" stroke="#000000" cx="2504.4828" cy="-277.1004" rx="99.6298" ry="18"/>
<text text-anchor="middle" x="2504.4828" y="-272.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Constructor/module</text>
</g>
<!-- section_6&#45;&gt;header_20 -->
<g id="edge11" class="edge">
<title>section_6&#45;&gt;header_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2504.4828,-517.9813C2504.4828,-473.4745 2504.4828,-358.9609 2504.4828,-305.4483"/>
<polygon fill="#000000" stroke="#000000" points="2507.9829,-305.2996 2504.4828,-295.2997 2500.9829,-305.2997 2507.9829,-305.2996"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="2896.4828" cy="-536.2007" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="2896.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_21</text>
</g>
<!-- leaf_23 -->
<g id="node23" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="3170.4828,-443.2012 2622.4828,-443.2012 2622.4828,-110.9995 3170.4828,-110.9995 3170.4828,-443.2012"/>
<text text-anchor="middle" x="2896.4828" y="-428.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local b = {}</text>
<text text-anchor="middle" x="2896.4828" y="-396.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Block, lines, linum)</text>
<text text-anchor="middle" x="2896.4828" y="-381.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local block = setmetatable({}, B)</text>
<text text-anchor="middle" x="2896.4828" y="-366.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.lines = {}</text>
<text text-anchor="middle" x="2896.4828" y="-350.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.line_first = linum</text>
<text text-anchor="middle" x="2896.4828" y="-335.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if (lines) then </text>
<text text-anchor="middle" x="2896.4828" y="-319.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(lines) == &quot;string&quot; then</text>
<text text-anchor="middle" x="2896.4828" y="-304.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block:addLine(lines)</text>
<text text-anchor="middle" x="2896.4828" y="-289.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif type(lines) == &quot;table&quot; then</text>
<text text-anchor="middle" x="2896.4828" y="-273.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, l in ipairs(lines) do</text>
<text text-anchor="middle" x="2896.4828" y="-258.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block:addLine(l)</text>
<text text-anchor="middle" x="2896.4828" y="-242.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2896.4828" y="-227.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2896.4828" y="-212.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;freeze(&quot;Error: in block.new type of `lines` is &quot; .. type(lines))</text>
<text text-anchor="middle" x="2896.4828" y="-196.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2896.4828" y="-181.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2896.4828" y="-149.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.id = &quot;block&quot;</text>
<text text-anchor="middle" x="2896.4828" y="-134.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="2896.4828" y="-119.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_23 -->
<g id="edge12" class="edge">
<title>codeblock_21&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2896.4828,-517.9813C2896.4828,-502.8645 2896.4828,-479.6716 2896.4828,-453.5359"/>
<polygon fill="#000000" stroke="#000000" points="2899.9829,-453.3856 2896.4828,-443.3857 2892.9829,-453.3857 2899.9829,-453.3856"/>
</g>
<!-- codeblock_22 -->
<g id="node24" class="node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="3350.4828" cy="-536.2007" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="3350.4828" y="-532.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_22</text>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="3512.4828,-397.3008 3188.4828,-397.3008 3188.4828,-156.8999 3512.4828,-156.8999 3512.4828,-397.3008"/>
<text text-anchor="middle" x="3350.4828" y="-382.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function structureOrProse(line)</text>
<text text-anchor="middle" x="3350.4828" y="-366.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if L.match(m.tagline_p, line) then</text>
<text text-anchor="middle" x="3350.4828" y="-351.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;tagline&quot;</text>
<text text-anchor="middle" x="3350.4828" y="-335.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.listline_p, line) then</text>
<text text-anchor="middle" x="3350.4828" y="-320.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;listline&quot;</text>
<text text-anchor="middle" x="3350.4828" y="-305.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.tableline_p, line) then</text>
<text text-anchor="middle" x="3350.4828" y="-289.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;tableline&quot;</text>
<text text-anchor="middle" x="3350.4828" y="-274.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3350.4828" y="-258.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false, &quot;&quot;</text>
<text text-anchor="middle" x="3350.4828" y="-243.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3350.4828" y="-212.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">b[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="3350.4828" y="-196.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">b[&quot;__index&quot;] = b</text>
<text text-anchor="middle" x="3350.4828" y="-165.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, b)</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_24 -->
<g id="edge13" class="edge">
<title>codeblock_22&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3350.4828,-517.9813C3350.4828,-494.3642 3350.4828,-451.0346 3350.4828,-407.5674"/>
<polygon fill="#000000" stroke="#000000" points="3353.9829,-407.4165 3350.4828,-397.4166 3346.9829,-407.4166 3353.9829,-407.4165"/>
</g>
</g>
</svg>