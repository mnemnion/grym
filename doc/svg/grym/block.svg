<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4849pt" height="802pt"
 viewBox="0.00 0.00 4848.50 802.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 798.0009)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-798.0009 4844.5,-798.0009 4844.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="2985.5" cy="-776.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2985.5" y="-771.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">52 &#160;</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="2985.5" cy="-704.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2985.5" y="-699.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">52 &#160;</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2985.5,-757.8323C2985.5,-750.1319 2985.5,-740.9753 2985.5,-732.4176"/>
<polygon fill="#000000" stroke="#000000" points="2989.0001,-732.4142 2985.5,-722.4142 2982.0001,-732.4142 2989.0001,-732.4142"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="2391.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2391.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">le &#160;</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2958.3365,-702.6894C2860.88,-697.7799 2529.2199,-679.2576 2427.5,-650.0009 2425.372,-649.3889 2423.2193,-648.6526 2421.0805,-647.8321"/>
<polygon fill="#000000" stroke="#000000" points="2422.4777,-644.6231 2411.9133,-643.8211 2419.6717,-651.0361 2422.4777,-644.6231"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="2463.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2463.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">&#45;6 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2958.5208,-702.2576C2869.6707,-696.3206 2586.9228,-675.8181 2499.5,-650.0009 2497.59,-649.4369 2495.6592,-648.7754 2493.7357,-648.045"/>
<polygon fill="#000000" stroke="#000000" points="2494.8779,-644.7253 2484.3113,-643.9528 2492.0899,-651.1461 2494.8779,-644.7253"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="2535.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2535.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">10 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2958.6831,-701.6794C2879.0093,-694.5971 2644.7164,-672.383 2571.5,-650.0009 2569.5955,-649.4187 2567.6689,-648.7431 2565.7486,-648.002"/>
<polygon fill="#000000" stroke="#000000" points="2566.8972,-644.6842 2556.3329,-643.881 2564.0905,-651.0969 2566.8972,-644.6842"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="2607.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2607.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">14 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2958.2431,-702.5346C2899.444,-698.7624 2756.8412,-686.3228 2643.5,-650.0009 2641.6035,-649.3932 2639.6831,-648.6976 2637.7676,-647.9414"/>
<polygon fill="#000000" stroke="#000000" points="2638.9255,-644.6265 2628.3645,-643.7799 2636.0925,-651.0276 2638.9255,-644.6265"/>
</g>
<!-- block_6 -->
<g id="node7" class="node">
<title>block_6</title>
<ellipse fill="none" stroke="#000000" cx="2679.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2679.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">27 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;block_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2958.8227,-701.0558C2909.6529,-695.1076 2801.8623,-679.6325 2715.5,-650.0009 2713.6163,-649.3546 2711.7058,-648.6291 2709.7979,-647.8501"/>
<polygon fill="#000000" stroke="#000000" points="2710.9706,-644.5398 2700.4151,-643.6274 2708.0978,-650.9231 2710.9706,-644.5398"/>
</g>
<!-- block_7 -->
<g id="node8" class="node">
<title>block_7</title>
<ellipse fill="none" stroke="#000000" cx="2751.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2751.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">33 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;block_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2959.6691,-698.6702C2921.3691,-690.3852 2847.5775,-672.9544 2787.5,-650.0009 2785.6397,-649.2902 2783.7474,-648.5146 2781.8533,-647.6974"/>
<polygon fill="#000000" stroke="#000000" points="2783.0528,-644.3959 2772.5075,-643.3724 2780.1129,-650.7487 2783.0528,-644.3959"/>
</g>
<!-- block_8 -->
<g id="node9" class="node">
<title>block_8</title>
<ellipse fill="none" stroke="#000000" cx="2823.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2823.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">45 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;block_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2962.9746,-693.9896C2935.0044,-681.5585 2887.1157,-660.2746 2855.3838,-646.1715"/>
<polygon fill="#000000" stroke="#000000" points="2856.6543,-642.9061 2846.0946,-642.043 2853.8113,-649.3028 2856.6543,-642.9061"/>
</g>
<!-- block_9 -->
<g id="node10" class="node">
<title>block_9</title>
<ellipse fill="none" stroke="#000000" cx="2922.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="2922.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">47 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;block_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2971.8299,-688.378C2963.3266,-678.6599 2952.2387,-665.988 2942.7292,-655.12"/>
<polygon fill="#000000" stroke="#000000" points="2945.3625,-652.8144 2936.1434,-647.5934 2940.0944,-657.4239 2945.3625,-652.8144"/>
</g>
<!-- block_10 -->
<g id="node11" class="node">
<title>block_10</title>
<ellipse fill="none" stroke="#000000" cx="3022.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="3022.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">70 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;block_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2994.2685,-686.9379C2998.6279,-678.4547 3003.9953,-668.0101 3008.8753,-658.5139"/>
<polygon fill="#000000" stroke="#000000" points="3012.0797,-659.9357 3013.5374,-649.4416 3005.8537,-656.7362 3012.0797,-659.9357"/>
</g>
<!-- block_11 -->
<g id="node12" class="node">
<title>block_11</title>
<ellipse fill="none" stroke="#000000" cx="3210.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="3210.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">73 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;block_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3010.0073,-696.1586C3050.2448,-683.2826 3130.4096,-657.6299 3176.2446,-642.9627"/>
<polygon fill="#000000" stroke="#000000" points="3177.5654,-646.2149 3186.023,-639.8336 3175.432,-639.5479 3177.5654,-646.2149"/>
</g>
<!-- block_12 -->
<g id="node13" class="node">
<title>block_12</title>
<ellipse fill="none" stroke="#000000" cx="3558.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="3558.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">98 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_12 -->
<g id="edge12" class="edge">
<title>section_1&#45;&gt;block_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.3684,-700.6248C3105.5141,-688.9206 3414.7039,-650.0696 3521.69,-636.6263"/>
<polygon fill="#000000" stroke="#000000" points="3522.2041,-640.0893 3531.6897,-635.3698 3521.3313,-633.1439 3522.2041,-640.0893"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="3690.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="3690.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">00 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_1&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.6182,-702.5366C3098.3039,-697.7089 3370.7913,-680.8179 3594.5,-650.0009 3614.4403,-647.2541 3636.5289,-643.1845 3654.4863,-639.6095"/>
<polygon fill="#000000" stroke="#000000" points="3655.4277,-642.99 3664.5345,-637.5754 3654.0388,-636.1291 3655.4277,-642.99"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="3870.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="3870.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">25 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_1&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.459,-702.5405C3109.2071,-697.1921 3447.9564,-677.5407 3726.5,-650.0009 3763.1212,-646.3802 3804.8305,-641.0315 3833.9003,-637.1053"/>
<polygon fill="#000000" stroke="#000000" points="3834.5694,-640.5466 3844.0055,-635.729 3833.6247,-633.6106 3834.5694,-640.5466"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="4035.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="4035.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">29 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_1&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.6855,-703.2029C3123.8002,-699.773 3554.2427,-684.8473 3906.5,-650.0009 3937.7492,-646.9097 3973.0547,-641.8756 3998.8206,-637.916"/>
<polygon fill="#000000" stroke="#000000" points="3999.549,-641.3449 4008.8917,-636.3485 3998.4724,-634.4282 3999.549,-641.3449"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="4284.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="4284.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">34 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_1&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.7977,-702.9921C3135.7041,-698.3768 3650.0644,-678.2772 4071.5,-650.0009 4133.2842,-645.8555 4205.0173,-639.467 4247.4818,-635.5205"/>
<polygon fill="#000000" stroke="#000000" points="4247.9925,-638.9881 4257.6234,-634.5727 4247.3411,-632.0185 4247.9925,-638.9881"/>
</g>
<!-- block_17 -->
<g id="node18" class="node">
<title>block_17</title>
<ellipse fill="none" stroke="#000000" cx="4678.5" cy="-632.0009" rx="27" ry="18"/>
<text text-anchor="middle" x="4678.5" y="-627.8009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">52 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_17 -->
<g id="edge17" class="edge">
<title>section_1&#45;&gt;block_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3012.7631,-702.9977C3151.6554,-697.8656 3794.4909,-673.8624 4320.5,-650.0009 4437.6891,-644.6849 4576.4058,-637.4379 4641.4049,-633.9862"/>
<polygon fill="#000000" stroke="#000000" points="4641.7587,-637.4724 4651.5586,-633.446 4641.3867,-630.4823 4641.7587,-637.4724"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="499,-516.8011 0,-516.8011 0,-430.4004 499,-430.4004 499,-516.8011"/>
<text text-anchor="middle" x="249.5" y="-485.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;A Block is the container for the next level of granularity below</text>
<text text-anchor="middle" x="249.5" y="-470.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> a Section. Any Section has a Header and one or more Blocks. Both the</text>
<text text-anchor="middle" x="249.5" y="-454.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Header and the Block may be virtual, that is, without contents.</text>
</g>
<!-- block_3&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>block_3&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2443.1659,-619.884C2438.2021,-617.4824 2432.7926,-615.3029 2427.5,-614.0009 2220.3057,-563.0339 716.5483,-620.7318 507.5,-578.0009 450.7948,-566.41 390.6714,-542.8101 342.7425,-520.9766"/>
<polygon fill="#000000" stroke="#000000" points="344.1788,-517.7848 333.6317,-516.7808 341.2507,-524.143 344.1788,-517.7848"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1016,-508.9011 517,-508.9011 517,-438.3004 1016,-438.3004 1016,-508.9011"/>
<text text-anchor="middle" x="766.5" y="-493.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> The most general premise is that Blocks are delineated by blank line</text>
<text text-anchor="middle" x="766.5" y="-478.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> whitespace. </text>
</g>
<!-- block_4&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>block_4&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2515.1605,-619.9057C2510.197,-617.5032 2504.7889,-615.3178 2499.5,-614.0009 2181.3384,-534.7829 1345.5463,-644.571 1024.5,-578.0009 961.2515,-564.8861 893.707,-537.0004 843.5995,-513.3462"/>
<polygon fill="#000000" stroke="#000000" points="844.984,-510.1288 834.4513,-508.9832 841.9707,-516.4471 844.984,-510.1288"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1575,-508.8011 1034,-508.8011 1034,-438.4004 1575,-438.4004 1575,-508.8011"/>
<text text-anchor="middle" x="1304.5" y="-493.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> A paragraph of prose is the simplest block, and the default. &#160;A list with</text>
<text text-anchor="middle" x="1304.5" y="-478.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> a tag line is a block also, as is a table. &#160;Most importantly for our short</text>
<text text-anchor="middle" x="1304.5" y="-462.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> path, code blocks are enclosed in blocks as well.</text>
</g>
<!-- block_5&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_5&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2587.1489,-619.9518C2582.1858,-617.5474 2576.7809,-615.3496 2571.5,-614.0009 2358.6306,-559.6387 1798.9414,-621.0549 1583.5,-578.0009 1515.4233,-564.3964 1442.0291,-536.3546 1387.6113,-512.7565"/>
<polygon fill="#000000" stroke="#000000" points="1388.9265,-509.5117 1378.3621,-508.7092 1386.1203,-515.9246 1388.9265,-509.5117"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2134,-577.9012 1593,-577.9012 1593,-369.3003 2134,-369.3003 2134,-577.9012"/>
<text text-anchor="middle" x="1863.5" y="-562.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> Blocking needs to identify when it has structure, and when prose, on a </text>
<text text-anchor="middle" x="1863.5" y="-547.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> line&#45;by&#45;line basis. &#160;It must also apply the cling rule to make sure that</text>
<text text-anchor="middle" x="1863.5" y="-532.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> e.g. tags are part of the block indicated by whitespacing. </text>
<text text-anchor="middle" x="1863.5" y="-516.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1863.5" y="-501.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Blocking need not, and mostly should not, parse within structure or prose.</text>
<text text-anchor="middle" x="1863.5" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> These categories are determined by the beginning of a line, making this</text>
<text text-anchor="middle" x="1863.5" y="-470.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> tractable. </text>
<text text-anchor="middle" x="1863.5" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1863.5" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> The cling rule requires lookahead. LPEG is quite capable of this, as is </text>
<text text-anchor="middle" x="1863.5" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> packrat PEG parsing generally. &#160;In the bootstrap implementation, we will</text>
<text text-anchor="middle" x="1863.5" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> parse once for ownership, again (in the `lines` array of each Section) for</text>
<text text-anchor="middle" x="1863.5" y="-393.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> blocking, and a final time to parse within blocks. </text>
</g>
<!-- block_6&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>block_6&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2659.113,-620.0872C2654.1514,-617.6773 2648.7562,-615.443 2643.5,-614.0009 2431.7891,-555.9181 2363.2047,-623.3669 2144.2113,-578.0342"/>
<polygon fill="#000000" stroke="#000000" points="2144.853,-574.5925 2134.3438,-575.9369 2143.3976,-581.4396 2144.853,-574.5925"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2651,-524.801 2152,-524.801 2152,-422.4005 2651,-422.4005 2651,-524.801"/>
<text text-anchor="middle" x="2401.5" y="-509.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Grimoire is intended to work, in linear time, as a single&#45;pass PEG</text>
<text text-anchor="middle" x="2401.5" y="-494.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> grammar. &#160;Presently (Feb 2018) I&#39;m intending to prototype that with </text>
<text text-anchor="middle" x="2401.5" y="-478.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> PEGylator and port it to `hammer` with a `quipu` back&#45;end. </text>
</g>
<!-- block_7&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>block_7&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2729.8721,-620.9977C2725.1537,-618.6503 2720.1738,-616.2131 2715.5,-614.0009 2654.4013,-585.0831 2585.9414,-554.2875 2528.5766,-528.9289"/>
<polygon fill="#000000" stroke="#000000" points="2529.6642,-525.5831 2519.1025,-524.7456 2526.8366,-531.9867 2529.6642,-525.5831"/>
</g>
<!-- codeblock_23 -->
<g id="node24" class="node">
<title>codeblock_23</title>
<ellipse fill="none" stroke="#000000" cx="2696.5" cy="-473.6007" rx="27" ry="18"/>
<text text-anchor="middle" x="2696.5" y="-469.4007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">44 &#160;</text>
</g>
<!-- block_8&#45;&gt;codeblock_23 -->
<g id="edge23" class="edge">
<title>block_8&#45;&gt;codeblock_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2801.6646,-621.271C2777.9621,-609.2497 2742.1889,-589.8933 2732.5,-578.0009 2714.5189,-555.9305 2705.2854,-524.3402 2700.7011,-501.6984"/>
<polygon fill="#000000" stroke="#000000" points="2704.1108,-500.8879 2698.8567,-491.6876 2697.2267,-502.1563 2704.1108,-500.8879"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2795.5,-491.6007 2741.5,-491.6007 2741.5,-455.6007 2795.5,-455.6007 2795.5,-491.6007"/>
</g>
<!-- block_8&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>block_8&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2817.4039,-614.4441C2807.9147,-587.1151 2789.5272,-534.1591 2778.2013,-501.5406"/>
<polygon fill="#000000" stroke="#000000" points="2781.379,-500.0217 2774.7924,-491.723 2774.7663,-502.3178 2781.379,-500.0217"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2977,-493.5028 2814,-493.5028 2814,-453.6987 2977,-453.6987 2977,-493.5028"/>
<text text-anchor="middle" x="2895.5" y="-478.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Metatable for Blocks</text>
</g>
<!-- block_9&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>block_9&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2919.4028,-613.8304C2914.8231,-586.9629 2906.1907,-536.3197 2900.6494,-503.8109"/>
<polygon fill="#000000" stroke="#000000" points="2904.0297,-502.8116 2898.8991,-493.5419 2897.1292,-503.9879 2904.0297,-502.8116"/>
</g>
<!-- codeblock_27 -->
<g id="node28" class="node">
<title>codeblock_27</title>
<ellipse fill="none" stroke="#000000" cx="3022.5" cy="-473.6007" rx="27" ry="18"/>
<text text-anchor="middle" x="3022.5" y="-469.4007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">68 &#160;</text>
</g>
<!-- block_10&#45;&gt;codeblock_27 -->
<g id="edge27" class="edge">
<title>block_10&#45;&gt;codeblock_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3022.5,-613.8304C3022.5,-586.5248 3022.5,-534.662 3022.5,-502.2354"/>
<polygon fill="#000000" stroke="#000000" points="3026.0001,-502.0472 3022.5,-492.0473 3019.0001,-502.0473 3026.0001,-502.0472"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3121.5,-493.6007 3067.5,-493.6007 3067.5,-453.6007 3121.5,-453.6007 3121.5,-493.6007"/>
</g>
<!-- block_10&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>block_10&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3035.0088,-615.6462C3042.5319,-605.2681 3051.8968,-591.3276 3058.5,-578.0009 3070.4235,-553.9367 3080.077,-524.9493 3086.3748,-503.6315"/>
<polygon fill="#000000" stroke="#000000" points="3089.7911,-504.4156 3089.1921,-493.8377 3083.0639,-502.4804 3089.7911,-504.4156"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3513,-500.9012 3140,-500.9012 3140,-446.3003 3513,-446.3003 3513,-500.9012"/>
<text text-anchor="middle" x="3326.5" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a .val field which is the union of all lines.</text>
<text text-anchor="middle" x="3326.5" y="-470.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Useful in visualization. </text>
</g>
<!-- block_11&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>block_11&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3222.4771,-615.6459C3240.781,-590.6517 3276.1519,-542.3521 3300.5279,-509.0662"/>
<polygon fill="#000000" stroke="#000000" points="3303.3866,-511.0864 3306.4712,-500.9505 3297.739,-506.9505 3303.3866,-511.0864"/>
</g>
<!-- codeblock_31 -->
<g id="node32" class="node">
<title>codeblock_31</title>
<ellipse fill="none" stroke="#000000" cx="3558.5" cy="-473.6007" rx="27" ry="18"/>
<text text-anchor="middle" x="3558.5" y="-469.4007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">96 &#160;</text>
</g>
<!-- block_12&#45;&gt;codeblock_31 -->
<g id="edge31" class="edge">
<title>block_12&#45;&gt;codeblock_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3558.5,-613.8304C3558.5,-586.5248 3558.5,-534.662 3558.5,-502.2354"/>
<polygon fill="#000000" stroke="#000000" points="3562.0001,-502.0472 3558.5,-492.0473 3555.0001,-502.0473 3562.0001,-502.0472"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="3657.5,-493.6007 3603.5,-493.6007 3603.5,-453.6007 3657.5,-453.6007 3657.5,-493.6007"/>
</g>
<!-- block_12&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>block_12&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3571.0088,-615.6462C3578.5319,-605.2681 3587.8968,-591.3276 3594.5,-578.0009 3606.4235,-553.9367 3616.077,-524.9493 3622.3748,-503.6315"/>
<polygon fill="#000000" stroke="#000000" points="3625.7911,-504.4156 3625.1921,-493.8377 3619.0639,-502.4804 3625.7911,-504.4156"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3825,-493.5028 3676,-493.5028 3676,-453.6987 3825,-453.6987 3825,-493.5028"/>
<text text-anchor="middle" x="3750.5" y="-478.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Constructor/module</text>
</g>
<!-- block_13&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>block_13&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3697.1503,-614.4441C3707.3534,-587.5078 3726.9868,-535.6756 3739.3794,-502.9591"/>
<polygon fill="#000000" stroke="#000000" points="3742.7052,-504.0595 3742.9745,-493.4681 3736.1591,-501.5799 3742.7052,-504.0595"/>
</g>
<!-- codeblock_35 -->
<g id="node36" class="node">
<title>codeblock_35</title>
<ellipse fill="none" stroke="#000000" cx="3870.5" cy="-473.6007" rx="27" ry="18"/>
<text text-anchor="middle" x="3870.5" y="-469.4007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">23 &#160;</text>
</g>
<!-- block_14&#45;&gt;codeblock_35 -->
<g id="edge35" class="edge">
<title>block_14&#45;&gt;codeblock_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3870.5,-613.8304C3870.5,-586.5248 3870.5,-534.662 3870.5,-502.2354"/>
<polygon fill="#000000" stroke="#000000" points="3874.0001,-502.0472 3870.5,-492.0473 3867.0001,-502.0473 3874.0001,-502.0472"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="3969.5,-493.6007 3915.5,-493.6007 3915.5,-453.6007 3969.5,-453.6007 3969.5,-493.6007"/>
</g>
<!-- block_14&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>block_14&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3883.0088,-615.6462C3890.5319,-605.2681 3899.8968,-591.3276 3906.5,-578.0009 3918.4235,-553.9367 3928.077,-524.9493 3934.3748,-503.6315"/>
<polygon fill="#000000" stroke="#000000" points="3937.7911,-504.4156 3937.1921,-493.8377 3931.0639,-502.4804 3937.7911,-504.4156"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="4269.5,-508.8011 3987.5,-508.8011 3987.5,-438.4004 4269.5,-438.4004 4269.5,-508.8011"/>
<text text-anchor="middle" x="4128.5" y="-493.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> Sorts lines into structure and prose.</text>
<text text-anchor="middle" x="4128.5" y="-478.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="4128.5" y="-462.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line : taken from block.lines</text>
</g>
<!-- block_15&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>block_15&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4045.4526,-615.0493C4058.9874,-591.9966 4083.6818,-549.9363 4102.6369,-517.6515"/>
<polygon fill="#000000" stroke="#000000" points="4105.7721,-519.2243 4107.817,-508.8286 4099.7356,-515.6801 4105.7721,-519.2243"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="4633,-516.8011 4288,-516.8011 4288,-430.4004 4633,-430.4004 4633,-516.8011"/>
<text text-anchor="middle" x="4460.5" y="-501.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; returns: </text>
<text text-anchor="middle" x="4460.5" y="-486.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;1. true for structure, false for prose</text>
<text text-anchor="middle" x="4460.5" y="-470.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;2. id of structure line or &quot;&quot; for prose</text>
</g>
<!-- block_16&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>block_16&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4300.7422,-617.383C4324.1791,-596.2897 4368.6277,-556.286 4404.7017,-523.8193"/>
<polygon fill="#000000" stroke="#000000" points="4407.1702,-526.3064 4412.2618,-517.0152 4402.4874,-521.1034 4407.1702,-526.3064"/>
</g>
<!-- codeblock_40 -->
<g id="node41" class="node">
<title>codeblock_40</title>
<ellipse fill="none" stroke="#000000" cx="4678.5" cy="-473.6007" rx="27" ry="18"/>
<text text-anchor="middle" x="4678.5" y="-469.4007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">51 &#160;</text>
</g>
<!-- block_17&#45;&gt;codeblock_40 -->
<g id="edge40" class="edge">
<title>block_17&#45;&gt;codeblock_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4678.5,-613.8304C4678.5,-586.5248 4678.5,-534.662 4678.5,-502.2354"/>
<polygon fill="#000000" stroke="#000000" points="4682.0001,-502.0472 4678.5,-492.0473 4675.0001,-502.0473 4682.0001,-502.0472"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="4777.5,-491.6007 4723.5,-491.6007 4723.5,-455.6007 4777.5,-455.6007 4777.5,-491.6007"/>
</g>
<!-- block_17&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>block_17&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4691.0088,-615.6462C4698.5319,-605.2681 4707.8968,-591.3276 4714.5,-578.0009 4726.7893,-553.1985 4736.6672,-523.1663 4742.9448,-501.6918"/>
<polygon fill="#000000" stroke="#000000" points="4746.3612,-502.4737 4745.7322,-491.8976 4739.6285,-500.5576 4746.3612,-502.4737"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2823.5,-240.4006 2513.5,-240.4006 2513.5,-92.7999 2823.5,-92.7999 2823.5,-240.4006"/>
<text text-anchor="middle" x="2668.5" y="-225.3004" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="2668.5" y="-193.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="2668.5" y="-178.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">local Codeblock = require &quot;grym/codeblock&quot;</text>
<text text-anchor="middle" x="2668.5" y="-163.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">local Structure = require &quot;grym/structure&quot;</text>
<text text-anchor="middle" x="2668.5" y="-131.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="2668.5" y="-116.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">local util = require &quot;../lib/util&quot;</text>
<text text-anchor="middle" x="2668.5" y="-100.9002" font-family="Inconsolata" font-size="14.00" fill="#000000">local freeze = util.freeze</text>
</g>
<!-- codeblock_23&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>codeblock_23&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2694.8323,-455.3159C2691.2415,-415.9449 2682.5845,-321.0265 2676.1714,-250.7115"/>
<polygon fill="#000000" stroke="#000000" points="2679.6362,-250.166 2675.2423,-240.5252 2672.6652,-250.8018 2679.6362,-250.166"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="3257,-318.001 2842,-318.001 2842,-15.1995 3257,-15.1995 3257,-318.001"/>
<text text-anchor="middle" x="3049.5" y="-302.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="3049.5" y="-287.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">B.__index = B</text>
<text text-anchor="middle" x="3049.5" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">B.__tostring = function(block) </text>
<text text-anchor="middle" x="3049.5" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;Block&quot;</text>
<text text-anchor="middle" x="3049.5" y="-225.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3049.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.addLine(block, line)</text>
<text text-anchor="middle" x="3049.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if L.match(m.tagline_hash_p, line) then</text>
<text text-anchor="middle" x="3049.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = Structure(line, &quot;hashline&quot;)</text>
<text text-anchor="middle" x="3049.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.tagline_handle_p, line) then</text>
<text text-anchor="middle" x="3049.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = Structure(line, &quot;handleline&quot;)</text>
<text text-anchor="middle" x="3049.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Eventually Blocks won&#39;t have lines, meantime:</text>
<text text-anchor="middle" x="3049.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3049.5" y="-85.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block.lines[#block.lines + 1] = line</text>
<text text-anchor="middle" x="3049.5" y="-70.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3049.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="3049.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_27&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>codeblock_27&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3024.1081,-455.3159C3026.3858,-429.4182 3030.7772,-379.486 3035.2761,-328.3314"/>
<polygon fill="#000000" stroke="#000000" points="3038.7871,-328.3591 3036.1767,-318.0909 3031.814,-327.7458 3038.7871,-328.3591"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="3683,-333.3009 3310,-333.3009 3310,.1003 3683,.1003 3683,-333.3009"/>
<text text-anchor="middle" x="3496.5" y="-318.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.toValue(block)</text>
<text text-anchor="middle" x="3496.5" y="-302.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.val = &quot;&quot;</text>
<text text-anchor="middle" x="3496.5" y="-287.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(block.lines) do</text>
<text text-anchor="middle" x="3496.5" y="-271.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;block.val = block.val .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="3496.5" y="-256.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3496.5" y="-225.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block.val</text>
<text text-anchor="middle" x="3496.5" y="-209.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3496.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.toMarkdown(block)</text>
<text text-anchor="middle" x="3496.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if block[1] and block[1].id == &quot;codeblock&quot; then</text>
<text text-anchor="middle" x="3496.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return block[1]:toMarkdown()</text>
<text text-anchor="middle" x="3496.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3496.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;</text>
<text text-anchor="middle" x="3496.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block:toValue()</text>
<text text-anchor="middle" x="3496.5" y="-85.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3496.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">function B.dotLabel(block)</text>
<text text-anchor="middle" x="3496.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;block &quot; .. tostring(block.line_first) </text>
<text text-anchor="middle" x="3496.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;&#45;&quot; .. tostring(block.line_last)</text>
<text text-anchor="middle" x="3496.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>codeblock_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3554.8073,-455.3159C3550.0857,-431.9363 3541.4083,-388.9691 3532.1646,-343.1978"/>
<polygon fill="#000000" stroke="#000000" points="3535.5951,-342.5035 3530.1847,-333.3942 3528.7336,-343.8892 3535.5951,-342.5035"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="4249.5,-332.7011 3701.5,-332.7011 3701.5,-.4994 4249.5,-.4994 4249.5,-332.7011"/>
<text text-anchor="middle" x="3975.5" y="-317.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local b = {}</text>
<text text-anchor="middle" x="3975.5" y="-286.3005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Block, lines, linum)</text>
<text text-anchor="middle" x="3975.5" y="-270.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local block = setmetatable({}, B)</text>
<text text-anchor="middle" x="3975.5" y="-255.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.lines = {}</text>
<text text-anchor="middle" x="3975.5" y="-240.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.line_first = linum</text>
<text text-anchor="middle" x="3975.5" y="-224.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if (lines) then </text>
<text text-anchor="middle" x="3975.5" y="-209.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(lines) == &quot;string&quot; then</text>
<text text-anchor="middle" x="3975.5" y="-193.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block:addLine(lines)</text>
<text text-anchor="middle" x="3975.5" y="-178.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif type(lines) == &quot;table&quot; then</text>
<text text-anchor="middle" x="3975.5" y="-163.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, l in ipairs(lines) do</text>
<text text-anchor="middle" x="3975.5" y="-147.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block:addLine(l)</text>
<text text-anchor="middle" x="3975.5" y="-132.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3975.5" y="-116.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3975.5" y="-101.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;freeze(&quot;Error: in block.new type of `lines` is &quot; .. type(lines))</text>
<text text-anchor="middle" x="3975.5" y="-86.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3975.5" y="-70.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3975.5" y="-39.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;block.id = &quot;block&quot;</text>
<text text-anchor="middle" x="3975.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="3975.5" y="-8.5" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_35&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>codeblock_35&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3876.5991,-455.7681C3884.6044,-432.3622 3899.511,-388.778 3915.3668,-342.4186"/>
<polygon fill="#000000" stroke="#000000" points="3918.7309,-343.3978 3918.6554,-332.8032 3912.1075,-341.1325 3918.7309,-343.3978"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="4840.5,-286.8008 4516.5,-286.8008 4516.5,-46.3998 4840.5,-46.3998 4840.5,-286.8008"/>
<text text-anchor="middle" x="4678.5" y="-271.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function structureOrProse(line)</text>
<text text-anchor="middle" x="4678.5" y="-256.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if L.match(m.tagline_p, line) then</text>
<text text-anchor="middle" x="4678.5" y="-240.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;tagline&quot;</text>
<text text-anchor="middle" x="4678.5" y="-225.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.listline_p, line) then</text>
<text text-anchor="middle" x="4678.5" y="-209.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;listline&quot;</text>
<text text-anchor="middle" x="4678.5" y="-194.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif L.match(m.tableline_p, line) then</text>
<text text-anchor="middle" x="4678.5" y="-179.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return true, &quot;tableline&quot;</text>
<text text-anchor="middle" x="4678.5" y="-163.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4678.5" y="-148.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false, &quot;&quot;</text>
<text text-anchor="middle" x="4678.5" y="-132.9002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4678.5" y="-101.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">b[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="4678.5" y="-86.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">b[&quot;__index&quot;] = b</text>
<text text-anchor="middle" x="4678.5" y="-54.7001" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, b)</text>
</g>
<!-- codeblock_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>codeblock_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4678.5,-455.3159C4678.5,-424.135 4678.5,-358.1133 4678.5,-297.0656"/>
<polygon fill="#000000" stroke="#000000" points="4682.0001,-296.9231 4678.5,-286.9232 4675.0001,-296.9232 4682.0001,-296.9231"/>
</g>
</g>
</svg>