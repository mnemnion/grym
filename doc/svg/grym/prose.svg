<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4919pt" height="1249pt"
 viewBox="0.00 0.00 4918.50 1249.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1245.0014)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1245.0014 4914.5,-1245.0014 4914.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1416.5" cy="-1223.0014" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1416.5" y="-1218.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 150</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1416.5" cy="-1151.0014" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1416.5" y="-1146.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;120</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1416.5,-1204.8328C1416.5,-1197.1324 1416.5,-1187.9758 1416.5,-1179.418"/>
<polygon fill="#000000" stroke="#000000" points="1420.0001,-1179.4146 1416.5,-1169.4147 1413.0001,-1179.4147 1420.0001,-1179.4146"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1045.5" cy="-1079.0014" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="1045.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1362.3448,-1140.7198C1305.7405,-1129.9438 1214.3516,-1112.4628 1135.5,-1097.0014 1128.5124,-1095.6313 1121.2218,-1094.191 1113.9471,-1092.7468"/>
<polygon fill="#000000" stroke="#000000" points="1114.5574,-1089.2997 1104.0667,-1090.7812 1113.1916,-1096.1651 1114.5574,-1089.2997"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1176.5" cy="-1079.0014" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1176.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1366.5746,-1139.2097C1326.4247,-1129.2753 1268.7841,-1113.9921 1219.5,-1097.0014 1216.7743,-1096.0617 1213.9745,-1095.035 1211.174,-1093.9636"/>
<polygon fill="#000000" stroke="#000000" points="1212.3418,-1090.6614 1201.7566,-1090.2109 1209.7505,-1097.1641 1212.3418,-1090.6614"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="1301.5" cy="-1079.0014" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1301.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1390.1167,-1134.4832C1374.4183,-1124.6546 1354.2917,-1112.0536 1337.188,-1101.3452"/>
<polygon fill="#000000" stroke="#000000" points="1338.8921,-1098.2827 1328.5589,-1095.9426 1335.1774,-1104.2158 1338.8921,-1098.2827"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1485.5" cy="-1079.0014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1485.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 26&#45;28</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1433.203,-1133.5722C1441.6373,-1124.7712 1452.0257,-1113.9311 1461.3153,-1104.2376"/>
<polygon fill="#000000" stroke="#000000" points="1464.0794,-1106.4119 1468.4715,-1096.7703 1459.0254,-1101.5685 1464.0794,-1106.4119"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2079.5" cy="-1079.0014" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2079.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 30&#45;94</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1477.6851,-1144.3569C1600.5029,-1131.0192 1876.4931,-1101.0474 2007.6505,-1086.8041"/>
<polygon fill="#000000" stroke="#000000" points="2008.418,-1090.2414 2017.9817,-1085.6821 2007.6622,-1083.2823 2008.418,-1090.2414"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="4398.5" cy="-1079.0014" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4398.5" y="-1074.8014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 121&#45;150</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1481.9072,-1149.4222C1870.4564,-1140.0407 3873.1926,-1091.6849 4313.0279,-1081.0651"/>
<polygon fill="#000000" stroke="#000000" points="4313.2129,-1084.5618 4323.1254,-1080.8213 4313.0438,-1077.5638 4313.2129,-1084.5618"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="1055.5,-898.9012 1001.5,-898.9012 1001.5,-862.9012 1055.5,-862.9012 1055.5,-898.9012"/>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.9312,-1060.7197C1040.9582,-1026.0766 1034.4852,-950.6466 1030.9406,-909.3411"/>
<polygon fill="#000000" stroke="#000000" points="1034.4073,-908.8028 1030.0651,-899.1387 1027.433,-909.4014 1034.4073,-908.8028"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="1100.5" cy="-880.9012" rx="27" ry="18"/>
<text text-anchor="middle" x="1100.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1161.6754,-1062.6012C1153.1902,-1052.4269 1142.9764,-1038.7161 1136.5,-1025.0014 1118.5538,-986.998 1108.8668,-938.9764 1104.1966,-909.0969"/>
<polygon fill="#000000" stroke="#000000" points="1107.6231,-908.3416 1102.697,-898.9616 1100.6984,-909.3663 1107.6231,-908.3416"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1427.5,-1025.1017 1145.5,-1025.1017 1145.5,-736.7007 1427.5,-736.7007 1427.5,-1025.1017"/>
<text text-anchor="middle" x="1286.5" y="-1009.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1286.5" y="-978.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="1286.5" y="-963.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require (&quot;status&quot;)()</text>
<text text-anchor="middle" x="1286.5" y="-947.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1286.5" y="-932.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1286.5" y="-916.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp</text>
<text text-anchor="middle" x="1286.5" y="-901.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;node/node&quot;</text>
<text text-anchor="middle" x="1286.5" y="-870.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1286.5" y="-838.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">local Link = require &quot;grym/link&quot;</text>
<text text-anchor="middle" x="1286.5" y="-823.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(type(Link) == &#39;function&#39;)</text>
<text text-anchor="middle" x="1286.5" y="-807.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local Grammar = require &quot;node/grammar&quot;</text>
<text text-anchor="middle" x="1286.5" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
<text text-anchor="middle" x="1286.5" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000">Pr.id = &quot;prose&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_4&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.1157,-1060.7197C1299.5826,-1053.6796 1298.922,-1044.955 1298.1815,-1035.1748"/>
<polygon fill="#000000" stroke="#000000" points="1301.6612,-1034.7731 1297.416,-1025.0659 1294.6812,-1035.3017 1301.6612,-1034.7731"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1587.5,-898.9012 1445.5,-898.9012 1445.5,-862.9012 1587.5,-862.9012 1587.5,-898.9012"/>
<text text-anchor="middle" x="1516.5" y="-877.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = false &#160;</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1488.3608,-1060.7197C1493.7936,-1026.0029 1505.636,-950.3254 1512.0907,-909.078"/>
<polygon fill="#000000" stroke="#000000" points="1515.5579,-909.5596 1513.6461,-899.1387 1508.642,-908.4773 1515.5579,-909.5596"/>
</g>
<!-- header_13 -->
<g id="node14" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1694.5" cy="-880.9012" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1694.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_6&#45;&gt;header_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2017.5846,-1072.9494C1944.6367,-1064.8654 1828.7653,-1048.7494 1792.5,-1025.0014 1749.1476,-996.6124 1719.9367,-941.7051 1705.3509,-908.4729"/>
<polygon fill="#000000" stroke="#000000" points="1708.4212,-906.7482 1701.2943,-898.9087 1701.9769,-909.4815 1708.4212,-906.7482"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1833.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1833.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2021.7538,-1070.3125C1968.7151,-1061.2066 1895.2931,-1045.3902 1874.5,-1025.0014 1843.298,-994.4061 1835.3917,-941.9045 1833.6428,-909.4274"/>
<polygon fill="#000000" stroke="#000000" points="1837.1333,-909.1035 1833.2611,-899.2417 1830.1382,-909.3658 1837.1333,-909.1035"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1915.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1915.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2028.4331,-1067.5322C2003.5396,-1059.4964 1975.0467,-1046.2695 1956.5,-1025.0014 1928.0567,-992.3846 1919.267,-941.2955 1916.5986,-909.5234"/>
<polygon fill="#000000" stroke="#000000" points="1920.0635,-908.89 1915.8879,-899.1527 1913.0799,-909.3687 1920.0635,-908.89"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="1997.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1997.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2063.2422,-1061.1509C2054.8463,-1051.1363 2045.023,-1038.0588 2038.5,-1025.0014 2019.5546,-987.0776 2008.114,-939.0342 2002.3014,-909.1284"/>
<polygon fill="#000000" stroke="#000000" points="2005.6838,-908.1731 2000.4111,-898.9834 1998.8022,-909.4554 2005.6838,-908.1731"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="2079.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2079.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2079.5,-1060.7197C2079.5,-1026.0766 2079.5,-950.6466 2079.5,-909.3411"/>
<polygon fill="#000000" stroke="#000000" points="2083.0001,-909.1387 2079.5,-899.1387 2076.0001,-909.1388 2083.0001,-909.1387"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="2161.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2161.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2095.7578,-1061.1509C2104.1537,-1051.1363 2113.977,-1038.0588 2120.5,-1025.0014 2139.4454,-987.0776 2150.886,-939.0342 2156.6986,-909.1284"/>
<polygon fill="#000000" stroke="#000000" points="2160.1978,-909.4554 2158.5889,-898.9834 2153.3162,-908.1731 2160.1978,-909.4554"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="2243.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2243.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>section_6&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2130.5669,-1067.5322C2155.4604,-1059.4964 2183.9533,-1046.2695 2202.5,-1025.0014 2230.9433,-992.3846 2239.733,-941.2955 2242.4014,-909.5234"/>
<polygon fill="#000000" stroke="#000000" points="2245.9201,-909.3687 2243.1121,-899.1527 2238.9365,-908.89 2245.9201,-909.3687"/>
</g>
<!-- codeblock_20 -->
<g id="node21" class="node">
<title>codeblock_20</title>
<ellipse fill="none" stroke="#000000" cx="2463.5" cy="-880.9012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2463.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 56&#45;78</text>
</g>
<!-- section_6&#45;&gt;codeblock_20 -->
<g id="edge20" class="edge">
<title>section_6&#45;&gt;codeblock_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2137.4981,-1070.4299C2179.8783,-1062.5998 2237.85,-1048.5621 2284.5,-1025.0014 2346.4797,-993.6984 2406.9211,-938.3528 2439.2675,-906.1253"/>
<polygon fill="#000000" stroke="#000000" points="2441.9327,-908.4083 2446.4916,-898.8444 2436.9636,-903.478 2441.9327,-908.4083"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="2866.5" cy="-880.9012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2866.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 80&#45;92</text>
</g>
<!-- section_6&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>section_6&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2142.9865,-1074.173C2253.0044,-1065.3951 2474.5083,-1045.7981 2549.5,-1025.0014 2655.394,-995.6349 2770.7326,-935.3191 2828.7131,-902.812"/>
<polygon fill="#000000" stroke="#000000" points="2830.5283,-905.8065 2837.5159,-897.8425 2827.087,-899.7107 2830.5283,-905.8065"/>
</g>
<!-- section_22 -->
<g id="node23" class="node">
<title>section_22</title>
<ellipse fill="none" stroke="#000000" cx="3789.5" cy="-880.9012" rx="70.655" ry="18"/>
<text text-anchor="middle" x="3789.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 95&#45;120</text>
</g>
<!-- section_6&#45;&gt;section_22 -->
<g id="edge22" class="edge">
<title>section_6&#45;&gt;section_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2145.1508,-1077.3778C2290.8639,-1073.2409 2652.1612,-1060.0387 2952.5,-1025.0014 3242.5494,-991.1645 3584.7494,-923.4409 3724.8254,-894.5111"/>
<polygon fill="#000000" stroke="#000000" points="3725.8752,-897.868 3734.9579,-892.4132 3724.456,-891.0134 3725.8752,-897.868"/>
</g>
<!-- header_52 -->
<g id="node53" class="node">
<title>header_52</title>
<ellipse fill="none" stroke="#000000" cx="4280.5" cy="-880.9012" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="4280.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Constructor</text>
</g>
<!-- section_7&#45;&gt;header_52 -->
<g id="edge52" class="edge">
<title>section_7&#45;&gt;header_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4383.712,-1061.0281C4375.5618,-1050.764 4365.5045,-1037.4875 4357.5,-1025.0014 4332.4683,-985.9548 4307.9993,-937.999 4293.5866,-908.4453"/>
<polygon fill="#000000" stroke="#000000" points="4296.6039,-906.6452 4289.098,-899.1677 4290.3026,-909.6939 4296.6039,-906.6452"/>
</g>
<!-- prose_53 -->
<g id="node54" class="node">
<title>prose_53</title>
<ellipse fill="none" stroke="#000000" cx="4398.5" cy="-880.9012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4398.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_53 -->
<g id="edge53" class="edge">
<title>section_7&#45;&gt;prose_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4398.5,-1060.7197C4398.5,-1026.0766 4398.5,-950.6466 4398.5,-909.3411"/>
<polygon fill="#000000" stroke="#000000" points="4402.0001,-909.1387 4398.5,-899.1387 4395.0001,-909.1388 4402.0001,-909.1387"/>
</g>
<!-- codeblock_54 -->
<g id="node55" class="node">
<title>codeblock_54</title>
<ellipse fill="none" stroke="#000000" cx="4558.5" cy="-880.9012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4558.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 125&#45;134</text>
</g>
<!-- section_7&#45;&gt;codeblock_54 -->
<g id="edge54" class="edge">
<title>section_7&#45;&gt;codeblock_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4412.9811,-1061.0719C4441.408,-1025.8759 4504.6063,-947.6284 4537.5742,-906.81"/>
<polygon fill="#000000" stroke="#000000" points="4540.3758,-908.9116 4543.9363,-898.9329 4534.9302,-904.5132 4540.3758,-908.9116"/>
</g>
<!-- codeblock_55 -->
<g id="node56" class="node">
<title>codeblock_55</title>
<ellipse fill="none" stroke="#000000" cx="4790.5" cy="-880.9012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4790.5" y="-876.7012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 136&#45;138</text>
</g>
<!-- section_7&#45;&gt;codeblock_55 -->
<g id="edge55" class="edge">
<title>section_7&#45;&gt;codeblock_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4463.7195,-1069.7854C4528.418,-1059.8419 4622.4096,-1042.9978 4654.5,-1025.0014 4706.334,-995.9327 4750.1439,-940.4736 4773.1543,-907.4804"/>
<polygon fill="#000000" stroke="#000000" points="4776.327,-909.0412 4779.0822,-898.8109 4770.5487,-905.0901 4776.327,-909.0412"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1297.5,-562.4022 903.5,-562.4022 903.5,-506.5992 1297.5,-506.5992 1297.5,-562.4022"/>
<text text-anchor="middle" x="1100.5" y="-515.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1100.5,-862.7649C1100.5,-808.6304 1100.5,-647.3618 1100.5,-572.9292"/>
<polygon fill="#000000" stroke="#000000" points="1104.0001,-572.6004 1100.5,-562.6004 1097.0001,-572.6005 1104.0001,-572.6004"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1542.5,-552.5007 1488.5,-552.5007 1488.5,-516.5007 1542.5,-516.5007 1542.5,-552.5007"/>
</g>
<!-- header_13&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>header_13&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1684.5768,-862.8133C1668.3945,-834.2267 1634.3089,-777.6601 1596.5,-736.801 1579.1045,-718.0021 1564.9881,-722.5742 1551.5,-700.801 1524.8992,-657.8606 1517.7727,-598.0887 1515.973,-563.1284"/>
<polygon fill="#000000" stroke="#000000" points="1519.453,-562.5551 1515.5579,-552.7022 1512.4586,-562.8336 1519.453,-562.5551"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1587.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="1587.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_14&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_14&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1833.9194,-862.8693C1833.5884,-832.2557 1828.2211,-770.1949 1792.5,-736.801 1736.4001,-684.356 1677.8929,-755.0144 1623.5,-700.801 1586.8424,-664.2644 1583.4991,-599.8443 1585.0401,-562.8209"/>
<polygon fill="#000000" stroke="#000000" points="1588.5415,-562.8927 1585.6119,-552.711 1581.5527,-562.4974 1588.5415,-562.8927"/>
</g>
<!-- raw_26 -->
<g id="node27" class="node">
<title>raw_26</title>
<ellipse fill="none" stroke="#000000" cx="1659.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="1659.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_26 -->
<g id="edge26" class="edge">
<title>prose_15&#45;&gt;raw_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1915.9596,-862.8261C1915.6893,-832.1471 1910.4111,-769.9905 1874.5,-736.801 1814.9056,-681.723 1753.3014,-757.7579 1695.5,-700.801 1658.5388,-664.3798 1655.3512,-599.6414 1656.9906,-562.5951"/>
<polygon fill="#000000" stroke="#000000" points="1660.4918,-562.6772 1657.5894,-552.4877 1653.5041,-562.2632 1660.4918,-562.6772"/>
</g>
<!-- link_27 -->
<g id="node28" class="node">
<title>link_27</title>
<ellipse fill="none" stroke="#000000" cx="1787.5" cy="-534.5007" rx="83.1925" ry="18"/>
<text text-anchor="middle" x="1787.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">link: LPEG manual</text>
</g>
<!-- prose_15&#45;&gt;link_27 -->
<g id="edge27" class="edge">
<title>prose_15&#45;&gt;link_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1911.179,-862.9209C1904.3926,-835.4196 1890.3614,-781.4034 1874.5,-736.801 1851.8048,-672.982 1818.8539,-600.6047 1800.7124,-562.0809"/>
<polygon fill="#000000" stroke="#000000" points="1803.6638,-560.1354 1796.2215,-552.5946 1797.3369,-563.1305 1803.6638,-560.1354"/>
</g>
<!-- raw_28 -->
<g id="node29" class="node">
<title>raw_28</title>
<ellipse fill="none" stroke="#000000" cx="1915.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="1915.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_28 -->
<g id="edge28" class="edge">
<title>prose_15&#45;&gt;raw_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1915.5,-862.7649C1915.5,-806.0774 1915.5,-631.9123 1915.5,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="1919.0001,-562.8753 1915.5,-552.8754 1912.0001,-562.8754 1919.0001,-562.8753"/>
</g>
<!-- raw_32 -->
<g id="node33" class="node">
<title>raw_32</title>
<ellipse fill="none" stroke="#000000" cx="1992.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="1992.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_16&#45;&gt;raw_32 -->
<g id="edge32" class="edge">
<title>prose_16&#45;&gt;raw_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1997.2382,-862.7649C1996.42,-806.0774 1993.9061,-631.9123 1992.9113,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="1996.4093,-562.8238 1992.7652,-552.8754 1989.41,-562.9249 1996.4093,-562.8238"/>
</g>
<!-- raw_34 -->
<g id="node35" class="node">
<title>raw_34</title>
<ellipse fill="none" stroke="#000000" cx="2084.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="2084.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_34 -->
<g id="edge34" class="edge">
<title>prose_17&#45;&gt;raw_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2079.7618,-862.7649C2080.58,-806.0774 2083.0939,-631.9123 2084.0887,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="2087.59,-562.9249 2084.2348,-552.8754 2080.5907,-562.8238 2087.59,-562.9249"/>
</g>
<!-- raw_36 -->
<g id="node37" class="node">
<title>raw_36</title>
<ellipse fill="none" stroke="#000000" cx="2163.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="2163.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_18&#45;&gt;raw_36 -->
<g id="edge36" class="edge">
<title>prose_18&#45;&gt;raw_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2161.6047,-862.7649C2161.932,-806.0774 2162.9376,-631.9123 2163.3355,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="2166.836,-562.8954 2163.3939,-552.8754 2159.8361,-562.855 2166.836,-562.8954"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2238.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="2238.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_19&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_19&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2243.2382,-862.7649C2242.42,-806.0774 2239.9061,-631.9123 2238.9113,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="2242.4093,-562.8238 2238.7652,-552.8754 2235.41,-562.9249 2242.4093,-562.8238"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2825,-700.6015 2284,-700.6015 2284,-368.3999 2825,-368.3999 2825,-700.6015"/>
<text text-anchor="middle" x="2554.5" y="-685.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="2554.5" y="-670.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="2554.5" y="-654.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="2554.5" y="-639.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="2554.5" y="-624.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2554.5" y="-592.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="2554.5" y="-577.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local Cg, C, P, Cmt, Cb = L.Cg, L.C, L.P, L.Cmt, L.Cb</text>
<text text-anchor="middle" x="2554.5" y="-561.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="2554.5" y="-546.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="2554.5" y="-531.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="2554.5" y="-515.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="2554.5" y="-500.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="2554.5" y="-484.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="2554.5" y="-469.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2554.5" y="-438.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="2554.5" y="-422.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="2554.5" y="-407.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="2554.5" y="-391.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="2554.5" y="-376.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_20&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>codeblock_20&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2468.2644,-862.7649C2475.9881,-833.364 2492.0134,-772.3622 2508.1772,-710.8331"/>
<polygon fill="#000000" stroke="#000000" points="2511.6156,-711.5194 2510.7713,-700.9583 2504.8453,-709.7408 2511.6156,-711.5194"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="3167.5,-623.4015 2843.5,-623.4015 2843.5,-445.5999 3167.5,-445.5999 3167.5,-623.4015"/>
<text text-anchor="middle" x="3005.5" y="-608.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="3005.5" y="-592.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="3005.5" y="-577.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _, node in ipairs(prose) do</text>
<text text-anchor="middle" x="3005.5" y="-561.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="3005.5" y="-546.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="3005.5" y="-531.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif node.id == &quot;raw&quot; then</text>
<text text-anchor="middle" x="3005.5" y="-515.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase &#160;.. node:toValue()</text>
<text text-anchor="middle" x="3005.5" y="-500.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3005.5" y="-484.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3005.5" y="-469.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="3005.5" y="-454.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>codeblock_21&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2873.7775,-862.7649C2890.6861,-820.6273 2933.6415,-713.5786 2965.936,-633.0978"/>
<polygon fill="#000000" stroke="#000000" points="2969.3431,-634.0051 2969.819,-623.4209 2962.8466,-631.3982 2969.3431,-634.0051"/>
</g>
<!-- header_42 -->
<g id="node43" class="node">
<title>header_42</title>
<ellipse fill="none" stroke="#000000" cx="3656.5" cy="-534.5007" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="3656.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : prose grammar</text>
</g>
<!-- section_22&#45;&gt;header_42 -->
<g id="edge42" class="edge">
<title>section_22&#45;&gt;header_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3782.5366,-862.7649C3760.6759,-805.8283 3693.3126,-630.3796 3667.0951,-562.0957"/>
<polygon fill="#000000" stroke="#000000" points="3670.2463,-560.5384 3663.3945,-552.4574 3663.7115,-563.0475 3670.2463,-560.5384"/>
</g>
<!-- prose_43 -->
<g id="node44" class="node">
<title>prose_43</title>
<ellipse fill="none" stroke="#000000" cx="3789.5" cy="-534.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3789.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_22&#45;&gt;prose_43 -->
<g id="edge43" class="edge">
<title>section_22&#45;&gt;prose_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3789.5,-862.7649C3789.5,-806.0774 3789.5,-631.9123 3789.5,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="3793.0001,-562.8753 3789.5,-552.8754 3786.0001,-562.8754 3793.0001,-562.8753"/>
</g>
<!-- prose_44 -->
<g id="node45" class="node">
<title>prose_44</title>
<ellipse fill="none" stroke="#000000" cx="3871.5" cy="-534.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3871.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_22&#45;&gt;prose_44 -->
<g id="edge44" class="edge">
<title>section_22&#45;&gt;prose_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3793.7932,-862.7649C3807.2436,-805.9452 3848.6331,-631.0997 3864.8678,-562.5177"/>
<polygon fill="#000000" stroke="#000000" points="3868.3515,-562.9948 3867.2493,-552.4574 3861.5398,-561.3822 3868.3515,-562.9948"/>
</g>
<!-- codeblock_45 -->
<g id="node46" class="node">
<title>codeblock_45</title>
<ellipse fill="none" stroke="#000000" cx="4059.5" cy="-534.5007" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="4059.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 102&#45;118</text>
</g>
<!-- section_22&#45;&gt;codeblock_45 -->
<g id="edge45" class="edge">
<title>section_22&#45;&gt;codeblock_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3803.6362,-862.7649C3848.3797,-805.3607 3987.0204,-627.4895 4039.2857,-560.435"/>
<polygon fill="#000000" stroke="#000000" points="4042.1166,-562.4963 4045.5037,-552.4574 4036.5956,-558.1929 4042.1166,-562.4963"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-254.8006 0,-254.8006 0,-184.1999 527,-184.1999 527,-254.8006"/>
<text text-anchor="middle" x="263.5" y="-207.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="263.5" y="-192.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1589.9235,-516.432C1593.4673,-481.5118 1595.4602,-404.9664 1551.5,-368.2004 1508.1752,-331.9659 590.6902,-344.2012 535.5,-332.2004 466.2098,-317.1336 392.1431,-285.3018 338.8235,-259.299"/>
<polygon fill="#000000" stroke="#000000" points="340.3007,-256.1251 329.7829,-254.849 337.2092,-262.4055 340.3007,-256.1251"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="890,-239.4023 545,-239.4023 545,-199.5982 890,-199.5982 890,-239.4023"/>
<text text-anchor="middle" x="717.5" y="-208.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the </text>
</g>
<!-- raw_26&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>raw_26&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1661.8772,-516.487C1665.3397,-481.6632 1667.1968,-405.279 1623.5,-368.2004 1562.0863,-316.0884 976.3972,-356.1613 899.5,-332.2004 841.4397,-314.109 783.2438,-273.1 748.8071,-245.8623"/>
<polygon fill="#000000" stroke="#000000" points="750.5676,-242.7874 740.5784,-239.2566 746.1855,-248.2461 750.5676,-242.7874"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="1092.5,-237.5002 908.5,-237.5002 908.5,-201.5002 1092.5,-201.5002 1092.5,-237.5002"/>
<text text-anchor="middle" x="1000.5" y="-216.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">[[LPEG manual][httk://]]</text>
</g>
<!-- link_27&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>link_27&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1783.5186,-516.2496C1774.6816,-480.6536 1749.7702,-402.4531 1695.5,-368.2004 1583.669,-297.6183 1220.5591,-389.7585 1101.5,-332.2004 1063.0341,-313.6044 1032.6827,-273.1581 1015.6581,-246.1248"/>
<polygon fill="#000000" stroke="#000000" points="1018.6028,-244.2313 1010.4029,-237.5222 1012.6292,-247.8805 1018.6028,-244.2313"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="1644.5,-246.7007 1110.5,-246.7007 1110.5,-192.2998 1644.5,-192.2998 1644.5,-246.7007"/>
<text text-anchor="middle" x="1377.5" y="-231.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1377.5" y="-216.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="1377.5" y="-200.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- raw_28&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>raw_28&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1917.5563,-516.3628C1920.3438,-482.008 1920.9117,-407.3862 1879.5,-368.2004 1805.6215,-298.2929 1751.4491,-359.606 1653.5,-332.2004 1579.0544,-311.371 1497.5278,-276.4841 1442.5237,-251.0332"/>
<polygon fill="#000000" stroke="#000000" points="1443.7932,-247.7635 1433.2503,-246.7154 1440.8385,-254.1094 1443.7932,-247.7635"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="1966,-254.7006 1663,-254.7006 1663,-184.2999 1966,-184.2999 1966,-254.7006"/>
<text text-anchor="middle" x="1814.5" y="-223.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1814.5" y="-208.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1814.5" y="-192.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- raw_32&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_32&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1991.0116,-516.4631C1987.7725,-484.7572 1978.1031,-417.7065 1951.5,-368.2004 1929.6122,-327.469 1893.9753,-289.2831 1864.5344,-261.8078"/>
<polygon fill="#000000" stroke="#000000" points="1866.5359,-258.8937 1856.8044,-254.7045 1861.7994,-264.048 1866.5359,-258.8937"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="2532.5,-254.7006 1984.5,-254.7006 1984.5,-184.2999 2532.5,-184.2999 2532.5,-254.7006"/>
<text text-anchor="middle" x="2258.5" y="-223.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="2258.5" y="-208.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="2258.5" y="-192.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- raw_34&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>raw_34&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2086.3681,-516.5221C2090.2403,-484.9075 2101.0934,-417.9935 2127.5,-368.2004 2148.8079,-328.0216 2183.0387,-289.6888 2211.1655,-262.0084"/>
<polygon fill="#000000" stroke="#000000" points="2213.8051,-264.3241 2218.546,-254.8491 2208.9312,-259.2995 2213.8051,-264.3241"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="3106,-262.1013 2551,-262.1013 2551,-176.8992 3106,-176.8992 3106,-262.1013"/>
<text text-anchor="middle" x="2828.5" y="-231.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2828.5" y="-215.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2828.5" y="-200.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2828.5" y="-184.9002" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- raw_36&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>raw_36&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2161.6458,-516.3937C2159.2116,-481.7524 2159.478,-406.1718 2202.5,-368.2004 2259.2983,-318.0699 2467.9143,-350.2073 2541.5,-332.2004 2605.6442,-316.5039 2674.6137,-289.7645 2728.8628,-266.2701"/>
<polygon fill="#000000" stroke="#000000" points="2730.3607,-269.4353 2738.1263,-262.2279 2727.5611,-263.0195 2730.3607,-269.4353"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="3672.5,-254.8006 3124.5,-254.8006 3124.5,-184.1999 3672.5,-184.1999 3672.5,-254.8006"/>
<text text-anchor="middle" x="3398.5" y="-223.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="3398.5" y="-208.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- raw_38&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_38&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2236.1005,-516.4606C2232.5989,-481.5906 2230.6764,-405.129 2274.5,-368.2004 2345.9375,-308.0025 3023.1392,-351.7021 3114.5,-332.2004 3186.4923,-316.8331 3263.8882,-285.0087 3319.6738,-259.0854"/>
<polygon fill="#000000" stroke="#000000" points="3321.2158,-262.2281 3328.785,-254.8147 3318.2448,-255.8898 3321.2158,-262.2281"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="3744.5,-237.5002 3690.5,-237.5002 3690.5,-201.5002 3744.5,-201.5002 3744.5,-237.5002"/>
</g>
<!-- header_42&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>header_42&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3660.0433,-516.2034C3670.235,-463.5742 3699.6812,-311.5155 3711.9898,-247.9544"/>
<polygon fill="#000000" stroke="#000000" points="3715.4818,-248.3311 3713.9469,-237.848 3708.6095,-247.0002 3715.4818,-248.3311"/>
</g>
<!-- raw_47 -->
<g id="node48" class="node">
<title>raw_47</title>
<ellipse fill="none" stroke="#000000" cx="3789.5" cy="-219.5002" rx="27" ry="18"/>
<text text-anchor="middle" x="3789.5" y="-215.3002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_43&#45;&gt;raw_47 -->
<g id="edge47" class="edge">
<title>prose_43&#45;&gt;raw_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3789.5,-516.2034C3789.5,-463.5742 3789.5,-311.5155 3789.5,-247.9544"/>
<polygon fill="#000000" stroke="#000000" points="3793.0001,-247.848 3789.5,-237.848 3786.0001,-247.8481 3793.0001,-247.848"/>
</g>
<!-- raw_49 -->
<g id="node50" class="node">
<title>raw_49</title>
<ellipse fill="none" stroke="#000000" cx="3866.5" cy="-219.5002" rx="27" ry="18"/>
<text text-anchor="middle" x="3866.5" y="-215.3002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_44&#45;&gt;raw_49 -->
<g id="edge49" class="edge">
<title>prose_44&#45;&gt;raw_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3871.2096,-516.2034C3870.3742,-463.5742 3867.9606,-311.5155 3866.9517,-247.9544"/>
<polygon fill="#000000" stroke="#000000" points="3870.4496,-247.7912 3866.7912,-237.848 3863.4505,-247.9024 3870.4496,-247.7912"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="4299,-332.4009 3912,-332.4009 3912,-106.5995 4299,-106.5995 4299,-332.4009"/>
<text text-anchor="middle" x="4105.5" y="-317.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function prose_gm(_ENV)</text>
<text text-anchor="middle" x="4105.5" y="-301.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;START &quot;prose&quot;</text>
<text text-anchor="middle" x="4105.5" y="-286.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;prose = (V&quot;link&quot; + V&quot;raw&quot;)^1</text>
<text text-anchor="middle" x="4105.5" y="-270.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;link = m.link</text>
<text text-anchor="middle" x="4105.5" y="-255.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;raw = (P(1) &#45; m.link)^1</text>
<text text-anchor="middle" x="4105.5" y="-240.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4105.5" y="-208.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">local function proseBuild(prose, str)</text>
<text text-anchor="middle" x="4105.5" y="-193.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return setmetatable(prose, {__index = Pr })</text>
<text text-anchor="middle" x="4105.5" y="-177.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4105.5" y="-146.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">local parse = Grammar(prose_gm, { prose = proseBuild,</text>
<text text-anchor="middle" x="4105.5" y="-131.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;link &#160;= Link }) &#160;</text>
</g>
<!-- codeblock_45&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>codeblock_45&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4062.172,-516.2034C4067.0873,-482.5442 4077.9416,-408.2156 4087.5559,-342.3784"/>
<polygon fill="#000000" stroke="#000000" points="4091.044,-342.7138 4089.0258,-332.3129 4084.1174,-341.7022 4091.044,-342.7138"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="3821.5,-70.7004 3273.5,-70.7004 3273.5,-.0997 3821.5,-.0997 3821.5,-70.7004"/>
<text text-anchor="middle" x="3547.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The Prose module is the first one to use our shiny&#45;new Node module. &#160;Which</text>
<text text-anchor="middle" x="3547.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">finally works the way I intend it to and I&#39;m pretty happy about this. </text>
</g>
<!-- raw_47&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_47&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3788.585,-201.3604C3786.3806,-176.7347 3778.8911,-132.8199 3753.5,-106.8001 3741.3458,-94.345 3726.9129,-84.0606 3711.4117,-75.5691"/>
<polygon fill="#000000" stroke="#000000" points="3712.6588,-72.2731 3702.1705,-70.7737 3709.4346,-78.4864 3712.6588,-72.2731"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="4367,-55.3021 3840,-55.3021 3840,-15.4979 4367,-15.4979 4367,-55.3021"/>
<text text-anchor="middle" x="4103.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000">It&#39;s pure link&#45;or&#45;raw, but it has everything it needs to be so much more.</text>
</g>
<!-- raw_49&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_49&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3867.4435,-201.3882C3869.6811,-176.7947 3877.2089,-132.9172 3902.5,-106.8001 3924.2348,-84.3554 3953.475,-68.9497 3982.9127,-58.3811"/>
<polygon fill="#000000" stroke="#000000" points="3984.1365,-61.6617 3992.4681,-55.117 3981.8736,-55.0376 3984.1365,-61.6617"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="4307.5,-552.5007 4253.5,-552.5007 4253.5,-516.5007 4307.5,-516.5007 4307.5,-552.5007"/>
</g>
<!-- header_52&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>header_52&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4280.5,-862.7649C4280.5,-806.0774 4280.5,-631.9123 4280.5,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="4284.0001,-562.8753 4280.5,-552.8754 4277.0001,-562.8754 4284.0001,-562.8753"/>
</g>
<!-- raw_57 -->
<g id="node58" class="node">
<title>raw_57</title>
<ellipse fill="none" stroke="#000000" cx="4387.5" cy="-534.5007" rx="27" ry="18"/>
<text text-anchor="middle" x="4387.5" y="-530.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_53&#45;&gt;raw_57 -->
<g id="edge57" class="edge">
<title>prose_53&#45;&gt;raw_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4397.9241,-862.7649C4396.124,-806.0774 4390.5933,-631.9123 4388.4049,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="4391.8992,-562.7592 4388.0835,-552.8754 4384.9027,-562.9814 4391.8992,-562.7592"/>
</g>
<!-- leaf_59 -->
<g id="node60" class="node">
<title>leaf_59</title>
<polygon fill="none" stroke="#c0c0c0" points="4708,-600.2011 4433,-600.2011 4433,-468.8003 4708,-468.8003 4708,-600.2011"/>
<text text-anchor="middle" x="4570.5" y="-584.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="4570.5" y="-569.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;\n&quot;</text>
<text text-anchor="middle" x="4570.5" y="-554.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="4570.5" y="-538.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="4570.5" y="-523.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4570.5" y="-507.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = parse(phrase, 0) </text>
<text text-anchor="middle" x="4570.5" y="-492.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="4570.5" y="-477.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_54&#45;&gt;leaf_59 -->
<g id="edge59" class="edge">
<title>codeblock_54&#45;&gt;leaf_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4559.1283,-862.7649C4560.7307,-816.5078 4565.043,-692.0271 4567.8728,-610.3407"/>
<polygon fill="#000000" stroke="#000000" points="4571.379,-610.2191 4568.2274,-600.1038 4564.3832,-609.9766 4571.379,-610.2191"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="4910.5,-552.5007 4726.5,-552.5007 4726.5,-516.5007 4910.5,-516.5007 4910.5,-552.5007"/>
<text text-anchor="middle" x="4818.5" y="-531.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_55&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>codeblock_55&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4791.966,-862.7649C4796.5481,-806.0774 4810.6261,-631.9123 4816.1965,-562.9979"/>
<polygon fill="#000000" stroke="#000000" points="4819.6976,-563.1249 4817.0148,-552.8754 4812.7204,-562.5608 4819.6976,-563.1249"/>
</g>
<!-- leaf_58 -->
<g id="node59" class="node">
<title>leaf_58</title>
<polygon fill="none" stroke="#c0c0c0" points="4648,-247.4017 4317,-247.4017 4317,-191.5987 4648,-191.5987 4648,-247.4017"/>
<text text-anchor="middle" x="4482.5" y="-200.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; [ ] #todo smuggle in that offset in =parse=</text>
</g>
<!-- raw_57&#45;&gt;leaf_58 -->
<g id="edge58" class="edge">
<title>raw_57&#45;&gt;leaf_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4390.4306,-516.2871C4395.6204,-485.4234 4407.4155,-421.0473 4423.5,-368.2004 4435.3067,-329.4087 4452.8359,-286.4995 4465.7204,-256.7858"/>
<polygon fill="#000000" stroke="#000000" points="4469.0951,-257.8043 4469.897,-247.2398 4462.6821,-254.9984 4469.0951,-257.8043"/>
</g>
</g>
</svg>