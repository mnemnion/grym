<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="6915pt" height="815pt"
 viewBox="0.00 0.00 6914.50 815.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 811.2009)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-811.2009 6910.5,-811.2009 6910.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1134.5" cy="-789.2009" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1134.5" y="-785.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 124</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1134.5" cy="-717.2009" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1134.5" y="-713.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;16</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1134.5,-771.0322C1134.5,-763.3318 1134.5,-754.1752 1134.5,-745.6175"/>
<polygon fill="#000000" stroke="#000000" points="1138.0001,-745.6141 1134.5,-735.6141 1131.0001,-745.6142 1138.0001,-745.6141"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="946.5" cy="-645.2009" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="946.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1096.9072,-702.8036C1067.9688,-691.7208 1027.7121,-676.3034 996.1284,-664.2075"/>
<polygon fill="#000000" stroke="#000000" points="997.2175,-660.8767 986.6271,-660.5687 994.7139,-667.4137 997.2175,-660.8767"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1073.5" cy="-645.2009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1073.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1119.4213,-699.4031C1111.8139,-690.4238 1102.4694,-679.3943 1094.2003,-669.634"/>
<polygon fill="#000000" stroke="#000000" points="1096.7035,-667.1741 1087.5688,-661.8067 1091.3626,-671.699 1096.7035,-667.1741"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="1196.5" cy="-645.2009" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1196.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1149.8258,-699.4031C1157.2779,-690.7492 1166.3698,-680.1908 1174.5427,-670.6997"/>
<polygon fill="#000000" stroke="#000000" points="1177.2625,-672.905 1181.1356,-663.0434 1171.9581,-668.3373 1177.2625,-672.905"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1774.5" cy="-645.2009" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1774.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 17&#45;81</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1191.2957,-710.8114C1308.204,-697.6592 1575.4949,-667.5889 1703.5516,-653.1826"/>
<polygon fill="#000000" stroke="#000000" points="1704.0973,-656.6433 1713.6433,-652.0472 1703.3147,-649.6872 1704.0973,-656.6433"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="1051.5,-544.9029 657.5,-544.9029 657.5,-505.0987 1051.5,-505.0987 1051.5,-544.9029"/>
<text text-anchor="middle" x="854.5" y="-513.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- prose_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>prose_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1050.4771,-632.5645C1014.7515,-612.9563 945.3078,-574.8415 899.4159,-549.6533"/>
<polygon fill="#000000" stroke="#000000" points="901.0189,-546.5406 890.5685,-544.7973 897.6508,-552.6771 901.0189,-546.5406"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="1323.5,-591.4016 1069.5,-591.4016 1069.5,-458.6 1323.5,-458.6 1323.5,-591.4016"/>
<text text-anchor="middle" x="1196.5" y="-576.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1196.5" y="-560.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="1196.5" y="-545.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1196.5" y="-513.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1196.5" y="-498.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1196.5" y="-467.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>codeblock_4&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1196.5,-626.9451C1196.5,-619.6823 1196.5,-610.8011 1196.5,-601.3394"/>
<polygon fill="#000000" stroke="#000000" points="1200.0001,-601.3127 1196.5,-591.3127 1193.0001,-601.3127 1200.0001,-601.3127"/>
</g>
<!-- header_8 -->
<g id="node9" class="node">
<title>header_8</title>
<ellipse fill="none" stroke="#000000" cx="1430.5" cy="-525.0008" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1430.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_5&#45;&gt;header_8 -->
<g id="edge8" class="edge">
<title>section_5&#45;&gt;header_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1713.6477,-638.352C1662.6294,-631.099 1588.679,-617.0062 1528.5,-591.2009 1503.463,-580.4648 1478.0542,-563.075 1459.3842,-548.8124"/>
<polygon fill="#000000" stroke="#000000" points="1461.3444,-545.9026 1451.3059,-542.5144 1457.0405,-551.4231 1461.3444,-545.9026"/>
</g>
<!-- prose_9 -->
<g id="node10" class="node">
<title>prose_9</title>
<ellipse fill="none" stroke="#000000" cx="1569.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1569.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_9 -->
<g id="edge9" class="edge">
<title>section_5&#45;&gt;prose_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1717.0583,-636.4438C1683.2473,-628.9663 1641.2303,-615.4066 1610.5,-591.2009 1597.5105,-580.9693 1587.574,-565.4027 1580.7383,-551.9347"/>
<polygon fill="#000000" stroke="#000000" points="1583.7599,-550.1381 1576.3096,-542.6051 1577.4362,-553.1399 1583.7599,-550.1381"/>
</g>
<!-- prose_10 -->
<g id="node11" class="node">
<title>prose_10</title>
<ellipse fill="none" stroke="#000000" cx="1651.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1651.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;prose_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1743.7287,-629.2511C1727.2538,-619.7082 1707.3553,-606.4756 1692.5,-591.2009 1681.1993,-579.5811 1671.4905,-564.3243 1664.3613,-551.3862"/>
<polygon fill="#000000" stroke="#000000" points="1667.4096,-549.6635 1659.6402,-542.4602 1661.2218,-552.9364 1667.4096,-549.6635"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="1733.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1733.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1768.3619,-627.2057C1761.59,-607.3525 1750.6162,-575.1805 1742.79,-552.2365"/>
<polygon fill="#000000" stroke="#000000" points="1746.0873,-551.0612 1739.5462,-542.7266 1739.4621,-553.3211 1746.0873,-551.0612"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="1815.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1815.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1780.6381,-627.2057C1787.41,-607.3525 1798.3838,-575.1805 1806.21,-552.2365"/>
<polygon fill="#000000" stroke="#000000" points="1809.5379,-553.3211 1809.4538,-542.7266 1802.9127,-551.0612 1809.5379,-553.3211"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="2019.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2019.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1806.5295,-629.4868C1853.0055,-606.6851 1938.7364,-564.6244 1986.016,-541.4284"/>
<polygon fill="#000000" stroke="#000000" points="1987.7788,-544.4622 1995.2149,-536.9154 1984.6955,-538.1778 1987.7788,-544.4622"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="2467.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2467.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1830.0396,-635.5676C1965.038,-612.1523 2307.9865,-552.6682 2426.4834,-532.1151"/>
<polygon fill="#000000" stroke="#000000" points="2427.3325,-535.5201 2436.5872,-530.3626 2426.1361,-528.6231 2427.3325,-535.5201"/>
</g>
<!-- section_15 -->
<g id="node16" class="node">
<title>section_15</title>
<ellipse fill="none" stroke="#000000" cx="3373.5" cy="-525.0008" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3373.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 42&#45;81</text>
</g>
<!-- section_5&#45;&gt;section_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;section_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1838.322,-640.5691C1965.7307,-631.3085 2260.6747,-609.8003 2508.5,-591.2009 2801.6572,-569.1993 3150.6387,-542.2631 3299.8899,-530.7078"/>
<polygon fill="#000000" stroke="#000000" points="3300.5874,-534.1644 3310.2873,-529.9027 3300.0469,-527.1853 3300.5874,-534.1644"/>
</g>
<!-- section_16 -->
<g id="node17" class="node">
<title>section_16</title>
<ellipse fill="none" stroke="#000000" cx="5547.5" cy="-525.0008" rx="70.655" ry="18"/>
<text text-anchor="middle" x="5547.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 82&#45;124</text>
</g>
<!-- section_5&#45;&gt;section_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;section_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1839.9875,-643.1146C2293.8443,-628.6556 4967.8417,-543.4675 5467.2047,-527.5588"/>
<polygon fill="#000000" stroke="#000000" points="5467.3221,-531.057 5477.2056,-527.2402 5467.0991,-524.0605 5467.3221,-531.057"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-415.3011 0,-415.3011 0,-360.7002 527,-360.7002 527,-415.3011"/>
<text text-anchor="middle" x="263.5" y="-384.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="263.5" y="-368.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- prose_9&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>prose_9&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1563.8509,-507.1336C1557.827,-491.3745 1546.6187,-469.3263 1528.5,-458.8007 1433.13,-403.3976 646.4284,-431.7832 536.5,-422.8007 515.2325,-421.0629 493.077,-418.8723 470.9904,-416.4398"/>
<polygon fill="#000000" stroke="#000000" points="471.1778,-412.939 460.8508,-415.3059 470.3998,-419.8956 471.1778,-412.939"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1079.5,-415.2011 545.5,-415.2011 545.5,-360.8002 1079.5,-360.8002 1079.5,-415.2011"/>
<text text-anchor="middle" x="812.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the [[LPEG manual][httk://]]]]</text>
<text text-anchor="middle" x="812.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="812.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- prose_10&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>prose_10&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1645.7697,-507.2707C1639.6898,-491.6063 1628.4448,-469.6201 1610.5,-458.8007 1560.7117,-428.782 1146.3637,-428.4394 1088.5,-422.8007 1068.6718,-420.8685 1048.0675,-418.6554 1027.4521,-416.3022"/>
<polygon fill="#000000" stroke="#000000" points="1027.6693,-412.8041 1017.3343,-415.1363 1026.8679,-419.7581 1027.6693,-412.8041"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1401,-415.2011 1098,-415.2011 1098,-360.8002 1401,-360.8002 1401,-415.2011"/>
<text text-anchor="middle" x="1249.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1249.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1249.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- prose_11&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>prose_11&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1727.4991,-507.2113C1721.2896,-491.7323 1710.0092,-470.0637 1692.5,-458.8007 1639.3682,-424.6228 1472.7654,-433.4841 1410.5,-422.8007 1400.4613,-421.0783 1390.0995,-419.1615 1379.6987,-417.1378"/>
<polygon fill="#000000" stroke="#000000" points="1380.213,-413.6718 1369.7243,-415.1676 1378.8565,-420.5391 1380.213,-413.6718"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1967.5,-415.2011 1419.5,-415.2011 1419.5,-360.8002 1967.5,-360.8002 1967.5,-415.2011"/>
<text text-anchor="middle" x="1693.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="1693.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="1693.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- prose_12&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>prose_12&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1806.5226,-507.4586C1798.966,-493.5336 1787.3554,-473.9552 1774.5,-458.8007 1763.3938,-445.7083 1749.82,-432.8898 1736.9826,-421.8364"/>
<polygon fill="#000000" stroke="#000000" points="1739.013,-418.9701 1729.1133,-415.1956 1734.4984,-424.3198 1739.013,-418.9701"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2541,-422.6019 1986,-422.6019 1986,-353.3994 2541,-353.3994 2541,-422.6019"/>
<text text-anchor="middle" x="2263.5" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2263.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2263.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2263.5" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- prose_13&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>prose_13&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2042.4549,-512.1121C2076.5328,-492.9782 2141.9502,-456.2479 2192.815,-427.6886"/>
<polygon fill="#000000" stroke="#000000" points="2194.8036,-430.586 2201.8097,-422.6383 2191.3765,-424.4823 2194.8036,-430.586"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="3107.5,-407.3012 2559.5,-407.3012 2559.5,-368.7 3107.5,-368.7 3107.5,-407.3012"/>
<text text-anchor="middle" x="2833.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="2833.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- prose_14&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>prose_14&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2494.4129,-514.9268C2552.6322,-493.1343 2691.5259,-441.144 2772.3357,-410.8955"/>
<polygon fill="#000000" stroke="#000000" points="2773.7549,-414.1015 2781.8933,-407.3179 2771.3009,-407.5457 2773.7549,-414.1015"/>
</g>
<!-- header_23 -->
<g id="node24" class="node">
<title>header_23</title>
<ellipse fill="none" stroke="#000000" cx="3192.5" cy="-388.0006" rx="67.2722" ry="18"/>
<text text-anchor="middle" x="3192.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lpeg locals</text>
</g>
<!-- section_15&#45;&gt;header_23 -->
<g id="edge23" class="edge">
<title>section_15&#45;&gt;header_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3350.9422,-507.9266C3318.7443,-483.5558 3259.5075,-438.7191 3223.2963,-411.3106"/>
<polygon fill="#000000" stroke="#000000" points="3225.1429,-408.3187 3215.0571,-405.0742 3220.9183,-413.9002 3225.1429,-408.3187"/>
</g>
<!-- prose_24 -->
<g id="node25" class="node">
<title>prose_24</title>
<ellipse fill="none" stroke="#000000" cx="3309.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3309.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_15&#45;&gt;prose_24 -->
<g id="edge24" class="edge">
<title>section_15&#45;&gt;prose_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3365.1331,-507.0904C3354.1488,-483.577 3334.7704,-442.095 3322.0316,-414.826"/>
<polygon fill="#000000" stroke="#000000" points="3325.0702,-413.061 3317.6666,-405.4822 3318.7281,-416.0238 3325.0702,-413.061"/>
</g>
<!-- codeblock_25 -->
<g id="node26" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="3437.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3437.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 44&#45;50</text>
</g>
<!-- section_15&#45;&gt;codeblock_25 -->
<g id="edge25" class="edge">
<title>section_15&#45;&gt;codeblock_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3381.8669,-507.0904C3392.7909,-483.7062 3412.0169,-442.5503 3424.7579,-415.2768"/>
<polygon fill="#000000" stroke="#000000" points="3428.0696,-416.4569 3429.1311,-405.9154 3421.7275,-413.4942 3428.0696,-416.4569"/>
</g>
<!-- codeblock_26 -->
<g id="node27" class="node">
<title>codeblock_26</title>
<ellipse fill="none" stroke="#000000" cx="3610.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3610.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 52&#45;73</text>
</g>
<!-- section_15&#45;&gt;codeblock_26 -->
<g id="edge26" class="edge">
<title>section_15&#45;&gt;codeblock_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3402.0877,-508.4754C3444.7665,-483.8045 3525.1927,-437.3133 3572.6866,-409.859"/>
<polygon fill="#000000" stroke="#000000" points="3574.5341,-412.8338 3581.4401,-404.799 3571.0308,-406.7735 3574.5341,-412.8338"/>
</g>
<!-- codeblock_27 -->
<g id="node28" class="node">
<title>codeblock_27</title>
<ellipse fill="none" stroke="#000000" cx="3896.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3896.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 75&#45;79</text>
</g>
<!-- section_15&#45;&gt;codeblock_27 -->
<g id="edge27" class="edge">
<title>section_15&#45;&gt;codeblock_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3421.2992,-512.4797C3516.4483,-487.5554 3729.4461,-431.7605 3834.9133,-404.1333"/>
<polygon fill="#000000" stroke="#000000" points="3835.9899,-407.4695 3844.7766,-401.5496 3834.216,-400.6979 3835.9899,-407.4695"/>
</g>
<!-- header_32 -->
<g id="node33" class="node">
<title>header_32</title>
<ellipse fill="none" stroke="#000000" cx="5305.5" cy="-388.0006" rx="69.1756" ry="18"/>
<text text-anchor="middle" x="5305.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Link or Raw</text>
</g>
<!-- section_16&#45;&gt;header_32 -->
<g id="edge32" class="edge">
<title>section_16&#45;&gt;header_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5518.3091,-508.4754C5474.4938,-483.6708 5391.7156,-436.8087 5343.3256,-409.4143"/>
<polygon fill="#000000" stroke="#000000" points="5344.8443,-406.2521 5334.4177,-404.3714 5341.3957,-412.3437 5344.8443,-406.2521"/>
</g>
<!-- prose_33 -->
<g id="node34" class="node">
<title>prose_33</title>
<ellipse fill="none" stroke="#000000" cx="5424.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5424.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_33 -->
<g id="edge33" class="edge">
<title>section_16&#45;&gt;prose_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5531.6717,-507.3709C5509.8217,-483.0338 5470.3511,-439.0706 5445.8916,-411.827"/>
<polygon fill="#000000" stroke="#000000" points="5448.4034,-409.3857 5439.1184,-404.2829 5443.1947,-414.0622 5448.4034,-409.3857"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="5506.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5506.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_16&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5542.0555,-506.8082C5535.0634,-483.4443 5522.8634,-442.6784 5514.7338,-415.5136"/>
<polygon fill="#000000" stroke="#000000" points="5518.0569,-414.4097 5511.8367,-405.833 5511.3508,-416.4167 5518.0569,-414.4097"/>
</g>
<!-- prose_35 -->
<g id="node36" class="node">
<title>prose_35</title>
<ellipse fill="none" stroke="#000000" cx="5588.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5588.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_35 -->
<g id="edge35" class="edge">
<title>section_16&#45;&gt;prose_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5552.9445,-506.8082C5559.9366,-483.4443 5572.1366,-442.6784 5580.2662,-415.5136"/>
<polygon fill="#000000" stroke="#000000" points="5583.6492,-416.4167 5583.1633,-405.833 5576.9431,-414.4097 5583.6492,-416.4167"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="5905.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5905.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>section_16&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5586.8363,-509.9475C5656.7783,-483.1819 5801.7587,-427.7006 5869.348,-401.8353"/>
<polygon fill="#000000" stroke="#000000" points="5870.652,-405.0839 5878.7405,-398.241 5868.1501,-398.5463 5870.652,-405.0839"/>
</g>
<!-- codeblock_37 -->
<g id="node38" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="6297.5" cy="-388.0006" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="6297.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 97&#45;108</text>
</g>
<!-- section_16&#45;&gt;codeblock_37 -->
<g id="edge37" class="edge">
<title>section_16&#45;&gt;codeblock_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5605.1059,-514.4781C5739.8155,-489.8711 6075.243,-428.5996 6224.2124,-401.3878"/>
<polygon fill="#000000" stroke="#000000" points="6224.9727,-404.807 6234.181,-399.5669 6223.7148,-397.9209 6224.9727,-404.807"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="6778.5" cy="-388.0006" rx="85.9862" ry="18"/>
<text text-anchor="middle" x="6778.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 110&#45;112</text>
</g>
<!-- section_16&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>section_16&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5612.3821,-517.7799C5818.5786,-494.832 6459,-423.5583 6692.3359,-397.59"/>
<polygon fill="#000000" stroke="#000000" points="6692.9182,-401.0469 6702.4697,-396.4622 6692.1439,-394.0898 6692.9182,-401.0469"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="3168.5,-176.6003 3114.5,-176.6003 3114.5,-140.6003 3168.5,-140.6003 3168.5,-176.6003"/>
</g>
<!-- prose_24&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>prose_24&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3293.2983,-372.1089C3286.1158,-365.651 3277.3074,-358.483 3268.5,-353.2006 3231.2001,-330.8293 3205.8063,-350.2234 3177.5,-317.2006 3145.9959,-280.4471 3140.5426,-221.7882 3140.3771,-187.0486"/>
<polygon fill="#000000" stroke="#000000" points="3143.8807,-186.7032 3140.4828,-176.668 3136.881,-186.6318 3143.8807,-186.7032"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3322,-201.1004 3187,-201.1004 3187,-116.1001 3322,-116.1001 3322,-201.1004"/>
<text text-anchor="middle" x="3254.5" y="-185.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cg = L.Cg</text>
<text text-anchor="middle" x="3254.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = L.C</text>
<text text-anchor="middle" x="3254.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = L.P</text>
<text text-anchor="middle" x="3254.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cmt = L.Cmt</text>
<text text-anchor="middle" x="3254.5" y="-124.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cb = L.Cb</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>codeblock_25&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3403.6225,-371.783C3380.6332,-359.4146 3350.8356,-340.5481 3330.5,-317.2006 3303.4869,-286.1866 3283.8595,-243.8991 3271.3243,-210.7888"/>
<polygon fill="#000000" stroke="#000000" points="3274.5596,-209.4458 3267.8192,-201.2716 3267.9909,-211.865 3274.5596,-209.4458"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3881,-317.3009 3340,-317.3009 3340,.1003 3881,.1003 3881,-317.3009"/>
<text text-anchor="middle" x="3610.5" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3610.5" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3610.5" y="-271.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3610.5" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3610.5" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3610.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3610.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3610.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3610.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3610.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3610.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3610.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3610.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3610.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3610.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3610.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3610.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3610.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_26&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_26&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3610.5,-370C3610.5,-359.2281 3610.5,-344.36 3610.5,-327.4549"/>
<polygon fill="#000000" stroke="#000000" points="3614.0001,-327.2815 3610.5,-317.2816 3607.0001,-327.2816 3614.0001,-327.2815"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="4118,-185.8007 3899,-185.8007 3899,-131.3998 4118,-131.3998 4118,-185.8007"/>
<text text-anchor="middle" x="4008.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="4008.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return prose.val</text>
<text text-anchor="middle" x="4008.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>codeblock_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3905.2885,-370C3923.6495,-332.3926 3966.3868,-244.8573 3990.7177,-195.0223"/>
<polygon fill="#000000" stroke="#000000" points="3993.939,-196.4019 3995.1812,-185.8802 3987.6486,-193.3308 3993.939,-196.4019"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="4691,-185.9007 4136,-185.9007 4136,-131.2999 4691,-131.2999 4691,-185.9007"/>
<text text-anchor="middle" x="4413.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The prose parser will be a proper recursive grammar. &#160;This calls for some</text>
<text text-anchor="middle" x="4413.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">enhancements to epnf to allow assignment of Node metatables to matched spans.</text>
</g>
<!-- prose_33&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>prose_33&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5410.1559,-371.7491C5402.9266,-364.72 5393.5648,-357.1998 5383.5,-353.2006 5242.2537,-297.0758 4846.6216,-359.0214 4700.5,-317.2006 4608.0263,-290.7341 4512.6,-230.1165 4458.4005,-191.9564"/>
<polygon fill="#000000" stroke="#000000" points="4460.2419,-188.9713 4450.0626,-186.0335 4456.1881,-194.6781 4460.2419,-188.9713"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="5285.5,-177.9009 4709.5,-177.9009 4709.5,-139.2997 5285.5,-139.2997 5285.5,-177.9009"/>
<text text-anchor="middle" x="4997.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ve been sloppy with the node constructor interface and will need to go through</text>
<text text-anchor="middle" x="4997.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">the whole =grym= directory and fix it into a consistent state. &#160;At some point.</text>
</g>
<!-- prose_34&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>prose_34&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5491.0894,-371.7228C5483.9114,-365.0381 5474.89,-357.8019 5465.5,-353.2006 5395.7576,-319.0246 5367.4842,-343.7583 5294.5,-317.2006 5196.4169,-281.5097 5090.6677,-218.4478 5035.6644,-183.5611"/>
<polygon fill="#000000" stroke="#000000" points="5037.2728,-180.4356 5026.9602,-178.0062 5033.507,-186.3363 5037.2728,-180.4356"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="5873,-193.2015 5304,-193.2015 5304,-123.999 5873,-123.999 5873,-193.2015"/>
<text text-anchor="middle" x="5588.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">Links give me a chance to design that interface to fit grammatically. For now,</text>
<text text-anchor="middle" x="5588.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">we&#39;re going to handroll another Link class, and write a simple either&#45;or parser</text>
<text text-anchor="middle" x="5588.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">over prose strings that finds links and puts the rest in a =raw= class, which</text>
<text text-anchor="middle" x="5588.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">shouldn&#39;t need an intermediate Node class. </text>
</g>
<!-- prose_35&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>prose_35&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5588.5,-370C5588.5,-334.4265 5588.5,-254.1793 5588.5,-203.4247"/>
<polygon fill="#000000" stroke="#000000" points="5592.0001,-203.3789 5588.5,-193.3789 5585.0001,-203.379 5592.0001,-203.3789"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="6390,-176.6003 5891,-176.6003 5891,-140.6003 6390,-140.6003 6390,-176.6003"/>
<text text-anchor="middle" x="6140.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">This Link class needs to fit the constructor semantics of =epeg.Csp=.</text>
</g>
<!-- prose_36&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>prose_36&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5921.6525,-372.233C5961.7142,-333.1259 6065.9199,-231.4033 6114.66,-183.8246"/>
<polygon fill="#000000" stroke="#000000" points="6117.2769,-186.1611 6121.9879,-176.6712 6112.3872,-181.152 6117.2769,-186.1611"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="6704.5,-239.7011 6408.5,-239.7011 6408.5,-77.4995 6704.5,-77.4995 6704.5,-239.7011"/>
<text text-anchor="middle" x="6556.5" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="6556.5" y="-193.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = setmetatable({},Pr)</text>
<text text-anchor="middle" x="6556.5" y="-177.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.id = &quot;prose&quot;</text>
<text text-anchor="middle" x="6556.5" y="-162.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.val = &quot;&quot;</text>
<text text-anchor="middle" x="6556.5" y="-147.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="6556.5" y="-131.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose.val = prose.val .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="6556.5" y="-116.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6556.5" y="-100.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="6556.5" y="-85.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_37&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6324.5968,-370.8846C6345.4919,-357.2472 6374.7385,-337.1879 6398.5,-317.2006 6423.9722,-295.7742 6450.084,-270.9342 6473.5568,-247.3623"/>
<polygon fill="#000000" stroke="#000000" points="6476.2053,-249.6618 6480.7531,-240.0927 6471.2305,-244.7372 6476.2053,-249.6618"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="6906.5,-176.6003 6722.5,-176.6003 6722.5,-140.6003 6906.5,-140.6003 6906.5,-176.6003"/>
<text text-anchor="middle" x="6814.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_38&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6781.3249,-370C6787.5659,-330.2304 6802.5691,-234.6268 6810.0719,-186.8173"/>
<polygon fill="#000000" stroke="#000000" points="6813.5457,-187.2565 6811.6384,-176.8347 6806.6303,-186.1712 6813.5457,-187.2565"/>
</g>
</g>
</svg>