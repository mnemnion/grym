<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="6544pt" height="956pt"
 viewBox="0.00 0.00 6543.50 955.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 951.6011)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-951.6011 6539.5,-951.6011 6539.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1752.5" cy="-929.6011" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1752.5" y="-925.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 137</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1752.5" cy="-857.6011" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1752.5" y="-853.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;108</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1752.5,-911.4324C1752.5,-903.732 1752.5,-894.5754 1752.5,-886.0177"/>
<polygon fill="#000000" stroke="#000000" points="1756.0001,-886.0143 1752.5,-876.0143 1749.0001,-886.0144 1756.0001,-886.0143"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1502.5" cy="-785.6011" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="1502.5" y="-781.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1707.2269,-844.5624C1666.2816,-832.7702 1605.7485,-815.3366 1561.1187,-802.4833"/>
<polygon fill="#000000" stroke="#000000" points="1561.859,-799.0542 1551.2809,-799.65 1559.9217,-805.7808 1561.859,-799.0542"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1629.5" cy="-785.6011" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1629.5" y="-781.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1724.5894,-841.2631C1705.6209,-830.1596 1680.5028,-815.4564 1660.8461,-803.95"/>
<polygon fill="#000000" stroke="#000000" points="1662.3623,-800.782 1651.964,-798.7507 1658.826,-806.8231 1662.3623,-800.782"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="1752.5" cy="-785.6011" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1752.5" y="-781.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;18</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1752.5,-839.4324C1752.5,-831.732 1752.5,-822.5754 1752.5,-814.0177"/>
<polygon fill="#000000" stroke="#000000" points="1756.0001,-814.0143 1752.5,-804.0143 1749.0001,-814.0144 1756.0001,-814.0143"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="2140.5" cy="-785.6011" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2140.5" y="-781.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 21&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1807.268,-847.4379C1877.8937,-834.3321 2000.553,-811.5706 2075.7285,-797.6205"/>
<polygon fill="#000000" stroke="#000000" points="2076.8171,-800.9783 2086.0106,-795.7125 2075.5399,-794.0958 2076.8171,-800.9783"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="5388.5" cy="-785.6011" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5388.5" y="-781.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 109&#45;137</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1818.3216,-856.2977C2261.1077,-847.5296 4803.0603,-797.1939 5303.1146,-787.2919"/>
<polygon fill="#000000" stroke="#000000" points="5303.2199,-790.7906 5313.1486,-787.0932 5303.0813,-783.7919 5303.2199,-790.7906"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="1417.5,-661.6024 1023.5,-661.6024 1023.5,-605.7995 1417.5,-605.7995 1417.5,-661.6024"/>
<text text-anchor="middle" x="1220.5" y="-614.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- prose_3&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1604.6497,-773.7689C1599.3902,-771.5267 1593.8197,-769.3414 1588.5,-767.6011 1518.3997,-744.6675 1496.2489,-755.5821 1426.5,-731.6011 1375.3251,-714.0062 1320.0812,-687.2966 1279.6971,-666.2184"/>
<polygon fill="#000000" stroke="#000000" points="1281.2774,-663.0951 1270.7974,-661.539 1278.0196,-669.2908 1281.2774,-663.0951"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="1689.5,-731.5013 1435.5,-731.5013 1435.5,-535.9006 1689.5,-535.9006 1689.5,-731.5013"/>
<text text-anchor="middle" x="1562.5" y="-716.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1562.5" y="-685.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="1562.5" y="-669.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1562.5" y="-654.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1562.5" y="-622.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1562.5" y="-591.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local Link = require &quot;grym/link&quot;</text>
<text text-anchor="middle" x="1562.5" y="-544.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_4&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1730.7046,-768.1762C1720.5063,-760.0229 1707.4523,-749.5866 1693.1354,-738.1406"/>
<polygon fill="#000000" stroke="#000000" points="1695.0581,-735.1967 1685.0618,-731.6859 1690.6869,-740.6642 1695.0581,-735.1967"/>
</g>
<!-- header_9 -->
<g id="node10" class="node">
<title>header_9</title>
<ellipse fill="none" stroke="#000000" cx="1796.5" cy="-633.701" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1796.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_5&#45;&gt;header_9 -->
<g id="edge9" class="edge">
<title>section_5&#45;&gt;header_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2076.4083,-781.4579C2024.6251,-775.8502 1951.2761,-762.6539 1894.5,-731.6011 1862.1331,-713.8985 1833.3672,-682.2583 1815.5088,-659.7406"/>
<polygon fill="#000000" stroke="#000000" points="1818.1016,-657.3721 1809.2137,-651.6052 1812.5654,-661.6559 1818.1016,-657.3721"/>
</g>
<!-- prose_10 -->
<g id="node11" class="node">
<title>prose_10</title>
<ellipse fill="none" stroke="#000000" cx="1935.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1935.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;prose_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2080.4258,-778.2977C2046.3165,-771.3566 2004.8952,-757.8499 1976.5,-731.6011 1956.6156,-713.2197 1946.0497,-683.6817 1940.6563,-661.8526"/>
<polygon fill="#000000" stroke="#000000" points="1944.0133,-660.8278 1938.4059,-651.8385 1937.1837,-662.3626 1944.0133,-660.8278"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="2017.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2017.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2107.5331,-769.8597C2091.0233,-760.6206 2071.7777,-747.6063 2058.5,-731.6011 2041.4906,-711.0975 2030.6167,-682.5287 2024.3733,-661.5435"/>
<polygon fill="#000000" stroke="#000000" points="2027.6648,-660.318 2021.5981,-651.6321 2020.9241,-662.2054 2027.6648,-660.318"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="2099.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2099.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2135.6358,-767.5796C2128.5464,-741.3142 2115.3147,-692.2924 2106.9806,-661.4155"/>
<polygon fill="#000000" stroke="#000000" points="2110.3429,-660.4414 2104.3579,-651.6989 2103.5848,-662.2655 2110.3429,-660.4414"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="2181.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2181.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2145.3642,-767.5796C2152.4536,-741.3142 2165.6853,-692.2924 2174.0194,-661.4155"/>
<polygon fill="#000000" stroke="#000000" points="2177.4152,-662.2655 2176.6421,-651.6989 2170.6571,-660.4414 2177.4152,-662.2655"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="2263.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2263.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2173.4669,-769.8597C2189.9767,-760.6206 2209.2223,-747.6063 2222.5,-731.6011 2239.5094,-711.0975 2250.3833,-682.5287 2256.6267,-661.5435"/>
<polygon fill="#000000" stroke="#000000" points="2260.0759,-662.2054 2259.4019,-651.6321 2253.3352,-660.318 2260.0759,-662.2054"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="2589.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2589.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2183.0246,-771.7641C2216.1607,-760.9422 2263.3031,-745.4586 2304.5,-731.6011 2393.6615,-701.6095 2498.1731,-665.4513 2552.4853,-646.5849"/>
<polygon fill="#000000" stroke="#000000" points="2553.7305,-649.8576 2562.0274,-643.2688 2551.4326,-643.2455 2553.7305,-649.8576"/>
</g>
<!-- section_16 -->
<g id="node17" class="node">
<title>section_16</title>
<ellipse fill="none" stroke="#000000" cx="3373.5" cy="-633.701" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3373.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 46&#45;85</text>
</g>
<!-- section_5&#45;&gt;section_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;section_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2202.0445,-779.2427C2294.9421,-769.5491 2476.5008,-750.2303 2630.5,-731.6011 2878.8772,-701.5549 3173.3328,-661.4099 3304.5058,-643.2899"/>
<polygon fill="#000000" stroke="#000000" points="3305.3729,-646.7034 3314.7994,-641.8669 3304.4143,-639.7694 3305.3729,-646.7034"/>
</g>
<!-- section_17 -->
<g id="node18" class="node">
<title>section_17</title>
<ellipse fill="none" stroke="#000000" cx="4940.5" cy="-633.701" rx="70.655" ry="18"/>
<text text-anchor="middle" x="4940.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 86&#45;108</text>
</g>
<!-- section_5&#45;&gt;section_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;section_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2205.8544,-783.4642C2397.0518,-777.0919 2971.8989,-757.0719 3448.5,-731.6011 3989.768,-702.6743 4640.6925,-655.8026 4862.2756,-639.5055"/>
<polygon fill="#000000" stroke="#000000" points="4862.7845,-642.9776 4872.5005,-638.7527 4862.2705,-635.9965 4862.7845,-642.9776"/>
</g>
<!-- header_44 -->
<g id="node45" class="node">
<title>header_44</title>
<ellipse fill="none" stroke="#000000" cx="5270.5" cy="-633.701" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="5270.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Constructor</text>
</g>
<!-- section_6&#45;&gt;header_44 -->
<g id="edge44" class="edge">
<title>section_6&#45;&gt;header_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5374.733,-767.8789C5354.0607,-741.2678 5314.8733,-690.8222 5290.8812,-659.9374"/>
<polygon fill="#000000" stroke="#000000" points="5293.4439,-657.5311 5284.5451,-651.7811 5287.9159,-661.8254 5293.4439,-657.5311"/>
</g>
<!-- prose_45 -->
<g id="node46" class="node">
<title>prose_45</title>
<ellipse fill="none" stroke="#000000" cx="5388.5" cy="-633.701" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5388.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_45 -->
<g id="edge45" class="edge">
<title>section_6&#45;&gt;prose_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5388.5,-767.5796C5388.5,-741.569 5388.5,-693.2413 5388.5,-662.3192"/>
<polygon fill="#000000" stroke="#000000" points="5392.0001,-662.1726 5388.5,-652.1727 5385.0001,-662.1727 5392.0001,-662.1726"/>
</g>
<!-- codeblock_46 -->
<g id="node47" class="node">
<title>codeblock_46</title>
<ellipse fill="none" stroke="#000000" cx="5552.5" cy="-633.701" rx="85.9862" ry="18"/>
<text text-anchor="middle" x="5552.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 111&#45;121</text>
</g>
<!-- section_6&#45;&gt;codeblock_46 -->
<g id="edge46" class="edge">
<title>section_6&#45;&gt;codeblock_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5407.6339,-767.8789C5436.8896,-740.7817 5492.8268,-688.9714 5525.9794,-658.2649"/>
<polygon fill="#000000" stroke="#000000" points="5528.5298,-660.6733 5533.488,-651.3102 5523.7731,-655.5377 5528.5298,-660.6733"/>
</g>
<!-- codeblock_47 -->
<g id="node48" class="node">
<title>codeblock_47</title>
<ellipse fill="none" stroke="#000000" cx="5791.5" cy="-633.701" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5791.5" y="-629.501" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 123&#45;125</text>
</g>
<!-- section_6&#45;&gt;codeblock_47 -->
<g id="edge47" class="edge">
<title>section_6&#45;&gt;codeblock_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5458.0501,-778.585C5511.4998,-771.4386 5586.2957,-757.5728 5647.5,-731.6011 5691.13,-713.0869 5735.3293,-680.5308 5763.0363,-658.0761"/>
<polygon fill="#000000" stroke="#000000" points="5765.5843,-660.5124 5771.0867,-651.4585 5761.1391,-655.1049 5765.5843,-660.5124"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-461.801 0,-461.801 0,-391.2004 527,-391.2004 527,-461.801"/>
<text text-anchor="middle" x="263.5" y="-414.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="263.5" y="-399.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- prose_10&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>prose_10&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1933.7183,-615.5773C1930.3895,-592.632 1920.9562,-553.9141 1894.5,-535.8008 1832.226,-493.165 611.1854,-510.6616 536.5,-499.8008 484.8192,-492.2854 428.93,-478.3517 381.2619,-464.6346"/>
<polygon fill="#000000" stroke="#000000" points="382.1106,-461.2364 371.531,-461.8047 380.1559,-467.958 382.1106,-461.2364"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1079.5,-461.7011 545.5,-461.7011 545.5,-391.3003 1079.5,-391.3003 1079.5,-461.7011"/>
<text text-anchor="middle" x="812.5" y="-430.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the [[LPEG manual][httk://]]]]</text>
<text text-anchor="middle" x="812.5" y="-415.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="812.5" y="-399.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- prose_11&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>prose_11&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2015.679,-615.6342C2012.3078,-592.7505 2002.8286,-554.099 1976.5,-535.8008 1895.4123,-479.4457 1186.1381,-514.5627 1088.5,-499.8008 1036.5623,-491.9484 980.3399,-478.0403 932.2758,-464.4341"/>
<polygon fill="#000000" stroke="#000000" points="933.039,-461.0121 922.4621,-461.6283 931.1148,-467.7424 933.039,-461.0121"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1401,-461.7011 1098,-461.7011 1098,-391.3003 1401,-391.3003 1401,-461.7011"/>
<text text-anchor="middle" x="1249.5" y="-430.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1249.5" y="-415.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1249.5" y="-399.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- prose_12&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>prose_12&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2097.6366,-615.6948C2094.2195,-592.8765 2084.6908,-554.2957 2058.5,-535.8008 1999.5952,-494.2048 1480.5207,-517.0376 1410.5,-499.8008 1380.09,-492.3149 1348.3611,-479.1624 1321.189,-466.0454"/>
<polygon fill="#000000" stroke="#000000" points="1322.6758,-462.8763 1312.1573,-461.6067 1319.5882,-469.1586 1322.6758,-462.8763"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1967.5,-461.7011 1419.5,-461.7011 1419.5,-391.3003 1967.5,-391.3003 1967.5,-461.7011"/>
<text text-anchor="middle" x="1693.5" y="-430.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="1693.5" y="-415.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="1693.5" y="-399.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- prose_13&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>prose_13&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2179.0157,-615.5534C2174.9812,-593.3163 2164.84,-556.1007 2140.5,-535.8008 2083.1912,-488.0045 2049.0773,-517.1594 1976.5,-499.8008 1930.2833,-488.747 1880.0173,-475.9738 1834.8462,-464.2174"/>
<polygon fill="#000000" stroke="#000000" points="1835.5484,-460.7836 1824.9888,-461.6471 1833.7821,-467.5571 1835.5484,-460.7836"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2541,-469.1018 1986,-469.1018 1986,-383.8996 2541,-383.8996 2541,-469.1018"/>
<text text-anchor="middle" x="2263.5" y="-438.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2263.5" y="-422.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2263.5" y="-407.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2263.5" y="-391.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- prose_14&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>prose_14&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2263.5,-615.6758C2263.5,-585.6239 2263.5,-524.1724 2263.5,-479.4385"/>
<polygon fill="#000000" stroke="#000000" points="2267.0001,-479.3119 2263.5,-469.312 2260.0001,-479.312 2267.0001,-479.3119"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="3107.5,-453.8011 2559.5,-453.8011 2559.5,-399.2003 3107.5,-399.2003 3107.5,-453.8011"/>
<text text-anchor="middle" x="2833.5" y="-422.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="2833.5" y="-407.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- prose_15&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>prose_15&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2607.4419,-618.465C2646.4637,-585.3284 2739.849,-506.0274 2793.5905,-460.3911"/>
<polygon fill="#000000" stroke="#000000" points="2795.8637,-463.0525 2801.2207,-453.9117 2791.3327,-457.7167 2795.8637,-463.0525"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="3192.5" cy="-426.5007" rx="67.2722" ry="18"/>
<text text-anchor="middle" x="3192.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lpeg locals</text>
</g>
<!-- section_16&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_16&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3358.068,-616.0352C3325.9425,-579.2594 3251.7858,-494.3683 3214.6007,-451.8005"/>
<polygon fill="#000000" stroke="#000000" points="3217.1077,-449.3503 3207.8929,-444.1218 3211.8359,-453.9556 3217.1077,-449.3503"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="3309.5" cy="-426.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3309.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_16&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3367.9324,-615.6758C3356.7224,-579.3834 3331.3674,-497.2964 3318.0446,-454.1638"/>
<polygon fill="#000000" stroke="#000000" points="3321.3046,-452.8583 3315.0092,-444.3367 3314.6164,-454.9242 3321.3046,-452.8583"/>
</g>
<!-- codeblock_26 -->
<g id="node27" class="node">
<title>codeblock_26</title>
<ellipse fill="none" stroke="#000000" cx="3437.5" cy="-426.5007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3437.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 48&#45;54</text>
</g>
<!-- section_16&#45;&gt;codeblock_26 -->
<g id="edge26" class="edge">
<title>section_16&#45;&gt;codeblock_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3379.0676,-615.6758C3390.2732,-579.3978 3415.6125,-497.3616 3428.9395,-454.2153"/>
<polygon fill="#000000" stroke="#000000" points="3432.2925,-455.2193 3431.8997,-444.6318 3425.6043,-453.1534 3432.2925,-455.2193"/>
</g>
<!-- codeblock_27 -->
<g id="node28" class="node">
<title>codeblock_27</title>
<ellipse fill="none" stroke="#000000" cx="3610.5" cy="-426.5007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3610.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 56&#45;77</text>
</g>
<!-- section_16&#45;&gt;codeblock_27 -->
<g id="edge27" class="edge">
<title>section_16&#45;&gt;codeblock_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3393.2988,-616.3916C3435.5579,-579.446 3534.6642,-492.8011 3583.0075,-450.5363"/>
<polygon fill="#000000" stroke="#000000" points="3585.366,-453.1235 3590.5908,-443.9065 3580.7586,-447.8535 3585.366,-453.1235"/>
</g>
<!-- codeblock_28 -->
<g id="node29" class="node">
<title>codeblock_28</title>
<ellipse fill="none" stroke="#000000" cx="3895.5" cy="-426.5007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3895.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 79&#45;83</text>
</g>
<!-- section_16&#45;&gt;codeblock_28 -->
<g id="edge28" class="edge">
<title>section_16&#45;&gt;codeblock_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3411.041,-618.7996C3503.6647,-582.034 3743.0583,-487.0102 3846.5925,-445.9138"/>
<polygon fill="#000000" stroke="#000000" points="3848.175,-449.0514 3856.1783,-442.1089 3845.5924,-442.5452 3848.175,-449.0514"/>
</g>
<!-- header_33 -->
<g id="node34" class="node">
<title>header_33</title>
<ellipse fill="none" stroke="#000000" cx="4739.5" cy="-426.5007" rx="69.1756" ry="18"/>
<text text-anchor="middle" x="4739.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Link or Raw</text>
</g>
<!-- section_17&#45;&gt;header_33 -->
<g id="edge33" class="edge">
<title>section_17&#45;&gt;header_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4923.3629,-616.0352C4887.6134,-579.1829 4804.9941,-494.0151 4763.7857,-451.5356"/>
<polygon fill="#000000" stroke="#000000" points="4766.0688,-448.8624 4756.5938,-444.1218 4761.0445,-453.7364 4766.0688,-448.8624"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="4858.5" cy="-426.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4858.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_17&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4933.3665,-615.6758C4918.9733,-579.3066 4886.3801,-496.9491 4869.3397,-453.8908"/>
<polygon fill="#000000" stroke="#000000" points="4872.4929,-452.3471 4865.5586,-444.3367 4865.9841,-454.923 4872.4929,-452.3471"/>
</g>
<!-- prose_35 -->
<g id="node36" class="node">
<title>prose_35</title>
<ellipse fill="none" stroke="#000000" cx="4940.5" cy="-426.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4940.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_35 -->
<g id="edge35" class="edge">
<title>section_17&#45;&gt;prose_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4940.5,-615.6758C4940.5,-579.5509 4940.5,-498.0531 4940.5,-454.7635"/>
<polygon fill="#000000" stroke="#000000" points="4944.0001,-454.6317 4940.5,-444.6318 4937.0001,-454.6318 4944.0001,-454.6317"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="5022.5" cy="-426.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5022.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>section_17&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4947.6335,-615.6758C4962.0267,-579.3066 4994.6199,-496.9491 5011.6603,-453.8908"/>
<polygon fill="#000000" stroke="#000000" points="5015.0159,-454.923 5015.4414,-444.3367 5008.5071,-452.3471 5015.0159,-454.923"/>
</g>
<!-- prose_37 -->
<g id="node38" class="node">
<title>prose_37</title>
<ellipse fill="none" stroke="#000000" cx="5104.5" cy="-426.5007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5104.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_37 -->
<g id="edge37" class="edge">
<title>section_17&#45;&gt;prose_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4959.052,-616.2476C4984.483,-591.7453 5030.7422,-545.0618 5063.5,-499.8008 5074.0581,-485.213 5083.9712,-467.6409 5091.4045,-453.359"/>
<polygon fill="#000000" stroke="#000000" points="5094.7135,-454.5737 5096.1319,-444.0742 5088.4755,-451.3976 5094.7135,-454.5737"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="5242.5" cy="-426.5007" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5242.5" y="-422.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 101&#45;106</text>
</g>
<!-- section_17&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>section_17&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4967.4257,-616.9416C5006.9873,-592.1321 5082.9084,-543.8144 5145.5,-499.8008 5168.2112,-483.8306 5193.192,-464.9205 5212.1143,-450.3076"/>
<polygon fill="#000000" stroke="#000000" points="5214.33,-453.0186 5220.0898,-444.1261 5210.0417,-447.4858 5214.33,-453.0186"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3111.5,-176.6003 3057.5,-176.6003 3057.5,-140.6003 3111.5,-140.6003 3111.5,-176.6003"/>
</g>
<!-- prose_25&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>prose_25&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3304.1399,-408.6267C3298.1627,-391.7927 3286.8444,-367.1377 3268.5,-353.2006 3214.5966,-312.2477 3167.998,-365.436 3120.5,-317.2006 3086.2085,-282.3767 3081.8309,-222.1368 3082.592,-186.7715"/>
<polygon fill="#000000" stroke="#000000" points="3086.0943,-186.7727 3082.9658,-176.6503 3079.0991,-186.5143 3086.0943,-186.7727"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3265,-201.1004 3130,-201.1004 3130,-116.1001 3265,-116.1001 3265,-201.1004"/>
<text text-anchor="middle" x="3197.5" y="-185.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cg = L.Cg</text>
<text text-anchor="middle" x="3197.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = L.C</text>
<text text-anchor="middle" x="3197.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = L.P</text>
<text text-anchor="middle" x="3197.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cmt = L.Cmt</text>
<text text-anchor="middle" x="3197.5" y="-124.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cb = L.Cb</text>
</g>
<!-- codeblock_26&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_26&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3419.6045,-408.974C3402.7467,-393.0814 3376.2941,-369.6879 3350.5,-353.2006 3318.6692,-332.8546 3300.3398,-343.786 3273.5,-317.2006 3243.9833,-287.9636 3224.373,-245.0003 3212.4771,-211.162"/>
<polygon fill="#000000" stroke="#000000" points="3215.7032,-209.7767 3209.1777,-201.4299 3209.0738,-212.0243 3215.7032,-209.7767"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="3824,-317.3009 3283,-317.3009 3283,.1003 3824,.1003 3824,-317.3009"/>
<text text-anchor="middle" x="3553.5" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3553.5" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3553.5" y="-271.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3553.5" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3553.5" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3553.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3553.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3553.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3553.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3553.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3553.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3553.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3553.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3553.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3553.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3553.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3553.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3553.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>codeblock_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3606.6716,-408.507C3602.8094,-390.3549 3596.4256,-360.3511 3589.3971,-327.3167"/>
<polygon fill="#000000" stroke="#000000" points="3592.8031,-326.5065 3587.2986,-317.4539 3585.9564,-327.9633 3592.8031,-326.5065"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="4061,-185.8007 3842,-185.8007 3842,-131.3998 4061,-131.3998 4061,-185.8007"/>
<text text-anchor="middle" x="3951.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="3951.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return prose.val</text>
<text text-anchor="middle" x="3951.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>codeblock_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3899.2613,-408.507C3908.3299,-365.1233 3931.5495,-254.0422 3943.748,-195.6853"/>
<polygon fill="#000000" stroke="#000000" points="3947.2004,-196.2747 3945.8206,-185.7701 3940.3485,-194.8423 3947.2004,-196.2747"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="4634,-193.9006 4079,-193.9006 4079,-123.2999 4634,-123.2999 4634,-193.9006"/>
<text text-anchor="middle" x="4356.5" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The prose parser will be a proper recursive grammar. &#160;This calls for some</text>
<text text-anchor="middle" x="4356.5" y="-131.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">enhancements to epnf to allow assignment of Node metatables to matched spans.</text>
</g>
<!-- prose_34&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>prose_34&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4853.2447,-408.4863C4847.3451,-391.5482 4836.0827,-366.8183 4817.5,-353.2006 4753.8016,-306.5213 4717.5626,-344.6082 4643.5,-317.2006 4561.1047,-286.7093 4473.7509,-235.3426 4417.3611,-199.3507"/>
<polygon fill="#000000" stroke="#000000" points="4419.2321,-196.3927 4408.9264,-193.9342 4415.4496,-202.2828 4419.2321,-196.3927"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="5228.5,-185.9007 4652.5,-185.9007 4652.5,-131.2999 5228.5,-131.2999 5228.5,-185.9007"/>
<text text-anchor="middle" x="4940.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ve been sloppy with the node constructor interface and will need to go through</text>
<text text-anchor="middle" x="4940.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">the whole =grym= directory and fix it into a consistent state. &#160;At some point.</text>
</g>
<!-- prose_35&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>prose_35&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4940.5,-408.0868C4940.5,-364.5729 4940.5,-254.6774 4940.5,-196.3375"/>
<polygon fill="#000000" stroke="#000000" points="4944.0001,-196.0718 4940.5,-186.0718 4937.0001,-196.0718 4944.0001,-196.0718"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="5816,-201.2013 5247,-201.2013 5247,-115.9992 5816,-115.9992 5816,-201.2013"/>
<text text-anchor="middle" x="5531.5" y="-170.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">Links give me a chance to design that interface to fit grammatically. For now,</text>
<text text-anchor="middle" x="5531.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">we&#39;re going to handroll another Link class, and write a simple either&#45;or parser</text>
<text text-anchor="middle" x="5531.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">over prose strings that finds links and puts the rest in a =raw= class, which</text>
<text text-anchor="middle" x="5531.5" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">shouldn&#39;t need an intermediate Node class. </text>
</g>
<!-- prose_36&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>prose_36&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5027.7553,-408.4863C5033.6549,-391.5482 5044.9173,-366.8183 5063.5,-353.2006 5127.1984,-306.5213 5163.2995,-344.2325 5237.5,-317.2006 5316.0236,-288.5937 5399.3012,-241.9388 5457.1,-206.6187"/>
<polygon fill="#000000" stroke="#000000" points="5459.1098,-209.4917 5465.7958,-201.2729 5455.4438,-203.5285 5459.1098,-209.4917"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="6333,-178.5024 5834,-178.5024 5834,-138.6982 6333,-138.6982 6333,-178.5024"/>
<text text-anchor="middle" x="6083.5" y="-147.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">This Link class needs to fit the constructor semantics of =epeg.Csp=.</text>
</g>
<!-- prose_37&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>prose_37&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5109.358,-408.4972C5115.1051,-391.0586 5126.5152,-365.5008 5146.5,-353.2006 5275.1809,-274.0003 5681.2408,-362.1533 5825.5,-317.2006 5915.9466,-289.0164 6006.8831,-221.9383 6052.8142,-184.678"/>
<polygon fill="#000000" stroke="#000000" points="6055.0756,-187.35 6060.591,-178.3039 6050.6382,-181.9362 6055.0756,-187.35"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="6535.5,-193.8007 6351.5,-193.8007 6351.5,-123.3999 6535.5,-123.3999 6535.5,-193.8007"/>
<text text-anchor="middle" x="6443.5" y="-178.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.parse(prose)</text>
<text text-anchor="middle" x="6443.5" y="-147.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return prose</text>
<text text-anchor="middle" x="6443.5" y="-131.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_38&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5258.8892,-408.7437C5276.5708,-390.9668 5306.5193,-364.6566 5338.5,-353.2006 5443.5882,-315.5561 6245.6162,-372.6457 6342.5,-317.2006 6385.5438,-292.5673 6413.0694,-241.3146 6428.3361,-203.7127"/>
<polygon fill="#000000" stroke="#000000" points="6431.7565,-204.5759 6432.1375,-193.9879 6425.2369,-202.0274 6431.7565,-204.5759"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="5401.5,-444.5007 5347.5,-444.5007 5347.5,-408.5007 5401.5,-408.5007 5401.5,-444.5007"/>
</g>
<!-- prose_45&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>prose_45&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5387.2821,-615.6758C5384.8412,-579.5509 5379.3346,-498.0531 5376.4096,-454.7635"/>
<polygon fill="#000000" stroke="#000000" points="5379.8913,-454.373 5375.7251,-444.6318 5372.9073,-454.845 5379.8913,-454.373"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="5715.5,-499.6015 5419.5,-499.6015 5419.5,-353.3999 5715.5,-353.3999 5715.5,-499.6015"/>
<text text-anchor="middle" x="5567.5" y="-484.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="5567.5" y="-469.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = setmetatable({},Pr)</text>
<text text-anchor="middle" x="5567.5" y="-453.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.id = &quot;prose&quot;</text>
<text text-anchor="middle" x="5567.5" y="-438.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.val = &quot;\n&quot;</text>
<text text-anchor="middle" x="5567.5" y="-423.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="5567.5" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose.val = prose.val .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="5567.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5567.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="5567.5" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_46&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>codeblock_46&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5553.8049,-615.6758C5555.5126,-592.0862 5558.621,-549.1492 5561.4452,-510.1376"/>
<polygon fill="#000000" stroke="#000000" points="5564.9631,-510.0164 5562.1943,-499.7898 5557.9813,-509.5109 5564.9631,-510.0164"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="5917.5,-444.5007 5733.5,-444.5007 5733.5,-408.5007 5917.5,-408.5007 5917.5,-444.5007"/>
<text text-anchor="middle" x="5825.5" y="-423.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_47&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>codeblock_47&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5794.4578,-615.6758C5800.3856,-579.5509 5813.7588,-498.0531 5820.8623,-454.7635"/>
<polygon fill="#000000" stroke="#000000" points="5824.3593,-455.0666 5822.5248,-444.6318 5817.4517,-453.933 5824.3593,-455.0666"/>
</g>
</g>
</svg>