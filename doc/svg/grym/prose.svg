<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="5659pt" height="1142pt"
 viewBox="0.00 0.00 5659.00 1142.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1138.2013)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1138.2013 5655,-1138.2013 5655,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1375" cy="-1116.2013" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1375" y="-1112.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 150</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1375" cy="-1044.2013" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1375" y="-1040.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;120</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1375,-1098.0327C1375,-1090.3323 1375,-1081.1757 1375,-1072.618"/>
<polygon fill="#000000" stroke="#000000" points="1378.5001,-1072.6146 1375,-1062.6146 1371.5001,-1072.6146 1378.5001,-1072.6146"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="742" cy="-972.2013" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="742" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1314.3053,-1037.2977C1199.3655,-1024.224 949.988,-995.8587 821.7277,-981.2699"/>
<polygon fill="#000000" stroke="#000000" points="821.9104,-977.7682 811.5789,-980.1155 821.1192,-984.7233 821.9104,-977.7682"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="1043" cy="-972.2013" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="1043" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;4</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1323.4893,-1033.0303C1260.7749,-1019.4296 1155.5529,-996.6104 1093.3626,-983.1234"/>
<polygon fill="#000000" stroke="#000000" points="1093.9057,-979.6598 1083.3911,-980.9609 1092.4221,-986.5008 1093.9057,-979.6598"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="1260" cy="-972.2013" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1260" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1348.6167,-1027.6831C1332.9183,-1017.8545 1312.7917,-1005.2535 1295.688,-994.5451"/>
<polygon fill="#000000" stroke="#000000" points="1297.3921,-991.4827 1287.0589,-989.1426 1293.6774,-997.4158 1297.3921,-991.4827"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1444" cy="-972.2013" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1444" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 26&#45;28</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1391.703,-1026.7722C1400.1373,-1017.9712 1410.5257,-1007.131 1419.8153,-997.4375"/>
<polygon fill="#000000" stroke="#000000" points="1422.5794,-999.6118 1426.9715,-989.9702 1417.5254,-994.7685 1422.5794,-999.6118"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2206" cy="-972.2013" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2206" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 30&#45;94</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1437.8007,-1038.7601C1588.8482,-1025.673 1971.8424,-992.4894 2132.8866,-978.5361"/>
<polygon fill="#000000" stroke="#000000" points="2133.508,-981.9954 2143.1685,-977.6452 2132.9037,-975.0216 2133.508,-981.9954"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="4990" cy="-972.2013" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4990" y="-968.0013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 121&#45;150</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1440.831,-1042.8902C1881.9444,-1034.1045 4405.6347,-983.8402 4904.3821,-973.9066"/>
<polygon fill="#000000" stroke="#000000" points="4904.8125,-977.3988 4914.7408,-973.7003 4904.673,-970.4002 4904.8125,-977.3988"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="674,-792.1011 620,-792.1011 620,-756.1011 674,-756.1011 674,-792.1011"/>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M717.2557,-955.0314C705.2492,-945.4894 691.5982,-932.6362 683,-918.2013 661.375,-881.8966 652.684,-833.0232 649.2293,-802.5492"/>
<polygon fill="#000000" stroke="#000000" points="652.672,-801.8068 648.1792,-792.2118 645.7079,-802.5143 652.672,-801.8068"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="1086,-794.0032 692,-794.0032 692,-754.1991 1086,-754.1991 1086,-794.0032"/>
<text text-anchor="middle" x="889" y="-762.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- block_3&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_3&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1029.6029,-954.9678C1002.9713,-920.7099 943.162,-843.7732 910.7953,-802.1378"/>
<polygon fill="#000000" stroke="#000000" points="913.4171,-799.8077 904.5163,-794.0607 907.8905,-804.1039 913.4171,-799.8077"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1386,-918.3016 1104,-918.3016 1104,-629.9007 1386,-629.9007 1386,-918.3016"/>
<text text-anchor="middle" x="1245" y="-903.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1245" y="-871.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="1245" y="-856.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require (&quot;status&quot;)()</text>
<text text-anchor="middle" x="1245" y="-840.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1245" y="-825.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1245" y="-810.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp</text>
<text text-anchor="middle" x="1245" y="-794.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;node/node&quot;</text>
<text text-anchor="middle" x="1245" y="-763.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1245" y="-731.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local Link = require &quot;grym/link&quot;</text>
<text text-anchor="middle" x="1245" y="-716.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(type(Link) == &#39;function&#39;)</text>
<text text-anchor="middle" x="1245" y="-701.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local Grammar = require &quot;node/grammar&quot;</text>
<text text-anchor="middle" x="1245" y="-653.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
<text text-anchor="middle" x="1245" y="-638.201" font-family="Inconsolata" font-size="14.00" fill="#000000">Pr.id = &quot;prose&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>codeblock_4&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1258.6157,-953.9196C1258.0826,-946.8795 1257.422,-938.155 1256.6815,-928.3747"/>
<polygon fill="#000000" stroke="#000000" points="1260.1612,-927.973 1255.916,-918.2659 1253.1812,-928.5016 1260.1612,-927.973"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1546,-792.1011 1404,-792.1011 1404,-756.1011 1546,-756.1011 1546,-792.1011"/>
<text text-anchor="middle" x="1475" y="-770.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = false &#160;</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_5&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1446.8608,-953.9196C1452.2936,-919.2028 1464.136,-843.5254 1470.5907,-802.2779"/>
<polygon fill="#000000" stroke="#000000" points="1474.0579,-802.7596 1472.1461,-792.3387 1467.142,-801.6773 1474.0579,-802.7596"/>
</g>
<!-- header_12 -->
<g id="node13" class="node">
<title>header_12</title>
<ellipse fill="none" stroke="#000000" cx="1653" cy="-774.1011" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1653" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_6&#45;&gt;header_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;header_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2140.2727,-971.012C2030.3362,-967.9463 1814.909,-957.0199 1751,-918.2013 1706.5924,-891.228 1677.6632,-835.5957 1663.4297,-801.8941"/>
<polygon fill="#000000" stroke="#000000" points="1666.4942,-800.1386 1659.4834,-792.1951 1660.0103,-802.7768 1666.4942,-800.1386"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1816" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1816" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 30&#45;34</text>
</g>
<!-- section_6&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2141.6016,-968.6203C2058.758,-962.8294 1920.7775,-948.8091 1881,-918.2013 1844.1018,-889.8091 1827.5628,-835.7688 1820.6033,-802.5398"/>
<polygon fill="#000000" stroke="#000000" points="1824.0045,-801.6932 1818.6666,-792.5413 1817.1322,-803.0244 1824.0045,-801.6932"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="1946" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1946" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 35&#45;38</text>
</g>
<!-- section_6&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2150.9379,-962.3656C2100.9735,-952.4947 2032.0042,-936.204 2011,-918.2013 1975.6502,-887.903 1958.6075,-834.4828 1951.1319,-801.889"/>
<polygon fill="#000000" stroke="#000000" points="1954.5503,-801.1371 1949.0298,-792.0942 1947.7061,-802.606 1954.5503,-801.1371"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="2076" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2076" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 39&#45;42</text>
</g>
<!-- section_6&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2180.7659,-955.4815C2167.6137,-945.7981 2152.0191,-932.6764 2141,-918.2013 2113.5191,-882.1015 2094.4252,-832.5356 2084.3458,-801.9486"/>
<polygon fill="#000000" stroke="#000000" points="2087.6556,-800.8074 2081.2741,-792.35 2080.9886,-802.941 2087.6556,-800.8074"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="2206" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2206" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 43&#45;46</text>
</g>
<!-- section_6&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2206,-953.9196C2206,-919.2765 2206,-843.8465 2206,-802.5411"/>
<polygon fill="#000000" stroke="#000000" points="2209.5001,-802.3386 2206,-792.3387 2202.5001,-802.3387 2209.5001,-802.3386"/>
</g>
<!-- block_17 -->
<g id="node18" class="node">
<title>block_17</title>
<ellipse fill="none" stroke="#000000" cx="2336" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2336" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 47&#45;51</text>
</g>
<!-- section_6&#45;&gt;block_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;block_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2231.2341,-955.4815C2244.3863,-945.7981 2259.9809,-932.6764 2271,-918.2013 2298.4809,-882.1015 2317.5748,-832.5356 2327.6542,-801.9486"/>
<polygon fill="#000000" stroke="#000000" points="2331.0114,-802.941 2330.7259,-792.35 2324.3444,-800.8074 2331.0114,-802.941"/>
</g>
<!-- block_18 -->
<g id="node19" class="node">
<title>block_18</title>
<ellipse fill="none" stroke="#000000" cx="2686" cy="-774.1011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2686" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 52&#45;55</text>
</g>
<!-- section_6&#45;&gt;block_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;block_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.3972,-960.9143C2297.2453,-951.463 2353.4952,-936.5798 2401,-918.2013 2494.1192,-882.1758 2597.258,-825.5284 2650.2412,-795.0985"/>
<polygon fill="#000000" stroke="#000000" points="2652.0093,-798.1192 2658.9214,-790.0896 2648.5106,-792.0562 2652.0093,-798.1192"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="3263" cy="-774.1011" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3263" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 56&#45;78</text>
</g>
<!-- section_6&#45;&gt;codeblock_19 -->
<g id="edge19" class="edge">
<title>section_6&#45;&gt;codeblock_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2271.123,-969.4477C2373.8716,-964.2756 2579.553,-950.5618 2751,-918.2013 2921.7225,-885.9776 3118.0533,-823.2851 3210.1379,-792.3145"/>
<polygon fill="#000000" stroke="#000000" points="3211.4273,-795.5733 3219.7823,-789.0584 3209.1881,-788.9411 3211.4273,-795.5733"/>
</g>
<!-- codeblock_20 -->
<g id="node21" class="node">
<title>codeblock_20</title>
<ellipse fill="none" stroke="#000000" cx="3678" cy="-774.1011" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3678" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 80&#45;92</text>
</g>
<!-- section_6&#45;&gt;codeblock_20 -->
<g id="edge20" class="edge">
<title>section_6&#45;&gt;codeblock_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2271.3677,-970.5027C2498.3427,-964.413 3244.2474,-942.7304 3349,-918.2013 3460.228,-892.156 3580.7474,-829.5921 3640.2984,-796.1147"/>
<polygon fill="#000000" stroke="#000000" points="3642.347,-798.9768 3649.3217,-791.0016 3638.8959,-792.8866 3642.347,-798.9768"/>
</g>
<!-- section_21 -->
<g id="node22" class="node">
<title>section_21</title>
<ellipse fill="none" stroke="#000000" cx="4338" cy="-774.1011" rx="70.655" ry="18"/>
<text text-anchor="middle" x="4338" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 95&#45;120</text>
</g>
<!-- section_6&#45;&gt;section_21 -->
<g id="edge21" class="edge">
<title>section_6&#45;&gt;section_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2271.8368,-971.7714C2529.4014,-969.8025 3469.0446,-959.8585 3764,-918.2013 3959.4368,-890.5994 4184.7827,-823.2792 4285.0988,-791.3929"/>
<polygon fill="#000000" stroke="#000000" points="4286.2368,-794.7037 4294.6986,-788.3281 4284.1078,-788.0353 4286.2368,-794.7037"/>
</g>
<!-- header_39 -->
<g id="node40" class="node">
<title>header_39</title>
<ellipse fill="none" stroke="#000000" cx="4808" cy="-774.1011" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="4808" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Constructor</text>
</g>
<!-- section_7&#45;&gt;header_39 -->
<g id="edge39" class="edge">
<title>section_7&#45;&gt;header_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4962.404,-955.3108C4947.5016,-945.483 4929.2854,-932.2785 4915,-918.2013 4877.9903,-881.7312 4843.7965,-831.6333 4824.4527,-801.1344"/>
<polygon fill="#000000" stroke="#000000" points="4827.215,-798.951 4818.9396,-792.3353 4821.2832,-802.6677 4827.215,-798.951"/>
</g>
<!-- block_40 -->
<g id="node41" class="node">
<title>block_40</title>
<ellipse fill="none" stroke="#000000" cx="4990" cy="-774.1011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="4990" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 121&#45;124</text>
</g>
<!-- section_7&#45;&gt;block_40 -->
<g id="edge40" class="edge">
<title>section_7&#45;&gt;block_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4990,-953.9196C4990,-919.2765 4990,-843.8465 4990,-802.5411"/>
<polygon fill="#000000" stroke="#000000" points="4993.5001,-802.3386 4990,-792.3387 4986.5001,-802.3387 4993.5001,-802.3386"/>
</g>
<!-- codeblock_41 -->
<g id="node42" class="node">
<title>codeblock_41</title>
<ellipse fill="none" stroke="#000000" cx="5236" cy="-774.1011" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5236" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 125&#45;134</text>
</g>
<!-- section_7&#45;&gt;codeblock_41 -->
<g id="edge41" class="edge">
<title>section_7&#45;&gt;codeblock_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5014.6658,-955.1535C5029.466,-944.7497 5048.5495,-931.0249 5065,-918.2013 5117.0159,-877.6538 5175.2983,-827.4646 5208.6246,-798.2856"/>
<polygon fill="#000000" stroke="#000000" points="5210.9345,-800.9152 5216.1426,-791.6888 5206.3175,-795.6537 5210.9345,-800.9152"/>
</g>
<!-- codeblock_42 -->
<g id="node43" class="node">
<title>codeblock_42</title>
<ellipse fill="none" stroke="#000000" cx="5494" cy="-774.1011" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5494" y="-769.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 136&#45;138</text>
</g>
<!-- section_7&#45;&gt;codeblock_42 -->
<g id="edge42" class="edge">
<title>section_7&#45;&gt;codeblock_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5060.8333,-965.7516C5146.5458,-957.1316 5285.2004,-940.3364 5332,-918.2013 5391.2875,-890.1599 5444.9142,-833.5384 5473.1224,-800.2297"/>
<polygon fill="#000000" stroke="#000000" points="5476.0214,-802.2181 5479.7344,-792.2952 5470.6437,-797.7369 5476.0214,-802.2181"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="54,-445.7006 0,-445.7006 0,-409.7006 54,-409.7006 54,-445.7006"/>
</g>
<!-- header_12&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>header_12&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1646.9762,-756.0434C1635.1659,-723.9055 1605.6114,-657.5742 1555,-630.0009 1482.1911,-590.3345 126.9006,-646.8336 63,-594.0009 22.801,-560.7647 20.9287,-494.2632 23.6367,-456.1958"/>
<polygon fill="#000000" stroke="#000000" points="27.16,-456.0789 24.5401,-445.8131 20.1864,-455.4721 27.16,-456.0789"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="599.5,-455.0011 72.5,-455.0011 72.5,-400.4002 599.5,-400.4002 599.5,-455.0011"/>
<text text-anchor="middle" x="336" y="-423.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="336" y="-408.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- block_13&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>block_13&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1813.9107,-756.0846C1809.1572,-724.3204 1794.3503,-658.9812 1751,-630.0009 1645.4597,-559.4457 730.6756,-630.2204 609,-594.0009 518.054,-566.9288 426.8117,-501.8353 376.2385,-461.5856"/>
<polygon fill="#000000" stroke="#000000" points="378.1643,-458.6429 368.1775,-455.1053 373.7784,-464.0986 378.1643,-458.6429"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="1152,-454.9011 618,-454.9011 618,-400.5002 1152,-400.5002 1152,-454.9011"/>
<text text-anchor="middle" x="885" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the [[LPEG manual][httk://]]]]</text>
<text text-anchor="middle" x="885" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="885" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- block_14&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>block_14&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1943.8186,-755.9137C1938.9397,-724.1833 1923.9678,-659.3025 1881,-630.0009 1814.8231,-584.8721 1237.6136,-617.3751 1161,-594.0009 1069.3231,-566.0311 976.7322,-501.0099 925.5153,-461.0607"/>
<polygon fill="#000000" stroke="#000000" points="927.6792,-458.3098 917.657,-454.8738 923.3491,-463.8098 927.6792,-458.3098"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1473.5,-454.9011 1170.5,-454.9011 1170.5,-400.5002 1473.5,-400.5002 1473.5,-454.9011"/>
<text text-anchor="middle" x="1322" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1322" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1322" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- block_15&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>block_15&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2073.7645,-755.9922C2068.8008,-724.3849 2053.7006,-659.6905 2011,-630.0009 1914.4408,-562.8636 1589.6614,-643.5435 1483,-594.0009 1421.8825,-565.6128 1371.7506,-503.0565 1344.4376,-463.2779"/>
<polygon fill="#000000" stroke="#000000" points="1347.2901,-461.2478 1338.7985,-454.912 1341.4856,-465.1604 1347.2901,-461.2478"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2040,-454.9011 1492,-454.9011 1492,-400.5002 2040,-400.5002 2040,-454.9011"/>
<text text-anchor="middle" x="1766" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="1766" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="1766" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- block_16&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>block_16&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2202.4865,-756.0447C2195.7357,-725.9504 2178.1992,-665.3582 2141,-630.0009 2109.1745,-599.7513 2088.4959,-613.1836 2049,-594.0009 1964.5789,-552.9986 1871.6552,-495.9266 1816.107,-460.4299"/>
<polygon fill="#000000" stroke="#000000" points="1817.8271,-457.3752 1807.5197,-454.9239 1814.0488,-463.268 1817.8271,-457.3752"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2613.5,-462.3019 2058.5,-462.3019 2058.5,-393.0994 2613.5,-393.0994 2613.5,-462.3019"/>
<text text-anchor="middle" x="2336" y="-447.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2336" y="-431.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2336" y="-416.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2336" y="-401.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- block_17&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>block_17&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2336,-755.9649C2336,-703.3814 2336,-549.7148 2336,-472.7361"/>
<polygon fill="#000000" stroke="#000000" points="2339.5001,-472.4014 2336,-462.4015 2332.5001,-472.4015 2339.5001,-472.4014"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="3180,-455.0011 2632,-455.0011 2632,-400.4002 3180,-400.4002 3180,-455.0011"/>
<text text-anchor="middle" x="2906" y="-439.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="2906" y="-424.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- block_18&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>block_18&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2697.2123,-756.4469C2731.6683,-702.1943 2836.4895,-537.1482 2883.1631,-463.6584"/>
<polygon fill="#000000" stroke="#000000" points="2886.1514,-465.4816 2888.5581,-455.1637 2880.2424,-461.7287 2886.1514,-465.4816"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3739.5,-593.8015 3198.5,-593.8015 3198.5,-261.5998 3739.5,-261.5998 3739.5,-593.8015"/>
<text text-anchor="middle" x="3469" y="-578.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3469" y="-563.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3469" y="-548.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3469" y="-532.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3469" y="-517.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3469" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3469" y="-470.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local Cg, C, P, Cmt, Cb = L.Cg, L.C, L.P, L.Cmt, L.Cb</text>
<text text-anchor="middle" x="3469" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3469" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3469" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3469" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3469" y="-393.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3469" y="-378.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3469" y="-362.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3469" y="-331.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3469" y="-315.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3469" y="-300.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3469" y="-285.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3469" y="-269.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>codeblock_19&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3273.7854,-755.9649C3291.3777,-726.3825 3327.9954,-664.8078 3364.815,-602.8936"/>
<polygon fill="#000000" stroke="#000000" points="3367.9066,-604.5423 3370.0098,-594.1582 3361.8901,-600.9643 3367.9066,-604.5423"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="4082,-516.6014 3758,-516.6014 3758,-338.7998 4082,-338.7998 4082,-516.6014"/>
<text text-anchor="middle" x="3920" y="-501.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="3920" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="3920" y="-470.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _, node in ipairs(prose) do</text>
<text text-anchor="middle" x="3920" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="3920" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="3920" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif node.id == &quot;raw&quot; then</text>
<text text-anchor="middle" x="3920" y="-408.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase &#160;.. node:toValue()</text>
<text text-anchor="middle" x="3920" y="-393.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3920" y="-378.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3920" y="-362.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="3920" y="-347.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_20&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_20&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3690.6702,-755.9649C3720.2876,-713.5703 3795.8075,-605.4707 3852.1452,-524.8285"/>
<polygon fill="#000000" stroke="#000000" points="3855.0213,-526.823 3857.8791,-516.6209 3849.2829,-522.8141 3855.0213,-526.823"/>
</g>
<!-- header_31 -->
<g id="node32" class="node">
<title>header_31</title>
<ellipse fill="none" stroke="#000000" cx="4182" cy="-427.7006" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="4182" y="-423.5006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : prose grammar</text>
</g>
<!-- section_21&#45;&gt;header_31 -->
<g id="edge31" class="edge">
<title>section_21&#45;&gt;header_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4329.8324,-755.9649C4304.1386,-698.9113 4224.854,-522.8586 4194.2385,-454.8764"/>
<polygon fill="#000000" stroke="#000000" points="4197.3844,-453.3382 4190.0867,-445.6574 4191.0018,-456.2126 4197.3844,-453.3382"/>
</g>
<!-- block_32 -->
<g id="node33" class="node">
<title>block_32</title>
<ellipse fill="none" stroke="#000000" cx="4338" cy="-427.7006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="4338" y="-423.5006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 95&#45;99</text>
</g>
<!-- section_21&#45;&gt;block_32 -->
<g id="edge32" class="edge">
<title>section_21&#45;&gt;block_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4338,-755.9649C4338,-699.2773 4338,-525.1122 4338,-456.1978"/>
<polygon fill="#000000" stroke="#000000" points="4341.5001,-456.0753 4338,-446.0753 4334.5001,-456.0753 4341.5001,-456.0753"/>
</g>
<!-- block_33 -->
<g id="node34" class="node">
<title>block_33</title>
<ellipse fill="none" stroke="#000000" cx="4477" cy="-427.7006" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="4477" y="-423.5006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 100&#45;101</text>
</g>
<!-- section_21&#45;&gt;block_33 -->
<g id="edge33" class="edge">
<title>section_21&#45;&gt;block_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4345.2775,-755.9649C4368.1245,-699.0282 4438.5267,-523.5796 4465.927,-455.2956"/>
<polygon fill="#000000" stroke="#000000" points="4469.3186,-456.2415 4469.7945,-445.6574 4462.8221,-453.6346 4469.3186,-456.2415"/>
</g>
<!-- codeblock_34 -->
<g id="node35" class="node">
<title>codeblock_34</title>
<ellipse fill="none" stroke="#000000" cx="4647" cy="-427.7006" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="4647" y="-423.5006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 102&#45;118</text>
</g>
<!-- section_21&#45;&gt;codeblock_34 -->
<g id="edge34" class="edge">
<title>section_21&#45;&gt;codeblock_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4363.5838,-757.1014C4406.462,-727.6922 4493.8419,-663.7379 4552,-594.0009 4588.73,-549.9583 4619.0894,-489.7758 4634.9902,-455.1926"/>
<polygon fill="#000000" stroke="#000000" points="4638.3338,-456.2932 4639.2685,-445.7397 4631.9565,-453.4069 4638.3338,-456.2932"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3837,-130.7002 3783,-130.7002 3783,-94.7002 3837,-94.7002 3837,-130.7002"/>
</g>
<!-- header_31&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>header_31&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4177.7943,-409.5802C4168.6437,-374.5693 4143.4062,-297.8721 4091,-261.4003 4000.6651,-198.5323 3929.9105,-296.6171 3846,-225.4003 3821.5005,-204.6071 3813.5004,-167.1388 3810.9833,-141.1417"/>
<polygon fill="#000000" stroke="#000000" points="3814.4699,-140.831 3810.2263,-131.1231 3807.4898,-141.3584 3814.4699,-140.831"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="4403,-140.0006 3855,-140.0006 3855,-85.3997 4403,-85.3997 4403,-140.0006"/>
<text text-anchor="middle" x="4129" y="-108.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The Prose module is the first one to use our shiny&#45;new Node module. &#160;Which</text>
<text text-anchor="middle" x="4129" y="-93.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">finally works the way I intend it to and I&#39;m pretty happy about this. </text>
</g>
<!-- block_32&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>block_32&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4333.4802,-409.6195C4325.0027,-377.8462 4304.6635,-310.6943 4273,-261.4003 4244.6209,-217.2196 4201.7256,-175.0296 4170.1302,-146.951"/>
<polygon fill="#000000" stroke="#000000" points="4172.1799,-144.093 4162.3566,-140.1238 4167.5606,-149.3525 4172.1799,-144.093"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="4948.5,-130.7002 4421.5,-130.7002 4421.5,-94.7002 4948.5,-94.7002 4948.5,-130.7002"/>
<text text-anchor="middle" x="4685" y="-109.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">It&#39;s pure link&#45;or&#45;raw, but it has everything it needs to be so much more.</text>
</g>
<!-- block_33&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>block_33&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4483.0398,-409.2792C4493.8991,-377.5551 4518.6382,-311.2224 4551,-261.4003 4582.1051,-213.5132 4628.4859,-165.8375 4657.7179,-137.8306"/>
<polygon fill="#000000" stroke="#000000" points="4660.2749,-140.2293 4665.1206,-130.8075 4655.457,-135.1511 4660.2749,-140.2293"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="5353.5,-225.6009 4966.5,-225.6009 4966.5,.2005 5353.5,.2005 5353.5,-225.6009"/>
<text text-anchor="middle" x="5160" y="-210.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function prose_gm(_ENV)</text>
<text text-anchor="middle" x="5160" y="-194.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;START &quot;prose&quot;</text>
<text text-anchor="middle" x="5160" y="-179.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;prose = (V&quot;link&quot; + V&quot;raw&quot;)^1</text>
<text text-anchor="middle" x="5160" y="-164.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;link = m.link</text>
<text text-anchor="middle" x="5160" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;raw = (P(1) &#45; m.link)^1</text>
<text text-anchor="middle" x="5160" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5160" y="-101.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">local function proseBuild(prose, str)</text>
<text text-anchor="middle" x="5160" y="-86.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return setmetatable(prose, {__index = Pr })</text>
<text text-anchor="middle" x="5160" y="-71.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5160" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">local parse = Grammar(prose_gm, { prose = proseBuild,</text>
<text text-anchor="middle" x="5160" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;link &#160;= Link }) &#160;</text>
</g>
<!-- codeblock_34&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>codeblock_34&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4651.8176,-409.6534C4662.1382,-374.7709 4689.8782,-298.2884 4743,-261.4003 4822.2206,-206.3892 4865.9691,-257.2673 4957,-225.4003 4957.0981,-225.366 4957.1962,-225.3316 4957.2943,-225.2972"/>
<polygon fill="#000000" stroke="#000000" points="4958.2381,-228.6784 4966.4382,-221.9694 4955.8442,-222.1004 4958.2381,-228.6784"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="4806,-445.7006 4752,-445.7006 4752,-409.7006 4806,-409.7006 4806,-445.7006"/>
</g>
<!-- header_39&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>header_39&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4806.4817,-755.9649C4801.7359,-699.2773 4787.1551,-525.1122 4781.3857,-456.1978"/>
<polygon fill="#000000" stroke="#000000" points="4784.8604,-455.7484 4780.5383,-446.0753 4777.8848,-456.3325 4784.8604,-455.7484"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="5155.5,-447.6027 4824.5,-447.6027 4824.5,-407.7986 5155.5,-407.7986 5155.5,-447.6027"/>
<text text-anchor="middle" x="4990" y="-416.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; [ ] #todo smuggle in that offset in =parse=</text>
</g>
<!-- block_40&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>block_40&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4990,-755.9649C4990,-699.8059 4990,-528.3498 4990,-458.1528"/>
<polygon fill="#000000" stroke="#000000" points="4993.5001,-457.7891 4990,-447.7892 4986.5001,-457.7892 4993.5001,-457.7891"/>
</g>
<!-- leaf_45 -->
<g id="node46" class="node">
<title>leaf_45</title>
<polygon fill="none" stroke="#c0c0c0" points="5448.5,-493.401 5173.5,-493.401 5173.5,-362.0002 5448.5,-362.0002 5448.5,-493.401"/>
<text text-anchor="middle" x="5311" y="-478.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="5311" y="-462.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;\n&quot;</text>
<text text-anchor="middle" x="5311" y="-447.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="5311" y="-431.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="5311" y="-416.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5311" y="-401.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = parse(phrase, 0) </text>
<text text-anchor="middle" x="5311" y="-385.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="5311" y="-370.3005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_41&#45;&gt;leaf_45 -->
<g id="edge45" class="edge">
<title>codeblock_41&#45;&gt;leaf_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5239.9267,-755.9649C5249.942,-709.7077 5276.8936,-585.2271 5294.5797,-503.5406"/>
<polygon fill="#000000" stroke="#000000" points="5298.1007,-503.818 5296.7961,-493.3038 5291.2592,-502.3367 5298.1007,-503.818"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="5651,-445.7006 5467,-445.7006 5467,-409.7006 5651,-409.7006 5651,-445.7006"/>
<text text-anchor="middle" x="5559" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_42&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>codeblock_42&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5497.4032,-755.9649C5508.0402,-699.2773 5540.7213,-525.1122 5553.6527,-456.1978"/>
<polygon fill="#000000" stroke="#000000" points="5557.1477,-456.5493 5555.5521,-446.0753 5550.2678,-455.2582 5557.1477,-456.5493"/>
</g>
</g>
</svg>