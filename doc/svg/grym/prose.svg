<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="5627pt" height="738pt"
 viewBox="0.00 0.00 5626.50 738.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 734.2007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-734.2007 5622.5,-734.2007 5622.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="558" cy="-712.2007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="558" y="-708.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 89</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="558" cy="-640.2007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="558" y="-636.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;13</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-694.0321C558,-686.3317 558,-677.1751 558,-668.6174"/>
<polygon fill="#000000" stroke="#000000" points="561.5001,-668.6139 558,-658.614 554.5001,-668.614 561.5001,-668.6139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="360" cy="-568.2007" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="360" y="-564.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M519.3536,-626.1475C488.6243,-614.9732 445.3498,-599.237 411.6503,-586.9826"/>
<polygon fill="#000000" stroke="#000000" points="412.5659,-583.5914 401.9718,-583.4632 410.1736,-590.17 412.5659,-583.5914"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="501" cy="-568.2007" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="501" y="-564.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;4</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.9101,-622.403C537.0256,-613.7067 528.6187,-603.0874 521.0765,-593.5605"/>
<polygon fill="#000000" stroke="#000000" points="523.6824,-591.2133 514.7311,-585.5453 518.194,-595.5583 523.6824,-591.2133"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="616" cy="-568.2007" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="616" y="-564.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 5&#45;13</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.3371,-622.403C579.3424,-613.7067 587.8968,-603.0874 595.5713,-593.5605"/>
<polygon fill="#000000" stroke="#000000" points="598.4803,-595.5285 602.028,-585.5453 593.029,-591.1372 598.4803,-595.5285"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1728" cy="-568.2007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1728" y="-564.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 14&#45;62</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M617.629,-636.5312C813.6099,-624.4709 1437.64,-586.069 1653.6002,-572.7792"/>
<polygon fill="#000000" stroke="#000000" points="1654.1125,-576.2544 1663.8786,-572.1467 1653.6825,-569.2676 1654.1125,-576.2544"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="468.5,-514.4028 165.5,-514.4028 165.5,-474.5986 468.5,-474.5986 468.5,-514.4028"/>
<text text-anchor="middle" x="317" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser.</text>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468.528,-555.1943C442.9098,-544.9331 406.4995,-530.3491 375.7907,-518.049"/>
<polygon fill="#000000" stroke="#000000" points="377.0462,-514.7815 366.4618,-514.3123 374.4434,-521.2797 377.0462,-514.7815"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="558" cy="-494.5007" rx="71.7805" ry="18"/>
<text text-anchor="middle" x="558" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;11</text>
</g>
<!-- block_4&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.2548,-550.7348C595.1363,-541.6894 586.3035,-530.4657 578.4056,-520.4299"/>
<polygon fill="#000000" stroke="#000000" points="580.9842,-518.047 572.0494,-512.3532 575.4834,-522.3761 580.9842,-518.047"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="702,-512.5007 648,-512.5007 648,-476.5007 702,-476.5007 702,-512.5007"/>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M629.9822,-550.7348C637.1702,-541.756 646.0765,-530.6306 654.0652,-520.6515"/>
<polygon fill="#000000" stroke="#000000" points="656.9848,-522.6049 660.502,-512.6109 651.5202,-518.2302 656.9848,-522.6049"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="1193" cy="-494.5007" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1193" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_5&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1666.2771,-562.0567C1581.4483,-553.2752 1424.188,-535.7849 1291,-514.2007 1282.3496,-512.7989 1273.2989,-511.1835 1264.3423,-509.4935"/>
<polygon fill="#000000" stroke="#000000" points="1264.7775,-506.0132 1254.2964,-507.5611 1263.4552,-512.8871 1264.7775,-506.0132"/>
</g>
<!-- block_11 -->
<g id="node12" class="node">
<title>block_11</title>
<ellipse fill="none" stroke="#000000" cx="1356" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1356" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 14&#45;18</text>
</g>
<!-- section_5&#45;&gt;block_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;block_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1669.2886,-560.0192C1607.1824,-550.8658 1506.5392,-534.6081 1421,-514.2007 1415.9677,-513.0001 1410.751,-511.6324 1405.561,-510.1901"/>
<polygon fill="#000000" stroke="#000000" points="1406.2464,-506.7455 1395.6687,-507.3489 1404.314,-513.4735 1406.2464,-506.7455"/>
</g>
<!-- block_12 -->
<g id="node13" class="node">
<title>block_12</title>
<ellipse fill="none" stroke="#000000" cx="1486" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1486" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 19&#45;22</text>
</g>
<!-- section_5&#45;&gt;block_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;block_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1683.8949,-554.7687C1642.41,-542.1347 1580.3345,-523.2299 1536.7973,-509.9708"/>
<polygon fill="#000000" stroke="#000000" points="1537.5652,-506.546 1526.9792,-506.9807 1535.5258,-513.2423 1537.5652,-506.546"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1616" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1616" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 23&#45;26</text>
</g>
<!-- section_5&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1702.5855,-551.477C1686.8668,-541.1336 1666.5106,-527.7385 1649.4854,-516.5353"/>
<polygon fill="#000000" stroke="#000000" points="1651.2058,-513.4776 1640.9281,-510.9043 1647.3578,-519.3251 1651.2058,-513.4776"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="1794" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1794" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 27&#45;30</text>
</g>
<!-- section_5&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1743.9768,-550.36C1752.2249,-541.1495 1762.427,-529.7572 1771.462,-519.6681"/>
<polygon fill="#000000" stroke="#000000" points="1774.3342,-521.7073 1778.3981,-511.9228 1769.1195,-517.0374 1774.3342,-521.7073"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="2191" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2191" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 31&#45;35</text>
</g>
<!-- section_5&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1785.2373,-559.0897C1873.1823,-545.0907 2040.7679,-518.4146 2130.5873,-504.1172"/>
<polygon fill="#000000" stroke="#000000" points="2131.2911,-507.5493 2140.6166,-502.5207 2130.1907,-500.6363 2131.2911,-507.5493"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="2675" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2675" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 36&#45;38</text>
</g>
<!-- section_5&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1791.2368,-563.2793C1963.102,-549.904 2437.4641,-512.9869 2610.6397,-499.5095"/>
<polygon fill="#000000" stroke="#000000" points="2610.9273,-502.9978 2620.6255,-498.7324 2610.3841,-496.0189 2610.9273,-502.9978"/>
</g>
<!-- block_17 -->
<g id="node18" class="node">
<title>block_17</title>
<ellipse fill="none" stroke="#000000" cx="3397" cy="-494.5007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3397" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 39&#45;62</text>
</g>
<!-- section_5&#45;&gt;block_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;block_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1792.9145,-565.3342C2058.856,-553.5907 3063.6531,-509.2207 3331.2098,-497.4059"/>
<polygon fill="#000000" stroke="#000000" points="3331.6991,-500.8878 3341.535,-496.9499 3331.3903,-493.8946 3331.6991,-500.8878"/>
</g>
<!-- section_18 -->
<g id="node19" class="node">
<title>section_18</title>
<ellipse fill="none" stroke="#000000" cx="4161" cy="-494.5007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="4161" y="-490.3007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 63&#45;89</text>
</g>
<!-- section_5&#45;&gt;section_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;section_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1793.3913,-566.2199C2135.6563,-555.8521 3719.0265,-507.8889 4085.25,-496.7953"/>
<polygon fill="#000000" stroke="#000000" points="4085.5825,-500.2869 4095.472,-496.4857 4085.3705,-493.2901 4085.5825,-500.2869"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="254,-438.6017 0,-438.6017 0,-353.3996 254,-353.3996 254,-438.6017"/>
<text text-anchor="middle" x="127" y="-423.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="127" y="-408.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="127" y="-392.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="127" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.5722,-481.6426C497.4762,-479.2361 486.9235,-476.8394 477,-474.8007 385.6624,-456.0363 358.5646,-460.9644 264.2236,-438.9969"/>
<polygon fill="#000000" stroke="#000000" points="264.7979,-435.5361 254.2603,-436.6363 263.184,-442.3476 264.7979,-435.5361"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="799.5,-423.3011 272.5,-423.3011 272.5,-368.7002 799.5,-368.7002 799.5,-423.3011"/>
<text text-anchor="middle" x="536" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="536" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- block_11&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>block_11&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1317.5059,-481.3145C1308.8725,-478.7847 1299.6938,-476.4224 1291,-474.8007 1079.8236,-435.4093 1022.3992,-463.457 809,-438.8007 775.7089,-434.9542 740.2592,-430.0201 706.3076,-424.8784"/>
<polygon fill="#000000" stroke="#000000" points="706.7143,-421.4 696.3005,-423.3505 705.6577,-428.3198 706.7143,-421.4"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1352,-423.2011 818,-423.2011 818,-368.8002 1352,-368.8002 1352,-423.2011"/>
<text text-anchor="middle" x="1085" y="-407.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the [[LPEG manual][httk://]]]]</text>
<text text-anchor="middle" x="1085" y="-392.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="1085" y="-377.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- block_12&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_12&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1445.8938,-481.9075C1437.6861,-479.4538 1429.0857,-476.9717 1421,-474.8007 1354.8119,-457.0288 1280.6937,-439.4069 1218.9449,-425.3489"/>
<polygon fill="#000000" stroke="#000000" points="1219.6706,-421.9247 1209.1439,-423.1238 1218.1208,-428.751 1219.6706,-421.9247"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="1447" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1447" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 23&#45;25</text>
</g>
<!-- block_13&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>block_13&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1588.8472,-478.675C1560.6529,-462.2422 1516.331,-436.4095 1484.7382,-417.996"/>
<polygon fill="#000000" stroke="#000000" points="1486.1843,-414.7878 1475.7822,-412.7761 1482.6594,-420.8355 1486.1843,-414.7878"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1596,-414.0006 1542,-414.0006 1542,-378.0006 1596,-378.0006 1596,-414.0006"/>
</g>
<!-- block_13&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>block_13&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1607.3795,-476.4343C1600.3348,-461.6704 1590.2595,-440.5551 1582.1996,-423.6636"/>
<polygon fill="#000000" stroke="#000000" points="1585.1904,-421.804 1577.725,-414.2861 1578.8727,-424.8186 1585.1904,-421.804"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2162,-423.2011 1614,-423.2011 1614,-368.8002 2162,-368.8002 2162,-423.2011"/>
<text text-anchor="middle" x="1888" y="-407.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="1888" y="-392.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="1888" y="-377.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- block_14&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>block_14&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1810.8053,-476.8909C1823.0584,-464.0511 1840.0597,-446.2359 1854.9891,-430.5919"/>
<polygon fill="#000000" stroke="#000000" points="1857.7498,-432.7686 1862.1217,-423.1178 1852.6857,-427.9359 1857.7498,-432.7686"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2735.5,-430.6019 2180.5,-430.6019 2180.5,-361.3994 2735.5,-361.3994 2735.5,-430.6019"/>
<text text-anchor="middle" x="2458" y="-415.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2458" y="-400.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2458" y="-384.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2458" y="-369.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- block_15&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>block_15&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2227.8449,-480.9081C2260.5663,-468.8367 2309.9853,-450.6053 2354.6525,-434.127"/>
<polygon fill="#000000" stroke="#000000" points="2355.9336,-437.385 2364.1041,-430.6401 2353.5108,-430.8177 2355.9336,-437.385"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="3302,-415.3012 2754,-415.3012 2754,-376.7 3302,-376.7 3302,-415.3012"/>
<text text-anchor="middle" x="3028" y="-400.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="3028" y="-384.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- block_16&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>block_16&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2717.2294,-482.7171C2774.2958,-466.7935 2877.1271,-438.0997 2948.809,-418.0978"/>
<polygon fill="#000000" stroke="#000000" points="2950.0176,-421.3944 2958.7089,-415.3354 2948.1361,-414.652 2950.0176,-421.3944"/>
</g>
<!-- codeblock_27 -->
<g id="node28" class="node">
<title>codeblock_27</title>
<ellipse fill="none" stroke="#000000" cx="3397" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3397" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 39&#45;60</text>
</g>
<!-- block_17&#45;&gt;codeblock_27 -->
<g id="edge27" class="edge">
<title>block_17&#45;&gt;codeblock_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3397,-476.4343C3397,-461.9463 3397,-441.3423 3397,-424.6151"/>
<polygon fill="#000000" stroke="#000000" points="3400.5001,-424.2861 3397,-414.2861 3393.5001,-424.2861 3400.5001,-424.2861"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3546,-414.0006 3492,-414.0006 3492,-378.0006 3546,-378.0006 3546,-414.0006"/>
</g>
<!-- block_17&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>block_17&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3425.5937,-478.8921C3443.0806,-468.6618 3465.3951,-454.3385 3483,-438.8007 3488.7055,-433.7651 3494.2918,-427.8012 3499.297,-421.9494"/>
<polygon fill="#000000" stroke="#000000" points="3502.0726,-424.0845 3505.7189,-414.1368 3496.665,-419.6395 3502.0726,-424.0845"/>
</g>
<!-- header_30 -->
<g id="node31" class="node">
<title>header_30</title>
<ellipse fill="none" stroke="#000000" cx="3953" cy="-396.0006" rx="69.1756" ry="18"/>
<text text-anchor="middle" x="3953" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Link or Raw</text>
</g>
<!-- section_18&#45;&gt;header_30 -->
<g id="edge30" class="edge">
<title>section_18&#45;&gt;header_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4123.585,-479.5985C4097.3717,-468.8849 4061.6825,-453.7482 4031,-438.8007 4017.5912,-432.2683 4003.2002,-424.5745 3990.4758,-417.5247"/>
<polygon fill="#000000" stroke="#000000" points="3991.9795,-414.3556 3981.5429,-412.5311 3988.5638,-420.4657 3991.9795,-414.3556"/>
</g>
<!-- block_31 -->
<g id="node32" class="node">
<title>block_31</title>
<ellipse fill="none" stroke="#000000" cx="4096" cy="-396.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="4096" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 63&#45;67</text>
</g>
<!-- section_18&#45;&gt;block_31 -->
<g id="edge31" class="edge">
<title>section_18&#45;&gt;block_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4149.078,-476.4343C4139.0284,-461.2052 4124.5193,-439.2184 4113.2097,-422.08"/>
<polygon fill="#000000" stroke="#000000" points="4116.0569,-420.0399 4107.6277,-413.6211 4110.2143,-423.8954 4116.0569,-420.0399"/>
</g>
<!-- block_32 -->
<g id="node33" class="node">
<title>block_32</title>
<ellipse fill="none" stroke="#000000" cx="4226" cy="-396.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="4226" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 68&#45;70</text>
</g>
<!-- section_18&#45;&gt;block_32 -->
<g id="edge32" class="edge">
<title>section_18&#45;&gt;block_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4172.922,-476.4343C4182.9716,-461.2052 4197.4807,-439.2184 4208.7903,-422.08"/>
<polygon fill="#000000" stroke="#000000" points="4211.7857,-423.8954 4214.3723,-413.6211 4205.9431,-420.0399 4211.7857,-423.8954"/>
</g>
<!-- block_33 -->
<g id="node34" class="node">
<title>block_33</title>
<ellipse fill="none" stroke="#000000" cx="4587" cy="-396.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="4587" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 71&#45;75</text>
</g>
<!-- section_18&#45;&gt;block_33 -->
<g id="edge33" class="edge">
<title>section_18&#45;&gt;block_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4211.5407,-482.8146C4291.9139,-464.2307 4448.2688,-428.0782 4531.5941,-408.8116"/>
<polygon fill="#000000" stroke="#000000" points="4532.4293,-412.2109 4541.3837,-406.5481 4530.8523,-405.3909 4532.4293,-412.2109"/>
</g>
<!-- block_34 -->
<g id="node35" class="node">
<title>block_34</title>
<ellipse fill="none" stroke="#000000" cx="5158" cy="-396.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="5158" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 76&#45;89</text>
</g>
<!-- section_18&#45;&gt;block_34 -->
<g id="edge34" class="edge">
<title>section_18&#45;&gt;block_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4222.9901,-488.3763C4401.2926,-470.7606 4914.2126,-420.086 5094.4502,-402.2791"/>
<polygon fill="#000000" stroke="#000000" points="5094.9585,-405.746 5104.5659,-401.2797 5094.2702,-398.7799 5094.9585,-405.746"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1598.5,-176.6003 1295.5,-176.6003 1295.5,-140.6003 1598.5,-140.6003 1598.5,-176.6003"/>
<text text-anchor="middle" x="1447" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1447,-377.7664C1447,-336.6836 1447,-236.623 1447,-187.1951"/>
<polygon fill="#000000" stroke="#000000" points="1450.5001,-186.8966 1447,-176.8966 1443.5001,-186.8967 1450.5001,-186.8966"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="3346.5,-317.3009 2805.5,-317.3009 2805.5,.1003 3346.5,.1003 3346.5,-317.3009"/>
<text text-anchor="middle" x="3076" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3076" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3076" y="-271.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3076" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3076" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3076" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3076" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3076" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3076" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3076" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3076" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3076" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3076" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3076" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3076" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3076" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3076" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3076" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_27&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>codeblock_27&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3373.6559,-378.7361C3355.7768,-365.5134 3329.1146,-345.795 3298.9686,-323.5001"/>
<polygon fill="#000000" stroke="#000000" points="3300.9285,-320.5964 3290.8073,-317.4642 3296.7662,-326.2244 3300.9285,-320.5964"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3919.5,-185.9007 3364.5,-185.9007 3364.5,-131.2999 3919.5,-131.2999 3919.5,-185.9007"/>
<text text-anchor="middle" x="3642" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The prose parser will be a proper recursive grammar. &#160;This calls for some</text>
<text text-anchor="middle" x="3642" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">enhancements to epnf to allow assignment of Node metatables to matched spans.</text>
</g>
<!-- block_31&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>block_31&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4073.6501,-379.3312C4061.4724,-370.7595 4045.8856,-360.5904 4031,-353.2006 3987.9402,-331.8239 3972.8552,-336.8941 3929,-317.2006 3844.4587,-279.2366 3751.3827,-225.4219 3694.8126,-191.2671"/>
<polygon fill="#000000" stroke="#000000" points="3696.42,-188.1487 3686.0538,-185.9597 3692.7924,-194.1354 3696.42,-188.1487"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="4514,-177.9009 3938,-177.9009 3938,-139.2997 4514,-139.2997 4514,-177.9009"/>
<text text-anchor="middle" x="4226" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ve been sloppy with the node constructor interface and will need to go through</text>
<text text-anchor="middle" x="4226" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">the whole =grym= directory and fix it into a consistent state. &#160;At some point.</text>
</g>
<!-- block_32&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>block_32&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4226,-377.7664C4226,-337.0019 4226,-238.1699 4226,-188.353"/>
<polygon fill="#000000" stroke="#000000" points="4229.5001,-188.221 4226,-178.221 4222.5001,-188.2211 4229.5001,-188.221"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="5101.5,-193.2015 4532.5,-193.2015 4532.5,-123.999 5101.5,-123.999 5101.5,-193.2015"/>
<text text-anchor="middle" x="4817" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">Links give me a chance to design that interface to fit grammatically. For now,</text>
<text text-anchor="middle" x="4817" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">we&#39;re going to handroll another Link class, and write a simple either&#45;or parser</text>
<text text-anchor="middle" x="4817" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">over prose strings that finds links and puts the rest in a =raw= class, which</text>
<text text-anchor="middle" x="4817" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">shouldn&#39;t need an intermediate Node class. </text>
</g>
<!-- block_33&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>block_33&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4603.9124,-378.544C4639.978,-341.318 4725.3088,-253.2416 4776.3749,-200.5326"/>
<polygon fill="#000000" stroke="#000000" points="4778.8999,-202.9563 4783.3444,-193.3388 4773.8724,-198.0855 4778.8999,-202.9563"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="5618.5,-266.5007 5119.5,-266.5007 5119.5,-50.6999 5618.5,-50.6999 5618.5,-266.5007"/>
<text text-anchor="middle" x="5369" y="-251.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">This Link class needs to fit the constructor semantics of =epeg.Csp=.</text>
</g>
<!-- block_34&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>block_34&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5173.5153,-378.544C5193.5846,-355.9636 5230.2829,-314.6737 5266.5079,-273.9162"/>
<polygon fill="#000000" stroke="#000000" points="5269.2351,-276.1163 5273.2623,-266.3167 5264.0029,-271.466 5269.2351,-276.1163"/>
</g>
</g>
</svg>