<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="6165pt" height="1514pt"
 viewBox="0.00 0.00 6164.50 1513.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1509.8018)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1509.8018 6160.5,-1509.8018 6160.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="947.5" cy="-1487.8018" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="947.5" y="-1483.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 165</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="947.5" cy="-1415.8018" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="947.5" y="-1411.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;135</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M947.5,-1469.6331C947.5,-1461.9327 947.5,-1452.7761 947.5,-1444.2184"/>
<polygon fill="#000000" stroke="#000000" points="951.0001,-1444.215 947.5,-1434.215 944.0001,-1444.2151 951.0001,-1444.215"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="546.5" cy="-1343.8018" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="546.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M892.1637,-1405.8661C820.8131,-1393.055 696.6001,-1370.7524 618.1162,-1356.6606"/>
<polygon fill="#000000" stroke="#000000" points="618.2916,-1353.1361 607.8304,-1354.8137 617.0544,-1360.026 618.2916,-1353.1361"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="695.5" cy="-1343.8018" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="695.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M898.7323,-1403.6457C858.0682,-1393.2681 798.7193,-1377.5604 747.5,-1361.8018 742.5479,-1360.2782 737.3602,-1358.5922 732.2589,-1356.8812"/>
<polygon fill="#000000" stroke="#000000" points="733.2348,-1353.516 722.6403,-1353.5958 730.9722,-1360.1403 733.2348,-1353.516"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="829.5" cy="-1343.8018" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="829.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;22</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M920.4284,-1399.2835C904.2046,-1389.3842 883.3715,-1376.6725 865.7407,-1365.9148"/>
<polygon fill="#000000" stroke="#000000" points="867.2137,-1362.7135 856.8542,-1360.4925 863.5676,-1368.6889 867.2137,-1362.7135"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1015.5" cy="-1343.8018" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1015.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;26</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M963.9609,-1398.3726C972.2729,-1389.5716 982.5109,-1378.7315 991.6658,-1369.038"/>
<polygon fill="#000000" stroke="#000000" points="994.3966,-1371.244 998.7183,-1361.5707 989.3075,-1366.4376 994.3966,-1371.244"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2703.5" cy="-1343.8018" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2703.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 28&#45;92</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.605,-1413.1323C1285.5785,-1401.9398 2337.1576,-1358.8227 2628.3663,-1346.8824"/>
<polygon fill="#000000" stroke="#000000" points="2628.554,-1350.3778 2638.4022,-1346.4709 2628.2672,-1343.3836 2628.554,-1350.3778"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="5557.5" cy="-1343.8018" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5557.5" y="-1339.6018" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 136&#45;165</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.1105,-1414.7771C1526.1074,-1406.765 4889.3523,-1354.2371 5471.6615,-1345.1424"/>
<polygon fill="#000000" stroke="#000000" points="5472.1294,-1348.6356 5482.0735,-1344.9798 5472.02,-1341.6365 5472.1294,-1348.6356"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="574.5,-1179.4016 460.5,-1179.4016 460.5,-1143.4016 574.5,-1143.4016 574.5,-1179.4016"/>
<text text-anchor="middle" x="517.5" y="-1157.9016" font-family="Inconsolata" font-size="14.00" fill="#000000">* Prose module</text>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.6133,-1325.6457C538.554,-1293.8244 528.0511,-1227.7643 522.0206,-1189.8344"/>
<polygon fill="#000000" stroke="#000000" points="525.4018,-1188.8106 520.375,-1179.4842 518.4887,-1189.9098 525.4018,-1188.8106"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="619.5" cy="-1161.4016" rx="27" ry="18"/>
<text text-anchor="middle" x="619.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.8172,-1327.3334C672.3822,-1317.135 662.1715,-1303.4226 655.5,-1289.8018 639.4976,-1257.1302 629.5763,-1216.1886 624.3002,-1189.44"/>
<polygon fill="#000000" stroke="#000000" points="627.7352,-1188.7681 622.4412,-1179.5908 620.8567,-1190.0664 627.7352,-1188.7681"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="960.5,-1289.702 664.5,-1289.702 664.5,-1033.1011 960.5,-1033.1011 960.5,-1289.702"/>
<text text-anchor="middle" x="812.5" y="-1274.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="812.5" y="-1243.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="812.5" y="-1227.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require (&quot;status&quot;)()</text>
<text text-anchor="middle" x="812.5" y="-1212.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;epeg&quot;</text>
<text text-anchor="middle" x="812.5" y="-1197.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp</text>
<text text-anchor="middle" x="812.5" y="-1181.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;node/node&quot;</text>
<text text-anchor="middle" x="812.5" y="-1150.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="812.5" y="-1134.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Link = require &quot;grym/link&quot;</text>
<text text-anchor="middle" x="812.5" y="-1119.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">local Richtext = require &quot;grym/richtext&quot;</text>
<text text-anchor="middle" x="812.5" y="-1104.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">local Grammar = require &quot;node/grammar&quot;</text>
<text text-anchor="middle" x="812.5" y="-1056.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
<text text-anchor="middle" x="812.5" y="-1041.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">Pr.id = &quot;prose&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_4&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.8078,-1325.6457C827.1465,-1318.5496 826.3264,-1309.7508 825.4121,-1299.9411"/>
<polygon fill="#000000" stroke="#000000" points="828.8818,-1299.4519 824.4688,-1289.8199 821.912,-1300.1016 828.8818,-1299.4519"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1120.5,-1179.4016 978.5,-1179.4016 978.5,-1143.4016 1120.5,-1143.4016 1120.5,-1179.4016"/>
<text text-anchor="middle" x="1049.5" y="-1157.9016" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = false &#160;</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1018.8844,-1325.6457C1024.8414,-1293.6879 1037.2356,-1227.1966 1044.2908,-1189.3476"/>
<polygon fill="#000000" stroke="#000000" points="1047.7375,-1189.9563 1046.1293,-1179.4842 1040.856,-1188.6735 1047.7375,-1189.9563"/>
</g>
<!-- header_13 -->
<g id="node14" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1227.5" cy="-1161.4016" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1227.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_6&#45;&gt;header_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2637.92,-1342.7813C2371.8534,-1338.4425 1384.295,-1320.338 1325.5,-1289.8018 1283.7317,-1268.1087 1254.6081,-1219.6706 1239.5022,-1188.8802"/>
<polygon fill="#000000" stroke="#000000" points="1242.5328,-1187.1019 1235.092,-1179.5597 1236.2054,-1190.0959 1242.5328,-1187.1019"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1366.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1366.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2637.6204,-1343.1366C2380.5729,-1340.2755 1456.7934,-1327.4056 1407.5,-1289.8018 1376.8453,-1266.4167 1368.6664,-1219.9449 1366.7302,-1189.7915"/>
<polygon fill="#000000" stroke="#000000" points="1370.213,-1189.3271 1366.2692,-1179.4937 1363.22,-1189.6402 1370.213,-1189.3271"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1448.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1448.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2641.4965,-1337.8226C2550.2213,-1328.7885 2374.3933,-1310.5006 2225.5,-1289.8018 1942.8267,-1250.5052 1604.5515,-1189.9276 1489.2734,-1168.8978"/>
<polygon fill="#000000" stroke="#000000" points="1489.6037,-1165.4003 1479.1374,-1167.0457 1488.3454,-1172.2863 1489.6037,-1165.4003"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="2266.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2266.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2667.3667,-1328.72C2584.8352,-1294.2721 2383.332,-1210.1663 2301.7029,-1176.095"/>
<polygon fill="#000000" stroke="#000000" points="2302.935,-1172.8167 2292.3585,-1172.1947 2300.2387,-1179.2766 2302.935,-1172.8167"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="2703.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2703.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2703.5,-1325.6457C2703.5,-1293.8244 2703.5,-1227.7643 2703.5,-1189.8344"/>
<polygon fill="#000000" stroke="#000000" points="2707.0001,-1189.4842 2703.5,-1179.4842 2700.0001,-1189.4843 2707.0001,-1189.4842"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="2856.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2856.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2718.4489,-1325.9804C2746.0617,-1293.0615 2805.0825,-1222.6994 2836.2522,-1185.5401"/>
<polygon fill="#000000" stroke="#000000" points="2839.0757,-1187.6202 2842.8208,-1177.7093 2833.7126,-1183.1216 2839.0757,-1187.6202"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="3009.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3009.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>section_6&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2763.5815,-1336.2813C2803.8869,-1329.1138 2856.8352,-1315.4382 2897.5,-1289.8018 2939.4525,-1263.3536 2974.4922,-1216.4763 2993.68,-1187.272"/>
<polygon fill="#000000" stroke="#000000" points="2996.6513,-1189.1224 2999.116,-1178.8182 2990.7635,-1185.3363 2996.6513,-1189.1224"/>
</g>
<!-- codeblock_20 -->
<g id="node21" class="node">
<title>codeblock_20</title>
<ellipse fill="none" stroke="#000000" cx="3302.5" cy="-1161.4016" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3302.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 54&#45;76</text>
</g>
<!-- section_6&#45;&gt;codeblock_20 -->
<g id="edge20" class="edge">
<title>section_6&#45;&gt;codeblock_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2767.9052,-1339.892C2838.6541,-1334.2022 2954.9293,-1320.7121 3050.5,-1289.8018 3132.3554,-1263.3274 3220.2059,-1212.9473 3267.5033,-1183.7849"/>
<polygon fill="#000000" stroke="#000000" points="3269.4847,-1186.6743 3276.1303,-1178.4228 3265.7895,-1180.7291 3269.4847,-1186.6743"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="3697.5" cy="-1161.4016" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3697.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 78&#45;90</text>
</g>
<!-- section_6&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>section_6&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2768.6281,-1341.2809C2916.1339,-1335.1485 3271.9411,-1317.8626 3388.5,-1289.8018 3489.3493,-1265.523 3599.8439,-1212.6458 3657.465,-1182.8767"/>
<polygon fill="#000000" stroke="#000000" points="3659.3319,-1185.8507 3666.586,-1178.1287 3656.0997,-1179.6416 3659.3319,-1185.8507"/>
</g>
<!-- section_22 -->
<g id="node23" class="node">
<title>section_22</title>
<ellipse fill="none" stroke="#000000" cx="4667.5" cy="-1161.4016" rx="70.655" ry="18"/>
<text text-anchor="middle" x="4667.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 93&#45;135</text>
</g>
<!-- section_6&#45;&gt;section_22 -->
<g id="edge22" class="edge">
<title>section_6&#45;&gt;section_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2769.0958,-1342.6747C2937.7673,-1339.3101 3400.2241,-1327.135 3783.5,-1289.8018 4089.3027,-1260.0149 4451.2354,-1199.4296 4599.2644,-1173.5564"/>
<polygon fill="#000000" stroke="#000000" points="4600.3033,-1176.9278 4609.5492,-1171.7544 4599.0952,-1170.0328 4600.3033,-1176.9278"/>
</g>
<!-- header_68 -->
<g id="node69" class="node">
<title>header_68</title>
<ellipse fill="none" stroke="#000000" cx="5409.5" cy="-1161.4016" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="5409.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Constructor</text>
</g>
<!-- section_7&#45;&gt;header_68 -->
<g id="edge68" class="edge">
<title>section_7&#45;&gt;header_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5543.0397,-1325.9804C5516.6673,-1293.4782 5460.6777,-1224.4747 5430.2439,-1186.9671"/>
<polygon fill="#000000" stroke="#000000" points="5432.8198,-1184.5868 5423.8011,-1179.0268 5427.3841,-1188.9974 5432.8198,-1184.5868"/>
</g>
<!-- prose_69 -->
<g id="node70" class="node">
<title>prose_69</title>
<ellipse fill="none" stroke="#000000" cx="5557.5" cy="-1161.4016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5557.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_69 -->
<g id="edge69" class="edge">
<title>section_7&#45;&gt;prose_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5557.5,-1325.6457C5557.5,-1293.8244 5557.5,-1227.7643 5557.5,-1189.8344"/>
<polygon fill="#000000" stroke="#000000" points="5561.0001,-1189.4842 5557.5,-1179.4842 5554.0001,-1189.4843 5561.0001,-1189.4842"/>
</g>
<!-- codeblock_70 -->
<g id="node71" class="node">
<title>codeblock_70</title>
<ellipse fill="none" stroke="#000000" cx="5755.5" cy="-1161.4016" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5755.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 140&#45;149</text>
</g>
<!-- section_7&#45;&gt;codeblock_70 -->
<g id="edge70" class="edge">
<title>section_7&#45;&gt;codeblock_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5576.4851,-1326.3125C5611.9486,-1293.643 5688.3271,-1223.2821 5728.9029,-1185.9032"/>
<polygon fill="#000000" stroke="#000000" points="5731.298,-1188.4556 5736.2815,-1179.1059 5726.5552,-1183.3072 5731.298,-1188.4556"/>
</g>
<!-- codeblock_71 -->
<g id="node72" class="node">
<title>codeblock_71</title>
<ellipse fill="none" stroke="#000000" cx="6006.5" cy="-1161.4016" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6006.5" y="-1157.2016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 151&#45;153</text>
</g>
<!-- section_7&#45;&gt;codeblock_71 -->
<g id="edge71" class="edge">
<title>section_7&#45;&gt;codeblock_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5624.495,-1335.4943C5698.4076,-1325.63 5812.1169,-1308.1855 5851.5,-1289.8018 5905.2727,-1264.7011 5955.9128,-1216.398 5983.9129,-1186.7224"/>
<polygon fill="#000000" stroke="#000000" points="5986.6199,-1188.9509 5990.863,-1179.2429 5981.492,-1184.186 5986.6199,-1188.9509"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="816.5,-858.6026 422.5,-858.6026 422.5,-802.7996 816.5,-802.7996 816.5,-858.6026"/>
<text text-anchor="middle" x="619.5" y="-811.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M619.5,-1143.1506C619.5,-1090.989 619.5,-940.4437 619.5,-869.0892"/>
<polygon fill="#000000" stroke="#000000" points="623.0001,-868.7504 619.5,-858.7504 616.0001,-868.7505 623.0001,-868.7504"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1081.5,-848.7011 939.5,-848.7011 939.5,-812.7011 1081.5,-812.7011 1081.5,-848.7011"/>
<text text-anchor="middle" x="1010.5" y="-827.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">** Bookend parsing</text>
</g>
<!-- header_13&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>header_13&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1215.1105,-1143.1841C1197.3588,-1117.5678 1163.1079,-1069.9082 1129.5,-1033.0014 1113.6177,-1015.5601 1104.5281,-1015.966 1090.5,-997.0014 1057.7252,-952.6933 1032.875,-892.8433 1020.098,-858.3441"/>
<polygon fill="#000000" stroke="#000000" points="1023.3745,-857.1127 1016.6712,-848.908 1016.795,-859.5022 1023.3745,-857.1127"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1126.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="1126.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_14&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_14&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1366.1172,-1143.0742C1364.4939,-1115.0737 1357.1367,-1061.862 1325.5,-1033.0014 1270.6899,-983.0009 1214.8506,-1049.5715 1162.5,-997.0014 1125.9795,-960.3278 1122.5856,-895.9582 1124.081,-858.9804"/>
<polygon fill="#000000" stroke="#000000" points="1127.5818,-859.0617 1124.6397,-848.8836 1120.5925,-858.6749 1127.5818,-859.0617"/>
</g>
<!-- raw_26 -->
<g id="node27" class="node">
<title>raw_26</title>
<ellipse fill="none" stroke="#000000" cx="1198.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="1198.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_26 -->
<g id="edge26" class="edge">
<title>prose_15&#45;&gt;raw_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1448.1601,-1143.0269C1446.594,-1114.9632 1439.3122,-1061.6684 1407.5,-1033.0014 1349.1575,-980.4271 1290.2556,-1052.3115 1234.5,-997.0014 1197.6609,-960.4567 1194.4278,-895.7643 1196.0267,-858.759"/>
<polygon fill="#000000" stroke="#000000" points="1199.5272,-858.8498 1196.6138,-848.6634 1192.5391,-858.4434 1199.5272,-858.8498"/>
</g>
<!-- link_27 -->
<g id="node28" class="node">
<title>link_27</title>
<ellipse fill="none" stroke="#000000" cx="1270.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="1270.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">link</text>
</g>
<!-- prose_15&#45;&gt;link_27 -->
<g id="edge27" class="edge">
<title>prose_15&#45;&gt;link_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1446.2595,-1143.2471C1442.2642,-1116.8614 1431.9116,-1067.3271 1407.5,-1033.0014 1392.0451,-1011.2699 1376.8689,-1017.2358 1359.5,-997.0014 1322.4221,-953.8066 1294.6605,-892.5904 1280.66,-857.7464"/>
<polygon fill="#000000" stroke="#000000" points="1283.8386,-856.2657 1276.9205,-848.2414 1277.3246,-858.8285 1283.8386,-856.2657"/>
</g>
<!-- raw_28 -->
<g id="node29" class="node">
<title>raw_28</title>
<ellipse fill="none" stroke="#000000" cx="1395.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="1395.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_28 -->
<g id="edge28" class="edge">
<title>prose_15&#45;&gt;raw_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1445.575,-1143.1506C1436.7974,-1088.3814 1410.6363,-925.146 1400.036,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="1403.4544,-858.2158 1398.416,-848.8957 1396.5426,-859.3235 1403.4544,-858.2158"/>
</g>
<!-- raw_35 -->
<g id="node36" class="node">
<title>raw_35</title>
<ellipse fill="none" stroke="#000000" cx="1911.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="1911.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_16&#45;&gt;raw_35 -->
<g id="edge35" class="edge">
<title>prose_16&#45;&gt;raw_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2249.8538,-1145.8948C2192.2899,-1092.2711 2001.5447,-914.5823 1934.8046,-852.4106"/>
<polygon fill="#000000" stroke="#000000" points="1937.0004,-849.6727 1927.2976,-845.4174 1932.229,-854.7946 1937.0004,-849.6727"/>
</g>
<!-- raw_37 -->
<g id="node38" class="node">
<title>raw_37</title>
<ellipse fill="none" stroke="#000000" cx="2205.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="2205.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_37 -->
<g id="edge37" class="edge">
<title>prose_17&#45;&gt;raw_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2674.9905,-1152.5133C2612.3378,-1132.0721 2459.7087,-1077.2365 2352.5,-997.0014 2297.3249,-955.7083 2247.4975,-890.9472 2222.4743,-855.6611"/>
<polygon fill="#000000" stroke="#000000" points="2225.2622,-853.5406 2216.6587,-847.3574 2219.5285,-857.5562 2225.2622,-853.5406"/>
</g>
<!-- literal_38 -->
<g id="node39" class="node">
<title>literal_38</title>
<ellipse fill="none" stroke="#000000" cx="2392.5" cy="-830.7011" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2392.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_17&#45;&gt;literal_38 -->
<g id="edge38" class="edge">
<title>prose_17&#45;&gt;literal_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2680.9319,-1148.473C2638.8183,-1123.5004 2547.1367,-1065.0493 2487.5,-997.0014 2449.5023,-953.6445 2419.3972,-892.7332 2403.9238,-857.9346"/>
<polygon fill="#000000" stroke="#000000" points="2406.985,-856.1986 2399.7757,-848.4348 2400.5699,-858.9998 2406.985,-856.1986"/>
</g>
<!-- raw_39 -->
<g id="node40" class="node">
<title>raw_39</title>
<ellipse fill="none" stroke="#000000" cx="2523.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="2523.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_39 -->
<g id="edge39" class="edge">
<title>prose_17&#45;&gt;raw_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2689.8476,-1145.0242C2666.5071,-1116.431 2618.46,-1054.9166 2587.5,-997.0014 2562.6519,-950.5193 2542.5306,-892.2486 2531.8505,-858.4687"/>
<polygon fill="#000000" stroke="#000000" points="2535.1584,-857.3195 2528.8442,-848.8117 2528.4748,-859.4001 2535.1584,-857.3195"/>
</g>
<!-- literal_40 -->
<g id="node41" class="node">
<title>literal_40</title>
<ellipse fill="none" stroke="#000000" cx="2627.5" cy="-830.7011" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2627.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_17&#45;&gt;literal_40 -->
<g id="edge40" class="edge">
<title>prose_17&#45;&gt;literal_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2699.3057,-1143.1506C2686.7189,-1088.3814 2649.2049,-925.146 2634.0044,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="2637.3323,-857.8577 2631.6814,-848.8957 2630.5101,-859.4255 2637.3323,-857.8577"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="2703.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="2703.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_17&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2703.5,-1143.1506C2703.5,-1088.3814 2703.5,-925.146 2703.5,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="2707.0001,-858.8956 2703.5,-848.8957 2700.0001,-858.8957 2707.0001,-858.8956"/>
</g>
<!-- literal_42 -->
<g id="node43" class="node">
<title>literal_42</title>
<ellipse fill="none" stroke="#000000" cx="2779.5" cy="-830.7011" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2779.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_17&#45;&gt;literal_42 -->
<g id="edge42" class="edge">
<title>prose_17&#45;&gt;literal_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2707.6943,-1143.1506C2720.2811,-1088.3814 2757.7951,-925.146 2772.9956,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="2776.4899,-859.4255 2775.3186,-848.8957 2769.6677,-857.8577 2776.4899,-859.4255"/>
</g>
<!-- raw_43 -->
<g id="node44" class="node">
<title>raw_43</title>
<ellipse fill="none" stroke="#000000" cx="2855.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="2855.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_43 -->
<g id="edge43" class="edge">
<title>prose_17&#45;&gt;raw_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2718.5138,-1145.0447C2743.4446,-1116.9629 2793.233,-1056.8092 2819.5,-997.0014 2839.6511,-951.1191 2848.9038,-893.0202 2852.8532,-859.0433"/>
<polygon fill="#000000" stroke="#000000" points="2856.354,-859.2254 2853.9563,-848.9054 2849.3951,-858.4682 2856.354,-859.2254"/>
</g>
<!-- literal_44 -->
<g id="node45" class="node">
<title>literal_44</title>
<ellipse fill="none" stroke="#000000" cx="2931.5" cy="-830.7011" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2931.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_17&#45;&gt;literal_44 -->
<g id="edge44" class="edge">
<title>prose_17&#45;&gt;literal_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2714.7964,-1144.4402C2733.2298,-1117.8113 2772.103,-1065.8514 2815.5,-1033.0014 2845.3006,-1010.4434 2867.9336,-1026.0111 2891.5,-997.0014 2923.9093,-957.1063 2930.7787,-895.1327 2931.8289,-859.1764"/>
<polygon fill="#000000" stroke="#000000" points="2935.3326,-858.9597 2931.9899,-848.906 2928.3335,-858.8499 2935.3326,-858.9597"/>
</g>
<!-- raw_45 -->
<g id="node46" class="node">
<title>raw_45</title>
<ellipse fill="none" stroke="#000000" cx="3007.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="3007.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_45 -->
<g id="edge45" class="edge">
<title>prose_17&#45;&gt;raw_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2713.4584,-1144.1977C2730.5709,-1116.2568 2768.3135,-1061.2964 2815.5,-1033.0014 2876.525,-996.4083 2921.529,-1047.6573 2971.5,-997.0014 3007.8472,-960.156 3011.305,-895.8498 3009.8672,-858.9291"/>
<polygon fill="#000000" stroke="#000000" points="3013.3571,-858.6464 3009.3252,-848.8488 3006.3672,-859.0223 3013.3571,-858.6464"/>
</g>
<!-- raw_55 -->
<g id="node56" class="node">
<title>raw_55</title>
<ellipse fill="none" stroke="#000000" cx="3079.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="3079.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_18&#45;&gt;raw_55 -->
<g id="edge55" class="edge">
<title>prose_18&#45;&gt;raw_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2867.8165,-1144.4667C2886.2774,-1117.874 2925.1877,-1065.9629 2968.5,-1033.0014 2997.9232,-1010.6098 3020.5907,-1026.0234 3043.5,-997.0014 3075.1816,-956.8666 3080.4786,-894.9775 3080.5868,-859.1009"/>
<polygon fill="#000000" stroke="#000000" points="3084.084,-858.8168 3080.4772,-848.8549 3077.0844,-858.8917 3084.084,-858.8168"/>
</g>
<!-- raw_57 -->
<g id="node58" class="node">
<title>raw_57</title>
<ellipse fill="none" stroke="#000000" cx="3151.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="3151.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_19&#45;&gt;raw_57 -->
<g id="edge57" class="edge">
<title>prose_19&#45;&gt;raw_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3023.1511,-1144.7958C3045.8319,-1116.3472 3091.1835,-1055.667 3115.5,-997.0014 3134.6882,-950.7082 3144.2542,-892.743 3148.5245,-858.903"/>
<polygon fill="#000000" stroke="#000000" points="3152.0194,-859.1536 3149.7304,-848.809 3145.0688,-858.3232 3152.0194,-859.1536"/>
</g>
<!-- leaf_59 -->
<g id="node60" class="node">
<title>leaf_59</title>
<polygon fill="none" stroke="#c0c0c0" points="3738,-996.8019 3197,-996.8019 3197,-664.6003 3738,-664.6003 3738,-996.8019"/>
<text text-anchor="middle" x="3467.5" y="-981.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3467.5" y="-966.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3467.5" y="-951.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3467.5" y="-935.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3467.5" y="-920.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3467.5" y="-888.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3467.5" y="-873.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local Cg, C, P, Cmt, Cb = L.Cg, L.C, L.P, L.Cmt, L.Cb</text>
<text text-anchor="middle" x="3467.5" y="-858.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3467.5" y="-842.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3467.5" y="-827.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3467.5" y="-811.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3467.5" y="-796.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3467.5" y="-781.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3467.5" y="-765.601" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3467.5" y="-734.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3467.5" y="-718.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3467.5" y="-703.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3467.5" y="-688.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3467.5" y="-672.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_20&#45;&gt;leaf_59 -->
<g id="edge59" class="edge">
<title>codeblock_20&#45;&gt;leaf_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3311.6061,-1143.1506C3325.2335,-1115.8381 3352.3193,-1061.5515 3380.1442,-1005.7836"/>
<polygon fill="#000000" stroke="#000000" points="3383.2815,-1007.335 3384.6143,-996.8243 3377.0179,-1004.2098 3383.2815,-1007.335"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="4080.5,-919.6019 3756.5,-919.6019 3756.5,-741.8003 4080.5,-741.8003 4080.5,-919.6019"/>
<text text-anchor="middle" x="3918.5" y="-904.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="3918.5" y="-888.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="3918.5" y="-873.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _, node in ipairs(prose) do</text>
<text text-anchor="middle" x="3918.5" y="-858.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="3918.5" y="-842.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="3918.5" y="-827.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif node.id == &quot;raw&quot; then</text>
<text text-anchor="middle" x="3918.5" y="-811.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase &#160;.. node:toValue()</text>
<text text-anchor="middle" x="3918.5" y="-796.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3918.5" y="-781.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3918.5" y="-765.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="3918.5" y="-750.201" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>codeblock_21&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3709.6967,-1143.1506C3736.5765,-1102.9281 3802.551,-1004.2052 3853.2083,-928.4025"/>
<polygon fill="#000000" stroke="#000000" points="3856.3476,-930.0041 3858.9939,-919.745 3850.5275,-926.1147 3856.3476,-930.0041"/>
</g>
<!-- header_61 -->
<g id="node62" class="node">
<title>header_61</title>
<ellipse fill="none" stroke="#000000" cx="4601.5" cy="-830.7011" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="4601.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : prose grammar</text>
</g>
<!-- section_22&#45;&gt;header_61 -->
<g id="edge61" class="edge">
<title>section_22&#45;&gt;header_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4663.8575,-1143.1506C4652.9269,-1088.3814 4620.349,-925.146 4607.1486,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="4610.5208,-858.0172 4605.1312,-848.8957 4603.6561,-859.3873 4610.5208,-858.0172"/>
</g>
<!-- prose_62 -->
<g id="node63" class="node">
<title>prose_62</title>
<ellipse fill="none" stroke="#000000" cx="4734.5" cy="-830.7011" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4734.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_22&#45;&gt;prose_62 -->
<g id="edge62" class="edge">
<title>section_22&#45;&gt;prose_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4671.1976,-1143.1506C4682.2939,-1088.3814 4715.3654,-925.146 4728.7659,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="4732.2584,-859.3915 4730.8138,-848.8957 4725.3977,-858.0015 4732.2584,-859.3915"/>
</g>
<!-- codeblock_63 -->
<g id="node64" class="node">
<title>codeblock_63</title>
<ellipse fill="none" stroke="#000000" cx="4938.5" cy="-830.7011" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="4938.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 98&#45;133</text>
</g>
<!-- section_22&#45;&gt;codeblock_63 -->
<g id="edge63" class="edge">
<title>section_22&#45;&gt;codeblock_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4682.0701,-1143.6217C4727.1028,-1088.6685 4864.2042,-921.3641 4917.2387,-856.6462"/>
<polygon fill="#000000" stroke="#000000" points="4920.2266,-858.522 4923.8578,-848.5689 4914.8123,-854.0852 4920.2266,-858.522"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-402.9008 0,-402.9008 0,-332.3001 527,-332.3001 527,-402.9008"/>
<text text-anchor="middle" x="263.5" y="-355.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="263.5" y="-340.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1128.8277,-812.7453C1132.2036,-778.0228 1133.9158,-701.808 1090.5,-664.4008 996.8682,-583.7274 648.6226,-678.1843 535.5,-628.4008 428.269,-581.2101 337.9612,-472.4241 293.3715,-411.3088"/>
<polygon fill="#000000" stroke="#000000" points="296.0755,-409.0747 287.3861,-403.0129 290.3988,-413.1704 296.0755,-409.0747"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="890,-387.5025 545,-387.5025 545,-347.6984 890,-347.6984 890,-387.5025"/>
<text text-anchor="middle" x="717.5" y="-356.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the </text>
</g>
<!-- raw_26&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>raw_26&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1200.6112,-812.7476C1203.5497,-778.3719 1204.4473,-703.2306 1162.5,-664.4008 1075.9211,-584.2565 1000.1553,-689.9436 899.5,-628.4008 808.5915,-572.8175 751.316,-452.824 728.6282,-397.1212"/>
<polygon fill="#000000" stroke="#000000" points="731.747,-395.4927 724.7941,-387.4985 725.2442,-398.0837 731.747,-395.4927"/>
</g>
<!-- anchortext_30 -->
<g id="node31" class="node">
<title>anchortext_30</title>
<ellipse fill="none" stroke="#000000" cx="959.5" cy="-367.6004" rx="51.3018" ry="18"/>
<text text-anchor="middle" x="959.5" y="-363.4004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">anchortext</text>
</g>
<!-- link_27&#45;&gt;anchortext_30 -->
<g id="edge30" class="edge">
<title>link_27&#45;&gt;anchortext_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1272.528,-812.593C1275.2671,-778.2892 1275.7559,-703.7507 1234.5,-664.4008 1164.391,-597.5308 1090.0402,-694.8158 1019.5,-628.4008 954.1498,-566.8723 953.2629,-449.6838 956.7615,-395.8832"/>
<polygon fill="#000000" stroke="#000000" points="960.2671,-395.9397 957.5274,-385.7052 953.2868,-395.4144 960.2671,-395.9397"/>
</g>
<!-- url_31 -->
<g id="node32" class="node">
<title>url_31</title>
<ellipse fill="none" stroke="#000000" cx="1055.5" cy="-367.6004" rx="27" ry="18"/>
<text text-anchor="middle" x="1055.5" y="-363.4004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">url</text>
</g>
<!-- link_27&#45;&gt;url_31 -->
<g id="edge31" class="edge">
<title>link_27&#45;&gt;url_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1272.2508,-812.6262C1274.4671,-778.7111 1274.0319,-705.2771 1234.5,-664.4008 1188.9384,-617.2898 1135.2385,-677.2091 1091.5,-628.4008 1032.7127,-562.7993 1042.0355,-448.1638 1050.236,-395.5013"/>
<polygon fill="#000000" stroke="#000000" points="1053.7053,-395.9743 1051.8923,-385.5357 1046.8,-394.8266 1053.7053,-395.9743"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="1634.5,-394.8009 1100.5,-394.8009 1100.5,-340.4 1634.5,-340.4 1634.5,-394.8009"/>
<text text-anchor="middle" x="1367.5" y="-379.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1367.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="1367.5" y="-348.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- raw_28&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>raw_28&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1394.4024,-812.547C1390.2501,-743.8711 1375.451,-499.1049 1369.7561,-404.914"/>
<polygon fill="#000000" stroke="#000000" points="1373.2365,-404.484 1369.1393,-394.7134 1366.2493,-404.9065 1373.2365,-404.484"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="1005,-53.4 912,-53.4 912,-17.4 1005,-17.4 1005,-53.4"/>
<text text-anchor="middle" x="958.5" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000">LPEG manual</text>
</g>
<!-- anchortext_30&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>anchortext_30&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M959.4448,-349.2667C959.2792,-294.2491 958.7856,-130.2733 958.5856,-63.8312"/>
<polygon fill="#000000" stroke="#000000" points="962.0852,-63.6665 958.555,-53.6771 955.0852,-63.6876 962.0852,-63.6665"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="1088,-53.4 1023,-53.4 1023,-17.4 1088,-17.4 1088,-53.4"/>
<text text-anchor="middle" x="1055.5" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000">httk://</text>
</g>
<!-- url_31&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>url_31&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1055.5,-349.2667C1055.5,-294.2491 1055.5,-130.2733 1055.5,-63.8312"/>
<polygon fill="#000000" stroke="#000000" points="1059.0001,-63.6771 1055.5,-53.6771 1052.0001,-63.6771 1059.0001,-63.6771"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="1956,-402.8008 1653,-402.8008 1653,-332.4001 1956,-332.4001 1956,-402.8008"/>
<text text-anchor="middle" x="1804.5" y="-371.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1804.5" y="-356.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1804.5" y="-340.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- raw_35&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>raw_35&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1907.371,-812.8308C1892.0142,-746.3658 1837.9031,-512.1706 1814.9345,-412.7616"/>
<polygon fill="#000000" stroke="#000000" points="1818.2776,-411.6827 1812.6161,-402.7274 1811.4572,-413.2586 1818.2776,-411.6827"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2028.5,-387.5025 1974.5,-387.5025 1974.5,-347.6984 2028.5,-347.6984 2028.5,-387.5025"/>
<text text-anchor="middle" x="2001.5" y="-356.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">The </text>
</g>
<!-- raw_37&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>raw_37&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2188.6223,-816.5321C2153.7042,-786.1334 2073.77,-710.6999 2037.5,-628.4008 2003.1543,-550.4681 1999.734,-447.8203 2000.4162,-397.7202"/>
<polygon fill="#000000" stroke="#000000" points="2003.9184,-397.6401 2000.622,-387.5712 1996.9199,-397.4981 2003.9184,-397.6401"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="2100.5,-385.6004 2046.5,-385.6004 2046.5,-349.6004 2100.5,-349.6004 2100.5,-385.6004"/>
<text text-anchor="middle" x="2073.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_38&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>literal_38&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2381.9088,-813.6438C2360.0099,-779.8306 2306.3337,-704.1433 2241.5,-664.4008 2189.6559,-632.6209 2149.6359,-674.0833 2109.5,-628.4008 2051.5005,-562.3861 2060.3119,-448.435 2068.2963,-395.7794"/>
<polygon fill="#000000" stroke="#000000" points="2071.7678,-396.2362 2069.9126,-385.805 2064.858,-395.1164 2071.7678,-396.2362"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2582.5,-386.901 2118.5,-386.901 2118.5,-348.2999 2582.5,-348.2999 2582.5,-386.901"/>
<text text-anchor="middle" x="2350.5" y="-371.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="2350.5" y="-356.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where </text>
</g>
<!-- raw_39&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_39&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2516.9294,-813.1125C2490.7773,-743.1064 2393.9246,-483.8429 2361.3041,-396.5218"/>
<polygon fill="#000000" stroke="#000000" points="2364.5181,-395.1235 2357.7399,-386.9807 2357.9607,-397.5732 2364.5181,-395.1235"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="2654.5,-385.6004 2600.5,-385.6004 2600.5,-349.6004 2654.5,-349.6004 2654.5,-385.6004"/>
<text text-anchor="middle" x="2627.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">a</text>
</g>
<!-- literal_40&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>literal_40&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2627.5,-812.547C2627.5,-741.5036 2627.5,-482.0199 2627.5,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="2631.0001,-395.629 2627.5,-385.629 2624.0001,-395.6291 2631.0001,-395.629"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="2836,-385.6004 2673,-385.6004 2673,-349.6004 2836,-349.6004 2836,-385.6004"/>
<text text-anchor="middle" x="2754.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> is unique, that is, </text>
</g>
<!-- raw_41&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_41&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2705.4993,-812.547C2713.3231,-741.5036 2741.8993,-482.0199 2751.4029,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="2754.8988,-395.9521 2752.5146,-385.629 2747.9409,-395.1858 2754.8988,-395.9521"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="2919,-385.6004 2854,-385.6004 2854,-349.6004 2919,-349.6004 2919,-385.6004"/>
<text text-anchor="middle" x="2886.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">pattern</text>
</g>
<!-- literal_42&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>literal_42&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2781.6327,-812.5163C2785.7934,-781.1496 2796.6589,-715.3409 2819.5,-664.4008 2827.47,-646.6262 2837.2144,-646.4667 2844.5,-628.4008 2876.7917,-548.3278 2884.303,-444.9825 2886.017,-395.8979"/>
<polygon fill="#000000" stroke="#000000" points="2889.5206,-395.8238 2886.3147,-385.7257 2882.5236,-395.619 2889.5206,-395.8238"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3072,-387.5025 2937,-387.5025 2937,-347.6984 3072,-347.6984 3072,-387.5025"/>
<text text-anchor="middle" x="3004.5" y="-356.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain </text>
</g>
<!-- raw_43&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_43&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2856.1137,-812.5627C2857.8852,-780.7008 2864.7678,-713.4162 2891.5,-664.4008 2902.3341,-644.5357 2915.9394,-647.8521 2927.5,-628.4008 2972.6493,-552.4346 2992.9405,-448.1251 3000.5869,-397.536"/>
<polygon fill="#000000" stroke="#000000" points="3004.0583,-397.9848 3002.031,-387.5857 2997.1309,-396.9793 3004.0583,-397.9848"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3155,-385.6004 3090,-385.6004 3090,-349.6004 3155,-349.6004 3155,-385.6004"/>
<text text-anchor="middle" x="3122.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">bookend</text>
</g>
<!-- literal_44&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>literal_44&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2930.5108,-812.5827C2929.6955,-778.9208 2932.891,-706.353 2971.5,-664.4008 3006.0485,-626.8607 3047.4098,-667.2326 3080.5,-628.4008 3137.5675,-561.4314 3132.688,-448.363 3126.6596,-395.9042"/>
<polygon fill="#000000" stroke="#000000" points="3130.0933,-395.1559 3125.3777,-385.6684 3123.1476,-396.0259 3130.0933,-395.1559"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="3385.5,-385.6004 3173.5,-385.6004 3173.5,-349.6004 3385.5,-349.6004 3385.5,-385.6004"/>
<text text-anchor="middle" x="3279.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> at any level of expansion. </text>
</g>
<!-- raw_45&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>raw_45&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3005.9052,-812.5249C3003.9973,-778.7666 3004.9946,-706.0445 3043.5,-664.4008 3081.3022,-623.5176 3121.707,-665.1947 3163.5,-628.4008 3235.1816,-565.2933 3264.6782,-449.3968 3274.8805,-395.9584"/>
<polygon fill="#000000" stroke="#000000" points="3278.3747,-396.3059 3276.7219,-385.8408 3271.4878,-395.0525 3278.3747,-396.3059"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="3959,-410.2015 3404,-410.2015 3404,-324.9994 3959,-324.9994 3959,-410.2015"/>
<text text-anchor="middle" x="3681.5" y="-379.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="3681.5" y="-363.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="3681.5" y="-348.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="3681.5" y="-333.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- raw_55&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>raw_55&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3077.3621,-812.7186C3074.3773,-778.2928 3073.4033,-703.0685 3115.5,-664.4008 3207.5787,-579.8224 3281.0089,-680.8581 3394.5,-628.4008 3499.3385,-579.9429 3592.5467,-479.3178 3642.6345,-418.2007"/>
<polygon fill="#000000" stroke="#000000" points="3645.5315,-420.1854 3649.1174,-410.2159 3640.0971,-415.7732 3645.5315,-420.1854"/>
</g>
<!-- leaf_58 -->
<g id="node59" class="node">
<title>leaf_58</title>
<polygon fill="none" stroke="#c0c0c0" points="4525.5,-402.9008 3977.5,-402.9008 3977.5,-332.3001 4525.5,-332.3001 4525.5,-402.9008"/>
<text text-anchor="middle" x="4251.5" y="-371.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="4251.5" y="-356.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- raw_57&#45;&gt;leaf_58 -->
<g id="edge58" class="edge">
<title>raw_57&#45;&gt;leaf_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3149.1112,-812.6737C3145.6283,-777.8259 3143.7372,-701.4015 3187.5,-664.4008 3253.7525,-608.3855 3887.4045,-661.7448 3967.5,-628.4008 4078.1694,-582.3289 4172.9771,-473.0964 4219.9606,-411.6118"/>
<polygon fill="#000000" stroke="#000000" points="4223.0321,-413.3527 4226.2695,-403.2645 4217.4477,-409.132 4223.0321,-413.3527"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="4679,-385.6004 4544,-385.6004 4544,-349.6004 4679,-349.6004 4679,-385.6004"/>
<text text-anchor="middle" x="4611.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">*** prose grammar</text>
</g>
<!-- header_61&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>header_61&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4601.892,-812.547C4603.4261,-741.5036 4609.0293,-482.0199 4610.8927,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="4614.3939,-395.7023 4611.1107,-385.629 4607.3955,-395.5511 4614.3939,-395.7023"/>
</g>
<!-- raw_65 -->
<g id="node66" class="node">
<title>raw_65</title>
<ellipse fill="none" stroke="#000000" cx="4724.5" cy="-367.6004" rx="27" ry="18"/>
<text text-anchor="middle" x="4724.5" y="-363.4004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_62&#45;&gt;raw_65 -->
<g id="edge65" class="edge">
<title>prose_62&#45;&gt;raw_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4734.108,-812.547C4732.5739,-741.5036 4726.9707,-482.0199 4725.1073,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="4728.6045,-395.5511 4724.8893,-385.629 4721.6061,-395.7023 4728.6045,-395.5511"/>
</g>
<!-- leaf_67 -->
<g id="node68" class="node">
<title>leaf_67</title>
<polygon fill="none" stroke="#c0c0c0" points="5269,-628.2013 4770,-628.2013 4770,-106.9995 5269,-106.9995 5269,-628.2013"/>
<text text-anchor="middle" x="5019.5" y="-613.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function prose_gm(_ENV)</text>
<text text-anchor="middle" x="5019.5" y="-597.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;START &quot;prose&quot;</text>
<text text-anchor="middle" x="5019.5" y="-582.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;SUPPRESS (&quot;anchorboxed&quot;, &quot;urlboxed&quot;, &quot;literalwrap&quot;, &quot;richtext&quot;)</text>
<text text-anchor="middle" x="5019.5" y="-551.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;prose = (V&quot;link&quot; + V&quot;richtext&quot; + V&quot;raw&quot;)^1</text>
<text text-anchor="middle" x="5019.5" y="-519.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;link = m.sel * m.WS * V&quot;anchorboxed&quot; * m.WS * V&quot;urlboxed&quot; * m.ser</text>
<text text-anchor="middle" x="5019.5" y="-504.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;anchorboxed = m.sel * m.WS * V&quot;anchortext&quot; * m.ser</text>
<text text-anchor="middle" x="5019.5" y="-488.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;urlboxed = m.sel * m.WS * V&quot;url&quot; * m.WS * m.ser</text>
<text text-anchor="middle" x="5019.5" y="-473.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;anchortext = m.anchor_text</text>
<text text-anchor="middle" x="5019.5" y="-458.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;url = m.url</text>
<text text-anchor="middle" x="5019.5" y="-426.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;richtext = V&quot;literalwrap&quot; &#45;&#45; + V&quot;bold&quot; + V&quot;italic&quot; + V&quot;underlined&quot;</text>
<text text-anchor="middle" x="5019.5" y="-411.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;literalwrap = lit_open * V&quot;literal&quot; * lit_close</text>
<text text-anchor="middle" x="5019.5" y="-395.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;literal = (P(1) &#45; lit_close)^1 &#45;&#45; This is not even close</text>
<text text-anchor="middle" x="5019.5" y="-364.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This is the catch bucket.</text>
<text text-anchor="middle" x="5019.5" y="-349.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;raw = (P(1) &#45; (V&quot;link&quot; + V&quot;richtext&quot;))^1</text>
<text text-anchor="middle" x="5019.5" y="-333.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5019.5" y="-302.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function proseBuild(prose, str)</text>
<text text-anchor="middle" x="5019.5" y="-286.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return setmetatable(prose, {__index = Pr})</text>
<text text-anchor="middle" x="5019.5" y="-271.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5019.5" y="-240.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">local proseMetas = { prose = proseBuild,</text>
<text text-anchor="middle" x="5019.5" y="-224.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;link &#160;= Link }</text>
<text text-anchor="middle" x="5019.5" y="-193.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">for k, v in pairs(Richtext) do</text>
<text text-anchor="middle" x="5019.5" y="-177.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;proseMetas[k] = v</text>
<text text-anchor="middle" x="5019.5" y="-162.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5019.5" y="-131.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">local parse = Grammar(prose_gm, proseMetas) &#160;</text>
</g>
<!-- codeblock_63&#45;&gt;leaf_67 -->
<g id="edge67" class="edge">
<title>codeblock_63&#45;&gt;leaf_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4941.6753,-812.547C4947.1899,-781.0187 4959.1958,-712.3772 4972.1647,-638.2302"/>
<polygon fill="#000000" stroke="#000000" points="4975.6415,-638.6661 4973.9168,-628.2126 4968.7462,-637.46 4975.6415,-638.6661"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="4998.5,-70.7004 4450.5,-70.7004 4450.5,-.0997 4998.5,-.0997 4998.5,-70.7004"/>
<text text-anchor="middle" x="4724.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The Prose module is the first one to use our shiny&#45;new Node module. &#160;Which</text>
<text text-anchor="middle" x="4724.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">finally works the way I intend it to and I&#39;m pretty happy about this. </text>
</g>
<!-- raw_65&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>raw_65&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4724.5,-349.2667C4724.5,-298.5759 4724.5,-155.3911 4724.5,-81.2165"/>
<polygon fill="#000000" stroke="#000000" points="4728.0001,-80.7926 4724.5,-70.7927 4721.0001,-80.7927 4728.0001,-80.7926"/>
</g>
<!-- leaf_72 -->
<g id="node73" class="node">
<title>leaf_72</title>
<polygon fill="none" stroke="#c0c0c0" points="5436.5,-848.7011 5322.5,-848.7011 5322.5,-812.7011 5436.5,-812.7011 5436.5,-848.7011"/>
<text text-anchor="middle" x="5379.5" y="-827.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">** Constructor</text>
</g>
<!-- header_68&#45;&gt;leaf_72 -->
<g id="edge72" class="edge">
<title>header_68&#45;&gt;leaf_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5407.8443,-1143.1506C5402.8759,-1088.3814 5388.0677,-925.146 5382.0675,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="5385.5398,-858.5385 5381.1505,-848.8957 5378.5684,-859.171 5385.5398,-858.5385"/>
</g>
<!-- raw_73 -->
<g id="node74" class="node">
<title>raw_73</title>
<ellipse fill="none" stroke="#000000" cx="5481.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="5481.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_69&#45;&gt;raw_73 -->
<g id="edge73" class="edge">
<title>prose_69&#45;&gt;raw_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5552.9087,-1143.1918C5545.309,-1112.907 5529.7392,-1050.2492 5517.5,-997.0014 5506.334,-948.4223 5494.2473,-891.6331 5487.3048,-858.5624"/>
<polygon fill="#000000" stroke="#000000" points="5490.7147,-857.7693 5485.2392,-848.6991 5483.8633,-859.2042 5490.7147,-857.7693"/>
</g>
<!-- literal_74 -->
<g id="node75" class="node">
<title>literal_74</title>
<ellipse fill="none" stroke="#000000" cx="5557.5" cy="-830.7011" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5557.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_69&#45;&gt;literal_74 -->
<g id="edge74" class="edge">
<title>prose_69&#45;&gt;literal_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5557.5,-1143.1506C5557.5,-1088.3814 5557.5,-925.146 5557.5,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="5561.0001,-858.8956 5557.5,-848.8957 5554.0001,-858.8957 5561.0001,-858.8956"/>
</g>
<!-- raw_75 -->
<g id="node76" class="node">
<title>raw_75</title>
<ellipse fill="none" stroke="#000000" cx="5633.5" cy="-830.7011" rx="27" ry="18"/>
<text text-anchor="middle" x="5633.5" y="-826.5011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_69&#45;&gt;raw_75 -->
<g id="edge75" class="edge">
<title>prose_69&#45;&gt;raw_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5562.0913,-1143.1918C5569.691,-1112.907 5585.2608,-1050.2492 5597.5,-997.0014 5608.666,-948.4223 5620.7527,-891.6331 5627.6952,-858.5624"/>
<polygon fill="#000000" stroke="#000000" points="5631.1367,-859.2042 5629.7608,-848.6991 5624.2853,-857.7693 5631.1367,-859.2042"/>
</g>
<!-- leaf_79 -->
<g id="node80" class="node">
<title>leaf_79</title>
<polygon fill="none" stroke="#c0c0c0" points="5954,-896.4015 5679,-896.4015 5679,-765.0007 5954,-765.0007 5954,-896.4015"/>
<text text-anchor="middle" x="5816.5" y="-881.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="5816.5" y="-865.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;\n&quot;</text>
<text text-anchor="middle" x="5816.5" y="-850.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="5816.5" y="-834.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="5816.5" y="-819.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5816.5" y="-804.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = parse(phrase, 0) </text>
<text text-anchor="middle" x="5816.5" y="-788.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="5816.5" y="-773.301" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_70&#45;&gt;leaf_79 -->
<g id="edge79" class="edge">
<title>codeblock_70&#45;&gt;leaf_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5758.8665,-1143.1506C5767.0175,-1098.9613 5788.1928,-984.1636 5802.4774,-906.7219"/>
<polygon fill="#000000" stroke="#000000" points="5805.9859,-906.9956 5804.358,-896.5266 5799.102,-905.7258 5805.9859,-906.9956"/>
</g>
<!-- leaf_80 -->
<g id="node81" class="node">
<title>leaf_80</title>
<polygon fill="none" stroke="#c0c0c0" points="6156.5,-848.7011 5972.5,-848.7011 5972.5,-812.7011 6156.5,-812.7011 6156.5,-848.7011"/>
<text text-anchor="middle" x="6064.5" y="-827.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_71&#45;&gt;leaf_80 -->
<g id="edge80" class="edge">
<title>codeblock_71&#45;&gt;leaf_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6009.7009,-1143.1506C6019.3067,-1088.3814 6047.9358,-925.146 6059.5361,-859.0039"/>
<polygon fill="#000000" stroke="#000000" points="6063.0288,-859.35 6061.3089,-848.8957 6056.134,-858.1407 6063.0288,-859.35"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="5569.5,-395.5019 5287.5,-395.5019 5287.5,-339.699 5569.5,-339.699 5569.5,-395.5019"/>
<text text-anchor="middle" x="5428.5" y="-348.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; [ ] #todo smuggle in that offset in </text>
</g>
<!-- raw_73&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>raw_73&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5479.4223,-812.547C5471.5731,-743.9626 5443.6248,-499.7571 5432.8136,-405.2915"/>
<polygon fill="#000000" stroke="#000000" points="5436.2864,-404.8532 5431.6719,-395.3161 5429.3318,-405.6492 5436.2864,-404.8532"/>
</g>
<!-- leaf_77 -->
<g id="node78" class="node">
<title>leaf_77</title>
<polygon fill="none" stroke="#c0c0c0" points="5641.5,-385.6004 5587.5,-385.6004 5587.5,-349.6004 5641.5,-349.6004 5641.5,-385.6004"/>
<text text-anchor="middle" x="5614.5" y="-364.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">parse</text>
</g>
<!-- literal_74&#45;&gt;leaf_77 -->
<g id="edge77" class="edge">
<title>literal_74&#45;&gt;leaf_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5559.7345,-812.547C5568.4787,-741.5036 5600.4169,-482.0199 5611.0386,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="5614.5331,-395.9817 5612.281,-385.629 5607.5855,-395.1265 5614.5331,-395.9817"/>
</g>
<!-- leaf_78 -->
<g id="node79" class="node">
<title>leaf_78</title>
<polygon fill="none" stroke="#c0c0c0" points="5713.5,-385.6004 5659.5,-385.6004 5659.5,-349.6004 5713.5,-349.6004 5713.5,-385.6004"/>
</g>
<!-- raw_75&#45;&gt;leaf_78 -->
<g id="edge78" class="edge">
<title>raw_75&#45;&gt;leaf_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5635.5777,-812.547C5643.7083,-741.5036 5673.4052,-482.0199 5683.2815,-395.723"/>
<polygon fill="#000000" stroke="#000000" points="5686.7769,-395.9622 5684.4367,-385.629 5679.8223,-395.1662 5686.7769,-395.9622"/>
</g>
</g>
</svg>