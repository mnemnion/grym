<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="6763pt" height="887pt"
 viewBox="0.00 0.00 6762.50 887.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 883.2009)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-883.2009 6758.5,-883.2009 6758.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="985.5" cy="-861.2009" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="985.5" y="-857.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 124</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="985.5" cy="-789.2009" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="985.5" y="-785.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;16</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M985.5,-843.0322C985.5,-835.3318 985.5,-826.1752 985.5,-817.6175"/>
<polygon fill="#000000" stroke="#000000" points="989.0001,-817.6141 985.5,-807.6141 982.0001,-817.6142 989.0001,-817.6141"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="787.5" cy="-717.2009" rx="76.9193" ry="18"/>
<text text-anchor="middle" x="787.5" y="-713.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Prose module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M946.8536,-775.1476C916.1243,-763.9733 872.8498,-748.2372 839.1503,-735.9828"/>
<polygon fill="#000000" stroke="#000000" points="840.0659,-732.5916 829.4718,-732.4633 837.6736,-739.1701 840.0659,-732.5916"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="928.5" cy="-717.2009" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="928.5" y="-713.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;4</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M971.4101,-771.4031C964.5256,-762.7069 956.1187,-752.0876 948.5765,-742.5606"/>
<polygon fill="#000000" stroke="#000000" points="951.1824,-740.2135 942.2311,-734.5455 945.694,-744.5584 951.1824,-740.2135"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="1043.5" cy="-717.2009" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="1043.5" y="-713.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 5&#45;16</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M999.8371,-771.4031C1006.8424,-762.7069 1015.3968,-752.0876 1023.0713,-742.5606"/>
<polygon fill="#000000" stroke="#000000" points="1025.9803,-744.5287 1029.528,-734.5455 1020.529,-740.1374 1025.9803,-744.5287"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1710.5" cy="-717.2009" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1710.5" y="-713.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 17&#45;81</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.2996,-783.4608C1174.5873,-770.4226 1494.9897,-738.6033 1638.6933,-724.332"/>
<polygon fill="#000000" stroke="#000000" points="1639.1244,-727.8065 1648.7296,-723.3353 1638.4326,-720.8408 1639.1244,-727.8065"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="893.5" cy="-645.2009" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="893.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_3&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M919.8483,-699.4031C915.8218,-691.12 910.9472,-681.0923 906.4912,-671.9257"/>
<polygon fill="#000000" stroke="#000000" points="909.5719,-670.2574 902.0522,-662.7939 903.2764,-673.3178 909.5719,-670.2574"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="1043.5" cy="-645.2009" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1043.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 5&#45;14</text>
</g>
<!-- block_4&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>block_4&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-699.0322C1043.5,-691.3318 1043.5,-682.1752 1043.5,-673.6175"/>
<polygon fill="#000000" stroke="#000000" points="1047.0001,-673.6141 1043.5,-663.6141 1040.0001,-673.6142 1047.0001,-673.6141"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="1222.5" cy="-645.2009" rx="88.5398" ry="18"/>
<text text-anchor="middle" x="1222.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Bookend parsing</text>
</g>
<!-- section_5&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1650.5804,-709.7375C1573.9141,-699.997 1437.081,-681.9689 1320.5,-663.2009 1312.9347,-661.983 1305.0533,-660.6476 1297.1917,-659.2719"/>
<polygon fill="#000000" stroke="#000000" points="1297.7269,-655.8123 1287.2696,-657.5135 1296.5054,-662.7049 1297.7269,-655.8123"/>
</g>
<!-- block_11 -->
<g id="node12" class="node">
<title>block_11</title>
<ellipse fill="none" stroke="#000000" cx="1385.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1385.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 17&#45;21</text>
</g>
<!-- section_5&#45;&gt;block_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;block_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1656.2407,-707.0043C1603.4826,-696.8374 1521.1853,-680.3091 1450.5,-663.2009 1446.1575,-662.1498 1441.6655,-661.0122 1437.165,-659.8372"/>
<polygon fill="#000000" stroke="#000000" points="1437.9178,-656.4158 1427.3539,-657.2242 1436.1163,-663.18 1437.9178,-656.4158"/>
</g>
<!-- block_12 -->
<g id="node13" class="node">
<title>block_12</title>
<ellipse fill="none" stroke="#000000" cx="1515.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1515.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 22&#45;25</text>
</g>
<!-- section_5&#45;&gt;block_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;block_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1671.0388,-702.6306C1639.4365,-690.962 1595.0437,-674.5709 1561.7696,-662.285"/>
<polygon fill="#000000" stroke="#000000" points="1562.8572,-658.9557 1552.2639,-658.7752 1560.4326,-665.5224 1562.8572,-658.9557"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1645.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1645.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 26&#45;29</text>
</g>
<!-- section_5&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1694.4326,-699.4031C1686.4232,-690.5312 1676.6069,-679.6577 1667.8742,-669.9846"/>
<polygon fill="#000000" stroke="#000000" points="1670.4573,-667.6228 1661.1583,-662.5455 1665.2614,-672.3135 1670.4573,-667.6228"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="1775.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1775.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 30&#45;33</text>
</g>
<!-- section_5&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1726.5674,-699.4031C1734.5768,-690.5312 1744.3931,-679.6577 1753.1258,-669.9846"/>
<polygon fill="#000000" stroke="#000000" points="1755.7386,-672.3135 1759.8417,-662.5455 1750.5427,-667.6228 1755.7386,-672.3135"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="2125.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2125.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 34&#45;38</text>
</g>
<!-- section_5&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1766.0381,-707.5653C1844.1952,-694.0056 1986.0241,-669.3991 2066.1782,-655.4928"/>
<polygon fill="#000000" stroke="#000000" points="2066.86,-658.9269 2076.1145,-653.769 2065.6633,-652.03 2066.86,-658.9269"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="2434.5" cy="-645.2009" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2434.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 39&#45;81</text>
</g>
<!-- section_5&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1772.2278,-711.0622C1908.3412,-697.5261 2233.0854,-665.2311 2370.9052,-651.5252"/>
<polygon fill="#000000" stroke="#000000" points="2371.2904,-655.0043 2380.8949,-650.5318 2370.5976,-648.0386 2371.2904,-655.0043"/>
</g>
<!-- section_17 -->
<g id="node18" class="node">
<title>section_17</title>
<ellipse fill="none" stroke="#000000" cx="3222.5" cy="-645.2009" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3222.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 42&#45;81</text>
</g>
<!-- section_5&#45;&gt;section_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;section_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1775.4688,-714.1071C2020.3406,-702.4466 2886.7838,-661.1874 3147.6454,-648.7654"/>
<polygon fill="#000000" stroke="#000000" points="3147.9511,-652.2549 3157.7733,-648.2831 3147.6181,-645.2628 3147.9511,-652.2549"/>
</g>
<!-- section_18 -->
<g id="node19" class="node">
<title>section_18</title>
<ellipse fill="none" stroke="#000000" cx="5371.5" cy="-645.2009" rx="70.655" ry="18"/>
<text text-anchor="middle" x="5371.5" y="-641.0009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 82&#45;124</text>
</g>
<!-- section_5&#45;&gt;section_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;section_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1776.3808,-715.9052C2222.6499,-707.1285 4799.7993,-656.4444 5290.7289,-646.7894"/>
<polygon fill="#000000" stroke="#000000" points="5290.9817,-650.2852 5300.9109,-646.5891 5290.844,-643.2865 5290.9817,-650.2852"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="940.5,-544.9029 546.5,-544.9029 546.5,-505.0987 940.5,-505.0987 940.5,-544.9029"/>
<text text-anchor="middle" x="743.5" y="-513.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Here we need a proper recursive parser. &#160;Eventually.</text>
</g>
<!-- prose_6&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>prose_6&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M874.8057,-630.2205C850.183,-610.4895 806.4796,-575.4685 776.2966,-551.2818"/>
<polygon fill="#000000" stroke="#000000" points="778.1613,-548.291 768.169,-544.7689 773.784,-553.7535 778.1613,-548.291"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="1212.5,-591.4016 958.5,-591.4016 958.5,-458.6 1212.5,-458.6 1212.5,-591.4016"/>
<text text-anchor="middle" x="1085.5" y="-576.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1085.5" y="-560.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;util&quot;</text>
<text text-anchor="middle" x="1085.5" y="-545.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1085.5" y="-513.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1085.5" y="-498.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1085.5" y="-467.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Pr, pr = u.inherit(Node)</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>codeblock_8&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1049.7878,-627.2057C1052.3891,-619.7611 1055.5956,-610.5844 1059.0104,-600.8116"/>
<polygon fill="#000000" stroke="#000000" points="1062.3406,-601.8911 1062.3352,-591.2963 1055.7324,-599.582 1062.3406,-601.8911"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="1344.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1344.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_11&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>block_11&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1379.3619,-627.2057C1372.59,-607.3525 1361.6162,-575.1805 1353.79,-552.2365"/>
<polygon fill="#000000" stroke="#000000" points="1357.0873,-551.0612 1350.5462,-542.7266 1350.4621,-553.3211 1357.0873,-551.0612"/>
</g>
<!-- prose_21 -->
<g id="node22" class="node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="1471.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1471.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_12&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>block_12&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1508.9128,-627.2057C1501.6454,-607.3525 1489.8686,-575.1805 1481.4698,-552.2365"/>
<polygon fill="#000000" stroke="#000000" points="1484.7129,-550.9141 1477.9887,-542.7266 1478.1395,-553.3204 1484.7129,-550.9141"/>
</g>
<!-- prose_23 -->
<g id="node24" class="node">
<title>prose_23</title>
<ellipse fill="none" stroke="#000000" cx="1621.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1621.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_13&#45;&gt;prose_23 -->
<g id="edge23" class="edge">
<title>block_13&#45;&gt;prose_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1641.907,-627.2057C1637.9834,-607.5551 1631.6501,-575.8359 1627.0789,-552.9418"/>
<polygon fill="#000000" stroke="#000000" points="1630.508,-552.2401 1625.1176,-543.119 1623.6435,-553.6107 1630.508,-552.2401"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="1739.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1739.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_14&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>block_14&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1770.1104,-627.2057C1764.2251,-607.5551 1754.7251,-575.8359 1747.8684,-552.9418"/>
<polygon fill="#000000" stroke="#000000" points="1751.1484,-551.6943 1744.9264,-543.119 1744.4427,-553.7028 1751.1484,-551.6943"/>
</g>
<!-- prose_27 -->
<g id="node28" class="node">
<title>prose_27</title>
<ellipse fill="none" stroke="#000000" cx="2171.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2171.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_15&#45;&gt;prose_27 -->
<g id="edge27" class="edge">
<title>block_15&#45;&gt;prose_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2132.3867,-627.2057C2139.9844,-607.3525 2152.2965,-575.1805 2161.077,-552.2365"/>
<polygon fill="#000000" stroke="#000000" points="2164.411,-553.3171 2164.7164,-542.7266 2157.8734,-550.8151 2164.411,-553.3171"/>
</g>
<!-- prose_29 -->
<g id="node30" class="node">
<title>prose_29</title>
<ellipse fill="none" stroke="#000000" cx="2613.5" cy="-525.0008" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2613.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_16&#45;&gt;prose_29 -->
<g id="edge29" class="edge">
<title>block_16&#45;&gt;prose_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2459.0139,-628.7396C2491.7616,-606.7492 2549.6937,-567.8473 2584.5511,-544.4403"/>
<polygon fill="#000000" stroke="#000000" points="2586.5359,-547.3234 2592.8866,-538.8429 2582.6335,-541.5121 2586.5359,-547.3234"/>
</g>
<!-- header_31 -->
<g id="node32" class="node">
<title>header_31</title>
<ellipse fill="none" stroke="#000000" cx="3016.5" cy="-525.0008" rx="67.2722" ry="18"/>
<text text-anchor="middle" x="3016.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lpeg locals</text>
</g>
<!-- section_17&#45;&gt;header_31 -->
<g id="edge31" class="edge">
<title>section_17&#45;&gt;header_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3179.8422,-631.4337C3153.6213,-622.0294 3119.915,-608.2038 3092.5,-591.2009 3073.6797,-579.5284 3054.8927,-563.217 3040.7061,-549.7063"/>
<polygon fill="#000000" stroke="#000000" points="3042.9378,-546.9947 3033.3269,-542.5358 3038.0596,-552.0149 3042.9378,-546.9947"/>
</g>
<!-- block_32 -->
<g id="node33" class="node">
<title>block_32</title>
<ellipse fill="none" stroke="#000000" cx="3157.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3157.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 42&#45;43</text>
</g>
<!-- section_17&#45;&gt;block_32 -->
<g id="edge32" class="edge">
<title>section_17&#45;&gt;block_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3212.7688,-627.2057C3201.9989,-607.2895 3184.5251,-574.9764 3172.1103,-552.0186"/>
<polygon fill="#000000" stroke="#000000" points="3175.1331,-550.2504 3167.2977,-543.119 3168.9757,-553.5801 3175.1331,-550.2504"/>
</g>
<!-- block_33 -->
<g id="node34" class="node">
<title>block_33</title>
<ellipse fill="none" stroke="#000000" cx="3287.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3287.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 44&#45;51</text>
</g>
<!-- section_17&#45;&gt;block_33 -->
<g id="edge33" class="edge">
<title>section_17&#45;&gt;block_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3232.2312,-627.2057C3243.0011,-607.2895 3260.4749,-574.9764 3272.8897,-552.0186"/>
<polygon fill="#000000" stroke="#000000" points="3276.0243,-553.5801 3277.7023,-543.119 3269.8669,-550.2504 3276.0243,-553.5801"/>
</g>
<!-- block_34 -->
<g id="node35" class="node">
<title>block_34</title>
<ellipse fill="none" stroke="#000000" cx="3438.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3438.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 52&#45;74</text>
</g>
<!-- section_17&#45;&gt;block_34 -->
<g id="edge34" class="edge">
<title>section_17&#45;&gt;block_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3263.918,-631.1706C3290.1258,-621.5324 3324.2656,-607.5498 3352.5,-591.2009 3373.4666,-579.0604 3395.0679,-562.4141 3411.3766,-548.8513"/>
<polygon fill="#000000" stroke="#000000" points="3414.0111,-551.2074 3419.3911,-542.0802 3409.4935,-545.8603 3414.0111,-551.2074"/>
</g>
<!-- block_35 -->
<g id="node36" class="node">
<title>block_35</title>
<ellipse fill="none" stroke="#000000" cx="3640.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3640.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 75&#45;81</text>
</g>
<!-- section_17&#45;&gt;block_35 -->
<g id="edge35" class="edge">
<title>section_17&#45;&gt;block_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3283.129,-638.1897C3340.8342,-630.4392 3429.5835,-615.6953 3503.5,-591.2009 3539.0522,-579.4196 3577.2472,-560.382 3604.2524,-545.7396"/>
<polygon fill="#000000" stroke="#000000" points="3606.2345,-548.6442 3613.3151,-540.7628 3602.865,-542.5085 3606.2345,-548.6442"/>
</g>
<!-- header_44 -->
<g id="node45" class="node">
<title>header_44</title>
<ellipse fill="none" stroke="#000000" cx="5033.5" cy="-525.0008" rx="69.1756" ry="18"/>
<text text-anchor="middle" x="5033.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Link or Raw</text>
</g>
<!-- section_18&#45;&gt;header_44 -->
<g id="edge44" class="edge">
<title>section_18&#45;&gt;header_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5303.3528,-640.3419C5249.0868,-634.3297 5172.3972,-620.9386 5111.5,-591.2009 5090.7057,-581.0465 5070.8739,-564.0808 5056.4111,-549.8672"/>
<polygon fill="#000000" stroke="#000000" points="5058.8802,-547.3865 5049.3606,-542.7359 5053.9023,-552.3079 5058.8802,-547.3865"/>
</g>
<!-- block_45 -->
<g id="node46" class="node">
<title>block_45</title>
<ellipse fill="none" stroke="#000000" cx="5176.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="5176.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 82&#45;86</text>
</g>
<!-- section_18&#45;&gt;block_45 -->
<g id="edge45" class="edge">
<title>section_18&#45;&gt;block_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5325.9412,-631.3342C5299.9216,-622.212 5267.4216,-608.712 5241.5,-591.2009 5224.7642,-579.8952 5208.8288,-563.7825 5196.9249,-550.2843"/>
<polygon fill="#000000" stroke="#000000" points="5199.577,-548.0004 5190.4063,-542.695 5194.2669,-552.5614 5199.577,-548.0004"/>
</g>
<!-- block_46 -->
<g id="node47" class="node">
<title>block_46</title>
<ellipse fill="none" stroke="#000000" cx="5306.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="5306.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 87&#45;89</text>
</g>
<!-- section_18&#45;&gt;block_46 -->
<g id="edge46" class="edge">
<title>section_18&#45;&gt;block_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5361.7688,-627.2057C5350.9989,-607.2895 5333.5251,-574.9764 5321.1103,-552.0186"/>
<polygon fill="#000000" stroke="#000000" points="5324.1331,-550.2504 5316.2977,-543.119 5317.9757,-553.5801 5324.1331,-550.2504"/>
</g>
<!-- block_47 -->
<g id="node48" class="node">
<title>block_47</title>
<ellipse fill="none" stroke="#000000" cx="5436.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="5436.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 90&#45;94</text>
</g>
<!-- section_18&#45;&gt;block_47 -->
<g id="edge47" class="edge">
<title>section_18&#45;&gt;block_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5381.2312,-627.2057C5392.0011,-607.2895 5409.4749,-574.9764 5421.8897,-552.0186"/>
<polygon fill="#000000" stroke="#000000" points="5425.0243,-553.5801 5426.7023,-543.119 5418.8669,-550.2504 5425.0243,-553.5801"/>
</g>
<!-- block_48 -->
<g id="node49" class="node">
<title>block_48</title>
<ellipse fill="none" stroke="#000000" cx="5777.5" cy="-525.0008" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="5777.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 95&#45;96</text>
</g>
<!-- section_18&#45;&gt;block_48 -->
<g id="edge48" class="edge">
<title>section_18&#45;&gt;block_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5417.6781,-631.5294C5494.2139,-608.8703 5646.7919,-563.6981 5726.435,-540.1191"/>
<polygon fill="#000000" stroke="#000000" points="5727.647,-543.4105 5736.242,-537.2156 5725.6598,-536.6984 5727.647,-543.4105"/>
</g>
<!-- block_49 -->
<g id="node50" class="node">
<title>block_49</title>
<ellipse fill="none" stroke="#000000" cx="6158.5" cy="-525.0008" rx="60.9913" ry="18"/>
<text text-anchor="middle" x="6158.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 97&#45;109</text>
</g>
<!-- section_18&#45;&gt;block_49 -->
<g id="edge49" class="edge">
<title>section_18&#45;&gt;block_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5438.4556,-639.4868C5530.0228,-631.2258 5699.2953,-614.3596 5842.5,-591.2009 5933.6279,-576.4639 6038.2865,-553.2906 6101.3528,-538.6345"/>
<polygon fill="#000000" stroke="#000000" points="6102.1659,-542.0388 6111.1089,-536.358 6100.5752,-535.222 6102.1659,-542.0388"/>
</g>
<!-- block_50 -->
<g id="node51" class="node">
<title>block_50</title>
<ellipse fill="none" stroke="#000000" cx="6482.5" cy="-525.0008" rx="65.0229" ry="18"/>
<text text-anchor="middle" x="6482.5" y="-520.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 110&#45;124</text>
</g>
<!-- section_18&#45;&gt;block_50 -->
<g id="edge50" class="edge">
<title>section_18&#45;&gt;block_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5441.3761,-642.5306C5617.7123,-635.5137 6077.4353,-615.4158 6228.5,-591.2009 6299.3686,-579.841 6379.178,-557.4015 6430.1021,-541.8153"/>
<polygon fill="#000000" stroke="#000000" points="6431.3672,-545.0879 6439.8906,-538.7948 6429.3031,-538.3991 6431.3672,-545.0879"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-415.3011 0,-415.3011 0,-360.7002 527,-360.7002 527,-415.3011"/>
<text text-anchor="middle" x="263.5" y="-384.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;We need to generate parsers to match sequences of single characters, so</text>
<text text-anchor="middle" x="263.5" y="-368.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">that *bold*, **bold**, ***bold*** etc all work correctly.</text>
</g>
<!-- prose_19&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>prose_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1324.3778,-510.5214C1300.9582,-494.568 1260.4973,-469.7249 1221.5,-458.8007 1074.7181,-417.683 688.3202,-436.4476 536.5,-422.8007 516.2674,-420.982 495.2252,-418.8075 474.2004,-416.4456"/>
<polygon fill="#000000" stroke="#000000" points="474.5473,-412.9626 464.2158,-415.31 473.7562,-419.9178 474.5473,-412.9626"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1079.5,-415.2011 545.5,-415.2011 545.5,-360.8002 1079.5,-360.8002 1079.5,-415.2011"/>
<text text-anchor="middle" x="812.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">Bookends are a fun construct borrowed from the [[LPEG manual][httk://]]]]</text>
<text text-anchor="middle" x="812.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">model for Lua long strings. &#160;The GGG/Pegylator form of a bookend construct</text>
<text text-anchor="middle" x="812.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">is </text>
</g>
<!-- prose_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>prose_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1456.0603,-508.8703C1440.0204,-493.2212 1413.4022,-470.2155 1385.5,-458.8007 1262.4341,-408.4541 1220.4612,-439.1175 1088.5,-422.8007 1071.7719,-420.7323 1054.4752,-418.581 1037.0758,-416.408"/>
<polygon fill="#000000" stroke="#000000" points="1037.1799,-412.8939 1026.823,-415.1265 1036.3116,-419.8398 1037.1799,-412.8939"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="1401,-415.2011 1098,-415.2011 1098,-360.8002 1401,-360.8002 1401,-415.2011"/>
<text text-anchor="middle" x="1249.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">~#!peg</text>
<text text-anchor="middle" x="1249.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;bookend = &quot;`&quot;:a !&quot;`&quot;:a pattern &#160;&quot;`&quot;:a</text>
<text text-anchor="middle" x="1249.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">~#/peg</text>
</g>
<!-- prose_23&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>prose_23&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1601.5416,-510.4869C1580.3648,-495.6742 1545.4744,-472.9128 1512.5,-458.8007 1473.4623,-442.0937 1429.4501,-428.3959 1388.7571,-417.6519"/>
<polygon fill="#000000" stroke="#000000" points="1389.5974,-414.2541 1379.0384,-415.1248 1387.8358,-421.0288 1389.5974,-414.2541"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1967.5,-415.2011 1419.5,-415.2011 1419.5,-360.8002 1967.5,-360.8002 1967.5,-415.2011"/>
<text text-anchor="middle" x="1693.5" y="-399.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">The =lpeg= engine doesn&#39;t model this directly but it&#39;s possible to provide</text>
<text text-anchor="middle" x="1693.5" y="-384.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">it. &#160;We only need the subset of this where =a= is unique, that is, =pattern=</text>
<text text-anchor="middle" x="1693.5" y="-369.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">does not contain =bookend= at any level of expansion. </text>
</g>
<!-- prose_25&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>prose_25&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1733.4863,-507.0904C1726.5113,-486.317 1714.8272,-451.5188 1705.8852,-424.887"/>
<polygon fill="#000000" stroke="#000000" points="1709.1089,-423.4921 1702.6079,-415.1263 1702.473,-425.7203 1709.1089,-423.4921"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="2541,-422.6019 1986,-422.6019 1986,-353.3994 2541,-353.3994 2541,-422.6019"/>
<text text-anchor="middle" x="2263.5" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">GGG being a specification format needn&#39;t respect this limitation. &#160;Orb</text>
<text text-anchor="middle" x="2263.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">does so by design. &#160;It is a simple consquence of the sort of markup we are</text>
<text text-anchor="middle" x="2263.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">using; there is no need to parse ***bold **inside bold** still bold*** twice,</text>
<text text-anchor="middle" x="2263.5" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">and this generalizes to all text styles. </text>
</g>
<!-- prose_27&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>prose_27&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2182.9658,-507.9266C2195.7756,-488.8512 2217.0054,-457.2373 2234.4523,-431.2564"/>
<polygon fill="#000000" stroke="#000000" points="2237.5372,-432.9408 2240.2065,-422.6877 2231.7259,-429.0383 2237.5372,-432.9408"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3107.5,-407.3012 2559.5,-407.3012 2559.5,-368.7 3107.5,-368.7 3107.5,-407.3012"/>
<text text-anchor="middle" x="2833.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">We do have to wire them up so that we don&#39;t cross the streams. &#160;Sans macros.</text>
<text text-anchor="middle" x="2833.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">By hand. </text>
</g>
<!-- prose_29&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>prose_29&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2635.3987,-511.3638C2672.2583,-488.4104 2747.2056,-441.7385 2793.6106,-412.8409"/>
<polygon fill="#000000" stroke="#000000" points="2795.5709,-415.7434 2802.2094,-407.4862 2791.8705,-409.8013 2795.5709,-415.7434"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="3157.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3157.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_32&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>block_32&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3157.5,-506.8082C3157.5,-483.6757 3157.5,-443.4843 3157.5,-416.3249"/>
<polygon fill="#000000" stroke="#000000" points="3161.0001,-416.2684 3157.5,-406.2684 3154.0001,-416.2685 3161.0001,-416.2684"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="3285.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3285.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 44&#45;50</text>
</g>
<!-- block_33&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>block_33&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3287.2344,-506.8082C3286.8967,-483.6757 3286.31,-443.4843 3285.9135,-416.3249"/>
<polygon fill="#000000" stroke="#000000" points="3289.4124,-416.2162 3285.7667,-406.2684 3282.4131,-416.3185 3289.4124,-416.2162"/>
</g>
<!-- codeblock_40 -->
<g id="node41" class="node">
<title>codeblock_40</title>
<ellipse fill="none" stroke="#000000" cx="3458.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3458.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 52&#45;73</text>
</g>
<!-- block_34&#45;&gt;codeblock_40 -->
<g id="edge40" class="edge">
<title>block_34&#45;&gt;codeblock_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3441.1558,-506.8082C3444.5328,-483.6757 3450.4002,-443.4843 3454.3651,-416.3249"/>
<polygon fill="#000000" stroke="#000000" points="3457.8518,-416.6692 3455.8332,-406.2684 3450.9253,-415.6579 3457.8518,-416.6692"/>
</g>
<!-- codeblock_42 -->
<g id="node43" class="node">
<title>codeblock_42</title>
<ellipse fill="none" stroke="#000000" cx="3784.5" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3784.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 75&#45;79</text>
</g>
<!-- block_35&#45;&gt;codeblock_42 -->
<g id="edge42" class="edge">
<title>block_35&#45;&gt;codeblock_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3658.4465,-507.9266C3683.6387,-483.959 3729.6367,-440.197 3758.5543,-412.6851"/>
<polygon fill="#000000" stroke="#000000" points="3761.038,-415.1531 3765.8705,-405.7246 3756.213,-410.0816 3761.038,-415.1531"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="3016.5,-176.6003 2962.5,-176.6003 2962.5,-140.6003 3016.5,-140.6003 3016.5,-176.6003"/>
</g>
<!-- prose_36&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>prose_36&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3141.2983,-372.1089C3134.1158,-365.651 3125.3074,-358.483 3116.5,-353.2006 3079.2001,-330.8293 3053.8063,-350.2234 3025.5,-317.2006 2993.9959,-280.4471 2988.5426,-221.7882 2988.3771,-187.0486"/>
<polygon fill="#000000" stroke="#000000" points="2991.8807,-186.7032 2988.4828,-176.668 2984.881,-186.6318 2991.8807,-186.7032"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="3170,-201.1004 3035,-201.1004 3035,-116.1001 3170,-116.1001 3170,-201.1004"/>
<text text-anchor="middle" x="3102.5" y="-185.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cg = L.Cg</text>
<text text-anchor="middle" x="3102.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = L.C</text>
<text text-anchor="middle" x="3102.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = L.P</text>
<text text-anchor="middle" x="3102.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cmt = L.Cmt</text>
<text text-anchor="middle" x="3102.5" y="-124.3002" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cb = L.Cb</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>codeblock_38&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3251.6225,-371.783C3228.6332,-359.4146 3198.8356,-340.5481 3178.5,-317.2006 3151.4869,-286.1866 3131.8595,-243.8991 3119.3243,-210.7888"/>
<polygon fill="#000000" stroke="#000000" points="3122.5596,-209.4458 3115.8192,-201.2716 3115.9909,-211.865 3122.5596,-209.4458"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="3729,-317.3009 3188,-317.3009 3188,.1003 3729,.1003 3729,-317.3009"/>
<text text-anchor="middle" x="3458.5" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="3458.5" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="3458.5" y="-271.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="3458.5" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="3458.5" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3458.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="3458.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="3458.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="3458.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="3458.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="3458.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="3458.5" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="3458.5" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3458.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="3458.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="3458.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="3458.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="3458.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
</g>
<!-- codeblock_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>codeblock_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3458.5,-370C3458.5,-359.2281 3458.5,-344.36 3458.5,-327.4549"/>
<polygon fill="#000000" stroke="#000000" points="3462.0001,-327.2815 3458.5,-317.2816 3455.0001,-327.2816 3462.0001,-327.2815"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3966,-185.8007 3747,-185.8007 3747,-131.3998 3966,-131.3998 3966,-185.8007"/>
<text text-anchor="middle" x="3856.5" y="-170.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Pr.toMarkdown(prose)</text>
<text text-anchor="middle" x="3856.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return prose.val</text>
<text text-anchor="middle" x="3856.5" y="-139.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3790.1497,-370C3801.9042,-332.549 3829.199,-245.5843 3844.8728,-195.6459"/>
<polygon fill="#000000" stroke="#000000" points="3848.2826,-196.4694 3847.9379,-185.8802 3841.6039,-194.3731 3848.2826,-196.4694"/>
</g>
<!-- prose_51 -->
<g id="node52" class="node">
<title>prose_51</title>
<ellipse fill="none" stroke="#000000" cx="4719.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4719.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_45&#45;&gt;prose_51 -->
<g id="edge51" class="edge">
<title>block_45&#45;&gt;prose_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5164.2083,-507.3716C5152.4939,-492.0005 5133.4255,-470.4003 5111.5,-458.8007 5050.9966,-426.7915 4849.6767,-401.9518 4761.4906,-392.333"/>
<polygon fill="#000000" stroke="#000000" points="4761.6316,-388.828 4751.3141,-391.236 4760.8813,-395.7877 4761.6316,-388.828"/>
</g>
<!-- prose_53 -->
<g id="node54" class="node">
<title>prose_53</title>
<ellipse fill="none" stroke="#000000" cx="5076.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5076.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_46&#45;&gt;prose_53 -->
<g id="edge53" class="edge">
<title>block_46&#45;&gt;prose_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5292.5531,-507.3664C5280.3299,-492.825 5261.4414,-472.4415 5241.5,-458.8007 5201.6917,-431.57 5149.7292,-411.3925 5114.8465,-399.6897"/>
<polygon fill="#000000" stroke="#000000" points="5115.6366,-396.2654 5105.0438,-396.4732 5113.4542,-402.9165 5115.6366,-396.2654"/>
</g>
<!-- prose_55 -->
<g id="node56" class="node">
<title>prose_55</title>
<ellipse fill="none" stroke="#000000" cx="5436.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5436.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_47&#45;&gt;prose_55 -->
<g id="edge55" class="edge">
<title>block_47&#45;&gt;prose_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5436.5,-506.8082C5436.5,-483.6757 5436.5,-443.4843 5436.5,-416.3249"/>
<polygon fill="#000000" stroke="#000000" points="5440.0001,-416.2684 5436.5,-406.2684 5433.0001,-416.2685 5440.0001,-416.2684"/>
</g>
<!-- prose_57 -->
<g id="node58" class="node">
<title>prose_57</title>
<ellipse fill="none" stroke="#000000" cx="5883.5" cy="-388.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5883.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_48&#45;&gt;prose_57 -->
<g id="edge57" class="edge">
<title>block_48&#45;&gt;prose_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5791.1406,-507.3709C5809.7886,-483.2693 5843.3294,-439.9193 5864.4496,-412.6223"/>
<polygon fill="#000000" stroke="#000000" points="5867.2239,-414.7562 5870.5752,-404.7053 5861.6876,-410.4726 5867.2239,-414.7562"/>
</g>
<!-- codeblock_59 -->
<g id="node60" class="node">
<title>codeblock_59</title>
<ellipse fill="none" stroke="#000000" cx="6281.5" cy="-388.0006" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="6281.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 97&#45;108</text>
</g>
<!-- block_49&#45;&gt;codeblock_59 -->
<g id="edge59" class="edge">
<title>block_49&#45;&gt;codeblock_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6174.3283,-507.3709C6195.7059,-483.56 6233.9503,-440.9625 6258.5012,-413.6173"/>
<polygon fill="#000000" stroke="#000000" points="6261.2656,-415.7772 6265.3419,-405.9979 6256.0568,-411.1007 6261.2656,-415.7772"/>
</g>
<!-- codeblock_61 -->
<g id="node62" class="node">
<title>codeblock_61</title>
<ellipse fill="none" stroke="#000000" cx="6626.5" cy="-388.0006" rx="85.9862" ry="18"/>
<text text-anchor="middle" x="6626.5" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 110&#45;112</text>
</g>
<!-- block_50&#45;&gt;codeblock_61 -->
<g id="edge61" class="edge">
<title>block_50&#45;&gt;codeblock_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6500.7377,-507.6496C6526.0256,-483.591 6571.8703,-439.9747 6600.67,-412.5751"/>
<polygon fill="#000000" stroke="#000000" points="6603.123,-415.0722 6607.9555,-405.6436 6598.2981,-410.0007 6603.123,-415.0722"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="4539,-185.9007 3984,-185.9007 3984,-131.2999 4539,-131.2999 4539,-185.9007"/>
<text text-anchor="middle" x="4261.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The prose parser will be a proper recursive grammar. &#160;This calls for some</text>
<text text-anchor="middle" x="4261.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">enhancements to epnf to allow assignment of Node metatables to matched spans.</text>
</g>
<!-- prose_51&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>prose_51&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4692.4333,-377.8783C4658.3705,-364.8938 4598.2955,-341.1746 4548.5,-317.2006 4465.7297,-277.3508 4373.2729,-224.7224 4316.2282,-191.2586"/>
<polygon fill="#000000" stroke="#000000" points="4317.778,-188.1096 4307.3838,-186.0573 4314.2295,-194.1436 4317.778,-188.1096"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="5133.5,-177.9009 4557.5,-177.9009 4557.5,-139.2997 5133.5,-139.2997 5133.5,-177.9009"/>
<text text-anchor="middle" x="4845.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ve been sloppy with the node constructor interface and will need to go through</text>
<text text-anchor="middle" x="4845.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">the whole =grym= directory and fix it into a consistent state. &#160;At some point.</text>
</g>
<!-- prose_53&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>prose_53&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5060.6224,-372.233C5021.6296,-333.5102 4920.818,-233.3967 4872.3285,-185.243"/>
<polygon fill="#000000" stroke="#000000" points="4874.5748,-182.5411 4865.0129,-177.9781 4869.6423,-187.508 4874.5748,-182.5411"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="5721,-193.2015 5152,-193.2015 5152,-123.999 5721,-123.999 5721,-193.2015"/>
<text text-anchor="middle" x="5436.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">Links give me a chance to design that interface to fit grammatically. For now,</text>
<text text-anchor="middle" x="5436.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">we&#39;re going to handroll another Link class, and write a simple either&#45;or parser</text>
<text text-anchor="middle" x="5436.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">over prose strings that finds links and puts the rest in a =raw= class, which</text>
<text text-anchor="middle" x="5436.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">shouldn&#39;t need an intermediate Node class. </text>
</g>
<!-- prose_55&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>prose_55&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5436.5,-370C5436.5,-334.4265 5436.5,-254.1793 5436.5,-203.4247"/>
<polygon fill="#000000" stroke="#000000" points="5440.0001,-203.3789 5436.5,-193.3789 5433.0001,-203.379 5440.0001,-203.3789"/>
</g>
<!-- leaf_58 -->
<g id="node59" class="node">
<title>leaf_58</title>
<polygon fill="none" stroke="#c0c0c0" points="6238,-176.6003 5739,-176.6003 5739,-140.6003 6238,-140.6003 6238,-176.6003"/>
<text text-anchor="middle" x="5988.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">This Link class needs to fit the constructor semantics of =epeg.Csp=.</text>
</g>
<!-- prose_57&#45;&gt;leaf_58 -->
<g id="edge58" class="edge">
<title>prose_57&#45;&gt;leaf_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5891.5648,-370.3809C5909.76,-330.6286 5954.1115,-233.7311 5975.9417,-186.0372"/>
<polygon fill="#000000" stroke="#000000" points="5979.1375,-187.4647 5980.117,-176.9152 5972.7725,-184.5513 5979.1375,-187.4647"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="6552.5,-239.7011 6256.5,-239.7011 6256.5,-77.4995 6552.5,-77.4995 6552.5,-239.7011"/>
<text text-anchor="middle" x="6404.5" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Prose, block)</text>
<text text-anchor="middle" x="6404.5" y="-193.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prose = setmetatable({},Pr)</text>
<text text-anchor="middle" x="6404.5" y="-177.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.id = &quot;prose&quot;</text>
<text text-anchor="middle" x="6404.5" y="-162.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;prose.val = &quot;&quot;</text>
<text text-anchor="middle" x="6404.5" y="-147.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,l in ipairs(block.lines) do</text>
<text text-anchor="middle" x="6404.5" y="-131.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose.val = prose.val .. l .. &quot;\n&quot;</text>
<text text-anchor="middle" x="6404.5" y="-116.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6404.5" y="-100.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return prose</text>
<text text-anchor="middle" x="6404.5" y="-85.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_59&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>codeblock_59&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6291.1516,-370C6305.1683,-343.8583 6332.1202,-293.5917 6356.2264,-248.6327"/>
<polygon fill="#000000" stroke="#000000" points="6359.3641,-250.1874 6361.005,-239.7204 6353.1949,-246.8795 6359.3641,-250.1874"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="6754.5,-176.6003 6570.5,-176.6003 6570.5,-140.6003 6754.5,-140.6003 6754.5,-176.6003"/>
<text text-anchor="middle" x="6662.5" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(pr, new)</text>
</g>
<!-- codeblock_61&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>codeblock_61&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6629.3249,-370C6635.5659,-330.2304 6650.5691,-234.6268 6658.0719,-186.8173"/>
<polygon fill="#000000" stroke="#000000" points="6661.5457,-187.2565 6659.6384,-176.8347 6654.6303,-186.1712 6661.5457,-187.2565"/>
</g>
</g>
</svg>