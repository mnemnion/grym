<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4003pt" height="1376pt"
 viewBox="0.00 0.00 4002.50 1375.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1371.6017)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1371.6017 3998.5,-1371.6017 3998.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="813" cy="-1349.6017" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="813" y="-1345.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 185</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="813" cy="-1277.6017" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="813" y="-1273.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;10</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M813,-1331.433C813,-1323.7326 813,-1314.576 813,-1306.0183"/>
<polygon fill="#000000" stroke="#000000" points="816.5001,-1306.0149 813,-1296.015 809.5001,-1306.015 816.5001,-1306.0149"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="611" cy="-1205.6017" rx="69.6687" ry="18"/>
<text text-anchor="middle" x="611" y="-1201.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Doc module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M774.0524,-1263.7194C741.9855,-1252.2896 696.2935,-1236.0033 661.433,-1223.5778"/>
<polygon fill="#000000" stroke="#000000" points="662.5028,-1220.2435 651.9081,-1220.1828 660.1525,-1226.8372 662.5028,-1220.2435"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="731" cy="-1205.6017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="731" y="-1201.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M793.5671,-1260.5387C782.3006,-1250.6461 767.9965,-1238.0864 755.9098,-1227.4737"/>
<polygon fill="#000000" stroke="#000000" points="758.1653,-1224.7964 748.3415,-1220.8284 753.5466,-1230.0565 758.1653,-1224.7964"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="813" cy="-1205.6017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="813" y="-1201.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M813,-1259.433C813,-1251.7326 813,-1242.576 813,-1234.0183"/>
<polygon fill="#000000" stroke="#000000" points="816.5001,-1234.0149 813,-1224.015 809.5001,-1234.015 816.5001,-1234.0149"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="915" cy="-1205.6017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="915" y="-1201.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.6572,-1260.9025C851.5539,-1250.3871 870.8695,-1236.7526 886.5937,-1225.6532"/>
<polygon fill="#000000" stroke="#000000" points="888.7577,-1228.4099 894.909,-1219.7836 884.7209,-1222.6911 888.7577,-1228.4099"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1491" cy="-1205.6017" rx="65.0143" ry="18"/>
<text text-anchor="middle" x="1491" y="-1201.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 11&#45;70</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M870.2216,-1271.5251C993.7463,-1258.4074 1285.0935,-1227.4679 1420.0719,-1213.1339"/>
<polygon fill="#000000" stroke="#000000" points="1420.7228,-1216.5845 1430.2972,-1212.048 1419.9835,-1209.6237 1420.7228,-1216.5845"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="652" cy="-1133.6017" rx="27" ry="18"/>
<text text-anchor="middle" x="652" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M713.8582,-1189.9788C702.6905,-1179.8006 687.9674,-1166.3821 675.6869,-1155.1897"/>
<polygon fill="#000000" stroke="#000000" points="677.78,-1152.3619 668.0314,-1148.2126 673.0648,-1157.5355 677.78,-1152.3619"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="729" cy="-1133.6017" rx="27" ry="18"/>
<text text-anchor="middle" x="729" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M795.1858,-1190.3323C783.0617,-1179.9403 766.8588,-1166.0521 753.5194,-1154.6183"/>
<polygon fill="#000000" stroke="#000000" points="755.5163,-1151.7201 745.6459,-1147.8696 750.9607,-1157.0349 755.5163,-1151.7201"/>
</g>
<!-- raw_11 -->
<g id="node12" class="node">
<title>raw_11</title>
<ellipse fill="none" stroke="#000000" cx="935" cy="-1133.6017" rx="27" ry="18"/>
<text text-anchor="middle" x="935" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_11 -->
<g id="edge11" class="edge">
<title>prose_5&#45;&gt;raw_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M919.9438,-1187.8039C922.1794,-1179.7558 924.8726,-1170.0605 927.3593,-1161.1083"/>
<polygon fill="#000000" stroke="#000000" points="930.7395,-1162.0162 930.0437,-1151.4442 923.9949,-1160.1426 930.7395,-1162.0162"/>
</g>
<!-- header_13 -->
<g id="node14" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1331" cy="-1133.6017" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1331" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_6&#45;&gt;header_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1456.676,-1190.1559C1431.4061,-1178.7844 1396.9922,-1163.2982 1370.5651,-1151.406"/>
<polygon fill="#000000" stroke="#000000" points="1371.7774,-1148.1135 1361.2218,-1147.2015 1368.9048,-1154.4969 1371.7774,-1148.1135"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1427" cy="-1133.6017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1427" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1475.1798,-1187.8039C1467.1184,-1178.7348 1457.1979,-1167.5743 1448.4584,-1157.7424"/>
<polygon fill="#000000" stroke="#000000" points="1451.0204,-1155.3563 1441.7607,-1150.2075 1445.7885,-1160.0069 1451.0204,-1155.3563"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="1555" cy="-1133.6017" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1555" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;28</text>
</g>
<!-- section_6&#45;&gt;codeblock_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;codeblock_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1506.8202,-1187.8039C1514.5126,-1179.15 1523.8978,-1168.5917 1532.3344,-1159.1005"/>
<polygon fill="#000000" stroke="#000000" points="1535.1122,-1161.2436 1539.14,-1151.4442 1529.8803,-1156.5931 1535.1122,-1161.2436"/>
</g>
<!-- section_16 -->
<g id="node17" class="node">
<title>section_16</title>
<ellipse fill="none" stroke="#000000" cx="1887" cy="-1133.6017" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1887" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 30&#45;70</text>
</g>
<!-- section_6&#45;&gt;section_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;section_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1545.6463,-1195.666C1617.9348,-1182.5226 1745.1696,-1159.389 1822.2146,-1145.3809"/>
<polygon fill="#000000" stroke="#000000" points="1823.0665,-1148.7834 1832.279,-1143.551 1821.8142,-1141.8963 1823.0665,-1148.7834"/>
</g>
<!-- section_17 -->
<g id="node18" class="node">
<title>section_17</title>
<ellipse fill="none" stroke="#000000" cx="2807" cy="-1133.6017" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2807" y="-1129.4017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 71&#45;185</text>
</g>
<!-- section_6&#45;&gt;section_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;section_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1554.9182,-1202.1046C1773.1209,-1190.1665 2488.3077,-1151.0377 2727.9424,-1137.927"/>
<polygon fill="#000000" stroke="#000000" points="2728.1774,-1141.4195 2737.9712,-1137.3783 2727.7949,-1134.43 2728.1774,-1141.4195"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="520,-1064.7031 0,-1064.7031 0,-1008.9001 520,-1008.9001 520,-1064.7031"/>
<text text-anchor="middle" x="260" y="-1017.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> Represents a Document, which is generally the same as a file, at first.</text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M626.5818,-1127.3249C577.9815,-1115.3236 469.0125,-1088.4149 382.4399,-1067.0368"/>
<polygon fill="#000000" stroke="#000000" points="383.0825,-1063.5904 372.535,-1064.5909 381.4043,-1070.3863 383.0825,-1063.5904"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="841.5,-1056.7037 538.5,-1056.7037 538.5,-1016.8995 841.5,-1016.8995 841.5,-1056.7037"/>
<text text-anchor="middle" x="690" y="-1025.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> A document contains an array of blocks. </text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M721.8468,-1115.8471C716.2744,-1102.016 708.4167,-1082.5129 701.9009,-1066.3404"/>
<polygon fill="#000000" stroke="#000000" points="705.0333,-1064.7491 698.0498,-1056.7816 698.5404,-1067.3651 705.0333,-1064.7491"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1324,-1072.102 860,-1072.102 860,-1001.5013 1324,-1001.5013 1324,-1072.102"/>
<text text-anchor="middle" x="1092" y="-1041.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> At some point documents can also contain documents, this is not</text>
<text text-anchor="middle" x="1092" y="-1025.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> currently supported.</text>
</g>
<!-- raw_11&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>raw_11&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M954.8842,-1121.3419C972.8242,-1110.2807 1000.2537,-1093.3688 1025.8781,-1077.5698"/>
<polygon fill="#000000" stroke="#000000" points="1027.8074,-1080.4921 1034.4826,-1072.2646 1024.1336,-1074.5336 1027.8074,-1080.4921"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1369" cy="-1036.8016" rx="27" ry="18"/>
<text text-anchor="middle" x="1369" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_14&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_14&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1416.6308,-1116.2958C1407.6682,-1101.3376 1394.5885,-1079.508 1384.4021,-1062.5073"/>
<polygon fill="#000000" stroke="#000000" points="1387.2273,-1060.4127 1379.0852,-1053.6335 1381.2227,-1064.0105 1387.2273,-1060.4127"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1696,-1079.4027 1414,-1079.4027 1414,-994.2006 1696,-994.2006 1696,-1079.4027"/>
<text text-anchor="middle" x="1555" y="-1064.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="1555" y="-1033.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;node/node&quot;</text>
<text text-anchor="middle" x="1555" y="-1017.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Section = require &quot;grym/section&quot;</text>
<text text-anchor="middle" x="1555" y="-1002.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local own = require &quot;grym/own&quot;</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_15&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1555,-1115.3943C1555,-1107.9135 1555,-1098.8305 1555,-1089.5326"/>
<polygon fill="#000000" stroke="#000000" points="1558.5001,-1089.4246 1555,-1079.4246 1551.5001,-1089.4247 1558.5001,-1089.4246"/>
</g>
<!-- header_21 -->
<g id="node22" class="node">
<title>header_21</title>
<ellipse fill="none" stroke="#000000" cx="1813" cy="-1036.8016" rx="99.1453" ry="18"/>
<text text-anchor="middle" x="1813" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Metatable for Docs.</text>
</g>
<!-- section_16&#45;&gt;header_21 -->
<g id="edge21" class="edge">
<title>section_16&#45;&gt;header_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1873.4273,-1115.8471C1862.1283,-1101.0668 1845.8777,-1079.8093 1833.0741,-1063.0607"/>
<polygon fill="#000000" stroke="#000000" points="1835.5912,-1060.5904 1826.7373,-1054.7715 1830.03,-1064.8417 1835.5912,-1060.5904"/>
</g>
<!-- prose_22 -->
<g id="node23" class="node">
<title>prose_22</title>
<ellipse fill="none" stroke="#000000" cx="1962" cy="-1036.8016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1962" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_22 -->
<g id="edge22" class="edge">
<title>section_16&#45;&gt;prose_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1900.7562,-1115.8471C1912.4959,-1100.6949 1929.5099,-1078.7356 1942.6272,-1061.8054"/>
<polygon fill="#000000" stroke="#000000" points="1945.725,-1063.5217 1949.083,-1053.4731 1940.1916,-1059.2344 1945.725,-1063.5217"/>
</g>
<!-- codeblock_23 -->
<g id="node24" class="node">
<title>codeblock_23</title>
<ellipse fill="none" stroke="#000000" cx="2090" cy="-1036.8016" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2090" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 32&#45;68</text>
</g>
<!-- section_16&#45;&gt;codeblock_23 -->
<g id="edge23" class="edge">
<title>section_16&#45;&gt;codeblock_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1920.8451,-1118.0791C1944.0296,-1107.3888 1975.4493,-1092.7893 2003,-1079.6017 2017.6969,-1072.5668 2033.7179,-1064.7327 2047.9606,-1057.7097"/>
<polygon fill="#000000" stroke="#000000" points="2049.6162,-1060.7956 2057.0314,-1053.2282 2046.5156,-1054.5198 2049.6162,-1060.7956"/>
</g>
<!-- header_27 -->
<g id="node28" class="node">
<title>header_27</title>
<ellipse fill="none" stroke="#000000" cx="2332" cy="-1036.8016" rx="86.074" ry="18"/>
<text text-anchor="middle" x="2332" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Doc Constructor</text>
</g>
<!-- section_17&#45;&gt;header_27 -->
<g id="edge27" class="edge">
<title>section_17&#45;&gt;header_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2738.0224,-1129.5424C2661.1324,-1123.6971 2533.6988,-1110.048 2428,-1079.6017 2409.384,-1074.2394 2389.6983,-1065.9639 2373.0316,-1058.1137"/>
<polygon fill="#000000" stroke="#000000" points="2374.1261,-1054.7559 2363.5983,-1053.5659 2371.0863,-1061.0614 2374.1261,-1054.7559"/>
</g>
<!-- prose_28 -->
<g id="node29" class="node">
<title>prose_28</title>
<ellipse fill="none" stroke="#000000" cx="2469" cy="-1036.8016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2469" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_28 -->
<g id="edge28" class="edge">
<title>section_17&#45;&gt;prose_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2742.1804,-1126.4172C2667.5389,-1117.3423 2550.1684,-1100.3751 2511,-1079.6017 2502.5386,-1075.1141 2494.7345,-1068.3243 2488.2081,-1061.4666"/>
<polygon fill="#000000" stroke="#000000" points="2490.4204,-1058.6855 2481.1707,-1053.5189 2485.1796,-1063.326 2490.4204,-1058.6855"/>
</g>
<!-- codeblock_29 -->
<g id="node30" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="2597" cy="-1036.8016" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2597" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 74&#45;92</text>
</g>
<!-- section_17&#45;&gt;codeblock_29 -->
<g id="edge29" class="edge">
<title>section_17&#45;&gt;codeblock_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2770.4848,-1118.0649C2745.9161,-1107.4903 2712.8632,-1093.0295 2684,-1079.6017 2669.1015,-1072.6706 2652.915,-1064.8021 2638.5892,-1057.719"/>
<polygon fill="#000000" stroke="#000000" points="2639.9894,-1054.5066 2629.4759,-1053.1955 2636.8771,-1060.7766 2639.9894,-1054.5066"/>
</g>
<!-- prose_30 -->
<g id="node31" class="node">
<title>prose_30</title>
<ellipse fill="none" stroke="#000000" cx="2725" cy="-1036.8016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2725" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_30 -->
<g id="edge30" class="edge">
<title>section_17&#45;&gt;prose_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2791.9599,-1115.8471C2778.9272,-1100.4621 2759.9495,-1078.0592 2745.5228,-1061.0286"/>
<polygon fill="#000000" stroke="#000000" points="2747.9865,-1058.522 2738.8522,-1053.154 2742.6453,-1063.0466 2747.9865,-1058.522"/>
</g>
<!-- prose_31 -->
<g id="node32" class="node">
<title>prose_31</title>
<ellipse fill="none" stroke="#000000" cx="2807" cy="-1036.8016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2807" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_31 -->
<g id="edge31" class="edge">
<title>section_17&#45;&gt;prose_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2807,-1115.3943C2807,-1101.1977 2807,-1081.2309 2807,-1064.9755"/>
<polygon fill="#000000" stroke="#000000" points="2810.5001,-1064.9273 2807,-1054.9273 2803.5001,-1064.9274 2810.5001,-1064.9273"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="3039" cy="-1036.8016" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3039" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 105&#45;154</text>
</g>
<!-- section_17&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>section_17&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2844.0176,-1118.1564C2883.8252,-1101.547 2947.2654,-1075.0771 2990.9094,-1056.867"/>
<polygon fill="#000000" stroke="#000000" points="2992.2985,-1060.0799 3000.1796,-1052.9991 2989.603,-1053.6197 2992.2985,-1060.0799"/>
</g>
<!-- prose_33 -->
<g id="node34" class="node">
<title>prose_33</title>
<ellipse fill="none" stroke="#000000" cx="3251" cy="-1036.8016" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3251" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_33 -->
<g id="edge33" class="edge">
<title>section_17&#45;&gt;prose_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2872.182,-1126.5802C2938.9273,-1118.5289 3045.3076,-1103.3005 3135,-1079.6017 3162.66,-1072.2932 3192.9602,-1060.9941 3215.6546,-1051.8403"/>
<polygon fill="#000000" stroke="#000000" points="3217.2661,-1054.9626 3225.1968,-1047.9373 3214.6161,-1048.4837 3217.2661,-1054.9626"/>
</g>
<!-- structure_34 -->
<g id="node35" class="node">
<title>structure_34</title>
<ellipse fill="none" stroke="#000000" cx="3445" cy="-1036.8016" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3445" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_17&#45;&gt;structure_34 -->
<g id="edge34" class="edge">
<title>section_17&#45;&gt;structure_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2875.7995,-1129.4611C2970.2864,-1122.9769 3145.209,-1108.1104 3292,-1079.6017 3329.0977,-1072.3968 3370.3114,-1060.6444 3400.609,-1051.2759"/>
<polygon fill="#000000" stroke="#000000" points="3401.9442,-1054.5255 3410.4436,-1048.2001 3399.8547,-1047.8446 3401.9442,-1054.5255"/>
</g>
<!-- structure_35 -->
<g id="node36" class="node">
<title>structure_35</title>
<ellipse fill="none" stroke="#000000" cx="3595" cy="-1036.8016" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3595" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_17&#45;&gt;structure_35 -->
<g id="edge35" class="edge">
<title>section_17&#45;&gt;structure_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2877.0723,-1131.1616C3028.6535,-1125.3913 3382.7123,-1109.1252 3499,-1079.6017 3519.7434,-1074.3353 3541.6293,-1064.9112 3559.2571,-1056.2444"/>
<polygon fill="#000000" stroke="#000000" points="3561.2285,-1059.1699 3568.5779,-1051.5386 3558.0737,-1052.9211 3561.2285,-1059.1699"/>
</g>
<!-- codeblock_36 -->
<g id="node37" class="node">
<title>codeblock_36</title>
<ellipse fill="none" stroke="#000000" cx="3819" cy="-1036.8016" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3819" y="-1032.6016" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 165&#45;184</text>
</g>
<!-- section_17&#45;&gt;codeblock_36 -->
<g id="edge36" class="edge">
<title>section_17&#45;&gt;codeblock_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2876.9127,-1130.7652C3051.0636,-1123.4345 3500.8459,-1102.8032 3649,-1079.6017 3686.3318,-1073.7554 3727.4387,-1063.5128 3759.8781,-1054.5133"/>
<polygon fill="#000000" stroke="#000000" points="3760.9731,-1057.8412 3769.6535,-1051.7665 3759.0795,-1051.1022 3760.9731,-1057.8412"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1608,-665.9015 1130,-665.9015 1130,-501.1002 1608,-501.1002 1608,-665.9015"/>
<text text-anchor="middle" x="1369" y="-602.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> In addition to the standard Node fields, a doc has:</text>
<text text-anchor="middle" x="1369" y="-587.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1369" y="-571.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; latest: The current block. &#160;This will be in `doc[#doc]` but may</text>
<text text-anchor="middle" x="1369" y="-556.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;be several layers deep.</text>
<text text-anchor="middle" x="1369" y="-540.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lastOf: An array containing references to the last block of a</text>
<text text-anchor="middle" x="1369" y="-525.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;given level.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369,-1018.752C1369,-962.3051 1369,-786.3347 1369,-676.1928"/>
<polygon fill="#000000" stroke="#000000" points="1372.5001,-676.0755 1369,-666.0755 1365.5001,-676.0755 1372.5001,-676.0755"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1827" cy="-583.5009" rx="27" ry="18"/>
<text text-anchor="middle" x="1827" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_22&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_22&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1948.0754,-1020.3957C1940.5207,-1011.9977 1930.7519,-1001.9067 1921,-994.0016 1897.4313,-974.8963 1879.0019,-983.7781 1863,-958.0016 1793.4911,-846.0336 1811.187,-677.9265 1821.804,-611.7261"/>
<polygon fill="#000000" stroke="#000000" points="1825.2925,-612.0859 1823.4951,-601.6447 1818.3889,-610.9278 1825.2925,-612.0859"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2308,-859.2018 1872,-859.2018 1872,-307.7999 2308,-307.7999 2308,-859.2018"/>
<text text-anchor="middle" x="2090" y="-843.9013" font-family="Inconsolata" font-size="14.00" fill="#000000">local D = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="2090" y="-828.5013" font-family="Inconsolata" font-size="14.00" fill="#000000">D.id = &quot;doc&quot;</text>
<text text-anchor="middle" x="2090" y="-797.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__tostring = function (doc)</text>
<text text-anchor="middle" x="2090" y="-781.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2090" y="-766.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(doc) do</text>
<text text-anchor="middle" x="2090" y="-750.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local repr = tostring(v)</text>
<text text-anchor="middle" x="2090" y="-735.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if repr ~= &quot;&quot; and repr ~= &quot;\n&quot; then</text>
<text text-anchor="middle" x="2090" y="-720.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. repr .. &quot;\n&quot;</text>
<text text-anchor="middle" x="2090" y="-704.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2090" y="-689.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2090" y="-657.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase </text>
<text text-anchor="middle" x="2090" y="-642.501" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2090" y="-595.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__index = D</text>
<text text-anchor="middle" x="2090" y="-563.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">D.own = own</text>
<text text-anchor="middle" x="2090" y="-532.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.dotLabel(doc)</text>
<text text-anchor="middle" x="2090" y="-516.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;doc &#45; &quot; .. tostring(doc.linum)</text>
<text text-anchor="middle" x="2090" y="-501.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">end </text>
<text text-anchor="middle" x="2090" y="-470.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.toMarkdown(doc)</text>
<text text-anchor="middle" x="2090" y="-454.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2090" y="-439.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, node in ipairs(doc) do</text>
<text text-anchor="middle" x="2090" y="-423.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="2090" y="-408.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="2090" y="-393.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else </text>
<text text-anchor="middle" x="2090" y="-377.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;no toMarkdown method for &quot; .. node.id)</text>
<text text-anchor="middle" x="2090" y="-362.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2090" y="-346.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2090" y="-331.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="2090" y="-316.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_23&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_23&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2090,-1018.752C2090,-990.8128 2090,-933.5916 2090,-869.5644"/>
<polygon fill="#000000" stroke="#000000" points="2093.5001,-869.2334 2090,-859.2334 2086.5001,-869.2335 2093.5001,-869.2334"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1854,-140.5001 1800,-140.5001 1800,-104.5001 1854,-104.5001 1854,-140.5001"/>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1827,-565.4291C1827,-494.7876 1827,-236.9836 1827,-150.7867"/>
<polygon fill="#000000" stroke="#000000" points="1830.5001,-150.6966 1827,-140.6966 1823.5001,-150.6967 1830.5001,-150.6966"/>
</g>
<!-- raw_37 -->
<g id="node38" class="node">
<title>raw_37</title>
<ellipse fill="none" stroke="#000000" cx="2353" cy="-583.5009" rx="27" ry="18"/>
<text text-anchor="middle" x="2353" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_28&#45;&gt;raw_37 -->
<g id="edge37" class="edge">
<title>prose_28&#45;&gt;raw_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2453.5786,-1020.8112C2445.6965,-1012.7088 2435.9111,-1002.7573 2427,-994.0016 2410.4055,-977.6964 2399.2056,-978.908 2389,-958.0016 2331.4418,-840.0918 2342.0473,-676.6352 2349.2829,-611.7117"/>
<polygon fill="#000000" stroke="#000000" points="2352.7964,-611.8022 2350.4909,-601.4612 2345.8445,-610.9828 2352.7964,-611.8022"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2631.5,-719.1016 2398.5,-719.1016 2398.5,-447.9001 2631.5,-447.9001 2631.5,-719.1016"/>
<text text-anchor="middle" x="2515" y="-704.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local d = {}</text>
<text text-anchor="middle" x="2515" y="-656.701" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.parentOf(doc, level)</text>
<text text-anchor="middle" x="2515" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = level &#45; 1</text>
<text text-anchor="middle" x="2515" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local parent = nil</text>
<text text-anchor="middle" x="2515" y="-610.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;while i &gt; 0 do</text>
<text text-anchor="middle" x="2515" y="-595.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;parent = doc.lastOf[i]</text>
<text text-anchor="middle" x="2515" y="-579.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent then</text>
<text text-anchor="middle" x="2515" y="-564.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return parent</text>
<text text-anchor="middle" x="2515" y="-548.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2515" y="-533.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i = i &#45; 1</text>
<text text-anchor="middle" x="2515" y="-518.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2515" y="-502.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2515" y="-471.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="2515" y="-455.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>codeblock_29&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593.7349,-1018.752C2585.0476,-970.7282 2560.7104,-836.1906 2541.371,-729.2812"/>
<polygon fill="#000000" stroke="#000000" points="2544.7992,-728.57 2539.575,-719.3528 2537.911,-729.8161 2544.7992,-728.57"/>
</g>
<!-- raw_40 -->
<g id="node41" class="node">
<title>raw_40</title>
<ellipse fill="none" stroke="#000000" cx="2677" cy="-583.5009" rx="27" ry="18"/>
<text text-anchor="middle" x="2677" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_30&#45;&gt;raw_40 -->
<g id="edge40" class="edge">
<title>prose_30&#45;&gt;raw_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2721.9504,-1018.6881C2719.3354,-1002.7418 2715.5907,-978.8756 2713,-958.0016 2697.0249,-829.2841 2684.1722,-674.9205 2679.21,-612.1468"/>
<polygon fill="#000000" stroke="#000000" points="2682.6741,-611.5512 2678.4026,-601.8557 2675.6956,-612.0988 2682.6741,-611.5512"/>
</g>
<!-- raw_42 -->
<g id="node43" class="node">
<title>raw_42</title>
<ellipse fill="none" stroke="#000000" cx="2749" cy="-583.5009" rx="27" ry="18"/>
<text text-anchor="middle" x="2749" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_42 -->
<g id="edge42" class="edge">
<title>prose_31&#45;&gt;raw_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2801.0137,-1018.8619C2795.9661,-1003.027 2788.9511,-979.2266 2785,-958.0016 2761.2067,-830.1842 2752.6495,-674.7235 2750.0196,-611.8801"/>
<polygon fill="#000000" stroke="#000000" points="2753.5049,-611.4402 2749.608,-601.5881 2746.5105,-611.72 2753.5049,-611.4402"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="3377.5,-958.0023 2794.5,-958.0023 2794.5,-208.9995 3377.5,-208.9995 3377.5,-958.0023"/>
<text text-anchor="middle" x="3086" y="-942.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addSection(doc, section, linum, finish)</text>
<text text-anchor="middle" x="3086" y="-927.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.id == &quot;section&quot;, &quot;type of putative section is &quot; .. section.id)</text>
<text text-anchor="middle" x="3086" y="-912.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(section.first, &quot;no first in section at line &quot; .. tostring(linum))</text>
<text text-anchor="middle" x="3086" y="-896.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(type(finish) == &quot;number&quot;, &quot;finish is of type &quot; .. type(finish))</text>
<text text-anchor="middle" x="3086" y="-881.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not doc.latest then</text>
<text text-anchor="middle" x="3086" y="-865.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = &#160;section</text>
<text text-anchor="middle" x="3086" y="-850.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3086" y="-835.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if linum &gt; 0 then</text>
<text text-anchor="middle" x="3086" y="-819.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.line_last = linum &#45; 1</text>
<text text-anchor="middle" x="3086" y="-804.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.last = finish &#160;&#160;</text>
<text text-anchor="middle" x="3086" y="-788.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-773.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local atLevel = doc.latest.level </text>
<text text-anchor="middle" x="3086" y="-758.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if atLevel &lt; section.level then</text>
<text text-anchor="middle" x="3086" y="-742.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; add the section under the latest section</text>
<text text-anchor="middle" x="3086" y="-727.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum, finish)</text>
<text text-anchor="middle" x="3086" y="-711.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3086" y="-696.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local parent = doc:parentOf(section.level)</text>
<text text-anchor="middle" x="3086" y="-681.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent.id == &quot;doc&quot; then</text>
<text text-anchor="middle" x="3086" y="-665.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if section.level == 1 and doc.latest.level == 1 then</text>
<text text-anchor="middle" x="3086" y="-650.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[#doc + 1] = section</text>
<text text-anchor="middle" x="3086" y="-634.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3086" y="-619.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum, finish)</text>
<text text-anchor="middle" x="3086" y="-604.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-588.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3086" y="-573.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;parent:addSection(section, linum, finish)</text>
<text text-anchor="middle" x="3086" y="-557.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-542.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-527.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-511.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = section</text>
<text text-anchor="middle" x="3086" y="-496.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf[section.level] = section</text>
<text text-anchor="middle" x="3086" y="-480.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3086" y="-465.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3086" y="-418.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addLine(doc, line, linum, finish)</text>
<text text-anchor="middle" x="3086" y="-402.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if doc.latest then</text>
<text text-anchor="middle" x="3086" y="-387.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3086" y="-371.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.last = finish</text>
<text text-anchor="middle" x="3086" y="-356.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3086" y="-341.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; a virtual zero block</text>
<text text-anchor="middle" x="3086" y="-325.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = Section(0, linum, 1, #line, doc.str)</text>
<text text-anchor="middle" x="3086" y="-310.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest = doc[1]</text>
<text text-anchor="middle" x="3086" y="-294.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3086" y="-279.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.last = finish</text>
<text text-anchor="middle" x="3086" y="-264.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3086" y="-232.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3086" y="-217.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_32&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3040.8715,-1018.752C3042.1095,-1006.8112 3043.9022,-989.5218 3046.0674,-968.6384"/>
<polygon fill="#000000" stroke="#000000" points="3049.5734,-968.7607 3047.1235,-958.453 3042.6108,-968.0387 3049.5734,-968.7607"/>
</g>
<!-- raw_45 -->
<g id="node46" class="node">
<title>raw_45</title>
<ellipse fill="none" stroke="#000000" cx="3423" cy="-583.5009" rx="27" ry="18"/>
<text text-anchor="middle" x="3423" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_33&#45;&gt;raw_45 -->
<g id="edge45" class="edge">
<title>prose_33&#45;&gt;raw_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3279.9564,-1028.7562C3312.0062,-1018.1991 3362.3798,-996.3497 3387,-958.0016 3458.1999,-847.1012 3439.5295,-678.3789 3428.4237,-611.8698"/>
<polygon fill="#000000" stroke="#000000" points="3431.823,-610.9895 3426.656,-601.7401 3424.9272,-612.1929 3431.823,-610.9895"/>
</g>
<!-- handleline_47 -->
<g id="node48" class="node">
<title>handleline_47</title>
<ellipse fill="none" stroke="#000000" cx="3518" cy="-583.5009" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3518" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_34&#45;&gt;handleline_47 -->
<g id="edge47" class="edge">
<title>structure_34&#45;&gt;handleline_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3448.326,-1018.6661C3451.2282,-1002.7057 3455.5092,-978.8312 3459,-958.0016 3480.6475,-828.83 3504.2892,-674.1977 3513.7457,-611.7302"/>
<polygon fill="#000000" stroke="#000000" points="3517.2072,-612.2477 3515.2414,-601.8369 3510.2858,-611.2013 3517.2072,-612.2477"/>
</g>
<!-- handleline_50 -->
<g id="node51" class="node">
<title>handleline_50</title>
<ellipse fill="none" stroke="#000000" cx="3637" cy="-583.5009" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3637" y="-579.3009" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_35&#45;&gt;handleline_50 -->
<g id="edge50" class="edge">
<title>structure_35&#45;&gt;handleline_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3596.6724,-1018.752C3603.1327,-949.0263 3626.4905,-696.9285 3634.3776,-611.804"/>
<polygon fill="#000000" stroke="#000000" points="3637.8853,-611.8824 3635.3229,-601.6021 3630.9151,-611.2365 3637.8853,-611.8824"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3994.5,-727.0013 3705.5,-727.0013 3705.5,-440.0004 3994.5,-440.0004 3994.5,-727.0013"/>
<text text-anchor="middle" x="3850" y="-711.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Doc, str)</text>
<text text-anchor="middle" x="3850" y="-696.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local doc = setmetatable({}, D)</text>
<text text-anchor="middle" x="3850" y="-681.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.str = str</text>
<text text-anchor="middle" x="3850" y="-665.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.first = 1</text>
<text text-anchor="middle" x="3850" y="-650.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.last = #str</text>
<text text-anchor="middle" x="3850" y="-634.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = nil</text>
<text text-anchor="middle" x="3850" y="-619.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lines = {}</text>
<text text-anchor="middle" x="3850" y="-604.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf = {}</text>
<text text-anchor="middle" x="3850" y="-588.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; for now lets set root to &#39;false&#39;</text>
<text text-anchor="middle" x="3850" y="-573.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.root = false</text>
<text text-anchor="middle" x="3850" y="-557.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc:own(str)</text>
<text text-anchor="middle" x="3850" y="-542.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3850" y="-511.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">setmetatable(D, Node)</text>
<text text-anchor="middle" x="3850" y="-479.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">d[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="3850" y="-448.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, d)</text>
</g>
<!-- codeblock_36&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>codeblock_36&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3820.2344,-1018.752C3823.4362,-971.9331 3832.2613,-842.887 3839.4767,-737.3784"/>
<polygon fill="#000000" stroke="#000000" points="3842.9792,-737.4604 3840.1697,-727.2449 3835.9955,-736.9827 3842.9792,-737.4604"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="2380,-142.5001 2326,-142.5001 2326,-102.5001 2380,-102.5001 2380,-142.5001"/>
</g>
<!-- raw_37&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>raw_37&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2353,-565.4291C2353,-495.3549 2353,-241.112 2353,-152.8963"/>
<polygon fill="#000000" stroke="#000000" points="2356.5001,-152.75 2353,-142.75 2349.5001,-152.75 2356.5001,-152.75"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="2859.5,-173.0002 2430.5,-173.0002 2430.5,-71.9999 2859.5,-71.9999 2859.5,-173.0002"/>
<text text-anchor="middle" x="2645" y="-141.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> This function looks at document level and places the block</text>
<text text-anchor="middle" x="2645" y="-126.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> accordingly.</text>
<text text-anchor="middle" x="2645" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="2645" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; doc : the document</text>
<text text-anchor="middle" x="2645" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; block : block to be appended</text>
</g>
<!-- raw_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>raw_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2675.7456,-565.4291C2671.3618,-502.276 2656.5948,-289.5376 2649.2382,-183.5564"/>
<polygon fill="#000000" stroke="#000000" points="2652.7127,-183.0672 2648.5286,-173.3336 2645.7295,-183.552 2652.7127,-183.0672"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3048,-150.4016 2878,-150.4016 2878,-94.5986 3048,-94.5986 3048,-150.4016"/>
<text text-anchor="middle" x="2963" y="-119.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> returns: the document</text>
</g>
<!-- raw_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>raw_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2744.9314,-565.6822C2732.7902,-507.7347 2702.5519,-321.8737 2785,-209.0002 2808.9581,-176.2009 2832.4074,-190.6286 2869,-173.0002 2880.4572,-167.4807 2892.5291,-161.29 2904.0623,-155.1849"/>
<polygon fill="#000000" stroke="#000000" points="2906,-158.1181 2913.174,-150.3216 2902.7039,-151.9426 2906,-158.1181"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="3477,-142.4022 3321,-142.4022 3321,-102.598 3477,-102.598 3477,-142.4022"/>
<text text-anchor="middle" x="3399" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Creates a Doc Node.</text>
</g>
<!-- raw_45&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>raw_45&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3422.0592,-565.4291C3418.4027,-495.1951 3405.1146,-239.9515 3400.5512,-152.2954"/>
<polygon fill="#000000" stroke="#000000" points="3404.0423,-152.0319 3400.027,-142.2274 3397.0517,-152.3959 3404.0423,-152.0319"/>
</g>
<!-- handle_48 -->
<g id="node49" class="node">
<title>handle_48</title>
<ellipse fill="none" stroke="#000000" cx="3532" cy="-122.5001" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3532" y="-118.3001" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_47&#45;&gt;handle_48 -->
<g id="edge48" class="edge">
<title>handleline_47&#45;&gt;handle_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3518.5488,-565.4291C3520.6941,-494.7876 3528.5233,-236.9836 3531.141,-150.7867"/>
<polygon fill="#000000" stroke="#000000" points="3534.6421,-150.7983 3531.4474,-140.6966 3527.6454,-150.5857 3534.6421,-150.7983"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="3559,-36 3505,-36 3505,0 3559,0 3559,-36"/>
</g>
<!-- handle_48&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>handle_48&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3532,-104.2976C3532,-88.3618 3532,-64.942 3532,-46.5196"/>
<polygon fill="#000000" stroke="#000000" points="3535.5001,-46.3445 3532,-36.3446 3528.5001,-46.3446 3535.5001,-46.3445"/>
</g>
<!-- handle_51 -->
<g id="node52" class="node">
<title>handle_51</title>
<ellipse fill="none" stroke="#000000" cx="3637" cy="-122.5001" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3637" y="-118.3001" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_50&#45;&gt;handle_51 -->
<g id="edge51" class="edge">
<title>handleline_50&#45;&gt;handle_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3637,-565.4291C3637,-494.7876 3637,-236.9836 3637,-150.7867"/>
<polygon fill="#000000" stroke="#000000" points="3640.5001,-150.6966 3637,-140.6966 3633.5001,-150.6967 3640.5001,-150.6966"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3664,-36 3610,-36 3610,0 3664,0 3664,-36"/>
</g>
<!-- handle_51&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>handle_51&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3637,-104.2976C3637,-88.3618 3637,-64.942 3637,-46.5196"/>
<polygon fill="#000000" stroke="#000000" points="3640.5001,-46.3445 3637,-36.3446 3633.5001,-46.3446 3640.5001,-46.3445"/>
</g>
</g>
</svg>