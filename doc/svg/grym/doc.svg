<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4251pt" height="1187pt"
 viewBox="0.00 0.00 4250.50 1187.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1183.4013)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1183.4013 4246.5,-1183.4013 4246.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1161.4013" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="770" y="-1157.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 175</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1089.4013" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="770" y="-1085.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;10</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770,-1143.2326C770,-1135.5322 770,-1126.3756 770,-1117.8179"/>
<polygon fill="#000000" stroke="#000000" points="773.5001,-1117.8145 770,-1107.8145 766.5001,-1117.8146 773.5001,-1117.8145"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="568" cy="-1017.4013" rx="69.6687" ry="18"/>
<text text-anchor="middle" x="568" y="-1013.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Doc module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M731.0524,-1075.519C698.9855,-1064.0892 653.2935,-1047.8029 618.433,-1035.3774"/>
<polygon fill="#000000" stroke="#000000" points="619.5028,-1032.0431 608.9081,-1031.9824 617.1525,-1038.6367 619.5028,-1032.0431"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="688" cy="-1017.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="688" y="-1013.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M750.5671,-1072.3383C739.3006,-1062.4457 724.9965,-1049.886 712.9098,-1039.2733"/>
<polygon fill="#000000" stroke="#000000" points="715.1653,-1036.596 705.3415,-1032.628 710.5466,-1041.8561 715.1653,-1036.596"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1017.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="770" y="-1013.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770,-1071.2326C770,-1063.5322 770,-1054.3756 770,-1045.8179"/>
<polygon fill="#000000" stroke="#000000" points="773.5001,-1045.8145 770,-1035.8145 766.5001,-1045.8146 773.5001,-1045.8145"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="932" cy="-1017.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="932" y="-1013.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.9605,-1074.3077C831.3489,-1062.1351 869.7176,-1045.0823 897.3009,-1032.8231"/>
<polygon fill="#000000" stroke="#000000" points="898.8554,-1035.9624 906.572,-1028.7026 896.0124,-1029.5657 898.8554,-1035.9624"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2188" cy="-1017.4013" rx="69.851" ry="18"/>
<text text-anchor="middle" x="2188" y="-1013.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 11&#45;175</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.024,-1086.3535C1055.6744,-1074.896 1853.2436,-1034.3988 2108.675,-1021.4291"/>
<polygon fill="#000000" stroke="#000000" points="2109.1718,-1024.9084 2118.9814,-1020.9058 2108.8167,-1017.9174 2109.1718,-1024.9084"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="520,-955.9027 0,-955.9027 0,-900.0998 520,-900.0998 520,-955.9027"/>
<text text-anchor="middle" x="260" y="-908.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> Represents a Document, which is generally the same as a file, at first.</text>
</g>
<!-- prose_3&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M663.635,-1005.6055C658.2447,-1003.3074 652.499,-1001.0907 647,-999.4013 590.356,-981.9992 527.6723,-968.193 469.5431,-957.5438"/>
<polygon fill="#000000" stroke="#000000" points="469.9658,-954.0635 459.5024,-955.7272 468.7195,-960.9517 469.9658,-954.0635"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="841.5,-947.9033 538.5,-947.9033 538.5,-908.0992 841.5,-908.0992 841.5,-947.9033"/>
<text text-anchor="middle" x="690" y="-916.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> A document contains an array of blocks. </text>
</g>
<!-- prose_4&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>prose_4&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M755.3268,-1001.0039C743.8799,-988.2121 727.7321,-970.1669 714.3553,-955.2183"/>
<polygon fill="#000000" stroke="#000000" points="716.9289,-952.8457 707.6523,-947.7277 711.7125,-957.5136 716.9289,-952.8457"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="1324,-963.3016 860,-963.3016 860,-892.7009 1324,-892.7009 1324,-963.3016"/>
<text text-anchor="middle" x="1092" y="-932.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> At some point documents can also contain documents, this is not</text>
<text text-anchor="middle" x="1092" y="-916.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> currently supported.</text>
</g>
<!-- prose_5&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>prose_5&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M954.9241,-1004.5924C972.0105,-995.0454 996.3448,-981.4486 1019.7801,-968.3541"/>
<polygon fill="#000000" stroke="#000000" points="1021.6784,-971.3028 1028.7009,-963.3696 1018.264,-965.192 1021.6784,-971.3028"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="1388" cy="-928.0012" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1388" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_6&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_6&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2117.9317,-1016.725C1957.3262,-1014.4677 1566.9322,-1004.7633 1443,-963.4013 1433.745,-960.3124 1424.5068,-955.3093 1416.3168,-950.0247"/>
<polygon fill="#000000" stroke="#000000" points="1418.119,-947.0169 1407.8899,-944.2572 1414.1654,-952.7936 1418.119,-947.0169"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="1484" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1484" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_6&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2118.9528,-1014.1538C1960.4168,-1006.3566 1579.8075,-985.5734 1526,-963.4013 1518.9684,-960.5038 1512.2419,-955.9762 1506.3127,-951.1152"/>
<polygon fill="#000000" stroke="#000000" points="1508.5653,-948.4345 1498.768,-944.4017 1503.912,-953.664 1508.5653,-948.4345"/>
</g>
<!-- codeblock_12 -->
<g id="node13" class="node">
<title>codeblock_12</title>
<ellipse fill="none" stroke="#000000" cx="1612" cy="-928.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1612" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;28</text>
</g>
<!-- section_6&#45;&gt;codeblock_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;codeblock_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2118.0921,-1015.7276C2022.2057,-1012.0723 1845.132,-1000.4365 1699,-963.4013 1684.3588,-959.6907 1668.9232,-954.0309 1655.1848,-948.3183"/>
<polygon fill="#000000" stroke="#000000" points="1656.5459,-945.0938 1645.9753,-944.3782 1653.7925,-951.5295 1656.5459,-945.0938"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1740" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1740" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2119.855,-1012.9728C2020.4302,-1005.7319 1841.0186,-989.4945 1782,-963.4013 1775.0443,-960.326 1768.3464,-955.7314 1762.4207,-950.8624"/>
<polygon fill="#000000" stroke="#000000" points="1764.6729,-948.1817 1754.867,-944.1697 1760.0307,-953.4211 1764.6729,-948.1817"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="1868" cy="-928.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1868" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 33&#45;67</text>
</g>
<!-- section_6&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2130.8215,-1006.788C2083.2311,-997.3284 2013.9757,-982.1037 1955,-963.4013 1941.2413,-959.0381 1926.596,-953.46 1913.3222,-948.0288"/>
<polygon fill="#000000" stroke="#000000" points="1914.5086,-944.7316 1903.9314,-944.1195 1911.8183,-951.194 1914.5086,-944.7316"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1996" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1996" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2138.7929,-1004.5095C2108.5431,-995.4346 2069.6519,-981.6479 2038,-963.4013 2031.783,-959.8173 2025.592,-955.2817 2019.9488,-950.6634"/>
<polygon fill="#000000" stroke="#000000" points="2021.9969,-947.8084 2012.1337,-943.9394 2017.4314,-953.1147 2021.9969,-947.8084"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="2124" cy="-928.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2124" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 72&#45;90</text>
</g>
<!-- section_6&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2175.0486,-999.3098C2165.7056,-986.2587 2152.9562,-968.4495 2142.5363,-953.8941"/>
<polygon fill="#000000" stroke="#000000" points="2145.3806,-951.8545 2136.7137,-945.7607 2139.6888,-955.9292 2145.3806,-951.8545"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="2252" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2252" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2200.9514,-999.3098C2210.4776,-986.0028 2223.545,-967.7493 2234.0739,-953.0417"/>
<polygon fill="#000000" stroke="#000000" points="2236.9588,-955.0247 2239.9339,-944.8561 2231.2669,-950.9499 2236.9588,-955.0247"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="2399" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2399" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2224.7534,-1001.829C2263.9386,-985.2263 2325.5351,-959.1281 2364.0254,-942.8199"/>
<polygon fill="#000000" stroke="#000000" points="2365.4434,-946.0204 2373.2855,-938.8964 2362.7124,-939.575 2365.4434,-946.0204"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="2663" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2663" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>section_6&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2244.8243,-1006.7063C2341.9809,-988.4204 2537.7198,-951.5803 2622.4142,-935.6399"/>
<polygon fill="#000000" stroke="#000000" points="2623.237,-939.0466 2632.417,-933.7573 2621.9422,-932.1674 2623.237,-939.0466"/>
</g>
<!-- codeblock_20 -->
<g id="node21" class="node">
<title>codeblock_20</title>
<ellipse fill="none" stroke="#000000" cx="2998" cy="-928.0012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2998" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 103&#45;145</text>
</g>
<!-- section_6&#45;&gt;codeblock_20 -->
<g id="edge20" class="edge">
<title>section_6&#45;&gt;codeblock_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2253.6058,-1010.8657C2351.6552,-1001.0233 2542.2149,-981.6058 2704,-963.4013 2774.5093,-955.4674 2854.4445,-945.799 2913.1483,-938.5724"/>
<polygon fill="#000000" stroke="#000000" points="2913.6208,-942.0407 2923.1175,-937.3435 2912.7644,-935.0933 2913.6208,-942.0407"/>
</g>
<!-- prose_21 -->
<g id="node22" class="node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="3336" cy="-928.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3336" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>section_6&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.4985,-1015.2909C2409.5152,-1010.2292 2782.8601,-995.3712 3094,-963.4013 3165.029,-956.103 3247.1637,-943.1181 3295.1656,-935.0666"/>
<polygon fill="#000000" stroke="#000000" points="3295.8854,-938.4947 3305.1629,-933.3781 3294.7196,-931.5924 3295.8854,-938.4947"/>
</g>
<!-- block_22 -->
<g id="node23" class="node">
<title>block_22</title>
<ellipse fill="none" stroke="#000000" cx="3677" cy="-928.0012" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="3677" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 150&#45;152</text>
</g>
<!-- section_6&#45;&gt;block_22 -->
<g id="edge22" class="edge">
<title>section_6&#45;&gt;block_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.8,-1015.9881C2441.3695,-1011.891 2952.7392,-998.0216 3377,-963.4013 3456.4304,-956.9196 3547.2673,-945.6597 3607.9819,-937.578"/>
<polygon fill="#000000" stroke="#000000" points="3608.7616,-941.0049 3618.2087,-936.2088 3607.8327,-934.0668 3608.7616,-941.0049"/>
</g>
<!-- block_23 -->
<g id="node24" class="node">
<title>block_23</title>
<ellipse fill="none" stroke="#000000" cx="3858" cy="-928.0012" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="3858" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 153&#45;155</text>
</g>
<!-- section_6&#45;&gt;block_23 -->
<g id="edge23" class="edge">
<title>section_6&#45;&gt;block_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.973,-1016.1694C2542.4342,-1011.0002 3604.0236,-990.0862 3752,-963.4013 3772.0695,-959.7821 3793.5279,-953.1672 3811.8515,-946.6266"/>
<polygon fill="#000000" stroke="#000000" points="3813.2171,-949.8538 3821.4009,-943.1252 3810.8073,-943.2817 3813.2171,-949.8538"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="4063" cy="-928.0012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4063" y="-923.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 156&#45;174</text>
</g>
<!-- section_6&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_6&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.8987,-1016.2086C2562.4356,-1010.8807 3765.6468,-988.4202 3933,-963.4013 3957.6862,-959.7107 3984.3798,-952.9462 4007.1181,-946.3115"/>
<polygon fill="#000000" stroke="#000000" points="4008.3504,-949.5964 4016.9334,-943.3849 4006.3503,-942.8882 4008.3504,-949.5964"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="745,-618.7013 267,-618.7013 267,-453.8999 745,-453.8999 745,-618.7013"/>
<text text-anchor="middle" x="506" y="-555.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> In addition to the standard Node fields, a doc has:</text>
<text text-anchor="middle" x="506" y="-539.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="506" y="-524.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; latest: The current block. &#160;This will be in `doc[#doc]` but may</text>
<text text-anchor="middle" x="506" y="-509.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;be several layers deep.</text>
<text text-anchor="middle" x="506" y="-493.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lastOf: An array containing references to the last block of a</text>
<text text-anchor="middle" x="506" y="-478.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;given level.</text>
</g>
<!-- prose_11&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>prose_11&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1469.7069,-911.47C1462.4888,-904.3198 1453.1216,-896.67 1443,-892.6012 1300.7436,-835.4162 889.8471,-927.6827 754,-856.6012 659.3913,-807.0975 589.7713,-703.6498 548.7774,-627.6566"/>
<polygon fill="#000000" stroke="#000000" points="551.7083,-625.7138 543.9203,-618.5307 545.529,-629.0027 551.7083,-625.7138"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1031,-578.9017 763,-578.9017 763,-493.6996 1031,-493.6996 1031,-578.9017"/>
<text text-anchor="middle" x="897" y="-563.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="897" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="897" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Block = require &quot;grym/section&quot;</text>
<text text-anchor="middle" x="897" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local own = require &quot;grym/own&quot;</text>
</g>
<!-- codeblock_12&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_12&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1578.9243,-911.693C1563.006,-904.5916 1543.4165,-896.9184 1525,-892.6012 1419.7782,-867.9349 1128.4283,-918.734 1040,-856.6012 950.8887,-793.9885 916.494,-662.5422 903.8557,-588.9914"/>
<polygon fill="#000000" stroke="#000000" points="907.2906,-588.3095 902.2133,-579.0105 900.3835,-589.4461 907.2906,-588.3095"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="1205,-564.2021 1049,-564.2021 1049,-508.3991 1205,-508.3991 1205,-564.2021"/>
<text text-anchor="middle" x="1127" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Metatable for Docs.</text>
</g>
<!-- prose_13&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>prose_13&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.2455,-911.5679C1717.8265,-904.4392 1708.2427,-896.7791 1698,-892.6012 1598.1353,-851.8675 1297.1872,-925.2459 1214,-856.6012 1129.2031,-786.6282 1122.4778,-643.0439 1124.5533,-574.4377"/>
<polygon fill="#000000" stroke="#000000" points="1128.0642,-574.2205 1124.9514,-564.0933 1121.0693,-573.9513 1128.0642,-574.2205"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="1659,-796.1015 1223,-796.1015 1223,-276.4997 1659,-276.4997 1659,-796.1015"/>
<text text-anchor="middle" x="1441" y="-781.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local D = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="1441" y="-749.601" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__tostring = function (doc)</text>
<text text-anchor="middle" x="1441" y="-734.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1441" y="-718.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(doc) do</text>
<text text-anchor="middle" x="1441" y="-703.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local repr = tostring(v)</text>
<text text-anchor="middle" x="1441" y="-688.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if repr ~= &quot;&quot; and repr ~= &quot;\n&quot; then</text>
<text text-anchor="middle" x="1441" y="-672.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. repr .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1441" y="-657.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-641.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase </text>
<text text-anchor="middle" x="1441" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1441" y="-563.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__index = D</text>
<text text-anchor="middle" x="1441" y="-532.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.own = own</text>
<text text-anchor="middle" x="1441" y="-500.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.dotLabel(doc)</text>
<text text-anchor="middle" x="1441" y="-485.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;doc &#45; &quot; .. tostring(doc.linum)</text>
<text text-anchor="middle" x="1441" y="-470.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">end </text>
<text text-anchor="middle" x="1441" y="-438.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.toMarkdown(doc)</text>
<text text-anchor="middle" x="1441" y="-423.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1441" y="-407.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, node in ipairs(doc) do</text>
<text text-anchor="middle" x="1441" y="-392.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="1441" y="-377.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="1441" y="-361.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1441" y="-346.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;no toMarkdown method for &quot; .. node.id)</text>
<text text-anchor="middle" x="1441" y="-330.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-315.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-300.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="1441" y="-284.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>codeblock_14&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1830.5637,-912.0219C1815.2959,-905.7009 1797.4056,-898.542 1781,-892.6012 1731.44,-874.6547 1710.5491,-887.7114 1668,-856.6012 1646.8999,-841.1737 1627.0273,-823.1802 1608.488,-803.7359"/>
<polygon fill="#000000" stroke="#000000" points="1610.8372,-801.1238 1601.4482,-796.2149 1605.7266,-805.9075 1610.8372,-801.1238"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="1812.5,-564.2021 1677.5,-564.2021 1677.5,-508.3991 1812.5,-508.3991 1812.5,-564.2021"/>
<text text-anchor="middle" x="1745" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Doc constructor.</text>
</g>
<!-- prose_15&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>prose_15&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1980.4582,-912.0635C1973.0132,-905.2154 1963.631,-897.6439 1954,-892.6012 1899.7482,-864.1958 1863.6174,-900.5771 1821,-856.6012 1745.6814,-778.8817 1740.2061,-640.8786 1742.4584,-574.3056"/>
<polygon fill="#000000" stroke="#000000" points="1745.9577,-574.3915 1742.8767,-564.2546 1738.9638,-574.1004 1745.9577,-574.3915"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2063.5,-671.9013 1830.5,-671.9013 1830.5,-400.6999 2063.5,-400.6999 2063.5,-671.9013"/>
<text text-anchor="middle" x="1947" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local d = {}</text>
<text text-anchor="middle" x="1947" y="-609.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.parentOf(doc, level)</text>
<text text-anchor="middle" x="1947" y="-594.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = level &#45; 1</text>
<text text-anchor="middle" x="1947" y="-578.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local parent = nil</text>
<text text-anchor="middle" x="1947" y="-563.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;while i &gt; 0 do</text>
<text text-anchor="middle" x="1947" y="-547.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;parent = doc.lastOf[i]</text>
<text text-anchor="middle" x="1947" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent then</text>
<text text-anchor="middle" x="1947" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return parent</text>
<text text-anchor="middle" x="1947" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1947" y="-486.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i = i &#45; 1</text>
<text text-anchor="middle" x="1947" y="-470.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1947" y="-455.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1947" y="-424.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="1947" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_16&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2109.4957,-910.3193C2098.5031,-896.34 2083.5415,-876.0117 2073,-856.6012 2043.076,-801.5011 2016.5142,-737.7586 1995.5858,-681.7154"/>
<polygon fill="#000000" stroke="#000000" points="1998.7678,-680.2296 1992.0106,-672.0694 1992.2042,-682.6624 1998.7678,-680.2296"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2294,-556.2027 2082,-556.2027 2082,-516.3985 2294,-516.3985 2294,-556.2027"/>
<text text-anchor="middle" x="2188" y="-524.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a block to a document.</text>
</g>
<!-- prose_17&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>prose_17&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2249.0415,-909.8943C2238.8984,-847.8154 2205.4632,-643.1808 2192.8624,-566.0602"/>
<polygon fill="#000000" stroke="#000000" points="2196.2941,-565.3572 2191.2273,-556.0525 2189.3857,-566.486 2196.2941,-565.3572"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2741.5,-586.8008 2312.5,-586.8008 2312.5,-485.8005 2741.5,-485.8005 2741.5,-586.8008"/>
<text text-anchor="middle" x="2527" y="-555.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> This function looks at document level and places the block</text>
<text text-anchor="middle" x="2527" y="-540.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> accordingly.</text>
<text text-anchor="middle" x="2527" y="-524.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="2527" y="-509.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; doc : the document</text>
<text text-anchor="middle" x="2527" y="-494.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; block : block to be appended</text>
</g>
<!-- prose_18&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>prose_18&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2404.8325,-910.1528C2422.7403,-855.3521 2477.5163,-687.7289 2507.2688,-596.6813"/>
<polygon fill="#000000" stroke="#000000" points="2510.6391,-597.6354 2510.4184,-587.0429 2503.9853,-595.461 2510.6391,-597.6354"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2930,-564.2021 2760,-564.2021 2760,-508.3991 2930,-508.3991 2930,-564.2021"/>
<text text-anchor="middle" x="2845" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> returns: the document</text>
</g>
<!-- prose_19&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>prose_19&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2685.5035,-914.9694C2705.2567,-902.418 2733.3601,-881.6725 2750,-856.6012 2809.8548,-766.4182 2832.9273,-637.5154 2841.0374,-574.2628"/>
<polygon fill="#000000" stroke="#000000" points="2844.5125,-574.6792 2842.2566,-564.3273 2837.5646,-573.8266 2844.5125,-574.6792"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3440,-856.4019 2948,-856.4019 2948,-216.1993 3440,-216.1993 3440,-856.4019"/>
<text text-anchor="middle" x="3194" y="-841.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addSection(doc, section, linum)</text>
<text text-anchor="middle" x="3194" y="-826.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not doc.latest then</text>
<text text-anchor="middle" x="3194" y="-810.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = &#160;section</text>
<text text-anchor="middle" x="3194" y="-795.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-779.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if linum &gt; 0 then</text>
<text text-anchor="middle" x="3194" y="-764.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.line_last = linum &#45; 1 &#160;&#160;&#160;</text>
<text text-anchor="middle" x="3194" y="-749.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-733.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local atLevel = doc.latest.level </text>
<text text-anchor="middle" x="3194" y="-718.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if atLevel &lt; section.level then</text>
<text text-anchor="middle" x="3194" y="-702.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; add the section under the latest section</text>
<text text-anchor="middle" x="3194" y="-687.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-672.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-656.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local parent = doc:parentOf(section.level)</text>
<text text-anchor="middle" x="3194" y="-641.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent.id == &quot;doc&quot; then</text>
<text text-anchor="middle" x="3194" y="-625.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if section.level == 1 and doc.latest.level == 1 then</text>
<text text-anchor="middle" x="3194" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[#doc + 1] = section</text>
<text text-anchor="middle" x="3194" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-579.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-564.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-548.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-533.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;parent:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-518.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-502.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-487.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-471.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = section</text>
<text text-anchor="middle" x="3194" y="-456.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf[section.level] = section</text>
<text text-anchor="middle" x="3194" y="-441.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3194" y="-425.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3194" y="-394.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addLine(doc, line, linum)</text>
<text text-anchor="middle" x="3194" y="-378.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if doc.latest then</text>
<text text-anchor="middle" x="3194" y="-363.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3194" y="-348.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-332.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; a virtual zero block</text>
<text text-anchor="middle" x="3194" y="-317.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = Block(0, linum)</text>
<text text-anchor="middle" x="3194" y="-301.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest = doc[1]</text>
<text text-anchor="middle" x="3194" y="-286.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3194" y="-271.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-239.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3194" y="-224.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_20&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_20&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3007.0604,-909.8943C3012.4952,-899.033 3020.1136,-883.8078 3029.1918,-865.6653"/>
<polygon fill="#000000" stroke="#000000" points="3032.4175,-867.0401 3033.7624,-856.531 3026.1575,-863.9077 3032.4175,-867.0401"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3614,-556.2027 3458,-556.2027 3458,-516.3985 3614,-516.3985 3614,-556.2027"/>
<text text-anchor="middle" x="3536" y="-524.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Creates a Doc Node.</text>
</g>
<!-- prose_21&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>prose_21&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3362.933,-917.7994C3388.7951,-906.6346 3427.0759,-886.2792 3449,-856.6012 3516.0206,-765.8774 3531.4146,-626.6251 3534.9483,-566.1011"/>
<polygon fill="#000000" stroke="#000000" points="3538.4454,-566.2453 3535.4652,-556.0783 3531.4547,-565.8847 3538.4454,-566.2453"/>
</g>
<!-- structure_36 -->
<g id="node37" class="node">
<title>structure_36</title>
<ellipse fill="none" stroke="#000000" cx="3677" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3677" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_22&#45;&gt;structure_36 -->
<g id="edge36" class="edge">
<title>block_22&#45;&gt;structure_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3677,-909.8943C3677,-847.5121 3677,-641.178 3677,-564.9391"/>
<polygon fill="#000000" stroke="#000000" points="3680.5001,-564.6672 3677,-554.6673 3673.5001,-564.6673 3680.5001,-564.6672"/>
</g>
<!-- structure_37 -->
<g id="node38" class="node">
<title>structure_37</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3784" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_22&#45;&gt;structure_37 -->
<g id="edge37" class="edge">
<title>block_22&#45;&gt;structure_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3694.148,-910.4839C3706.4062,-896.9072 3722.2276,-877.0215 3731,-856.6012 3774.4729,-755.4053 3782.4592,-622.0777 3783.8044,-564.6313"/>
<polygon fill="#000000" stroke="#000000" points="3787.3061,-564.561 3783.9894,-554.4987 3780.3073,-564.4331 3787.3061,-564.561"/>
</g>
<!-- structure_44 -->
<g id="node45" class="node">
<title>structure_44</title>
<ellipse fill="none" stroke="#000000" cx="3891" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3891" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_23&#45;&gt;structure_44 -->
<g id="edge44" class="edge">
<title>block_23&#45;&gt;structure_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3859.5255,-909.8943C3864.7811,-847.5121 3882.1643,-641.178 3888.5873,-564.9391"/>
<polygon fill="#000000" stroke="#000000" points="3892.1007,-564.9258 3889.4526,-554.6673 3885.1254,-564.3381 3892.1007,-564.9258"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="4242.5,-671.9013 3953.5,-671.9013 3953.5,-400.6999 4242.5,-400.6999 4242.5,-671.9013"/>
<text text-anchor="middle" x="4098" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Doc, str)</text>
<text text-anchor="middle" x="4098" y="-641.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local doc = setmetatable({}, D)</text>
<text text-anchor="middle" x="4098" y="-626.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.str = str</text>
<text text-anchor="middle" x="4098" y="-610.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.id = &quot;doc&quot;</text>
<text text-anchor="middle" x="4098" y="-595.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = nil</text>
<text text-anchor="middle" x="4098" y="-579.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lines = {}</text>
<text text-anchor="middle" x="4098" y="-564.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf = {}</text>
<text text-anchor="middle" x="4098" y="-549.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; for now lets set root to &#39;false&#39;</text>
<text text-anchor="middle" x="4098" y="-533.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.root = false</text>
<text text-anchor="middle" x="4098" y="-518.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc:own(str)</text>
<text text-anchor="middle" x="4098" y="-502.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4098" y="-471.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">setmetatable(D, Node)</text>
<text text-anchor="middle" x="4098" y="-440.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">d[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="4098" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, d)</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>codeblock_24&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4064.6179,-909.8943C4068.2297,-869.4737 4077.2417,-768.6163 4084.9926,-681.8727"/>
<polygon fill="#000000" stroke="#000000" points="4088.4787,-682.1826 4085.8827,-671.9107 4081.5065,-681.5595 4088.4787,-682.1826"/>
</g>
<!-- handleline_38 -->
<g id="node39" class="node">
<title>handleline_38</title>
<ellipse fill="none" stroke="#000000" cx="3665" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3665" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_36&#45;&gt;handleline_38 -->
<g id="edge38" class="edge">
<title>structure_36&#45;&gt;handleline_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3676.4212,-518.2473C3674.493,-458.1033 3668.2766,-264.2017 3665.9186,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3669.4058,-190.1933 3665.587,-180.3106 3662.4094,-190.4177 3669.4058,-190.1933"/>
</g>
<!-- handleline_41 -->
<g id="node42" class="node">
<title>handleline_41</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3784" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_37&#45;&gt;handleline_41 -->
<g id="edge41" class="edge">
<title>structure_37&#45;&gt;handleline_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-518.2473C3784,-458.1033 3784,-264.2017 3784,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-190.3106 3784,-180.3106 3780.5001,-190.3107 3787.5001,-190.3106"/>
</g>
<!-- handle_39 -->
<g id="node40" class="node">
<title>handle_39</title>
<ellipse fill="none" stroke="#000000" cx="3665" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3665" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_38&#45;&gt;handle_39 -->
<g id="edge39" class="edge">
<title>handleline_38&#45;&gt;handle_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3665,-143.8314C3665,-136.131 3665,-126.9743 3665,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3668.5001,-118.4132 3665,-108.4133 3661.5001,-118.4133 3668.5001,-118.4132"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3692,-36 3638,-36 3638,0 3692,0 3692,-36"/>
</g>
<!-- handle_39&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>handle_39&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3665,-71.8314C3665,-64.131 3665,-54.9743 3665,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3668.5001,-46.4132 3665,-36.4133 3661.5001,-46.4133 3668.5001,-46.4132"/>
</g>
<!-- handle_42 -->
<g id="node43" class="node">
<title>handle_42</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3784" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_41&#45;&gt;handle_42 -->
<g id="edge42" class="edge">
<title>handleline_41&#45;&gt;handle_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-143.8314C3784,-136.131 3784,-126.9743 3784,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-118.4132 3784,-108.4133 3780.5001,-118.4133 3787.5001,-118.4132"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3811,-36 3757,-36 3757,0 3811,0 3811,-36"/>
</g>
<!-- handle_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>handle_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-71.8314C3784,-64.131 3784,-54.9743 3784,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-46.4132 3784,-36.4133 3780.5001,-46.4133 3787.5001,-46.4132"/>
</g>
<!-- handleline_45 -->
<g id="node46" class="node">
<title>handleline_45</title>
<ellipse fill="none" stroke="#000000" cx="3903" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3903" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_44&#45;&gt;handleline_45 -->
<g id="edge45" class="edge">
<title>structure_44&#45;&gt;handleline_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3891.5788,-518.2473C3893.507,-458.1033 3899.7234,-264.2017 3902.0814,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3905.5906,-190.4177 3902.413,-180.3106 3898.5942,-190.1933 3905.5906,-190.4177"/>
</g>
<!-- handle_46 -->
<g id="node47" class="node">
<title>handle_46</title>
<ellipse fill="none" stroke="#000000" cx="3903" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3903" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_45&#45;&gt;handle_46 -->
<g id="edge46" class="edge">
<title>handleline_45&#45;&gt;handle_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3903,-143.8314C3903,-136.131 3903,-126.9743 3903,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3906.5001,-118.4132 3903,-108.4133 3899.5001,-118.4133 3906.5001,-118.4132"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3930,-36 3876,-36 3876,0 3930,0 3930,-36"/>
</g>
<!-- handle_46&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>handle_46&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3903,-71.8314C3903,-64.131 3903,-54.9743 3903,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3906.5001,-46.4132 3903,-36.4133 3899.5001,-46.4133 3906.5001,-46.4132"/>
</g>
</g>
</svg>