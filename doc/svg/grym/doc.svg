<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4251pt" height="1171pt"
 viewBox="0.00 0.00 4250.50 1171.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1167.4013)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1167.4013 4246.5,-1167.4013 4246.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1145.4013" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="770" y="-1141.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 175</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1073.4013" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="770" y="-1069.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;10</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770,-1127.2326C770,-1119.5322 770,-1110.3756 770,-1101.8179"/>
<polygon fill="#000000" stroke="#000000" points="773.5001,-1101.8145 770,-1091.8145 766.5001,-1101.8146 773.5001,-1101.8145"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="568" cy="-1001.4013" rx="69.6687" ry="18"/>
<text text-anchor="middle" x="568" y="-997.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Doc module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M731.0524,-1059.519C698.9855,-1048.0892 653.2935,-1031.8029 618.433,-1019.3774"/>
<polygon fill="#000000" stroke="#000000" points="619.5028,-1016.0431 608.9081,-1015.9824 617.1525,-1022.6367 619.5028,-1016.0431"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="688" cy="-1001.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="688" y="-997.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M750.5671,-1056.3383C739.3006,-1046.4457 724.9965,-1033.886 712.9098,-1023.2733"/>
<polygon fill="#000000" stroke="#000000" points="715.1653,-1020.596 705.3415,-1016.628 710.5466,-1025.8561 715.1653,-1020.596"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="770" cy="-1001.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="770" y="-997.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M770,-1055.2326C770,-1047.5322 770,-1038.3756 770,-1029.8179"/>
<polygon fill="#000000" stroke="#000000" points="773.5001,-1029.8145 770,-1019.8145 766.5001,-1029.8146 773.5001,-1029.8145"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="932" cy="-1001.4013" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="932" y="-997.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.9605,-1058.3077C831.3489,-1046.1351 869.7176,-1029.0823 897.3009,-1016.8231"/>
<polygon fill="#000000" stroke="#000000" points="898.8554,-1019.9624 906.572,-1012.7026 896.0124,-1013.5657 898.8554,-1019.9624"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2188" cy="-1001.4013" rx="69.851" ry="18"/>
<text text-anchor="middle" x="2188" y="-997.2013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 11&#45;175</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.024,-1070.3535C1055.6744,-1058.896 1853.2436,-1018.3988 2108.675,-1005.4291"/>
<polygon fill="#000000" stroke="#000000" points="2109.1718,-1008.9084 2118.9814,-1004.9058 2108.8167,-1001.9174 2109.1718,-1008.9084"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="520,-939.9033 0,-939.9033 0,-900.0992 520,-900.0992 520,-939.9033"/>
<text text-anchor="middle" x="260" y="-908.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> Represents a Document, which is generally the same as a file, at first.</text>
</g>
<!-- prose_3&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M663.6603,-989.5217C658.2684,-987.2289 652.5156,-985.0354 647,-983.4013 583.6424,-964.63 512.6989,-950.9791 449.0286,-941.2643"/>
<polygon fill="#000000" stroke="#000000" points="449.2837,-937.7634 438.8747,-939.7387 448.2437,-944.6857 449.2837,-937.7634"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="841.5,-938.0012 538.5,-938.0012 538.5,-902.0012 841.5,-902.0012 841.5,-938.0012"/>
<text text-anchor="middle" x="690" y="-916.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> A document contains an array of blocks. </text>
</g>
<!-- prose_4&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>prose_4&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M754.1946,-985.3193C743.0034,-973.9322 727.7649,-958.427 714.9431,-945.3809"/>
<polygon fill="#000000" stroke="#000000" points="717.2278,-942.7122 707.722,-938.0334 712.2353,-947.6189 717.2278,-942.7122"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="1324,-947.3017 860,-947.3017 860,-892.7008 1324,-892.7008 1324,-947.3017"/>
<text text-anchor="middle" x="1092" y="-932.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> At some point documents can also contain documents, this is not</text>
<text text-anchor="middle" x="1092" y="-916.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> currently supported.</text>
</g>
<!-- prose_5&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>prose_5&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M955.9536,-989.2149C975.2933,-979.3758 1003.4149,-965.069 1029.0773,-952.0132"/>
<polygon fill="#000000" stroke="#000000" points="1030.7077,-955.1107 1038.0335,-947.4567 1027.5335,-948.8717 1030.7077,-955.1107"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="1388" cy="-920.0012" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1388" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_6&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_6&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2118.2147,-999.7928C1958.2123,-995.5484 1569.0133,-981.907 1443,-947.4013 1436.1561,-945.5272 1429.1556,-942.7773 1422.5419,-939.7331"/>
<polygon fill="#000000" stroke="#000000" points="1423.7099,-936.4069 1413.1922,-935.1302 1420.6181,-942.6872 1423.7099,-936.4069"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="1484" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1484" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_6&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2118.0877,-1000.0336C1970.954,-996.4529 1634.0098,-984.3634 1526,-947.4013 1520.9805,-945.6835 1515.9708,-943.231 1511.2508,-940.4909"/>
<polygon fill="#000000" stroke="#000000" points="1512.9193,-937.404 1502.6044,-934.9846 1509.1592,-943.3084 1512.9193,-937.404"/>
</g>
<!-- codeblock_12 -->
<g id="node13" class="node">
<title>codeblock_12</title>
<ellipse fill="none" stroke="#000000" cx="1612" cy="-920.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1612" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;28</text>
</g>
<!-- section_6&#45;&gt;codeblock_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;codeblock_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2118.8978,-998.0238C2023.566,-992.4029 1846.7257,-978.5092 1699,-947.4013 1687.6143,-945.0037 1675.5974,-941.7252 1664.2496,-938.269"/>
<polygon fill="#000000" stroke="#000000" points="1665.0714,-934.8587 1654.4822,-935.2037 1662.9753,-941.5375 1665.0714,-934.8587"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1740" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1740" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2121.0479,-996.1137C2022.2799,-987.7024 1842.6694,-969.9013 1782,-947.4013 1777.0258,-945.5565 1772.0398,-943.0375 1767.3296,-940.2697"/>
<polygon fill="#000000" stroke="#000000" points="1768.9994,-937.1833 1758.6872,-934.7524 1765.2327,-943.0835 1768.9994,-937.1833"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="1868" cy="-920.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1868" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 33&#45;67</text>
</g>
<!-- section_6&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2133.5602,-990.0328C2086.1487,-979.8352 2015.6887,-963.9639 1955,-947.4013 1944.3563,-944.4965 1933.0622,-941.1433 1922.2599,-937.801"/>
<polygon fill="#000000" stroke="#000000" points="1923.0996,-934.3964 1912.5106,-934.7477 1921.0075,-941.0765 1923.0996,-934.3964"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1996" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1996" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2141.5655,-987.7719C2111.3354,-978.1562 2071.4511,-964.0497 2038,-947.4013 2033.5573,-945.1902 2029.0108,-942.6053 2024.627,-939.9228"/>
<polygon fill="#000000" stroke="#000000" points="2026.2525,-936.8078 2015.9425,-934.3677 2022.4806,-942.7046 2026.2525,-936.8078"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="2124" cy="-920.0012" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2124" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 72&#45;90</text>
</g>
<!-- section_6&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2174.113,-983.7387C2165.4506,-972.7212 2154.1478,-958.3454 2144.4694,-946.0358"/>
<polygon fill="#000000" stroke="#000000" points="2147.0132,-943.6084 2138.081,-937.9105 2141.5103,-947.9349 2147.0132,-943.6084"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="2252" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2252" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2201.887,-983.7387C2210.9343,-972.2317 2222.8618,-957.0614 2232.8106,-944.4078"/>
<polygon fill="#000000" stroke="#000000" points="2235.5831,-946.5442 2239.0125,-936.5197 2230.0803,-942.2176 2235.5831,-946.5442"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="2399" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2399" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2227.193,-986.2813C2266.0309,-971.2984 2325.0302,-948.5375 2362.7926,-933.9694"/>
<polygon fill="#000000" stroke="#000000" points="2364.3077,-937.1364 2372.3778,-930.2716 2361.7882,-930.6055 2364.3077,-937.1364"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="2663" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2663" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>section_6&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2246.2443,-991.42C2343.7476,-974.711 2537.6185,-941.4877 2622.0803,-927.0136"/>
<polygon fill="#000000" stroke="#000000" points="2622.7978,-930.4418 2632.0629,-925.3029 2621.6154,-923.5423 2622.7978,-930.4418"/>
</g>
<!-- codeblock_20 -->
<g id="node21" class="node">
<title>codeblock_20</title>
<ellipse fill="none" stroke="#000000" cx="2998" cy="-920.0012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2998" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 103&#45;145</text>
</g>
<!-- section_6&#45;&gt;codeblock_20 -->
<g id="edge20" class="edge">
<title>section_6&#45;&gt;codeblock_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2253.2576,-994.8433C2397.8187,-980.3158 2745.1852,-945.4076 2909.2853,-928.9165"/>
<polygon fill="#000000" stroke="#000000" points="2909.7482,-932.3877 2919.3481,-927.9053 2909.0482,-925.4228 2909.7482,-932.3877"/>
</g>
<!-- prose_21 -->
<g id="node22" class="node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="3336" cy="-920.0012" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3336" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>section_6&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.1394,-998.5372C2408.8303,-991.9778 2782.1854,-974.3269 3094,-947.4013 3164.4464,-941.3181 3246.1228,-931.4903 3294.2964,-925.4059"/>
<polygon fill="#000000" stroke="#000000" points="3294.8626,-928.8622 3304.3419,-924.13 3293.9806,-921.918 3294.8626,-928.8622"/>
</g>
<!-- block_22 -->
<g id="node23" class="node">
<title>block_22</title>
<ellipse fill="none" stroke="#000000" cx="3677" cy="-920.0012" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="3677" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 150&#45;152</text>
</g>
<!-- section_6&#45;&gt;block_22 -->
<g id="edge22" class="edge">
<title>section_6&#45;&gt;block_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.752,-999.3475C2441.2056,-993.7043 2952.3196,-976.4235 3377,-947.4013 3455.18,-942.0585 3544.6117,-933.5838 3605.3434,-927.4735"/>
<polygon fill="#000000" stroke="#000000" points="3605.9905,-930.926 3615.5877,-926.4378 3605.2863,-923.9615 3605.9905,-930.926"/>
</g>
<!-- block_23 -->
<g id="node24" class="node">
<title>block_23</title>
<ellipse fill="none" stroke="#000000" cx="3858" cy="-920.0012" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="3858" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 153&#45;155</text>
</g>
<!-- section_6&#45;&gt;block_23 -->
<g id="edge23" class="edge">
<title>section_6&#45;&gt;block_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2258.1172,-1001.0138C2522.3136,-999.2379 3457.5677,-990.0149 3752,-947.4013 3769.2141,-944.9099 3787.6656,-940.6986 3804.2705,-936.3154"/>
<polygon fill="#000000" stroke="#000000" points="3805.6111,-939.578 3814.3431,-933.5778 3803.7752,-932.8231 3805.6111,-939.578"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="4063" cy="-920.0012" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4063" y="-915.8012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 156&#45;174</text>
</g>
<!-- section_6&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_6&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2258.2863,-1000.885C2541.602,-998.5476 3600.4603,-987.2735 3933,-947.4013 3954.1568,-944.8645 3976.9735,-940.5904 3997.4968,-936.1632"/>
<polygon fill="#000000" stroke="#000000" points="3998.3594,-939.5572 4007.3703,-933.9845 3996.851,-932.7216 3998.3594,-939.5572"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="745,-610.7013 267,-610.7013 267,-461.8999 745,-461.8999 745,-610.7013"/>
<text text-anchor="middle" x="506" y="-563.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> In addition to the standard Node fields, a doc has:</text>
<text text-anchor="middle" x="506" y="-547.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="506" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; latest: The current block. &#160;This will be in `doc[#doc]` but may</text>
<text text-anchor="middle" x="506" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;be several layers deep.</text>
<text text-anchor="middle" x="506" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; lastOf: An array containing references to the last block of a</text>
<text text-anchor="middle" x="506" y="-486.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;given level.</text>
</g>
<!-- prose_11&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>prose_11&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1465.9319,-904.8838C1459.1583,-900.0709 1451.1249,-895.2997 1443,-892.6012 1297.4954,-844.2751 889.8471,-927.6827 754,-856.6012 656.098,-805.3743 584.9547,-696.3823 544.6006,-619.8238"/>
<polygon fill="#000000" stroke="#000000" points="547.5512,-617.9116 539.8323,-610.6543 541.3407,-621.1412 547.5512,-617.9116"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1031,-578.9017 763,-578.9017 763,-493.6996 1031,-493.6996 1031,-578.9017"/>
<text text-anchor="middle" x="897" y="-563.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="897" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="897" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Block = require &quot;grym/section&quot;</text>
<text text-anchor="middle" x="897" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local own = require &quot;grym/own&quot;</text>
</g>
<!-- codeblock_12&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_12&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1570.4639,-904.7718C1556.2292,-900.1311 1540.0852,-895.4961 1525,-892.6012 1418.8624,-872.2329 1128.4283,-918.734 1040,-856.6012 950.8887,-793.9885 916.494,-662.5422 903.8557,-588.9914"/>
<polygon fill="#000000" stroke="#000000" points="907.2906,-588.3095 902.2133,-579.0105 900.3835,-589.4461 907.2906,-588.3095"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="1205,-556.2027 1049,-556.2027 1049,-516.3985 1205,-516.3985 1205,-556.2027"/>
<text text-anchor="middle" x="1127" y="-540.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Metatable for Docs.</text>
</g>
<!-- prose_13&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>prose_13&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1721.4068,-904.985C1714.46,-900.1817 1706.2472,-895.3906 1698,-892.6012 1595.8329,-858.0459 1297.1872,-925.2459 1214,-856.6012 1125.7708,-783.7959 1122.0612,-631.2997 1124.844,-566.4852"/>
<polygon fill="#000000" stroke="#000000" points="1128.3573,-566.3162 1125.377,-556.1492 1121.3666,-565.9556 1128.3573,-566.3162"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="1659,-796.1015 1223,-796.1015 1223,-276.4997 1659,-276.4997 1659,-796.1015"/>
<text text-anchor="middle" x="1441" y="-781.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local D = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="1441" y="-749.601" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__tostring = function (doc)</text>
<text text-anchor="middle" x="1441" y="-734.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1441" y="-718.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(doc) do</text>
<text text-anchor="middle" x="1441" y="-703.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local repr = tostring(v)</text>
<text text-anchor="middle" x="1441" y="-688.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if repr ~= &quot;&quot; and repr ~= &quot;\n&quot; then</text>
<text text-anchor="middle" x="1441" y="-672.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. repr .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1441" y="-657.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-641.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase </text>
<text text-anchor="middle" x="1441" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1441" y="-563.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__index = D</text>
<text text-anchor="middle" x="1441" y="-532.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.own = own</text>
<text text-anchor="middle" x="1441" y="-500.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.dotLabel(doc)</text>
<text text-anchor="middle" x="1441" y="-485.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;doc &#45; &quot; .. tostring(doc.linum)</text>
<text text-anchor="middle" x="1441" y="-470.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">end </text>
<text text-anchor="middle" x="1441" y="-438.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.toMarkdown(doc)</text>
<text text-anchor="middle" x="1441" y="-423.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1441" y="-407.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, node in ipairs(doc) do</text>
<text text-anchor="middle" x="1441" y="-392.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="1441" y="-377.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="1441" y="-361.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1441" y="-346.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;no toMarkdown method for &quot; .. node.id)</text>
<text text-anchor="middle" x="1441" y="-330.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-315.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1441" y="-300.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="1441" y="-284.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>codeblock_14&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1821.8503,-905.4697C1763.0369,-886.9368 1668.809,-857.1919 1668,-856.6012 1646.8888,-841.1889 1627.0085,-823.2061 1608.464,-803.7688"/>
<polygon fill="#000000" stroke="#000000" points="1610.8127,-801.1565 1601.4222,-796.2504 1605.7036,-805.9416 1610.8127,-801.1565"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="1812.5,-556.2027 1677.5,-556.2027 1677.5,-516.3985 1812.5,-516.3985 1812.5,-556.2027"/>
<text text-anchor="middle" x="1745" y="-540.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Doc constructor.</text>
</g>
<!-- prose_15&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>prose_15&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1976.6503,-905.5593C1969.7662,-900.9225 1961.7863,-896.0895 1954,-892.6012 1898.1139,-867.5639 1863.6174,-900.5771 1821,-856.6012 1742.4195,-775.5158 1739.8629,-628.8123 1742.7894,-566.0689"/>
<polygon fill="#000000" stroke="#000000" points="1746.2859,-566.2281 1743.3387,-556.0515 1739.2964,-565.8448 1746.2859,-566.2281"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2063.5,-671.9013 1830.5,-671.9013 1830.5,-400.6999 2063.5,-400.6999 2063.5,-671.9013"/>
<text text-anchor="middle" x="1947" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local d = {}</text>
<text text-anchor="middle" x="1947" y="-609.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.parentOf(doc, level)</text>
<text text-anchor="middle" x="1947" y="-594.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = level &#45; 1</text>
<text text-anchor="middle" x="1947" y="-578.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local parent = nil</text>
<text text-anchor="middle" x="1947" y="-563.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;while i &gt; 0 do</text>
<text text-anchor="middle" x="1947" y="-547.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;parent = doc.lastOf[i]</text>
<text text-anchor="middle" x="1947" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent then</text>
<text text-anchor="middle" x="1947" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return parent</text>
<text text-anchor="middle" x="1947" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1947" y="-486.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i = i &#45; 1</text>
<text text-anchor="middle" x="1947" y="-470.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1947" y="-455.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1947" y="-424.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="1947" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_16&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2107.247,-902.2206C2096.4381,-890.0696 2082.6475,-873.2148 2073,-856.6012 2041.3713,-802.1348 2014.428,-738.2217 1993.6735,-681.8741"/>
<polygon fill="#000000" stroke="#000000" points="1996.8498,-680.3683 1990.1339,-672.174 1990.2739,-682.7679 1996.8498,-680.3683"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2294,-554.3006 2082,-554.3006 2082,-518.3006 2294,-518.3006 2294,-554.3006"/>
<text text-anchor="middle" x="2188" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Adds a block to a document.</text>
</g>
<!-- prose_17&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>prose_17&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2248.999,-902.0092C2238.7763,-840.721 2205.2555,-639.7529 2192.7555,-564.8111"/>
<polygon fill="#000000" stroke="#000000" points="2196.1666,-563.9881 2191.069,-554.7002 2189.262,-565.1398 2196.1666,-563.9881"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2741.5,-578.8008 2312.5,-578.8008 2312.5,-493.8005 2741.5,-493.8005 2741.5,-578.8008"/>
<text text-anchor="middle" x="2527" y="-563.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> This function looks at document level and places the block</text>
<text text-anchor="middle" x="2527" y="-548.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> accordingly.</text>
<text text-anchor="middle" x="2527" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="2527" y="-517.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; doc : the document</text>
<text text-anchor="middle" x="2527" y="-502.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; block : block to be appended</text>
</g>
<!-- prose_18&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>prose_18&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2404.917,-902.2641C2423.3807,-846.9162 2480.4347,-675.8877 2509.5381,-588.6454"/>
<polygon fill="#000000" stroke="#000000" points="2512.9303,-589.537 2512.7747,-578.9433 2506.29,-587.3218 2512.9303,-589.537"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2930,-556.2027 2760,-556.2027 2760,-516.3985 2930,-516.3985 2930,-556.2027"/>
<text text-anchor="middle" x="2845" y="-540.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> returns: the document</text>
</g>
<!-- prose_19&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>prose_19&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2687.4743,-907.9554C2707.1031,-897.096 2733.9405,-879.3509 2750,-856.6012 2815.3196,-764.0699 2836.2646,-626.3347 2842.5258,-566.198"/>
<polygon fill="#000000" stroke="#000000" points="2846.0105,-566.5251 2843.5013,-556.2317 2839.0437,-565.8432 2846.0105,-566.5251"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3440,-856.4019 2948,-856.4019 2948,-216.1993 3440,-216.1993 3440,-856.4019"/>
<text text-anchor="middle" x="3194" y="-841.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addSection(doc, section, linum)</text>
<text text-anchor="middle" x="3194" y="-826.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not doc.latest then</text>
<text text-anchor="middle" x="3194" y="-810.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = &#160;section</text>
<text text-anchor="middle" x="3194" y="-795.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-779.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if linum &gt; 0 then</text>
<text text-anchor="middle" x="3194" y="-764.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.line_last = linum &#45; 1 &#160;&#160;&#160;</text>
<text text-anchor="middle" x="3194" y="-749.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-733.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local atLevel = doc.latest.level </text>
<text text-anchor="middle" x="3194" y="-718.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if atLevel &lt; section.level then</text>
<text text-anchor="middle" x="3194" y="-702.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; add the section under the latest section</text>
<text text-anchor="middle" x="3194" y="-687.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-672.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-656.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local parent = doc:parentOf(section.level)</text>
<text text-anchor="middle" x="3194" y="-641.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent.id == &quot;doc&quot; then</text>
<text text-anchor="middle" x="3194" y="-625.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if section.level == 1 and doc.latest.level == 1 then</text>
<text text-anchor="middle" x="3194" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[#doc + 1] = section</text>
<text text-anchor="middle" x="3194" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-579.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-564.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-548.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-533.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;parent:addSection(section, linum)</text>
<text text-anchor="middle" x="3194" y="-518.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-502.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-487.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-471.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = section</text>
<text text-anchor="middle" x="3194" y="-456.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf[section.level] = section</text>
<text text-anchor="middle" x="3194" y="-441.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3194" y="-425.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3194" y="-394.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addLine(doc, line, linum)</text>
<text text-anchor="middle" x="3194" y="-378.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if doc.latest then</text>
<text text-anchor="middle" x="3194" y="-363.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3194" y="-348.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3194" y="-332.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; a virtual zero block</text>
<text text-anchor="middle" x="3194" y="-317.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = Block(0, linum)</text>
<text text-anchor="middle" x="3194" y="-301.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest = doc[1]</text>
<text text-anchor="middle" x="3194" y="-286.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="3194" y="-271.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3194" y="-239.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="3194" y="-224.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_20&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_20&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3007.1906,-902.0092C3011.9356,-892.7201 3018.3196,-880.2224 3025.8701,-865.4411"/>
<polygon fill="#000000" stroke="#000000" points="3029.0148,-866.9788 3030.447,-856.4812 3022.781,-863.7944 3029.0148,-866.9788"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3614,-554.3006 3458,-554.3006 3458,-518.3006 3614,-518.3006 3614,-554.3006"/>
<text text-anchor="middle" x="3536" y="-532.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> Creates a Doc Node.</text>
</g>
<!-- prose_21&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>prose_21&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3364.3777,-911.2039C3390.1787,-901.7625 3427.4191,-884.2728 3449,-856.6012 3519.0567,-766.7727 3532.795,-624.6675 3535.419,-564.5973"/>
<polygon fill="#000000" stroke="#000000" points="3538.9252,-564.4872 3535.7907,-554.3667 3531.9298,-564.233 3538.9252,-564.4872"/>
</g>
<!-- structure_36 -->
<g id="node37" class="node">
<title>structure_36</title>
<ellipse fill="none" stroke="#000000" cx="3677" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3677" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_22&#45;&gt;structure_36 -->
<g id="edge36" class="edge">
<title>block_22&#45;&gt;structure_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3677,-901.7527C3677,-840.1458 3677,-639.5414 3677,-564.7511"/>
<polygon fill="#000000" stroke="#000000" points="3680.5001,-564.6608 3677,-554.6609 3673.5001,-564.6609 3680.5001,-564.6608"/>
</g>
<!-- structure_37 -->
<g id="node38" class="node">
<title>structure_37</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3784" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_22&#45;&gt;structure_37 -->
<g id="edge37" class="edge">
<title>block_22&#45;&gt;structure_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3696.2777,-902.7639C3708.2118,-890.9672 3722.7792,-874.3043 3731,-856.6012 3777.3878,-756.7079 3783.8391,-622.6943 3784.2943,-564.8503"/>
<polygon fill="#000000" stroke="#000000" points="3787.7946,-564.6526 3784.3167,-554.645 3780.7946,-564.6372 3787.7946,-564.6526"/>
</g>
<!-- structure_44 -->
<g id="node45" class="node">
<title>structure_44</title>
<ellipse fill="none" stroke="#000000" cx="3891" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3891" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_23&#45;&gt;structure_44 -->
<g id="edge44" class="edge">
<title>block_23&#45;&gt;structure_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3859.5695,-901.7527C3864.8679,-840.1458 3882.1208,-639.5414 3888.5531,-564.7511"/>
<polygon fill="#000000" stroke="#000000" points="3892.0511,-564.924 3889.4209,-554.6609 3885.0768,-564.3242 3892.0511,-564.924"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="4242.5,-671.9013 3953.5,-671.9013 3953.5,-400.6999 4242.5,-400.6999 4242.5,-671.9013"/>
<text text-anchor="middle" x="4098" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Doc, str)</text>
<text text-anchor="middle" x="4098" y="-641.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local doc = setmetatable({}, D)</text>
<text text-anchor="middle" x="4098" y="-626.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.str = str</text>
<text text-anchor="middle" x="4098" y="-610.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.id = &quot;doc&quot;</text>
<text text-anchor="middle" x="4098" y="-595.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = nil</text>
<text text-anchor="middle" x="4098" y="-579.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lines = {}</text>
<text text-anchor="middle" x="4098" y="-564.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf = {}</text>
<text text-anchor="middle" x="4098" y="-549.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; for now lets set root to &#39;false&#39;</text>
<text text-anchor="middle" x="4098" y="-533.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.root = false</text>
<text text-anchor="middle" x="4098" y="-518.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc:own(str)</text>
<text text-anchor="middle" x="4098" y="-502.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4098" y="-471.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">setmetatable(D, Node)</text>
<text text-anchor="middle" x="4098" y="-440.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">d[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="4098" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, d)</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>codeblock_24&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4064.6646,-901.7527C4068.2611,-862.3245 4077.0508,-765.9637 4084.7017,-682.0877"/>
<polygon fill="#000000" stroke="#000000" points="4088.2058,-682.2021 4085.6287,-671.9255 4081.2347,-681.5662 4088.2058,-682.2021"/>
</g>
<!-- handleline_38 -->
<g id="node39" class="node">
<title>handleline_38</title>
<ellipse fill="none" stroke="#000000" cx="3665" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3665" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_36&#45;&gt;handleline_38 -->
<g id="edge38" class="edge">
<title>structure_36&#45;&gt;handleline_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3676.4212,-518.2473C3674.493,-458.1033 3668.2766,-264.2017 3665.9186,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3669.4058,-190.1933 3665.587,-180.3106 3662.4094,-190.4177 3669.4058,-190.1933"/>
</g>
<!-- handleline_41 -->
<g id="node42" class="node">
<title>handleline_41</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3784" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_37&#45;&gt;handleline_41 -->
<g id="edge41" class="edge">
<title>structure_37&#45;&gt;handleline_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-518.2473C3784,-458.1033 3784,-264.2017 3784,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-190.3106 3784,-180.3106 3780.5001,-190.3107 3787.5001,-190.3106"/>
</g>
<!-- handle_39 -->
<g id="node40" class="node">
<title>handle_39</title>
<ellipse fill="none" stroke="#000000" cx="3665" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3665" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_38&#45;&gt;handle_39 -->
<g id="edge39" class="edge">
<title>handleline_38&#45;&gt;handle_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3665,-143.8314C3665,-136.131 3665,-126.9743 3665,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3668.5001,-118.4132 3665,-108.4133 3661.5001,-118.4133 3668.5001,-118.4132"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3692,-36 3638,-36 3638,0 3692,0 3692,-36"/>
</g>
<!-- handle_39&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>handle_39&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3665,-71.8314C3665,-64.131 3665,-54.9743 3665,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3668.5001,-46.4132 3665,-36.4133 3661.5001,-46.4133 3668.5001,-46.4132"/>
</g>
<!-- handle_42 -->
<g id="node43" class="node">
<title>handle_42</title>
<ellipse fill="none" stroke="#000000" cx="3784" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3784" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_41&#45;&gt;handle_42 -->
<g id="edge42" class="edge">
<title>handleline_41&#45;&gt;handle_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-143.8314C3784,-136.131 3784,-126.9743 3784,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-118.4132 3784,-108.4133 3780.5001,-118.4133 3787.5001,-118.4132"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3811,-36 3757,-36 3757,0 3811,0 3811,-36"/>
</g>
<!-- handle_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>handle_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3784,-71.8314C3784,-64.131 3784,-54.9743 3784,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3787.5001,-46.4132 3784,-36.4133 3780.5001,-46.4133 3787.5001,-46.4132"/>
</g>
<!-- handleline_45 -->
<g id="node46" class="node">
<title>handleline_45</title>
<ellipse fill="none" stroke="#000000" cx="3903" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3903" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_44&#45;&gt;handleline_45 -->
<g id="edge45" class="edge">
<title>structure_44&#45;&gt;handleline_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3891.5788,-518.2473C3893.507,-458.1033 3899.7234,-264.2017 3902.0814,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="3905.5906,-190.4177 3902.413,-180.3106 3898.5942,-190.1933 3905.5906,-190.4177"/>
</g>
<!-- handle_46 -->
<g id="node47" class="node">
<title>handle_46</title>
<ellipse fill="none" stroke="#000000" cx="3903" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3903" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_45&#45;&gt;handle_46 -->
<g id="edge46" class="edge">
<title>handleline_45&#45;&gt;handle_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3903,-143.8314C3903,-136.131 3903,-126.9743 3903,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3906.5001,-118.4132 3903,-108.4133 3899.5001,-118.4133 3906.5001,-118.4132"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3930,-36 3876,-36 3876,0 3930,0 3930,-36"/>
</g>
<!-- handle_46&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>handle_46&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3903,-71.8314C3903,-64.131 3903,-54.9743 3903,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3906.5001,-46.4132 3903,-36.4133 3899.5001,-46.4133 3906.5001,-46.4132"/>
</g>
</g>
</svg>