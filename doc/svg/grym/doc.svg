<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2400pt" height="937pt"
 viewBox="0.00 0.00 2400.08 936.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 932.6012)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-932.6012 2396.0843,-932.6012 2396.0843,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="69.5843" cy="-910.6012" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="69.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 175</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="69.5843" cy="-536.3006" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="69.5843" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;10</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M69.5843,-892.5479C69.5843,-832.4039 69.5843,-638.5023 69.5843,-564.9524"/>
<polygon fill="#000000" stroke="#000000" points="73.0844,-564.6112 69.5843,-554.6113 66.0844,-564.6113 73.0844,-564.6112"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="69.5843" cy="-162" rx="69.6687" ry="18"/>
<text text-anchor="middle" x="69.5843" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Doc module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M69.5843,-518.2473C69.5843,-458.1033 69.5843,-264.2017 69.5843,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="73.0844,-190.3106 69.5843,-180.3106 66.0844,-190.3107 73.0844,-190.3106"/>
</g>
<!-- section_3 -->
<g id="node4" class="node">
<title>section_3</title>
<ellipse fill="none" stroke="#000000" cx="194.5843" cy="-910.6012" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="194.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_3</text>
</g>
<!-- header_4 -->
<g id="node5" class="node">
<title>header_4</title>
<ellipse fill="none" stroke="#000000" cx="194.5843" cy="-536.3006" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="194.5843" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Fields</text>
</g>
<!-- section_3&#45;&gt;header_4 -->
<g id="edge3" class="edge">
<title>section_3&#45;&gt;header_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M194.5843,-892.5479C194.5843,-832.4039 194.5843,-638.5023 194.5843,-564.9524"/>
<polygon fill="#000000" stroke="#000000" points="198.0844,-564.6112 194.5843,-554.6113 191.0844,-564.6113 198.0844,-564.6112"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="392.5843" cy="-910.6012" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="392.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_5</text>
</g>
<!-- leaf_12 -->
<g id="node7" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="526.5843,-578.9017 258.5843,-578.9017 258.5843,-493.6996 526.5843,-493.6996 526.5843,-578.9017"/>
<text text-anchor="middle" x="392.5843" y="-563.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="392.5843" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="392.5843" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Block = require &quot;grym/section&quot;</text>
<text text-anchor="middle" x="392.5843" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local own = require &quot;grym/own&quot;</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_12 -->
<g id="edge4" class="edge">
<title>codeblock_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M392.5843,-892.5479C392.5843,-838.2265 392.5843,-674.7925 392.5843,-589.4673"/>
<polygon fill="#000000" stroke="#000000" points="396.0844,-589.2119 392.5843,-579.212 389.0844,-589.212 396.0844,-589.2119"/>
</g>
<!-- codeblock_6 -->
<g id="node8" class="node">
<title>codeblock_6</title>
<ellipse fill="none" stroke="#000000" cx="762.5843" cy="-910.6012" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="762.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_6</text>
</g>
<!-- leaf_13 -->
<g id="node9" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="980.5843,-796.1015 544.5843,-796.1015 544.5843,-276.4997 980.5843,-276.4997 980.5843,-796.1015"/>
<text text-anchor="middle" x="762.5843" y="-781.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local D = setmetatable({}, { __index = Node })</text>
<text text-anchor="middle" x="762.5843" y="-749.601" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__tostring = function (doc)</text>
<text text-anchor="middle" x="762.5843" y="-734.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="762.5843" y="-718.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(doc) do</text>
<text text-anchor="middle" x="762.5843" y="-703.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local repr = tostring(v)</text>
<text text-anchor="middle" x="762.5843" y="-688.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if repr ~= &quot;&quot; and repr ~= &quot;\n&quot; then</text>
<text text-anchor="middle" x="762.5843" y="-672.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. repr .. &quot;\n&quot;</text>
<text text-anchor="middle" x="762.5843" y="-657.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="762.5843" y="-641.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="762.5843" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase </text>
<text text-anchor="middle" x="762.5843" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="762.5843" y="-563.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.__index = D</text>
<text text-anchor="middle" x="762.5843" y="-532.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">D.own = own</text>
<text text-anchor="middle" x="762.5843" y="-500.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.dotLabel(doc)</text>
<text text-anchor="middle" x="762.5843" y="-485.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;doc &#45; &quot; .. tostring(doc.linum)</text>
<text text-anchor="middle" x="762.5843" y="-470.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">end </text>
<text text-anchor="middle" x="762.5843" y="-438.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.toMarkdown(doc)</text>
<text text-anchor="middle" x="762.5843" y="-423.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="762.5843" y="-407.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, node in ipairs(doc) do</text>
<text text-anchor="middle" x="762.5843" y="-392.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if node.toMarkdown then</text>
<text text-anchor="middle" x="762.5843" y="-377.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. node:toMarkdown()</text>
<text text-anchor="middle" x="762.5843" y="-361.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else </text>
<text text-anchor="middle" x="762.5843" y="-346.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;no toMarkdown method for &quot; .. node.id)</text>
<text text-anchor="middle" x="762.5843" y="-330.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="762.5843" y="-315.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="762.5843" y="-300.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="762.5843" y="-284.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_6&#45;&gt;leaf_13 -->
<g id="edge5" class="edge">
<title>codeblock_6&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M762.5843,-892.5479C762.5843,-874.0607 762.5843,-842.9356 762.5843,-806.5525"/>
<polygon fill="#000000" stroke="#000000" points="766.0844,-806.1573 762.5843,-796.1574 759.0844,-806.1574 766.0844,-806.1573"/>
</g>
<!-- codeblock_7 -->
<g id="node10" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1115.5843" cy="-910.6012" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="1115.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_7</text>
</g>
<!-- leaf_14 -->
<g id="node11" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="1232.0843,-671.9013 999.0843,-671.9013 999.0843,-400.6999 1232.0843,-400.6999 1232.0843,-671.9013"/>
<text text-anchor="middle" x="1115.5843" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local d = {}</text>
<text text-anchor="middle" x="1115.5843" y="-609.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.parentOf(doc, level)</text>
<text text-anchor="middle" x="1115.5843" y="-594.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = level &#45; 1</text>
<text text-anchor="middle" x="1115.5843" y="-578.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local parent = nil</text>
<text text-anchor="middle" x="1115.5843" y="-563.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;while i &gt; 0 do</text>
<text text-anchor="middle" x="1115.5843" y="-547.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;parent = doc.lastOf[i]</text>
<text text-anchor="middle" x="1115.5843" y="-532.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent then</text>
<text text-anchor="middle" x="1115.5843" y="-517.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return parent</text>
<text text-anchor="middle" x="1115.5843" y="-501.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1115.5843" y="-486.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i = i &#45; 1</text>
<text text-anchor="middle" x="1115.5843" y="-470.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1115.5843" y="-455.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1115.5843" y="-424.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="1115.5843" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_14 -->
<g id="edge6" class="edge">
<title>codeblock_7&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1115.5843,-892.5479C1115.5843,-854.5266 1115.5843,-763.0505 1115.5843,-682.3178"/>
<polygon fill="#000000" stroke="#000000" points="1119.0844,-682.0229 1115.5843,-672.023 1112.0844,-682.023 1119.0844,-682.0229"/>
</g>
<!-- codeblock_8 -->
<g id="node12" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="1496.5843" cy="-910.6012" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="1496.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_8</text>
</g>
<!-- leaf_15 -->
<g id="node13" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="1742.5843,-856.4019 1250.5843,-856.4019 1250.5843,-216.1993 1742.5843,-216.1993 1742.5843,-856.4019"/>
<text text-anchor="middle" x="1496.5843" y="-841.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addSection(doc, section, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-826.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not doc.latest then</text>
<text text-anchor="middle" x="1496.5843" y="-810.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = &#160;section</text>
<text text-anchor="middle" x="1496.5843" y="-795.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1496.5843" y="-779.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if linum &gt; 0 then</text>
<text text-anchor="middle" x="1496.5843" y="-764.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest.line_last = linum &#45; 1 &#160;&#160;&#160;</text>
<text text-anchor="middle" x="1496.5843" y="-749.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-733.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local atLevel = doc.latest.level </text>
<text text-anchor="middle" x="1496.5843" y="-718.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if atLevel &lt; section.level then</text>
<text text-anchor="middle" x="1496.5843" y="-702.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; add the section under the latest section</text>
<text text-anchor="middle" x="1496.5843" y="-687.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-672.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1496.5843" y="-656.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local parent = doc:parentOf(section.level)</text>
<text text-anchor="middle" x="1496.5843" y="-641.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if parent.id == &quot;doc&quot; then</text>
<text text-anchor="middle" x="1496.5843" y="-625.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if section.level == 1 and doc.latest.level == 1 then</text>
<text text-anchor="middle" x="1496.5843" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[#doc + 1] = section</text>
<text text-anchor="middle" x="1496.5843" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1496.5843" y="-579.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addSection(section, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-564.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-548.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1496.5843" y="-533.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;parent:addSection(section, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-518.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-502.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-487.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-471.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = section</text>
<text text-anchor="middle" x="1496.5843" y="-456.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf[section.level] = section</text>
<text text-anchor="middle" x="1496.5843" y="-441.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="1496.5843" y="-425.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1496.5843" y="-394.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function D.addLine(doc, line, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-378.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if doc.latest then</text>
<text text-anchor="middle" x="1496.5843" y="-363.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="1496.5843" y="-348.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1496.5843" y="-332.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; a virtual zero block</text>
<text text-anchor="middle" x="1496.5843" y="-317.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc[1] = Block(0, linum)</text>
<text text-anchor="middle" x="1496.5843" y="-301.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest = doc[1]</text>
<text text-anchor="middle" x="1496.5843" y="-286.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;doc.latest:addLine(line)</text>
<text text-anchor="middle" x="1496.5843" y="-271.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1496.5843" y="-239.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc</text>
<text text-anchor="middle" x="1496.5843" y="-224.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_15 -->
<g id="edge7" class="edge">
<title>codeblock_8&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1496.5843,-892.5479C1496.5843,-885.5761 1496.5843,-876.8069 1496.5843,-866.6362"/>
<polygon fill="#000000" stroke="#000000" points="1500.0844,-866.4683 1496.5843,-856.4684 1493.0844,-866.4684 1500.0844,-866.4683"/>
</g>
<!-- block_9 -->
<g id="node14" class="node">
<title>block_9</title>
<ellipse fill="none" stroke="#000000" cx="1861.5843" cy="-910.6012" rx="40.6767" ry="18"/>
<text text-anchor="middle" x="1861.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block_9</text>
</g>
<!-- structure_16 -->
<g id="node15" class="node">
<title>structure_16</title>
<ellipse fill="none" stroke="#000000" cx="1805.5843" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1805.5843" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_9&#45;&gt;structure_16 -->
<g id="edge8" class="edge">
<title>block_9&#45;&gt;structure_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1858.8833,-892.5479C1849.885,-832.4039 1820.875,-638.5023 1809.871,-564.9524"/>
<polygon fill="#000000" stroke="#000000" points="1813.265,-563.9833 1808.3238,-554.6113 1806.3421,-565.0191 1813.265,-563.9833"/>
</g>
<!-- structure_17 -->
<g id="node16" class="node">
<title>structure_17</title>
<ellipse fill="none" stroke="#000000" cx="1918.5843" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1918.5843" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_9&#45;&gt;structure_17 -->
<g id="edge9" class="edge">
<title>block_9&#45;&gt;structure_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1864.3335,-892.5479C1873.5113,-832.2804 1903.142,-637.7055 1914.2899,-564.5008"/>
<polygon fill="#000000" stroke="#000000" points="1917.7504,-565.0242 1915.7959,-554.6113 1910.8302,-563.9703 1917.7504,-565.0242"/>
</g>
<!-- handleline_18 -->
<g id="node17" class="node">
<title>handleline_18</title>
<ellipse fill="none" stroke="#000000" cx="1802.5843" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1802.5843" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_16&#45;&gt;handleline_18 -->
<g id="edge10" class="edge">
<title>structure_16&#45;&gt;handleline_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1805.4396,-518.2473C1804.9576,-458.1033 1803.4035,-264.2017 1802.814,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="1806.3112,-190.2822 1802.7311,-180.3106 1799.3114,-190.3384 1806.3112,-190.2822"/>
</g>
<!-- handleline_21 -->
<g id="node20" class="node">
<title>handleline_21</title>
<ellipse fill="none" stroke="#000000" cx="1921.5843" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1921.5843" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_17&#45;&gt;handleline_21 -->
<g id="edge13" class="edge">
<title>structure_17&#45;&gt;handleline_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1918.729,-518.2473C1919.2111,-458.1033 1920.7652,-264.2017 1921.3547,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="1924.8572,-190.3384 1921.4376,-180.3106 1917.8574,-190.2822 1924.8572,-190.3384"/>
</g>
<!-- handle_19 -->
<g id="node18" class="node">
<title>handle_19</title>
<ellipse fill="none" stroke="#000000" cx="1802.5843" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1802.5843" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_18&#45;&gt;handle_19 -->
<g id="edge11" class="edge">
<title>handleline_18&#45;&gt;handle_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1802.5843,-143.8314C1802.5843,-136.131 1802.5843,-126.9743 1802.5843,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="1806.0844,-118.4132 1802.5843,-108.4133 1799.0844,-118.4133 1806.0844,-118.4132"/>
</g>
<!-- leaf_20 -->
<g id="node19" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1829.5843,-36 1775.5843,-36 1775.5843,0 1829.5843,0 1829.5843,-36"/>
</g>
<!-- handle_19&#45;&gt;leaf_20 -->
<g id="edge12" class="edge">
<title>handle_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1802.5843,-71.8314C1802.5843,-64.131 1802.5843,-54.9743 1802.5843,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="1806.0844,-46.4132 1802.5843,-36.4133 1799.0844,-46.4133 1806.0844,-46.4132"/>
</g>
<!-- handle_22 -->
<g id="node21" class="node">
<title>handle_22</title>
<ellipse fill="none" stroke="#000000" cx="1921.5843" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1921.5843" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_21&#45;&gt;handle_22 -->
<g id="edge14" class="edge">
<title>handleline_21&#45;&gt;handle_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1921.5843,-143.8314C1921.5843,-136.131 1921.5843,-126.9743 1921.5843,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="1925.0844,-118.4132 1921.5843,-108.4133 1918.0844,-118.4133 1925.0844,-118.4132"/>
</g>
<!-- leaf_23 -->
<g id="node22" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1948.5843,-36 1894.5843,-36 1894.5843,0 1948.5843,0 1948.5843,-36"/>
</g>
<!-- handle_22&#45;&gt;leaf_23 -->
<g id="edge15" class="edge">
<title>handle_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1921.5843,-71.8314C1921.5843,-64.131 1921.5843,-54.9743 1921.5843,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="1925.0844,-46.4132 1921.5843,-36.4133 1918.0844,-46.4133 1925.0844,-46.4132"/>
</g>
<!-- block_10 -->
<g id="node23" class="node">
<title>block_10</title>
<ellipse fill="none" stroke="#000000" cx="2040.5843" cy="-910.6012" rx="45.5132" ry="18"/>
<text text-anchor="middle" x="2040.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block_10</text>
</g>
<!-- structure_24 -->
<g id="node24" class="node">
<title>structure_24</title>
<ellipse fill="none" stroke="#000000" cx="2040.5843" cy="-536.3006" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2040.5843" y="-532.1006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_10&#45;&gt;structure_24 -->
<g id="edge16" class="edge">
<title>block_10&#45;&gt;structure_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2040.5843,-892.5479C2040.5843,-832.4039 2040.5843,-638.5023 2040.5843,-564.9524"/>
<polygon fill="#000000" stroke="#000000" points="2044.0844,-564.6112 2040.5843,-554.6113 2037.0844,-564.6113 2044.0844,-564.6112"/>
</g>
<!-- handleline_25 -->
<g id="node25" class="node">
<title>handleline_25</title>
<ellipse fill="none" stroke="#000000" cx="2040.5843" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2040.5843" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_24&#45;&gt;handleline_25 -->
<g id="edge17" class="edge">
<title>structure_24&#45;&gt;handleline_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2040.5843,-518.2473C2040.5843,-458.1033 2040.5843,-264.2017 2040.5843,-190.6518"/>
<polygon fill="#000000" stroke="#000000" points="2044.0844,-190.3106 2040.5843,-180.3106 2037.0844,-190.3107 2044.0844,-190.3106"/>
</g>
<!-- handle_26 -->
<g id="node26" class="node">
<title>handle_26</title>
<ellipse fill="none" stroke="#000000" cx="2040.5843" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2040.5843" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_25&#45;&gt;handle_26 -->
<g id="edge18" class="edge">
<title>handleline_25&#45;&gt;handle_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2040.5843,-143.8314C2040.5843,-136.131 2040.5843,-126.9743 2040.5843,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2044.0844,-118.4132 2040.5843,-108.4133 2037.0844,-118.4133 2044.0844,-118.4132"/>
</g>
<!-- leaf_27 -->
<g id="node27" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2067.5843,-36 2013.5843,-36 2013.5843,0 2067.5843,0 2067.5843,-36"/>
</g>
<!-- handle_26&#45;&gt;leaf_27 -->
<g id="edge19" class="edge">
<title>handle_26&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2040.5843,-71.8314C2040.5843,-64.131 2040.5843,-54.9743 2040.5843,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2044.0844,-46.4132 2040.5843,-36.4133 2037.0844,-46.4133 2044.0844,-46.4132"/>
</g>
<!-- codeblock_11 -->
<g id="node28" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="2247.5843" cy="-910.6012" rx="64.0625" ry="18"/>
<text text-anchor="middle" x="2247.5843" y="-906.4012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_11</text>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="2392.0843,-671.9013 2103.0843,-671.9013 2103.0843,-400.6999 2392.0843,-400.6999 2392.0843,-671.9013"/>
<text text-anchor="middle" x="2247.5843" y="-656.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Doc, str)</text>
<text text-anchor="middle" x="2247.5843" y="-641.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local doc = setmetatable({}, D)</text>
<text text-anchor="middle" x="2247.5843" y="-626.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.str = str</text>
<text text-anchor="middle" x="2247.5843" y="-610.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.id = &quot;doc&quot;</text>
<text text-anchor="middle" x="2247.5843" y="-595.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.latest = nil</text>
<text text-anchor="middle" x="2247.5843" y="-579.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lines = {}</text>
<text text-anchor="middle" x="2247.5843" y="-564.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.lastOf = {}</text>
<text text-anchor="middle" x="2247.5843" y="-549.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; for now lets set root to &#39;false&#39;</text>
<text text-anchor="middle" x="2247.5843" y="-533.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;doc.root = false</text>
<text text-anchor="middle" x="2247.5843" y="-518.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return doc:own(str)</text>
<text text-anchor="middle" x="2247.5843" y="-502.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2247.5843" y="-471.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">setmetatable(D, Node)</text>
<text text-anchor="middle" x="2247.5843" y="-440.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">d[&quot;__call&quot;] = new</text>
<text text-anchor="middle" x="2247.5843" y="-408.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">return setmetatable({}, d)</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_28 -->
<g id="edge20" class="edge">
<title>codeblock_11&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2247.5843,-892.5479C2247.5843,-854.5266 2247.5843,-763.0505 2247.5843,-682.3178"/>
<polygon fill="#000000" stroke="#000000" points="2251.0844,-682.0229 2247.5843,-672.023 2244.0844,-682.023 2251.0844,-682.0229"/>
</g>
</g>
</svg>