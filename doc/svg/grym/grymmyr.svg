<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2231pt" height="1271pt"
 viewBox="0.00 0.00 2230.89 1270.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1266.6015)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1266.6015 2226.8945,-1266.6015 2226.8945,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="864.3945" cy="-1244.6015" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="864.3945" y="-1240.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 125</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="864.3945" cy="-1172.6015" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="864.3945" y="-1168.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;125</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M864.3945,-1226.4329C864.3945,-1218.7325 864.3945,-1209.5759 864.3945,-1201.0182"/>
<polygon fill="#000000" stroke="#000000" points="867.8946,-1201.0148 864.3945,-1191.0148 860.8946,-1201.0148 867.8946,-1201.0148"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="363.3945" cy="-1100.6015" rx="96.1863" ry="18"/>
<text text-anchor="middle" x="363.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Grimoire Grammar</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M804.5937,-1165.0951C726.9764,-1155.2037 587.3797,-1136.9074 468.3945,-1118.6015 460.2485,-1117.3483 451.7568,-1115.9859 443.2867,-1114.5904"/>
<polygon fill="#000000" stroke="#000000" points="443.8142,-1111.1301 433.3754,-1112.9415 442.6654,-1118.0352 443.8142,-1111.1301"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="509.3945" cy="-1100.6015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="509.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M802.5947,-1166.4716C738.522,-1159.0782 635.9454,-1144.3174 550.3945,-1118.6015 547.9842,-1117.877 545.5279,-1117.0479 543.0756,-1116.1522"/>
<polygon fill="#000000" stroke="#000000" points="544.3299,-1112.8845 533.7441,-1112.448 541.7472,-1119.3906 544.3299,-1112.8845"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="632.3945" cy="-1100.6015" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="632.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 4&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.7571,-1159.0589C783.0449,-1147.3551 728.3433,-1130.3787 687.5949,-1117.7327"/>
<polygon fill="#000000" stroke="#000000" points="688.4054,-1114.3196 677.8174,-1114.6983 686.3306,-1121.0051 688.4054,-1114.3196"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="800.3945" cy="-1100.6015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="800.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 29&#45;31</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.5743,-1154.8038C840.8818,-1146.1498 831.4967,-1135.5915 823.0601,-1126.1004"/>
<polygon fill="#000000" stroke="#000000" points="825.5141,-1123.5929 816.2545,-1118.4441 820.2823,-1128.2435 825.5141,-1123.5929"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="928.3945" cy="-1100.6015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="928.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M880.2147,-1154.8038C888.2761,-1145.7347 898.1966,-1134.5742 906.9361,-1124.7422"/>
<polygon fill="#000000" stroke="#000000" points="909.606,-1127.0068 913.6337,-1117.2074 904.3741,-1122.3562 909.606,-1127.0068"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1155.3945" cy="-1100.6015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1155.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 36&#45;57</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M913.4296,-1160.4691C962.683,-1148.2827 1038.7774,-1129.4552 1092.4591,-1116.1732"/>
<polygon fill="#000000" stroke="#000000" points="1093.3437,-1119.5599 1102.2104,-1113.7605 1091.6624,-1112.7648 1093.3437,-1119.5599"/>
</g>
<!-- prose_8 -->
<g id="node9" class="node">
<title>prose_8</title>
<ellipse fill="none" stroke="#000000" cx="1431.3945" cy="-1100.6015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1431.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;prose_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M924.0018,-1165.0324C1039.3372,-1150.3866 1290.4078,-1118.5046 1389.7386,-1105.8912"/>
<polygon fill="#000000" stroke="#000000" points="1390.2221,-1109.358 1399.7015,-1104.626 1389.3403,-1102.4137 1390.2221,-1109.358"/>
</g>
<!-- codeblock_9 -->
<g id="node10" class="node">
<title>codeblock_9</title>
<ellipse fill="none" stroke="#000000" cx="1744.3945" cy="-1100.6015" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1744.3945" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 65&#45;124</text>
</g>
<!-- section_1&#45;&gt;codeblock_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;codeblock_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M927.3288,-1167.4524C1081.7808,-1154.8154 1479.8341,-1122.2474 1657.0493,-1107.748"/>
<polygon fill="#000000" stroke="#000000" points="1657.4356,-1111.2281 1667.1169,-1106.9242 1656.8648,-1104.2514 1657.4356,-1111.2281"/>
</g>
<!-- raw_10 -->
<g id="node11" class="node">
<title>raw_10</title>
<ellipse fill="none" stroke="#000000" cx="38.3945" cy="-591.8008" rx="27" ry="18"/>
<text text-anchor="middle" x="38.3945" y="-587.6008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;raw_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M485.1378,-1088.4224C479.7407,-1086.1482 473.9648,-1084.0381 468.3945,-1082.6015 383.26,-1060.645 136.1854,-1109.1464 74.3945,-1046.6015 -42.276,-928.5076 7.9619,-698.9363 30.0116,-619.5798"/>
<polygon fill="#000000" stroke="#000000" points="33.4173,-620.3995 32.7934,-609.823 26.6855,-618.4801 33.4173,-620.3995"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="610.8945,-742.6014 83.8945,-742.6014 83.8945,-441.0002 610.8945,-441.0002 610.8945,-742.6014"/>
<text text-anchor="middle" x="347.3945" y="-727.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="347.3945" y="-712.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;../peg/epeg&quot;</text>
<text text-anchor="middle" x="347.3945" y="-696.701" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;../peg/epnf&quot;</text>
<text text-anchor="middle" x="347.3945" y="-665.301" font-family="Inconsolata" font-size="14.00" fill="#000000">local match = lpeg.match &#45;&#45; match a pattern against a string</text>
<text text-anchor="middle" x="347.3945" y="-649.901" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = lpeg.P &#45;&#45; match a string literally</text>
<text text-anchor="middle" x="347.3945" y="-634.501" font-family="Inconsolata" font-size="14.00" fill="#000000">local S = lpeg.S &#160;&#45;&#45; match anything in a set</text>
<text text-anchor="middle" x="347.3945" y="-619.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">local R = epeg.R &#160;&#45;&#45; match anything in a range</text>
<text text-anchor="middle" x="347.3945" y="-603.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = lpeg.B &#160;&#45;&#45; match iff the pattern precedes the use of B</text>
<text text-anchor="middle" x="347.3945" y="-588.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = lpeg.C &#160;&#45;&#45; captures a match</text>
<text text-anchor="middle" x="347.3945" y="-572.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp &#45;&#45; captures start and end position of match</text>
<text text-anchor="middle" x="347.3945" y="-557.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cg = lpeg.Cg &#45;&#45; named capture group (for **balanced highlighting**)</text>
<text text-anchor="middle" x="347.3945" y="-542.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cb = lpeg.Cb &#45;&#45; Back capture</text>
<text text-anchor="middle" x="347.3945" y="-526.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cmt = lpeg.Cmt &#45;&#45; match&#45;time capture</text>
<text text-anchor="middle" x="347.3945" y="-511.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Ct = lpeg.Ct &#45;&#45; a table with all captures from the pattern</text>
<text text-anchor="middle" x="347.3945" y="-495.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local V = lpeg.V &#45;&#45; create a variable within a grammar</text>
<text text-anchor="middle" x="347.3945" y="-464.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local letter = R&quot;AZ&quot; + R&quot;az&quot; &#160;&#160;</text>
<text text-anchor="middle" x="347.3945" y="-449.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local digit = R&quot;09&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_4&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M622.2512,-1082.493C592.8374,-1029.9816 505.2488,-873.6128 436.7663,-751.3533"/>
<polygon fill="#000000" stroke="#000000" points="439.8103,-749.6256 431.8697,-742.6115 433.7031,-753.0465 439.8103,-749.6256"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="883.3945,-609.8008 629.3945,-609.8008 629.3945,-573.8008 883.3945,-573.8008 883.3945,-609.8008"/>
<text text-anchor="middle" x="756.3945" y="-588.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">local punctuation = S&quot;!?,.:;\\^%~&quot;</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_5&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M798.8285,-1082.493C792.2534,-1006.4612 766.8494,-712.6985 758.8328,-619.997"/>
<polygon fill="#000000" stroke="#000000" points="762.3133,-619.6186 757.9646,-609.9573 755.3393,-620.2217 762.3133,-619.6186"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="928.3945" cy="-591.8008" rx="27" ry="18"/>
<text text-anchor="middle" x="928.3945" y="-587.6008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_6&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M928.3945,-1082.493C928.3945,-1006.4612 928.3945,-712.6985 928.3945,-619.997"/>
<polygon fill="#000000" stroke="#000000" points="931.8946,-619.9573 928.3945,-609.9573 924.8946,-619.9574 931.8946,-619.9573"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1535.3945,-750.5015 973.3945,-750.5015 973.3945,-433.1002 1535.3945,-433.1002 1535.3945,-750.5015"/>
<text text-anchor="middle" x="1254.3945" y="-735.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">local interior = S&quot;*_&#45;/@#&quot;</text>
<text text-anchor="middle" x="1254.3945" y="-719.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local sym = letter + digit + punctuation + interior</text>
<text text-anchor="middle" x="1254.3945" y="-704.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local first_letter = letter + digit + punctuation</text>
<text text-anchor="middle" x="1254.3945" y="-689.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = P&#39; &#39; + P&#39;,&#39; + P&#39;\09&#39; &#45;&#45; Not accurate, refine (needs Unicode spaces)</text>
<text text-anchor="middle" x="1254.3945" y="-673.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local NL = P&quot;\n&quot;</text>
<text text-anchor="middle" x="1254.3945" y="-642.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="1254.3945" y="-626.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="1254.3945" y="-611.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="1254.3945" y="-596.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="1254.3945" y="-580.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1254.3945" y="-549.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="1254.3945" y="-533.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="1254.3945" y="-518.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="1254.3945" y="-503.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="1254.3945" y="-487.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="1254.3945" y="-472.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="1254.3945" y="-456.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="1254.3945" y="-441.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_7&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1158.9179,-1082.493C1168.8767,-1031.3109 1198.0335,-881.4627 1221.5307,-760.7011"/>
<polygon fill="#000000" stroke="#000000" points="1225.024,-761.0726 1223.4984,-750.5882 1218.1528,-759.7356 1225.024,-761.0726"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="1580.3945" cy="-591.8008" rx="27" ry="18"/>
<text text-anchor="middle" x="1580.3945" y="-587.6008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_8&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_8&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1462.1442,-1094.7929C1488.6325,-1088.0444 1525.4943,-1074.1098 1544.3945,-1046.6015 1637.5679,-910.9924 1603.2353,-696.0024 1586.9753,-619.7482"/>
<polygon fill="#000000" stroke="#000000" points="1590.3827,-618.9465 1584.8161,-609.9319 1583.5462,-620.4503 1590.3827,-618.9465"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2222.8945,-1046.4023 1625.8945,-1046.4023 1625.8945,-137.1994 2222.8945,-137.1994 2222.8945,-1046.4023"/>
<text text-anchor="middle" x="1924.3945" y="-1031.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">local _grym_fn = function ()</text>
<text text-anchor="middle" x="1924.3945" y="-1016.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local function grymmyr (_ENV)</text>
<text text-anchor="middle" x="1924.3945" y="-1000.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;START &quot;grym&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-985.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;SUPPRESS (&quot;structure&quot;, &quot;structured&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-953.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local prose_word = first_letter * (sym^1)^0</text>
<text text-anchor="middle" x="1924.3945" y="-938.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local prose_span = (prose_word + WS^1)^1</text>
<text text-anchor="middle" x="1924.3945" y="-923.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local NEOL = NL + &#45;P(1)</text>
<text text-anchor="middle" x="1924.3945" y="-907.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local LS = B(&quot;\n&quot;) + &#45;B(1)</text>
<text text-anchor="middle" x="1924.3945" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;grym &#160;&#160;&#160;&#160;&#160;= &#160;V&quot;section&quot;^1 * V&quot;unparsed&quot;^0</text>
<text text-anchor="middle" x="1924.3945" y="-844.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;section &#160;&#160;= &#160;(V&quot;header&quot; * V&quot;block&quot;^0) + V&quot;block&quot;^1</text>
<text text-anchor="middle" x="1924.3945" y="-813.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;structure = &#160;V&quot;blank_line&quot; &#45;&#45; list, table, json, comment...</text>
<text text-anchor="middle" x="1924.3945" y="-782.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;header &#160;&#160;&#160;&#160;= &#160;LS * V&quot;lead_ws&quot; * V&quot;lead_tar&quot; * V&quot;prose_line&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-766.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lead_ws &#160;&#160;&#160;= &#160;Csp(P&quot; &quot;^0)</text>
<text text-anchor="middle" x="1924.3945" y="-751.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lead_tar &#160;&#160;= &#160;Csp(P&quot;*&quot;^&#45;6 * P&quot; &quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-735.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose_line = &#160;Csp(prose_span * NEOL)</text>
<text text-anchor="middle" x="1924.3945" y="-704.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;block = &#160;(V&quot;structure&quot;^1 + V&quot;prose&quot;^1)^1 * #V&quot;block_end&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-673.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose &#160;&#160;&#160;&#160;&#160;&#160;&#160;= &#160;(V&quot;structured&quot; + V&quot;unstructured&quot;)^1</text>
<text text-anchor="middle" x="1924.3945" y="-657.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;unstructured = &#160;Csp(V&quot;prose_line&quot;^1 * prose_span + V&quot;prose_line&quot;^1</text>
<text text-anchor="middle" x="1924.3945" y="-642.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ prose_span &#45;V&quot;header&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-626.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;structured &#160;&#160;= &#160;V&quot;bold&quot; + V&quot;italic&quot; + V&quot;underscore&quot; + V&quot;strikethrough&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-611.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ V&quot;literal&quot; + V&quot;quoted&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-580.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;unparsed = Csp(P(1)^1)</text>
<text text-anchor="middle" x="1924.3945" y="-548.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Highlighting</text>
<text text-anchor="middle" x="1924.3945" y="-533.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; These inner blocks will need to be re&#45;parsed to render, e.g., links</text>
<text text-anchor="middle" x="1924.3945" y="-517.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; or multiple layers of highlight. </text>
<text text-anchor="middle" x="1924.3945" y="-502.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-487.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-471.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-456.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-440.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-425.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;bold &#160;&#160;= &#160;Csp(bold_open * (P(1) &#45; bold_close)^0 * bold_close / 1) &#45; V&quot;header&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-410.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;italic = &#160;Csp(italic_open * (P(1) &#45; italic_close)^0 * italic_close / 1)</text>
<text text-anchor="middle" x="1924.3945" y="-394.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;underscore = Csp(under_open * (P(1) &#45; under_close)^0 * under_close / 1)</text>
<text text-anchor="middle" x="1924.3945" y="-379.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;strikethrough = Csp(strike_open * (P(1) &#45; strike_close)^0 * strike_close / 1)</text>
<text text-anchor="middle" x="1924.3945" y="-363.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;literal = Csp(lit_open * (P(1) &#45; lit_close)^0 * lit_close / 1)</text>
<text text-anchor="middle" x="1924.3945" y="-332.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local quoted_open = Cg(C(P(&quot;\&quot;&quot;)^2), &quot;quoted_init&quot;)</text>
<text text-anchor="middle" x="1924.3945" y="-317.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local quoted_close = Cmt(C(P(&quot;\&quot;&quot;)^1) * Cb(&quot;quoted_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="1924.3945" y="-301.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;quoted = Csp(quoted_open * (P(1) &#45; quoted_close)^0 * quoted_close / 1)</text>
<text text-anchor="middle" x="1924.3945" y="-270.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;block_end = V&quot;blank_line&quot;^1 + &#45;P(1) + #V&quot;header&quot;</text>
<text text-anchor="middle" x="1924.3945" y="-238.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;blank_line = Csp((WS^0 * NL)^1)</text>
<text text-anchor="middle" x="1924.3945" y="-223.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1924.3945" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return grymmyr</text>
<text text-anchor="middle" x="1924.3945" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1924.3945" y="-145.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">return epnf.define(_grym_fn(), nil, false)</text>
</g>
<!-- codeblock_9&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_9&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1750.8008,-1082.493C1753.2953,-1075.4417 1756.4524,-1066.5177 1760.1538,-1056.055"/>
<polygon fill="#000000" stroke="#000000" points="1763.5081,-1057.0677 1763.5437,-1046.4729 1756.9089,-1054.733 1763.5081,-1057.0677"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="65.3945,-70.5001 11.3945,-70.5001 11.3945,-30.5001 65.3945,-30.5001 65.3945,-70.5001"/>
</g>
<!-- raw_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>raw_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M38.3945,-573.7908C38.3945,-495.0189 38.3945,-180.3033 38.3945,-80.8119"/>
<polygon fill="#000000" stroke="#000000" points="41.8946,-80.554 38.3945,-70.554 34.8946,-80.554 41.8946,-80.554"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="1146.3945,-77.8005 710.3945,-77.8005 710.3945,-23.1997 1146.3945,-23.1997 1146.3945,-77.8005"/>
<text text-anchor="middle" x="928.3945" y="-46.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Interior symbols are valid within a prose word, but not if </text>
<text text-anchor="middle" x="928.3945" y="-31.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> preceded by whitespace</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M928.3945,-573.7908C928.3945,-496.9077 928.3945,-195.2604 928.3945,-88.3338"/>
<polygon fill="#000000" stroke="#000000" points="931.8946,-88.0231 928.3945,-78.0231 924.8946,-88.0232 931.8946,-88.0231"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1840.3945,-101.0002 1320.3945,-101.0002 1320.3945,.0001 1840.3945,.0001 1840.3945,-101.0002"/>
<text text-anchor="middle" x="1580.3945" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> The Grimoire grammar is a specially&#45;massaged closure to be executed</text>
<text text-anchor="middle" x="1580.3945" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> in the epnf context. </text>
<text text-anchor="middle" x="1580.3945" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1580.3945" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> The advantage of this approach is that we can make it look much like an</text>
<text text-anchor="middle" x="1580.3945" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> actual grammar. This should aid in porting to target languages. </text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1580.3945,-573.7908C1580.3945,-501.8669 1580.3945,-233.2396 1580.3945,-111.343"/>
<polygon fill="#000000" stroke="#000000" points="1583.8946,-111.0672 1580.3945,-101.0672 1576.8946,-111.0672 1583.8946,-111.0672"/>
</g>
</g>
</svg>