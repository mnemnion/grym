<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2398pt" height="1271pt"
 viewBox="0.00 0.00 2398.00 1270.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1266.6015)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1266.6015 2394,-1266.6015 2394,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="967.5" cy="-1244.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="967.5" y="-1240.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">25 &#160;</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="967.5" cy="-1172.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="967.5" y="-1168.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">25 &#160;</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M967.5,-1226.4329C967.5,-1218.7325 967.5,-1209.5759 967.5,-1201.0182"/>
<polygon fill="#000000" stroke="#000000" points="971.0001,-1201.0148 967.5,-1191.0148 964.0001,-1201.0148 971.0001,-1201.0148"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="530.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="530.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">ar &#160;</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M940.0921,-1171.9977C874.23,-1169.8891 702.448,-1160.4695 566.5,-1118.6015 564.5967,-1118.0154 562.671,-1117.3366 560.7515,-1116.5932"/>
<polygon fill="#000000" stroke="#000000" points="561.9015,-1113.2758 551.3377,-1112.4659 559.0908,-1119.6868 561.9015,-1113.2758"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="602.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="602.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">&#45;3 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M940.416,-1170.9165C883.3302,-1166.7714 746.9822,-1153.7304 638.5,-1118.6015 636.6054,-1117.988 634.6864,-1117.288 632.772,-1116.5284"/>
<polygon fill="#000000" stroke="#000000" points="633.9321,-1113.2141 623.3719,-1112.3577 631.0931,-1119.6126 633.9321,-1113.2141"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="674.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="674.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">28 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M942.0107,-1166.338C889.6281,-1153.4658 769.7802,-1124.0151 709.9039,-1109.3015"/>
<polygon fill="#000000" stroke="#000000" points="710.6853,-1105.8894 700.139,-1106.9019 709.0148,-1112.6872 710.6853,-1105.8894"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="883.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="883.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">32 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M950.9043,-1158.3766C938.6739,-1147.8935 921.8399,-1133.4643 908.0549,-1121.6486"/>
<polygon fill="#000000" stroke="#000000" points="910.2191,-1118.8938 900.3487,-1115.0433 905.6635,-1124.2087 910.2191,-1118.8938"/>
</g>
<!-- block_6 -->
<g id="node7" class="node">
<title>block_6</title>
<ellipse fill="none" stroke="#000000" cx="1051.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="1051.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">35 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;block_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M984.0957,-1158.3766C996.3261,-1147.8935 1013.1601,-1133.4643 1026.9451,-1121.6486"/>
<polygon fill="#000000" stroke="#000000" points="1029.3365,-1124.2087 1034.6513,-1115.0433 1024.7809,-1118.8938 1029.3365,-1124.2087"/>
</g>
<!-- block_7 -->
<g id="node8" class="node">
<title>block_7</title>
<ellipse fill="none" stroke="#000000" cx="1409.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="1409.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">58 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;block_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M993.8254,-1168.3132C1069.2792,-1156.0221 1286.4401,-1120.6475 1373.1272,-1106.5265"/>
<polygon fill="#000000" stroke="#000000" points="1373.7266,-1109.9751 1383.0337,-1104.9128 1372.6011,-1103.0662 1373.7266,-1109.9751"/>
</g>
<!-- block_8 -->
<g id="node9" class="node">
<title>block_8</title>
<ellipse fill="none" stroke="#000000" cx="1634.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="1634.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">64 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;block_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M994.4733,-1169.6899C1098.9236,-1158.4149 1476.9431,-1117.6092 1597.3721,-1104.6093"/>
<polygon fill="#000000" stroke="#000000" points="1597.991,-1108.063 1607.5576,-1103.5099 1597.2397,-1101.1034 1597.991,-1108.063"/>
</g>
<!-- block_9 -->
<g id="node10" class="node">
<title>block_9</title>
<ellipse fill="none" stroke="#000000" cx="2091.5" cy="-1100.6015" rx="27" ry="18"/>
<text text-anchor="middle" x="2091.5" y="-1096.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">25 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;block_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M994.451,-1170.8751C1144.8746,-1161.2395 1880.1278,-1114.1414 2054.4045,-1102.9778"/>
<polygon fill="#000000" stroke="#000000" points="2054.8471,-1106.4567 2064.6029,-1102.3245 2054.3995,-1099.471 2054.8471,-1106.4567"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="218.5,-1016.1015 164.5,-1016.1015 164.5,-976.1015 218.5,-976.1015 218.5,-1016.1015"/>
</g>
<!-- block_3&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>block_3&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M582.0765,-1088.8168C577.1164,-1086.4016 571.731,-1084.1325 566.5,-1082.6015 421.0862,-1040.0426 358.3312,-1123.0192 227.5,-1046.6015 218.6676,-1041.4426 211.4329,-1033.1581 205.8264,-1024.7784"/>
<polygon fill="#000000" stroke="#000000" points="208.7596,-1022.8655 200.5746,-1016.1382 202.778,-1026.5014 208.7596,-1022.8655"/>
</g>
<!-- codeblock_11 -->
<g id="node12" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="263.5" cy="-996.1015" rx="27" ry="18"/>
<text text-anchor="middle" x="263.5" y="-991.9015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">24 &#160;</text>
</g>
<!-- block_4&#45;&gt;codeblock_11 -->
<g id="edge11" class="edge">
<title>block_4&#45;&gt;codeblock_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M654.0765,-1088.8168C649.1164,-1086.4016 643.731,-1084.1325 638.5,-1082.6015 493.0862,-1040.0426 430.3312,-1123.0192 299.5,-1046.6015 289.8773,-1040.981 282.1511,-1031.6506 276.3607,-1022.5289"/>
<polygon fill="#000000" stroke="#000000" points="279.2489,-1020.5314 271.2171,-1013.6219 273.187,-1024.032 279.2489,-1020.5314"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="766,-1031.4018 309,-1031.4018 309,-960.8011 766,-960.8011 766,-1031.4018"/>
<text text-anchor="middle" x="537.5" y="-1000.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> Punctuation is valid inside of prose blocks, even with leading</text>
<text text-anchor="middle" x="537.5" y="-984.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> whitespace</text>
</g>
<!-- block_4&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>block_4&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M656.5896,-1086.94C640.1749,-1074.4192 615.0032,-1055.2189 592.0233,-1037.6904"/>
<polygon fill="#000000" stroke="#000000" points="594.0781,-1034.8558 584.0044,-1031.5738 589.8327,-1040.4215 594.0781,-1034.8558"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="811.5" cy="-996.1015" rx="27" ry="18"/>
<text text-anchor="middle" x="811.5" y="-991.9015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">31 &#160;</text>
</g>
<!-- block_5&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>block_5&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M871.932,-1083.8118C860.2115,-1066.8008 841.9493,-1040.2952 828.5664,-1020.8715"/>
<polygon fill="#000000" stroke="#000000" points="831.3578,-1018.7539 822.802,-1012.505 825.5935,-1022.7255 831.3578,-1018.7539"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="910.5,-1014.1015 856.5,-1014.1015 856.5,-978.1015 910.5,-978.1015 910.5,-1014.1015"/>
</g>
<!-- block_5&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>block_5&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M883.5,-1082.399C883.5,-1066.4632 883.5,-1043.0434 883.5,-1024.621"/>
<polygon fill="#000000" stroke="#000000" points="887.0001,-1024.446 883.5,-1014.446 880.0001,-1024.446 887.0001,-1024.446"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1364.5,-1023.4019 928.5,-1023.4019 928.5,-968.801 1364.5,-968.801 1364.5,-1023.4019"/>
<text text-anchor="middle" x="1146.5" y="-1008.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> Interior symbols are valid within a prose word, but not if </text>
<text text-anchor="middle" x="1146.5" y="-992.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> preceded by whitespace</text>
</g>
<!-- block_6&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>block_6&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1065.5176,-1085.1822C1078.3434,-1071.0738 1097.7959,-1049.676 1114.4212,-1031.3882"/>
<polygon fill="#000000" stroke="#000000" points="1117.2087,-1033.5251 1121.3456,-1023.7713 1112.0291,-1028.8163 1117.2087,-1033.5251"/>
</g>
<!-- codeblock_18 -->
<g id="node19" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="1409.5" cy="-996.1015" rx="27" ry="18"/>
<text text-anchor="middle" x="1409.5" y="-991.9015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">57 &#160;</text>
</g>
<!-- block_7&#45;&gt;codeblock_18 -->
<g id="edge18" class="edge">
<title>block_7&#45;&gt;codeblock_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1409.5,-1082.399C1409.5,-1066.4632 1409.5,-1043.0434 1409.5,-1024.621"/>
<polygon fill="#000000" stroke="#000000" points="1413.0001,-1024.446 1409.5,-1014.446 1406.0001,-1024.446 1413.0001,-1024.446"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1508.5,-1014.1015 1454.5,-1014.1015 1454.5,-978.1015 1508.5,-978.1015 1508.5,-1014.1015"/>
</g>
<!-- block_7&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_7&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1421.068,-1083.8118C1432.4438,-1067.3011 1449.9821,-1041.8462 1463.2403,-1022.6033"/>
<polygon fill="#000000" stroke="#000000" points="1466.2017,-1024.4741 1468.9933,-1014.2536 1460.4374,-1020.5025 1466.2017,-1024.4741"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2046.5,-1046.6016 1526.5,-1046.6016 1526.5,-945.6013 2046.5,-945.6013 2046.5,-1046.6016"/>
<text text-anchor="middle" x="1786.5" y="-1031.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> The Grimoire grammar is a specially&#45;massaged closure to be executed</text>
<text text-anchor="middle" x="1786.5" y="-1016.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> in the epnf context. </text>
<text text-anchor="middle" x="1786.5" y="-1000.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1786.5" y="-985.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> The advantage of this approach is that we can make it look much like an</text>
<text text-anchor="middle" x="1786.5" y="-969.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> actual grammar. This should aid in porting to target languages. </text>
</g>
<!-- block_8&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>block_8&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1653.4436,-1087.5778C1666.6151,-1078.5224 1685.1748,-1065.7626 1704.2628,-1052.6395"/>
<polygon fill="#000000" stroke="#000000" points="1706.4983,-1055.3501 1712.7558,-1046.8006 1702.5325,-1049.5818 1706.4983,-1055.3501"/>
</g>
<!-- codeblock_22 -->
<g id="node23" class="node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="2091.5" cy="-996.1015" rx="27" ry="18"/>
<text text-anchor="middle" x="2091.5" y="-991.9015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">24 &#160;</text>
</g>
<!-- block_9&#45;&gt;codeblock_22 -->
<g id="edge22" class="edge">
<title>block_9&#45;&gt;codeblock_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2091.5,-1082.399C2091.5,-1066.4632 2091.5,-1043.0434 2091.5,-1024.621"/>
<polygon fill="#000000" stroke="#000000" points="2095.0001,-1024.446 2091.5,-1014.446 2088.0001,-1024.446 2095.0001,-1024.446"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2190.5,-1014.1015 2136.5,-1014.1015 2136.5,-978.1015 2190.5,-978.1015 2190.5,-1014.1015"/>
</g>
<!-- block_9&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>block_9&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2103.068,-1083.8118C2114.4438,-1067.3011 2131.9821,-1041.8462 2145.2403,-1022.6033"/>
<polygon fill="#000000" stroke="#000000" points="2148.2017,-1024.4741 2150.9933,-1014.2536 2142.4374,-1020.5025 2148.2017,-1024.4741"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="527,-605.6013 0,-605.6013 0,-304.0001 527,-304.0001 527,-605.6013"/>
<text text-anchor="middle" x="263.5" y="-590.501" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="263.5" y="-575.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;../peg/epeg&quot;</text>
<text text-anchor="middle" x="263.5" y="-559.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;../peg/epnf&quot;</text>
<text text-anchor="middle" x="263.5" y="-528.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">local match = lpeg.match &#45;&#45; match a pattern against a string</text>
<text text-anchor="middle" x="263.5" y="-512.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = lpeg.P &#45;&#45; match a string literally</text>
<text text-anchor="middle" x="263.5" y="-497.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">local S = lpeg.S &#160;&#45;&#45; match anything in a set</text>
<text text-anchor="middle" x="263.5" y="-482.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local R = epeg.R &#160;&#45;&#45; match anything in a range</text>
<text text-anchor="middle" x="263.5" y="-466.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = lpeg.B &#160;&#45;&#45; match iff the pattern precedes the use of B</text>
<text text-anchor="middle" x="263.5" y="-451.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = lpeg.C &#160;&#45;&#45; captures a match</text>
<text text-anchor="middle" x="263.5" y="-435.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp &#45;&#45; captures start and end position of match</text>
<text text-anchor="middle" x="263.5" y="-420.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cg = lpeg.Cg &#45;&#45; named capture group (for **balanced highlighting**)</text>
<text text-anchor="middle" x="263.5" y="-405.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cb = lpeg.Cb &#45;&#45; Back capture</text>
<text text-anchor="middle" x="263.5" y="-389.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cmt = lpeg.Cmt &#45;&#45; match&#45;time capture</text>
<text text-anchor="middle" x="263.5" y="-374.3005" font-family="Inconsolata" font-size="14.00" fill="#000000">local Ct = lpeg.Ct &#45;&#45; a table with all captures from the pattern</text>
<text text-anchor="middle" x="263.5" y="-358.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">local V = lpeg.V &#45;&#45; create a variable within a grammar</text>
<text text-anchor="middle" x="263.5" y="-327.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">local letter = R&quot;AZ&quot; + R&quot;az&quot; &#160;&#160;</text>
<text text-anchor="middle" x="263.5" y="-312.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">local digit = R&quot;09&quot;</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_11&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M263.5,-978.0914C263.5,-922.3097 263.5,-748.2106 263.5,-616.0074"/>
<polygon fill="#000000" stroke="#000000" points="267.0001,-615.763 263.5,-605.763 260.0001,-615.763 267.0001,-615.763"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="938.5,-472.8007 684.5,-472.8007 684.5,-436.8007 938.5,-436.8007 938.5,-472.8007"/>
<text text-anchor="middle" x="811.5" y="-451.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">local punctuation = S&quot;!?,.:;\\^%~&quot;</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>codeblock_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M811.5,-978.0914C811.5,-898.7811 811.5,-580.2906 811.5,-483.1027"/>
<polygon fill="#000000" stroke="#000000" points="815.0001,-482.8783 811.5,-472.8784 808.0001,-482.8784 815.0001,-482.8783"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1690.5,-613.5013 1128.5,-613.5013 1128.5,-296.1001 1690.5,-296.1001 1690.5,-613.5013"/>
<text text-anchor="middle" x="1409.5" y="-598.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local interior = S&quot;*_&#45;/@#&quot;</text>
<text text-anchor="middle" x="1409.5" y="-582.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local sym = letter + digit + punctuation + interior</text>
<text text-anchor="middle" x="1409.5" y="-567.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local first_letter = letter + digit + punctuation</text>
<text text-anchor="middle" x="1409.5" y="-552.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = P&#39; &#39; + P&#39;,&#39; + P&#39;\09&#39; &#45;&#45; Not accurate, refine (needs Unicode spaces)</text>
<text text-anchor="middle" x="1409.5" y="-536.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local NL = P&quot;\n&quot;</text>
<text text-anchor="middle" x="1409.5" y="-505.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function equal_strings(s, i, a, b)</text>
<text text-anchor="middle" x="1409.5" y="-489.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns true if a and b are equal.</text>
<text text-anchor="middle" x="1409.5" y="-474.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; s and i are not used, provided because expected by Cb.</text>
<text text-anchor="middle" x="1409.5" y="-459.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return a == b</text>
<text text-anchor="middle" x="1409.5" y="-443.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1409.5" y="-412.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function bookends(sigil)</text>
<text text-anchor="middle" x="1409.5" y="-396.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Returns a pair of patterns, _open and _close,</text>
<text text-anchor="middle" x="1409.5" y="-381.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; which will match a brace of sigil.</text>
<text text-anchor="middle" x="1409.5" y="-366.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; sigil must be a string. </text>
<text text-anchor="middle" x="1409.5" y="-350.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _open = Cg(C(P(sigil)^1), sigil .. &quot;_init&quot;)</text>
<text text-anchor="middle" x="1409.5" y="-335.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local _close = &#160;Cmt(C(P(sigil)^1) * Cb(sigil .. &quot;_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="1409.5" y="-319.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return _open, _close</text>
<text text-anchor="middle" x="1409.5" y="-304.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1409.5,-978.0914C1409.5,-923.3824 1409.5,-754.8629 1409.5,-623.6798"/>
<polygon fill="#000000" stroke="#000000" points="1413.0001,-623.5057 1409.5,-613.5057 1406.0001,-623.5058 1413.0001,-623.5057"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2390,-909.4021 1793,-909.4021 1793,-.1992 2390,-.1992 2390,-909.4021"/>
<text text-anchor="middle" x="2091.5" y="-894.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local _grym_fn = function ()</text>
<text text-anchor="middle" x="2091.5" y="-879.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local function grymmyr (_ENV)</text>
<text text-anchor="middle" x="2091.5" y="-863.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;START &quot;grym&quot;</text>
<text text-anchor="middle" x="2091.5" y="-848.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;SUPPRESS (&quot;structure&quot;, &quot;structured&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-816.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local prose_word = first_letter * (sym^1)^0</text>
<text text-anchor="middle" x="2091.5" y="-801.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local prose_span = (prose_word + WS^1)^1</text>
<text text-anchor="middle" x="2091.5" y="-786.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local NEOL = NL + &#45;P(1)</text>
<text text-anchor="middle" x="2091.5" y="-770.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local LS = B(&quot;\n&quot;) + &#45;B(1)</text>
<text text-anchor="middle" x="2091.5" y="-739.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;grym &#160;&#160;&#160;&#160;&#160;= &#160;V&quot;section&quot;^1 * V&quot;unparsed&quot;^0</text>
<text text-anchor="middle" x="2091.5" y="-707.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;section &#160;&#160;= &#160;(V&quot;header&quot; * V&quot;block&quot;^0) + V&quot;block&quot;^1</text>
<text text-anchor="middle" x="2091.5" y="-676.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;structure = &#160;V&quot;blank_line&quot; &#45;&#45; list, table, json, comment...</text>
<text text-anchor="middle" x="2091.5" y="-645.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;header &#160;&#160;&#160;&#160;= &#160;LS * V&quot;lead_ws&quot; * V&quot;lead_tar&quot; * V&quot;prose_line&quot;</text>
<text text-anchor="middle" x="2091.5" y="-629.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lead_ws &#160;&#160;&#160;= &#160;Csp(P&quot; &quot;^0)</text>
<text text-anchor="middle" x="2091.5" y="-614.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lead_tar &#160;&#160;= &#160;Csp(P&quot;*&quot;^&#45;6 * P&quot; &quot;)</text>
<text text-anchor="middle" x="2091.5" y="-598.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose_line = &#160;Csp(prose_span * NEOL)</text>
<text text-anchor="middle" x="2091.5" y="-567.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;block = &#160;(V&quot;structure&quot;^1 + V&quot;prose&quot;^1)^1 * #V&quot;block_end&quot;</text>
<text text-anchor="middle" x="2091.5" y="-536.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;prose &#160;&#160;&#160;&#160;&#160;&#160;&#160;= &#160;(V&quot;structured&quot; + V&quot;unstructured&quot;)^1</text>
<text text-anchor="middle" x="2091.5" y="-520.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;unstructured = &#160;Csp(V&quot;prose_line&quot;^1 * prose_span + V&quot;prose_line&quot;^1</text>
<text text-anchor="middle" x="2091.5" y="-505.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ prose_span &#45;V&quot;header&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-489.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;structured &#160;&#160;= &#160;V&quot;bold&quot; + V&quot;italic&quot; + V&quot;underscore&quot; + V&quot;strikethrough&quot;</text>
<text text-anchor="middle" x="2091.5" y="-474.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ V&quot;literal&quot; + V&quot;quoted&quot;</text>
<text text-anchor="middle" x="2091.5" y="-443.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;unparsed = Csp(P(1)^1)</text>
<text text-anchor="middle" x="2091.5" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Highlighting</text>
<text text-anchor="middle" x="2091.5" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; These inner blocks will need to be re&#45;parsed to render, e.g., links</text>
<text text-anchor="middle" x="2091.5" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; or multiple layers of highlight. </text>
<text text-anchor="middle" x="2091.5" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bold_open, bold_close &#160;&#160;&#160;&#160;= &#160;bookends(&quot;*&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local italic_open, italic_close = &#160;bookends(&quot;/&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local under_open, under_close &#160;&#160;= &#160;bookends(&quot;_&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-319.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local strike_open, strike_close = &#160;bookends(&quot;&#45;&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-303.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local lit_open, lit_close &#160;&#160;&#160;&#160;&#160;&#160;= &#160;bookends(&quot;=&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-288.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;bold &#160;&#160;= &#160;Csp(bold_open * (P(1) &#45; bold_close)^0 * bold_close / 1) &#45; V&quot;header&quot;</text>
<text text-anchor="middle" x="2091.5" y="-273.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;italic = &#160;Csp(italic_open * (P(1) &#45; italic_close)^0 * italic_close / 1)</text>
<text text-anchor="middle" x="2091.5" y="-257.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;underscore = Csp(under_open * (P(1) &#45; under_close)^0 * under_close / 1)</text>
<text text-anchor="middle" x="2091.5" y="-242.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;strikethrough = Csp(strike_open * (P(1) &#45; strike_close)^0 * strike_close / 1)</text>
<text text-anchor="middle" x="2091.5" y="-226.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;literal = Csp(lit_open * (P(1) &#45; lit_close)^0 * lit_close / 1)</text>
<text text-anchor="middle" x="2091.5" y="-195.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local quoted_open = Cg(C(P(&quot;\&quot;&quot;)^2), &quot;quoted_init&quot;)</text>
<text text-anchor="middle" x="2091.5" y="-180.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local quoted_close = Cmt(C(P(&quot;\&quot;&quot;)^1) * Cb(&quot;quoted_init&quot;), equal_strings)</text>
<text text-anchor="middle" x="2091.5" y="-164.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;quoted = Csp(quoted_open * (P(1) &#45; quoted_close)^0 * quoted_close / 1)</text>
<text text-anchor="middle" x="2091.5" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;block_end = V&quot;blank_line&quot;^1 + &#45;P(1) + #V&quot;header&quot;</text>
<text text-anchor="middle" x="2091.5" y="-101.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;blank_line = Csp((WS^0 * NL)^1)</text>
<text text-anchor="middle" x="2091.5" y="-86.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2091.5" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return grymmyr</text>
<text text-anchor="middle" x="2091.5" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2091.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return epnf.define(_grym_fn(), nil, false)</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2091.5,-978.0914C2091.5,-964.6902 2091.5,-944.4601 2091.5,-919.6227"/>
<polygon fill="#000000" stroke="#000000" points="2095.0001,-919.4932 2091.5,-909.4933 2088.0001,-919.4933 2095.0001,-919.4932"/>
</g>
</g>
</svg>