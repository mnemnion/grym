<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3560pt" height="663pt"
 viewBox="0.00 0.00 3560.00 663.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 659.4007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-659.4007 3556,-659.4007 3556,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="espalier/node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1066.5" cy="-637.4007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="1066.5" y="-633.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 85</text>
</g>
<!-- section_1 -->
<g id="node2" class="espalier/node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1066.5" cy="-565.4007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1066.5" y="-561.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1066.5,-619.232C1066.5,-611.5316 1066.5,-602.375 1066.5,-593.8173"/>
<polygon fill="#000000" stroke="#000000" points="1070.0001,-593.8139 1066.5,-583.8139 1063.0001,-593.814 1070.0001,-593.8139"/>
</g>
<!-- header_2 -->
<g id="node3" class="espalier/node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="756.5" cy="-493.4007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="756.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1018.4026,-554.2297C968.1637,-542.5613 888.711,-524.1077 830.48,-510.5831"/>
<polygon fill="#000000" stroke="#000000" points="831.1292,-507.1408 820.5967,-508.2876 829.5455,-513.9593 831.1292,-507.1408"/>
</g>
<!-- prose_3 -->
<g id="node4" class="espalier/node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="920.5" cy="-493.4007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="920.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035.1793,-549.9548C1011.3612,-538.2089 978.6407,-522.0728 954.2451,-510.0421"/>
<polygon fill="#000000" stroke="#000000" points="955.5272,-506.7719 945.0104,-505.488 952.4311,-513.05 955.5272,-506.7719"/>
</g>
<!-- prose_4 -->
<g id="node5" class="espalier/node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1002.5" cy="-493.4007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1002.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1051.0074,-547.9715C1042.834,-538.7764 1032.6821,-527.3555 1023.7811,-517.3419"/>
<polygon fill="#000000" stroke="#000000" points="1026.2322,-514.8312 1016.9726,-509.6823 1021.0003,-519.4817 1026.2322,-514.8312"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="espalier/node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1130.5" cy="-493.4007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1130.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1081.9926,-547.9715C1089.7383,-539.2576 1099.2608,-528.5448 1107.8116,-518.9251"/>
<polygon fill="#000000" stroke="#000000" points="1110.6777,-520.9689 1114.7054,-511.1695 1105.4458,-516.3184 1110.6777,-520.9689"/>
</g>
<!-- section_6 -->
<g id="node7" class="espalier/node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1645.5" cy="-493.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1645.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1122.543,-558.4316C1228.7436,-545.2253 1459.0556,-516.5854 1575.3307,-502.1264"/>
<polygon fill="#000000" stroke="#000000" points="1576.0488,-505.5641 1585.5404,-500.8568 1575.1849,-498.6176 1576.0488,-505.5641"/>
</g>
<!-- section_7 -->
<g id="node8" class="espalier/node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="2890.5" cy="-493.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2890.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1126.9277,-563.0154C1399.3894,-552.2603 2513.3709,-508.2873 2814.9235,-496.3839"/>
<polygon fill="#000000" stroke="#000000" points="2815.451,-499.8659 2825.3052,-495.9741 2815.1749,-492.8714 2815.451,-499.8659"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="espalier/node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-439.3009 0,-439.3009 0,-352.7003 443,-352.7003 443,-439.3009"/>
<text text-anchor="middle" x="221.5" y="-376.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="221.5" y="-360.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- prose_3&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M896.0831,-481.3835C890.4278,-479.0403 884.3497,-476.8607 878.5,-475.4007 697.2981,-430.1732 642.6415,-463.7833 453.0503,-439.4076"/>
<polygon fill="#000000" stroke="#000000" points="453.41,-435.9248 443.0373,-438.0829 452.4918,-442.8643 453.41,-435.9248"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="espalier/node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-423.3011 461.5,-423.3011 461.5,-368.7002 939.5,-368.7002 939.5,-423.3011"/>
<text text-anchor="middle" x="700.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="700.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- prose_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M977.5403,-481.8824C972.2888,-479.6174 966.7491,-477.3436 961.5,-475.4007 912.3613,-457.2124 856.9515,-439.9163 809.8671,-426.1378"/>
<polygon fill="#000000" stroke="#000000" points="810.8387,-422.7754 800.2589,-423.341 808.8822,-429.4965 810.8387,-422.7754"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="espalier/node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1303,-415.3012 958,-415.3012 958,-376.7 1303,-376.7 1303,-415.3012"/>
<text text-anchor="middle" x="1130.5" y="-400.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1130.5" y="-384.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, {__index = lpeg})</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>codeblock_5&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.5,-475.0805C1130.5,-461.1575 1130.5,-441.7188 1130.5,-425.5984"/>
<polygon fill="#000000" stroke="#000000" points="1134.0001,-425.5755 1130.5,-415.5755 1127.0001,-425.5756 1134.0001,-425.5755"/>
</g>
<!-- header_11 -->
<g id="node12" class="espalier/node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="1437.5" cy="-396.0006" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1437.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_6&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1612.0812,-477.7517C1577.3572,-461.4915 1522.7571,-435.9239 1483.8686,-417.7136"/>
<polygon fill="#000000" stroke="#000000" points="1484.8824,-414.3237 1474.3419,-413.2525 1481.9138,-420.6631 1484.8824,-414.3237"/>
</g>
<!-- prose_12 -->
<g id="node13" class="espalier/node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="1604.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1604.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1637.7882,-475.0805C1631.6411,-460.4773 1622.9397,-439.8062 1615.9749,-423.2605"/>
<polygon fill="#000000" stroke="#000000" points="1619.0067,-421.4414 1611.901,-413.5826 1612.555,-424.1573 1619.0067,-421.4414"/>
</g>
<!-- prose_13 -->
<g id="node14" class="espalier/node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1686.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1686.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1653.2118,-475.0805C1659.3589,-460.4773 1668.0603,-439.8062 1675.0251,-423.2605"/>
<polygon fill="#000000" stroke="#000000" points="1678.445,-424.1573 1679.099,-413.5826 1671.9933,-421.4414 1678.445,-424.1573"/>
</g>
<!-- prose_14 -->
<g id="node15" class="espalier/node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1768.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1768.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1673.9641,-476.9187C1690.2854,-466.9247 1710.7854,-453.4247 1727.5,-439.4007 1734.4629,-433.5586 1741.4661,-426.6268 1747.6652,-420.0371"/>
<polygon fill="#000000" stroke="#000000" points="1750.353,-422.2844 1754.5224,-412.5444 1745.1891,-417.5585 1750.353,-422.2844"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="espalier/node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="2056.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2056.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- section_6&#45;&gt;codeblock_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;codeblock_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1695.4858,-481.5549C1769.9304,-463.9128 1909.947,-430.7312 1992.0135,-411.2828"/>
<polygon fill="#000000" stroke="#000000" points="1993.0475,-414.6348 2001.9709,-408.9231 1991.4333,-407.8235 1993.0475,-414.6348"/>
</g>
<!-- header_20 -->
<g id="node21" class="espalier/node">
<title>header_20</title>
<ellipse fill="none" stroke="#000000" cx="2738.5" cy="-396.0006" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="2738.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_20 -->
<g id="edge20" class="edge">
<title>section_7&#45;&gt;header_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2864.3703,-476.657C2839.5545,-460.7553 2802.0381,-436.7152 2774.417,-419.0158"/>
<polygon fill="#000000" stroke="#000000" points="2776.1335,-415.9589 2765.8254,-413.5105 2772.3567,-421.8527 2776.1335,-415.9589"/>
</g>
<!-- prose_21 -->
<g id="node22" class="espalier/node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="2890.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2890.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>section_7&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2890.5,-475.0805C2890.5,-460.7959 2890.5,-440.7053 2890.5,-424.3491"/>
<polygon fill="#000000" stroke="#000000" points="2894.0001,-424.2386 2890.5,-414.2387 2887.0001,-424.2387 2894.0001,-424.2386"/>
</g>
<!-- codeblock_22 -->
<g id="node23" class="espalier/node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="3113.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3113.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- section_7&#45;&gt;codeblock_22 -->
<g id="edge22" class="edge">
<title>section_7&#45;&gt;codeblock_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2925.835,-477.9673C2964.1985,-461.2112 3025.6051,-434.3906 3067.6571,-416.0235"/>
<polygon fill="#000000" stroke="#000000" points="3069.0847,-419.2193 3076.8478,-412.0092 3066.2829,-412.8045 3069.0847,-419.2193"/>
</g>
<!-- codeblock_23 -->
<g id="node24" class="espalier/node">
<title>codeblock_23</title>
<ellipse fill="none" stroke="#000000" cx="3443.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3443.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 83&#45;85</text>
</g>
<!-- section_7&#45;&gt;codeblock_23 -->
<g id="edge23" class="edge">
<title>section_7&#45;&gt;codeblock_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2946.0495,-483.745C3007.9111,-472.9799 3110.8737,-455.0266 3199.5,-439.4007 3257.5523,-429.1653 3323.353,-417.455 3371.9816,-408.7801"/>
<polygon fill="#000000" stroke="#000000" points="3372.8591,-412.1789 3382.0888,-406.9766 3371.6295,-405.2877 3372.8591,-412.1789"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="espalier/node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1182.5,-186.2018 984.5,-186.2018 984.5,-130.3988 1182.5,-130.3988 1182.5,-186.2018"/>
<text text-anchor="middle" x="1083.5" y="-138.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- prose_12&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>prose_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1593.2763,-379.114C1585.9867,-369.6233 1575.603,-358.5241 1563.5,-352.6006 1414.3047,-279.581 1334.4566,-401.1851 1191.5,-316.6006 1145.2399,-289.2294 1114.3541,-233.3567 1097.8621,-195.8589"/>
<polygon fill="#000000" stroke="#000000" points="1100.9218,-194.1104 1093.785,-186.28 1094.481,-196.8519 1100.9218,-194.1104"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="espalier/node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1532,-178.2024 1201,-178.2024 1201,-138.3982 1532,-138.3982 1532,-178.2024"/>
<text text-anchor="middle" x="1366.5" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- prose_13&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>prose_13&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1674.0065,-379.2744C1666.574,-370.3115 1656.4704,-359.6871 1645.5,-352.6006 1604.4136,-326.0601 1583.5961,-341.5086 1541.5,-316.6006 1480.4607,-280.484 1421.9466,-220.8215 1390.4568,-185.976"/>
<polygon fill="#000000" stroke="#000000" points="1392.6904,-183.2229 1383.417,-178.0989 1387.471,-187.8875 1392.6904,-183.2229"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="espalier/node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1986.5,-178.2024 1550.5,-178.2024 1550.5,-138.3982 1986.5,-138.3982 1986.5,-178.2024"/>
<text text-anchor="middle" x="1768.5" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- prose_14&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>prose_14&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1768.5,-377.7434C1768.5,-337.0286 1768.5,-238.4612 1768.5,-188.4629"/>
<polygon fill="#000000" stroke="#000000" points="1772.0001,-188.2834 1768.5,-178.2834 1765.0001,-188.2835 1772.0001,-188.2834"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="espalier/node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2426.5,-262.5008 2004.5,-262.5008 2004.5,-54.0998 2426.5,-54.0998 2426.5,-262.5008"/>
<text text-anchor="middle" x="2215.5" y="-247.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="2215.5" y="-231.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="2215.5" y="-216.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="2215.5" y="-201.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="2215.5" y="-185.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="2215.5" y="-170.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="2215.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="2215.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="2215.5" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="2215.5" y="-108.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="2215.5" y="-93.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="2215.5" y="-77.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2215.5" y="-62.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_15&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2068.4508,-378.1345C2083.9573,-354.9527 2112.3179,-312.5545 2140.0249,-271.1333"/>
<polygon fill="#000000" stroke="#000000" points="2143.0869,-272.8508 2145.7377,-262.5929 2137.2686,-268.9588 2143.0869,-272.8508"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="espalier/node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2958,-193.6006 2445,-193.6006 2445,-123 2958,-123 2958,-193.6006"/>
<text text-anchor="middle" x="2701.5" y="-146.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="2701.5" y="-131.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- prose_21&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>prose_21&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2877.2099,-379.286C2848.1984,-342.799 2778.4081,-255.0256 2736.0323,-201.7306"/>
<polygon fill="#000000" stroke="#000000" points="2738.6954,-199.4562 2729.7322,-193.8072 2733.2163,-203.8128 2738.6954,-199.4562"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="espalier/node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="3440.5,-316.4011 2976.5,-316.4011 2976.5,-.1995 3440.5,-.1995 3440.5,-316.4011"/>
<text text-anchor="middle" x="3208.5" y="-301.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="3208.5" y="-286.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="3208.5" y="-270.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="3208.5" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="3208.5" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="3208.5" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="3208.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="3208.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="3208.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3208.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="3208.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="3208.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3208.5" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="3208.5" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="3208.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="3208.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="3208.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="3208.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="3208.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>codeblock_22&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3120.7967,-377.7434C3125.8872,-365.0065 3133.2405,-346.6078 3141.5544,-325.8056"/>
<polygon fill="#000000" stroke="#000000" points="3144.8429,-327.0079 3145.3042,-316.4232 3138.3428,-324.4101 3144.8429,-327.0079"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="espalier/node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="3552,-176.3003 3459,-176.3003 3459,-140.3003 3552,-140.3003 3552,-176.3003"/>
<text text-anchor="middle" x="3505.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_23&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_23&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3448.2621,-377.7434C3459.0364,-336.4358 3485.3433,-235.5786 3498.1941,-186.3101"/>
<polygon fill="#000000" stroke="#000000" points="3501.5844,-187.1794 3500.7217,-176.6198 3494.811,-185.4126 3501.5844,-187.1794"/>
</g>
</g>
</svg>