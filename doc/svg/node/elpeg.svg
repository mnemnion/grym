<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3546pt" height="663pt"
 viewBox="0.00 0.00 3546.00 663.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 659.4007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-659.4007 3542,-659.4007 3542,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1059.5" cy="-637.4007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="1059.5" y="-633.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 71</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1059.5" cy="-565.4007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1059.5" y="-561.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1059.5,-619.232C1059.5,-611.5316 1059.5,-602.375 1059.5,-593.8173"/>
<polygon fill="#000000" stroke="#000000" points="1063.0001,-593.8139 1059.5,-583.8139 1056.0001,-593.814 1063.0001,-593.8139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="749.5" cy="-493.4007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="749.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1011.4026,-554.2297C961.1637,-542.5613 881.711,-524.1077 823.48,-510.5831"/>
<polygon fill="#000000" stroke="#000000" points="824.1292,-507.1408 813.5967,-508.2876 822.5455,-513.9593 824.1292,-507.1408"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="913.5" cy="-493.4007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="913.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1028.1793,-549.9548C1004.3612,-538.2089 971.6407,-522.0728 947.2451,-510.0421"/>
<polygon fill="#000000" stroke="#000000" points="948.5272,-506.7719 938.0104,-505.488 945.4311,-513.05 948.5272,-506.7719"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="995.5" cy="-493.4007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="995.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1044.0074,-547.9715C1035.834,-538.7764 1025.6821,-527.3555 1016.7811,-517.3419"/>
<polygon fill="#000000" stroke="#000000" points="1019.2322,-514.8312 1009.9726,-509.6823 1014.0003,-519.4817 1019.2322,-514.8312"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1123.5" cy="-493.4007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1123.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1074.9926,-547.9715C1082.7383,-539.2576 1092.2608,-528.5448 1100.8116,-518.9251"/>
<polygon fill="#000000" stroke="#000000" points="1103.6777,-520.9689 1107.7054,-511.1695 1098.4458,-516.3184 1103.6777,-520.9689"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1631.5" cy="-493.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1631.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1115.6489,-558.333C1220.708,-545.1087 1446.7219,-516.6594 1561.5156,-502.2099"/>
<polygon fill="#000000" stroke="#000000" points="1562.1146,-505.6622 1571.5991,-500.9406 1561.2403,-498.717 1562.1146,-505.6622"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="2876.5" cy="-493.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2876.5" y="-489.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;71</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1119.9548,-563.0051C1391.6768,-552.2379 2499.7696,-508.3289 2800.7481,-496.4024"/>
<polygon fill="#000000" stroke="#000000" points="2801.2581,-499.885 2811.1117,-495.9917 2800.9809,-492.8905 2801.2581,-499.885"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-439.3009 0,-439.3009 0,-352.7003 443,-352.7003 443,-439.3009"/>
<text text-anchor="middle" x="221.5" y="-376.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="221.5" y="-360.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- prose_3&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M889.0816,-481.3896C883.4263,-479.0461 877.3487,-476.8648 871.5,-475.4007 693.374,-430.8083 639.5752,-463.494 453.1726,-439.424"/>
<polygon fill="#000000" stroke="#000000" points="453.4122,-435.9251 443.0381,-438.0767 452.4896,-442.8641 453.4122,-435.9251"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-423.3011 461.5,-423.3011 461.5,-368.7002 939.5,-368.7002 939.5,-423.3011"/>
<text text-anchor="middle" x="700.5" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="700.5" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- prose_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M970.5287,-481.9135C965.278,-479.6463 959.7416,-477.3636 954.5,-475.4007 906.4314,-457.399 852.247,-440.0681 806.308,-426.2161"/>
<polygon fill="#000000" stroke="#000000" points="807.2194,-422.8355 796.6354,-423.3141 805.2078,-429.5403 807.2194,-422.8355"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1289,-415.3012 958,-415.3012 958,-376.7 1289,-376.7 1289,-415.3012"/>
<text text-anchor="middle" x="1123.5" y="-400.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require lpeg</text>
<text text-anchor="middle" x="1123.5" y="-384.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, __index = lpeg)</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>codeblock_5&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.5,-475.0805C1123.5,-461.1575 1123.5,-441.7188 1123.5,-425.5984"/>
<polygon fill="#000000" stroke="#000000" points="1127.0001,-425.5755 1123.5,-415.5755 1120.0001,-425.5756 1127.0001,-425.5755"/>
</g>
<!-- header_11 -->
<g id="node12" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="1423.5" cy="-396.0006" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1423.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_6&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1598.0812,-477.7517C1563.3572,-461.4915 1508.7571,-435.9239 1469.8686,-417.7136"/>
<polygon fill="#000000" stroke="#000000" points="1470.8824,-414.3237 1460.3419,-413.2525 1467.9138,-420.6631 1470.8824,-414.3237"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="1590.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1590.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1623.7882,-475.0805C1617.6411,-460.4773 1608.9397,-439.8062 1601.9749,-423.2605"/>
<polygon fill="#000000" stroke="#000000" points="1605.0067,-421.4414 1597.901,-413.5826 1598.555,-424.1573 1605.0067,-421.4414"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1672.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1672.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1639.2118,-475.0805C1645.3589,-460.4773 1654.0603,-439.8062 1661.0251,-423.2605"/>
<polygon fill="#000000" stroke="#000000" points="1664.445,-424.1573 1665.099,-413.5826 1657.9933,-421.4414 1664.445,-424.1573"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1754.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1754.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1659.9641,-476.9187C1676.2854,-466.9247 1696.7854,-453.4247 1713.5,-439.4007 1720.4629,-433.5586 1727.4661,-426.6268 1733.6652,-420.0371"/>
<polygon fill="#000000" stroke="#000000" points="1736.353,-422.2844 1740.5224,-412.5444 1731.1891,-417.5585 1736.353,-422.2844"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="2042.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2042.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- section_6&#45;&gt;codeblock_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;codeblock_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1681.4858,-481.5549C1755.9304,-463.9128 1895.947,-430.7312 1978.0135,-411.2828"/>
<polygon fill="#000000" stroke="#000000" points="1979.0475,-414.6348 1987.9709,-408.9231 1977.4333,-407.8235 1979.0475,-414.6348"/>
</g>
<!-- header_20 -->
<g id="node21" class="node">
<title>header_20</title>
<ellipse fill="none" stroke="#000000" cx="2724.5" cy="-396.0006" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="2724.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_20 -->
<g id="edge20" class="edge">
<title>section_7&#45;&gt;header_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2850.3703,-476.657C2825.5545,-460.7553 2788.0381,-436.7152 2760.417,-419.0158"/>
<polygon fill="#000000" stroke="#000000" points="2762.1335,-415.9589 2751.8254,-413.5105 2758.3567,-421.8527 2762.1335,-415.9589"/>
</g>
<!-- prose_21 -->
<g id="node22" class="node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="2876.5" cy="-396.0006" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2876.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>section_7&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2876.5,-475.0805C2876.5,-460.7959 2876.5,-440.7053 2876.5,-424.3491"/>
<polygon fill="#000000" stroke="#000000" points="2880.0001,-424.2386 2876.5,-414.2387 2873.0001,-424.2387 2880.0001,-424.2386"/>
</g>
<!-- codeblock_22 -->
<g id="node23" class="node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="3099.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3099.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- section_7&#45;&gt;codeblock_22 -->
<g id="edge22" class="edge">
<title>section_7&#45;&gt;codeblock_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2911.835,-477.9673C2950.1985,-461.2112 3011.6051,-434.3906 3053.6571,-416.0235"/>
<polygon fill="#000000" stroke="#000000" points="3055.0847,-419.2193 3062.8478,-412.0092 3052.2829,-412.8045 3055.0847,-419.2193"/>
</g>
<!-- codeblock_23 -->
<g id="node24" class="node">
<title>codeblock_23</title>
<ellipse fill="none" stroke="#000000" cx="3429.5" cy="-396.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3429.5" y="-391.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 69&#45;71</text>
</g>
<!-- section_7&#45;&gt;codeblock_23 -->
<g id="edge23" class="edge">
<title>section_7&#45;&gt;codeblock_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2932.0495,-483.745C2993.9111,-472.9799 3096.8737,-455.0266 3185.5,-439.4007 3243.5523,-429.1653 3309.353,-417.455 3357.9816,-408.7801"/>
<polygon fill="#000000" stroke="#000000" points="3358.8591,-412.1789 3368.0888,-406.9766 3357.6295,-405.2877 3358.8591,-412.1789"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1168.5,-186.2018 970.5,-186.2018 970.5,-130.3988 1168.5,-130.3988 1168.5,-186.2018"/>
<text text-anchor="middle" x="1069.5" y="-138.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- prose_12&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>prose_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1579.2763,-379.114C1571.9867,-369.6233 1561.603,-358.5241 1549.5,-352.6006 1400.3047,-279.581 1320.4566,-401.1851 1177.5,-316.6006 1131.2399,-289.2294 1100.3541,-233.3567 1083.8621,-195.8589"/>
<polygon fill="#000000" stroke="#000000" points="1086.9218,-194.1104 1079.785,-186.28 1080.481,-196.8519 1086.9218,-194.1104"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1518,-178.2024 1187,-178.2024 1187,-138.3982 1518,-138.3982 1518,-178.2024"/>
<text text-anchor="middle" x="1352.5" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- prose_13&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>prose_13&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1660.0065,-379.2744C1652.574,-370.3115 1642.4704,-359.6871 1631.5,-352.6006 1590.4136,-326.0601 1569.5961,-341.5086 1527.5,-316.6006 1466.4607,-280.484 1407.9466,-220.8215 1376.4568,-185.976"/>
<polygon fill="#000000" stroke="#000000" points="1378.6904,-183.2229 1369.417,-178.0989 1373.471,-187.8875 1378.6904,-183.2229"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1972.5,-178.2024 1536.5,-178.2024 1536.5,-138.3982 1972.5,-138.3982 1972.5,-178.2024"/>
<text text-anchor="middle" x="1754.5" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- prose_14&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>prose_14&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1754.5,-377.7434C1754.5,-337.0286 1754.5,-238.4612 1754.5,-188.4629"/>
<polygon fill="#000000" stroke="#000000" points="1758.0001,-188.2834 1754.5,-178.2834 1751.0001,-188.2835 1758.0001,-188.2834"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2412.5,-262.5008 1990.5,-262.5008 1990.5,-54.0998 2412.5,-54.0998 2412.5,-262.5008"/>
<text text-anchor="middle" x="2201.5" y="-247.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="2201.5" y="-231.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="2201.5" y="-216.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="2201.5" y="-201.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="2201.5" y="-185.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="2201.5" y="-170.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="2201.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="2201.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="2201.5" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="2201.5" y="-108.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="2201.5" y="-93.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="2201.5" y="-77.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2201.5" y="-62.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_15&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2054.4508,-378.1345C2069.9573,-354.9527 2098.3179,-312.5545 2126.0249,-271.1333"/>
<polygon fill="#000000" stroke="#000000" points="2129.0869,-272.8508 2131.7377,-262.5929 2123.2686,-268.9588 2129.0869,-272.8508"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2944,-193.6006 2431,-193.6006 2431,-123 2944,-123 2944,-193.6006"/>
<text text-anchor="middle" x="2687.5" y="-146.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="2687.5" y="-131.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- prose_21&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>prose_21&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2863.2099,-379.286C2834.1984,-342.799 2764.4081,-255.0256 2722.0323,-201.7306"/>
<polygon fill="#000000" stroke="#000000" points="2724.6954,-199.4562 2715.7322,-193.8072 2719.2163,-203.8128 2724.6954,-199.4562"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="3426.5,-316.4011 2962.5,-316.4011 2962.5,-.1995 3426.5,-.1995 3426.5,-316.4011"/>
<text text-anchor="middle" x="3194.5" y="-301.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="3194.5" y="-286.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="3194.5" y="-270.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="3194.5" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="3194.5" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="3194.5" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="3194.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="3194.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="3194.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3194.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="3194.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="3194.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3194.5" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="3194.5" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="3194.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="3194.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="3194.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="3194.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="3194.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>codeblock_22&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3106.7967,-377.7434C3111.8872,-365.0065 3119.2405,-346.6078 3127.5544,-325.8056"/>
<polygon fill="#000000" stroke="#000000" points="3130.8429,-327.0079 3131.3042,-316.4232 3124.3428,-324.4101 3130.8429,-327.0079"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="3538,-176.3003 3445,-176.3003 3445,-140.3003 3538,-140.3003 3538,-176.3003"/>
<text text-anchor="middle" x="3491.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_23&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_23&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3434.2621,-377.7434C3445.0364,-336.4358 3471.3433,-235.5786 3484.1941,-186.3101"/>
<polygon fill="#000000" stroke="#000000" points="3487.5844,-187.1794 3486.7217,-176.6198 3480.811,-185.4126 3487.5844,-187.1794"/>
</g>
</g>
</svg>