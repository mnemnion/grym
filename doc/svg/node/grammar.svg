<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="8526pt" height="1753pt"
 viewBox="0.00 0.00 8526.00 1752.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1748.6025)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1748.6025 8522,-1748.6025 8522,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1499" cy="-1726.6025" rx="46.1547" ry="18"/>
<text text-anchor="middle" x="1499" y="-1722.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 211</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1499" cy="-1654.6025" rx="55.6456" ry="18"/>
<text text-anchor="middle" x="1499" y="-1650.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;6</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1499,-1708.4338C1499,-1700.7334 1499,-1691.5768 1499,-1683.0191"/>
<polygon fill="#000000" stroke="#000000" points="1502.5001,-1683.0157 1499,-1673.0157 1495.5001,-1683.0158 1502.5001,-1683.0157"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1358" cy="-1582.6025" rx="91.3932" ry="18"/>
<text text-anchor="middle" x="1358" y="-1578.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Grammar Module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1469.0975,-1639.3331C1449.0799,-1629.1114 1422.4382,-1615.5071 1400.2621,-1604.1831"/>
<polygon fill="#000000" stroke="#000000" points="1401.5616,-1600.9168 1391.0638,-1599.4861 1398.3781,-1607.1511 1401.5616,-1600.9168"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1499" cy="-1582.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1499" y="-1578.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1499,-1636.4338C1499,-1628.7334 1499,-1619.5768 1499,-1611.0191"/>
<polygon fill="#000000" stroke="#000000" points="1502.5001,-1611.0157 1499,-1601.0157 1495.5001,-1611.0158 1502.5001,-1611.0157"/>
</g>
<!-- section_4 -->
<g id="node5" class="node">
<title>section_4</title>
<ellipse fill="none" stroke="#000000" cx="1963" cy="-1582.6025" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1963" y="-1578.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 7&#45;101</text>
</g>
<!-- section_1&#45;&gt;section_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;section_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1549.5394,-1646.7601C1633.5031,-1633.7313 1801.772,-1607.6206 1895.6935,-1593.0466"/>
<polygon fill="#000000" stroke="#000000" points="1896.3114,-1596.4927 1905.6564,-1591.5006 1895.238,-1589.5755 1896.3114,-1596.4927"/>
</g>
<!-- leaf_5 -->
<g id="node6" class="node">
<title>leaf_5</title>
<polygon fill="none" stroke="#c0c0c0" points="1422,-1528.6025 1294,-1528.6025 1294,-1492.6025 1422,-1492.6025 1422,-1528.6025"/>
<text text-anchor="middle" x="1358" y="-1507.1025" font-family="Inconsolata" font-size="14.00" fill="#000000">* Grammar Module</text>
</g>
<!-- header_2&#45;&gt;leaf_5 -->
<g id="edge5" class="edge">
<title>header_2&#45;&gt;leaf_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1358,-1564.4338C1358,-1556.7334 1358,-1547.5768 1358,-1539.0191"/>
<polygon fill="#000000" stroke="#000000" points="1361.5001,-1539.0157 1358,-1529.0157 1354.5001,-1539.0158 1361.5001,-1539.0157"/>
</g>
<!-- raw_6 -->
<g id="node7" class="node">
<title>raw_6</title>
<ellipse fill="none" stroke="#000000" cx="1483" cy="-1510.6025" rx="27" ry="18"/>
<text text-anchor="middle" x="1483" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_6 -->
<g id="edge6" class="edge">
<title>prose_3&#45;&gt;raw_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1494.9625,-1564.4338C1493.2059,-1556.529 1491.1083,-1547.0897 1489.1637,-1538.339"/>
<polygon fill="#000000" stroke="#000000" points="1492.5668,-1537.5185 1486.9808,-1528.5159 1485.7335,-1539.037 1492.5668,-1537.5185"/>
</g>
<!-- header_8 -->
<g id="node9" class="node">
<title>header_8</title>
<ellipse fill="none" stroke="#000000" cx="1681" cy="-1510.6025" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="1681" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Parameters</text>
</g>
<!-- section_4&#45;&gt;header_8 -->
<g id="edge8" class="edge">
<title>section_4&#45;&gt;header_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1914.8429,-1570.307C1866.5172,-1557.9686 1791.9985,-1538.9425 1740.1158,-1525.6959"/>
<polygon fill="#000000" stroke="#000000" points="1740.9347,-1522.2927 1730.3796,-1523.21 1739.2029,-1529.0752 1740.9347,-1522.2927"/>
</g>
<!-- prose_9 -->
<g id="node10" class="node">
<title>prose_9</title>
<ellipse fill="none" stroke="#000000" cx="1799" cy="-1510.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1799" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_4&#45;&gt;prose_9 -->
<g id="edge9" class="edge">
<title>section_4&#45;&gt;prose_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1928.2198,-1567.3331C1900.38,-1555.1108 1861.5246,-1538.0523 1833.7047,-1525.8387"/>
<polygon fill="#000000" stroke="#000000" points="1834.9243,-1522.5517 1824.3609,-1521.7365 1832.1103,-1528.9612 1834.9243,-1522.5517"/>
</g>
<!-- prose_10 -->
<g id="node11" class="node">
<title>prose_10</title>
<ellipse fill="none" stroke="#000000" cx="1881" cy="-1510.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1881" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_4&#45;&gt;prose_10 -->
<g id="edge10" class="edge">
<title>section_4&#45;&gt;prose_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1943.1501,-1565.1733C1932.0588,-1555.4346 1918.1239,-1543.199 1906.2613,-1532.7831"/>
<polygon fill="#000000" stroke="#000000" points="1908.264,-1529.8839 1898.4403,-1525.9159 1903.6454,-1535.144 1908.264,-1529.8839"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="1963" cy="-1510.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1963" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_4&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_4&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1963,-1564.4338C1963,-1556.7334 1963,-1547.5768 1963,-1539.0191"/>
<polygon fill="#000000" stroke="#000000" points="1966.5001,-1539.0157 1963,-1529.0157 1959.5001,-1539.0158 1966.5001,-1539.0157"/>
</g>
<!-- section_12 -->
<g id="node13" class="node">
<title>section_12</title>
<ellipse fill="none" stroke="#000000" cx="2377" cy="-1510.6025" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2377" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 17&#45;46</text>
</g>
<!-- section_4&#45;&gt;section_12 -->
<g id="edge12" class="edge">
<title>section_4&#45;&gt;section_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2018.8339,-1572.8922C2094.8194,-1559.6773 2230.5585,-1536.0705 2311.3371,-1522.0221"/>
<polygon fill="#000000" stroke="#000000" points="2312.1387,-1525.4353 2321.3911,-1520.2736 2310.9393,-1518.5388 2312.1387,-1525.4353"/>
</g>
<!-- section_13 -->
<g id="node14" class="node">
<title>section_13</title>
<ellipse fill="none" stroke="#000000" cx="4676" cy="-1510.6025" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="4676" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 47&#45;70</text>
</g>
<!-- section_4&#45;&gt;section_13 -->
<g id="edge13" class="edge">
<title>section_4&#45;&gt;section_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2028.3849,-1580.8672C2396.3801,-1571.101 4206.7468,-1523.0559 4600.3727,-1512.6095"/>
<polygon fill="#000000" stroke="#000000" points="4600.6037,-1516.1047 4610.5073,-1512.3406 4600.418,-1509.1072 4600.6037,-1516.1047"/>
</g>
<!-- section_14 -->
<g id="node15" class="node">
<title>section_14</title>
<ellipse fill="none" stroke="#000000" cx="6266" cy="-1510.6025" rx="70.655" ry="18"/>
<text text-anchor="middle" x="6266" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 71&#45;101</text>
</g>
<!-- section_4&#45;&gt;section_14 -->
<g id="edge14" class="edge">
<title>section_4&#45;&gt;section_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2028.868,-1581.5003C2522.6753,-1573.2377 5640.9431,-1521.0612 6185.0622,-1511.9568"/>
<polygon fill="#000000" stroke="#000000" points="6185.2335,-1515.4545 6195.1736,-1511.7876 6185.1164,-1508.4555 6185.2335,-1515.4545"/>
</g>
<!-- section_15 -->
<g id="node16" class="node">
<title>section_15</title>
<ellipse fill="none" stroke="#000000" cx="7364" cy="-1510.6025" rx="74.6878" ry="18"/>
<text text-anchor="middle" x="7364" y="-1506.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 102&#45;211</text>
</g>
<!-- section_4&#45;&gt;section_15 -->
<g id="edge15" class="edge">
<title>section_4&#45;&gt;section_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2028.6409,-1581.926C2429.2906,-1577.7696 4586.3965,-1554.9981 6346,-1528.6025 6692.1504,-1523.4099 7104.4789,-1515.6273 7279.1348,-1512.2567"/>
<polygon fill="#000000" stroke="#000000" points="7279.3566,-1515.7532 7289.2871,-1512.0606 7279.2213,-1508.7545 7279.3566,-1515.7532"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="1609,-1456.5027 1187,-1456.5027 1187,-1369.9021 1609,-1369.9021 1609,-1456.5027"/>
<text text-anchor="middle" x="1398" y="-1393.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The grammar module returns one function, which generates</text>
<text text-anchor="middle" x="1398" y="-1378.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">a grammar. </text>
</g>
<!-- raw_6&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>raw_6&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1469.3433,-1494.9535C1461.9461,-1486.4772 1452.3418,-1475.4717 1442.5903,-1464.2977"/>
<polygon fill="#000000" stroke="#000000" points="1445.0534,-1461.797 1435.8411,-1456.5639 1439.7793,-1466.3996 1445.0534,-1461.797"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1734.5,-1431.2024 1627.5,-1431.2024 1627.5,-1395.2024 1734.5,-1395.2024 1734.5,-1431.2024"/>
<text text-anchor="middle" x="1681" y="-1409.7024" font-family="Inconsolata" font-size="14.00" fill="#000000">** Parameters</text>
</g>
<!-- header_8&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>header_8&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1681,-1492.2823C1681,-1477.9977 1681,-1457.9071 1681,-1441.5509"/>
<polygon fill="#000000" stroke="#000000" points="1684.5001,-1441.4405 1681,-1431.4405 1677.5001,-1441.4405 1684.5001,-1441.4405"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="1780" cy="-1413.2024" rx="27" ry="18"/>
<text text-anchor="middle" x="1780" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_9&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_9&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1795.4262,-1492.2823C1792.6221,-1477.9073 1788.671,-1457.6525 1785.4695,-1441.2408"/>
<polygon fill="#000000" stroke="#000000" points="1788.8435,-1440.2563 1783.4935,-1431.1114 1781.973,-1441.5966 1788.8435,-1440.2563"/>
</g>
<!-- raw_19 -->
<g id="node20" class="node">
<title>raw_19</title>
<ellipse fill="none" stroke="#000000" cx="1852" cy="-1413.2024" rx="27" ry="18"/>
<text text-anchor="middle" x="1852" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_10&#45;&gt;raw_19 -->
<g id="edge19" class="edge">
<title>prose_10&#45;&gt;raw_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1875.681,-1492.7378C1871.3478,-1478.1842 1865.1563,-1457.3894 1860.1909,-1440.7127"/>
<polygon fill="#000000" stroke="#000000" points="1863.4935,-1439.5393 1857.2853,-1430.9538 1856.7845,-1441.5368 1863.4935,-1439.5393"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1924" cy="-1413.2024" rx="27" ry="18"/>
<text text-anchor="middle" x="1924" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_11&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_11&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1955.8468,-1492.7378C1949.9277,-1477.9551 1941.4301,-1456.7331 1934.7013,-1439.9282"/>
<polygon fill="#000000" stroke="#000000" points="1937.9431,-1438.6086 1930.9766,-1430.6261 1931.4447,-1441.2106 1937.9431,-1438.6086"/>
</g>
<!-- header_23 -->
<g id="node24" class="node">
<title>header_23</title>
<ellipse fill="none" stroke="#000000" cx="2066" cy="-1413.2024" rx="96.7227" ry="18"/>
<text text-anchor="middle" x="2066" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : grammar_template</text>
</g>
<!-- section_12&#45;&gt;header_23 -->
<g id="edge23" class="edge">
<title>section_12&#45;&gt;header_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2325.9068,-1499.1131C2284.0983,-1489.2428 2223.6521,-1473.8966 2172,-1456.6025 2152.2491,-1449.9895 2130.9157,-1441.5226 2112.601,-1433.8259"/>
<polygon fill="#000000" stroke="#000000" points="2113.8956,-1430.5732 2103.3231,-1429.8851 2111.1589,-1437.0161 2113.8956,-1430.5732"/>
</g>
<!-- prose_24 -->
<g id="node25" class="node">
<title>prose_24</title>
<ellipse fill="none" stroke="#000000" cx="2213" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2213" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_24 -->
<g id="edge24" class="edge">
<title>section_12&#45;&gt;prose_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.6665,-1496.8188C2309.8748,-1487.6111 2278.6892,-1473.9967 2254,-1456.6025 2246.448,-1451.2819 2239.185,-1444.4057 2232.9251,-1437.7019"/>
<polygon fill="#000000" stroke="#000000" points="2235.3442,-1435.1556 2226.0801,-1430.015 2230.1165,-1439.8108 2235.3442,-1435.1556"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2295" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2295" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_12&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2361.9599,-1492.7378C2348.9272,-1477.2575 2329.9495,-1454.7157 2315.5228,-1437.5796"/>
<polygon fill="#000000" stroke="#000000" points="2317.9701,-1435.052 2308.8522,-1429.6562 2312.6151,-1439.5603 2317.9701,-1435.052"/>
</g>
<!-- prose_26 -->
<g id="node27" class="node">
<title>prose_26</title>
<ellipse fill="none" stroke="#000000" cx="2377" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2377" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_26 -->
<g id="edge26" class="edge">
<title>section_12&#45;&gt;prose_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2377,-1492.2823C2377,-1477.9977 2377,-1457.9071 2377,-1441.5509"/>
<polygon fill="#000000" stroke="#000000" points="2380.5001,-1441.4405 2377,-1431.4405 2373.5001,-1441.4405 2380.5001,-1441.4405"/>
</g>
<!-- prose_27 -->
<g id="node28" class="node">
<title>prose_27</title>
<ellipse fill="none" stroke="#000000" cx="2459" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2459" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_27 -->
<g id="edge27" class="edge">
<title>section_12&#45;&gt;prose_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2392.0401,-1492.7378C2405.0728,-1477.2575 2424.0505,-1454.7157 2438.4772,-1437.5796"/>
<polygon fill="#000000" stroke="#000000" points="2441.3849,-1439.5603 2445.1478,-1429.6562 2436.0299,-1435.052 2441.3849,-1439.5603"/>
</g>
<!-- prose_28 -->
<g id="node29" class="node">
<title>prose_28</title>
<ellipse fill="none" stroke="#000000" cx="2541" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2541" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_28 -->
<g id="edge28" class="edge">
<title>section_12&#45;&gt;prose_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2419.3335,-1496.8188C2444.1252,-1487.6111 2475.3108,-1473.9967 2500,-1456.6025 2507.552,-1451.2819 2514.815,-1444.4057 2521.0749,-1437.7019"/>
<polygon fill="#000000" stroke="#000000" points="2523.8835,-1439.8108 2527.9199,-1430.015 2518.6558,-1435.1556 2523.8835,-1439.8108"/>
</g>
<!-- prose_29 -->
<g id="node30" class="node">
<title>prose_29</title>
<ellipse fill="none" stroke="#000000" cx="2687" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2687" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_29 -->
<g id="edge29" class="edge">
<title>section_12&#45;&gt;prose_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2428.1086,-1499.159C2469.9261,-1489.3154 2530.3768,-1473.9827 2582,-1456.6025 2606.0458,-1448.5068 2632.4362,-1437.5897 2652.7445,-1428.7303"/>
<polygon fill="#000000" stroke="#000000" points="2654.1623,-1431.9304 2661.9021,-1424.6953 2651.3397,-1425.5246 2654.1623,-1431.9304"/>
</g>
<!-- prose_30 -->
<g id="node31" class="node">
<title>prose_30</title>
<ellipse fill="none" stroke="#000000" cx="2890" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2890" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_30 -->
<g id="edge30" class="edge">
<title>section_12&#45;&gt;prose_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2437.2932,-1503.3607C2507.5048,-1494.4586 2626.7869,-1477.8794 2728,-1456.6025 2770.8657,-1447.5913 2819.2948,-1434.1836 2851.946,-1424.6584"/>
<polygon fill="#000000" stroke="#000000" points="2852.9416,-1428.0139 2861.5489,-1421.8362 2850.9678,-1421.298 2852.9416,-1428.0139"/>
</g>
<!-- header_46 -->
<g id="node47" class="node">
<title>header_46</title>
<ellipse fill="none" stroke="#000000" cx="4497" cy="-1413.2024" rx="46.4563" ry="18"/>
<text text-anchor="middle" x="4497" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : metas</text>
</g>
<!-- section_13&#45;&gt;header_46 -->
<g id="edge46" class="edge">
<title>section_13&#45;&gt;header_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4636.5649,-1496.1634C4611.8176,-1486.4125 4579.6597,-1472.4565 4553,-1456.6025 4542.9632,-1450.6338 4532.669,-1443.1233 4523.6887,-1436.0354"/>
<polygon fill="#000000" stroke="#000000" points="4525.8325,-1433.2678 4515.856,-1429.7013 4521.4309,-1438.7108 4525.8325,-1433.2678"/>
</g>
<!-- prose_47 -->
<g id="node48" class="node">
<title>prose_47</title>
<ellipse fill="none" stroke="#000000" cx="4594" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4594" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_13&#45;&gt;prose_47 -->
<g id="edge47" class="edge">
<title>section_13&#45;&gt;prose_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4660.9599,-1492.7378C4647.9272,-1477.2575 4628.9495,-1454.7157 4614.5228,-1437.5796"/>
<polygon fill="#000000" stroke="#000000" points="4616.9701,-1435.052 4607.8522,-1429.6562 4611.6151,-1439.5603 4616.9701,-1435.052"/>
</g>
<!-- prose_48 -->
<g id="node49" class="node">
<title>prose_48</title>
<ellipse fill="none" stroke="#000000" cx="4676" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4676" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_13&#45;&gt;prose_48 -->
<g id="edge48" class="edge">
<title>section_13&#45;&gt;prose_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4676,-1492.2823C4676,-1477.9977 4676,-1457.9071 4676,-1441.5509"/>
<polygon fill="#000000" stroke="#000000" points="4679.5001,-1441.4405 4676,-1431.4405 4672.5001,-1441.4405 4679.5001,-1441.4405"/>
</g>
<!-- prose_49 -->
<g id="node50" class="node">
<title>prose_49</title>
<ellipse fill="none" stroke="#000000" cx="4884" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4884" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_13&#45;&gt;prose_49 -->
<g id="edge49" class="edge">
<title>section_13&#45;&gt;prose_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4709.4188,-1494.9535C4747.9539,-1476.9086 4810.9677,-1447.4012 4849.8213,-1429.2073"/>
<polygon fill="#000000" stroke="#000000" points="4851.5772,-1432.2498 4859.1492,-1424.8393 4848.6086,-1425.9105 4851.5772,-1432.2498"/>
</g>
<!-- prose_50 -->
<g id="node51" class="node">
<title>prose_50</title>
<ellipse fill="none" stroke="#000000" cx="5284" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5284" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_13&#45;&gt;prose_50 -->
<g id="edge50" class="edge">
<title>section_13&#45;&gt;prose_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4732.9259,-1501.4831C4854.4877,-1482.0092 5136.9766,-1436.7552 5242.9013,-1419.7863"/>
<polygon fill="#000000" stroke="#000000" points="5243.5628,-1423.2251 5252.8832,-1418.1873 5242.4555,-1416.3132 5243.5628,-1423.2251"/>
</g>
<!-- prose_51 -->
<g id="node52" class="node">
<title>prose_51</title>
<ellipse fill="none" stroke="#000000" cx="5673" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5673" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_13&#45;&gt;prose_51 -->
<g id="edge51" class="edge">
<title>section_13&#45;&gt;prose_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4740.1029,-1506.1456C4856.6617,-1497.8465 5111.0498,-1478.835 5325,-1456.6025 5435.7146,-1445.0976 5565.779,-1427.8907 5631.0903,-1418.9936"/>
<polygon fill="#000000" stroke="#000000" points="5631.9474,-1422.4091 5641.3815,-1417.5873 5630.9996,-1415.4735 5631.9474,-1422.4091"/>
</g>
<!-- header_63 -->
<g id="node64" class="node">
<title>header_63</title>
<ellipse fill="none" stroke="#000000" cx="6090" cy="-1413.2024" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="6090" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : includes</text>
</g>
<!-- section_14&#45;&gt;header_63 -->
<g id="edge63" class="edge">
<title>section_14&#45;&gt;header_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6231.9588,-1494.7084C6210.4561,-1484.3936 6182.2529,-1470.3555 6158,-1456.6025 6146.2723,-1449.952 6133.7492,-1442.1663 6122.6873,-1435.0394"/>
<polygon fill="#000000" stroke="#000000" points="6124.463,-1432.0192 6114.1722,-1429.4994 6120.6456,-1437.8867 6124.463,-1432.0192"/>
</g>
<!-- prose_64 -->
<g id="node65" class="node">
<title>prose_64</title>
<ellipse fill="none" stroke="#000000" cx="6199" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6199" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_14&#45;&gt;prose_64 -->
<g id="edge64" class="edge">
<title>section_14&#45;&gt;prose_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6253.7112,-1492.7378C6243.288,-1477.5853 6228.2108,-1455.6672 6216.5224,-1438.6753"/>
<polygon fill="#000000" stroke="#000000" points="6219.3127,-1436.5559 6210.7616,-1430.3006 6213.5454,-1440.5232 6219.3127,-1436.5559"/>
</g>
<!-- codeblock_65 -->
<g id="node66" class="node">
<title>codeblock_65</title>
<ellipse fill="none" stroke="#000000" cx="6334" cy="-1413.2024" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="6334" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 73&#45;78</text>
</g>
<!-- section_14&#45;&gt;codeblock_65 -->
<g id="edge65" class="edge">
<title>section_14&#45;&gt;codeblock_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6278.4722,-1492.7378C6288.8551,-1477.8659 6303.788,-1456.4766 6315.5535,-1439.6243"/>
<polygon fill="#000000" stroke="#000000" points="6318.5219,-1441.4867 6321.3765,-1431.2837 6312.7822,-1437.4796 6318.5219,-1441.4867"/>
</g>
<!-- prose_66 -->
<g id="node67" class="node">
<title>prose_66</title>
<ellipse fill="none" stroke="#000000" cx="6487" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6487" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_14&#45;&gt;prose_66 -->
<g id="edge66" class="edge">
<title>section_14&#45;&gt;prose_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6313.3305,-1497.2102C6344.4087,-1487.6466 6385.5331,-1473.5088 6420,-1456.6025 6433.3857,-1450.0366 6447.353,-1441.325 6459.0492,-1433.4305"/>
<polygon fill="#000000" stroke="#000000" points="6461.257,-1436.1596 6467.5034,-1427.6019 6457.2837,-1430.3965 6461.257,-1436.1596"/>
</g>
<!-- codeblock_67 -->
<g id="node68" class="node">
<title>codeblock_67</title>
<ellipse fill="none" stroke="#000000" cx="6676" cy="-1413.2024" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="6676" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 84&#45;99</text>
</g>
<!-- section_14&#45;&gt;codeblock_67 -->
<g id="edge67" class="edge">
<title>section_14&#45;&gt;codeblock_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6323.5486,-1500.1478C6376.8378,-1490.1348 6458.1513,-1474.0108 6528,-1456.6025 6558.6604,-1448.961 6592.5026,-1439.1423 6620.0781,-1430.7775"/>
<polygon fill="#000000" stroke="#000000" points="6621.394,-1434.0353 6629.9365,-1427.7682 6619.3503,-1427.3402 6621.394,-1434.0353"/>
</g>
<!-- header_75 -->
<g id="node76" class="node">
<title>header_75</title>
<ellipse fill="none" stroke="#000000" cx="7016" cy="-1413.2024" rx="46.4822" ry="18"/>
<text text-anchor="middle" x="7016" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : define</text>
</g>
<!-- section_15&#45;&gt;header_75 -->
<g id="edge75" class="edge">
<title>section_15&#45;&gt;header_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7300.329,-1501.1199C7248.3153,-1492.414 7173.3141,-1477.6552 7110,-1456.6025 7090.4275,-1450.0944 7069.5148,-1440.7007 7052.396,-1432.3159"/>
<polygon fill="#000000" stroke="#000000" points="7053.8197,-1429.1149 7043.3085,-1427.7863 7050.6969,-1435.3798 7053.8197,-1429.1149"/>
</g>
<!-- prose_76 -->
<g id="node77" class="node">
<title>prose_76</title>
<ellipse fill="none" stroke="#000000" cx="7151" cy="-1413.2024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7151" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_15&#45;&gt;prose_76 -->
<g id="edge76" class="edge">
<title>section_15&#45;&gt;prose_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7328.8274,-1494.5188C7289.1773,-1476.3877 7225.1156,-1447.0938 7185.6723,-1429.0573"/>
<polygon fill="#000000" stroke="#000000" points="7186.7544,-1425.7036 7176.2046,-1424.7279 7183.8433,-1432.0696 7186.7544,-1425.7036"/>
</g>
<!-- codeblock_77 -->
<g id="node78" class="node">
<title>codeblock_77</title>
<ellipse fill="none" stroke="#000000" cx="7364" cy="-1413.2024" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7364" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 104&#45;179</text>
</g>
<!-- section_15&#45;&gt;codeblock_77 -->
<g id="edge77" class="edge">
<title>section_15&#45;&gt;codeblock_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7364,-1492.2823C7364,-1477.9977 7364,-1457.9071 7364,-1441.5509"/>
<polygon fill="#000000" stroke="#000000" points="7367.5001,-1441.4405 7364,-1431.4405 7360.5001,-1441.4405 7367.5001,-1441.4405"/>
</g>
<!-- codeblock_78 -->
<g id="node79" class="node">
<title>codeblock_78</title>
<ellipse fill="none" stroke="#000000" cx="7665" cy="-1413.2024" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7665" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 181&#45;190</text>
</g>
<!-- section_15&#45;&gt;codeblock_78 -->
<g id="edge78" class="edge">
<title>section_15&#45;&gt;codeblock_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7408.7377,-1496.1259C7461.8383,-1478.9432 7550.4573,-1450.2671 7608.3122,-1431.5459"/>
<polygon fill="#000000" stroke="#000000" points="7609.5947,-1434.8097 7618.0314,-1428.4009 7607.4395,-1428.1497 7609.5947,-1434.8097"/>
</g>
<!-- codeblock_79 -->
<g id="node80" class="node">
<title>codeblock_79</title>
<ellipse fill="none" stroke="#000000" cx="8014" cy="-1413.2024" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="8014" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 193&#45;207</text>
</g>
<!-- section_15&#45;&gt;codeblock_79 -->
<g id="edge79" class="edge">
<title>section_15&#45;&gt;codeblock_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7430.482,-1502.2757C7509.4148,-1492.2239 7644.9834,-1474.4381 7761,-1456.6025 7820.6496,-1447.4323 7887.9876,-1435.8195 7938.1884,-1426.9143"/>
<polygon fill="#000000" stroke="#000000" points="7939.0791,-1430.3109 7948.3118,-1425.114 7937.8534,-1423.419 7939.0791,-1430.3109"/>
</g>
<!-- codeblock_80 -->
<g id="node81" class="node">
<title>codeblock_80</title>
<ellipse fill="none" stroke="#000000" cx="8340" cy="-1413.2024" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="8340" y="-1409.0024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 209&#45;211</text>
</g>
<!-- section_15&#45;&gt;codeblock_80 -->
<g id="edge80" class="edge">
<title>section_15&#45;&gt;codeblock_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7438.1362,-1508.0432C7572.535,-1502.7802 7865.1809,-1488.4554 8110,-1456.6025 8164.133,-1449.5593 8224.7888,-1437.9567 8270.2145,-1428.5195"/>
<polygon fill="#000000" stroke="#000000" points="8271.1799,-1431.8934 8280.2504,-1426.4184 8269.7454,-1425.0419 8271.1799,-1431.8934"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1108.5,-786.4028 791.5,-786.4028 791.5,-730.5998 1108.5,-730.5998 1108.5,-786.4028"/>
<text text-anchor="middle" x="950" y="-739.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">This function takes two parameters, namely:</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1770.3107,-1396.1738C1763.8881,-1386.6326 1754.5269,-1375.5304 1743,-1369.8024 1618.4152,-1307.8931 1226.8624,-1420.4229 1118,-1333.8024 948.1678,-1198.669 943.5585,-901.8133 947.6768,-796.4879"/>
<polygon fill="#000000" stroke="#000000" points="951.1808,-796.473 948.1257,-786.3282 944.1876,-796.164 951.1808,-796.473"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1703,-785.8018 1127,-785.8018 1127,-731.2009 1703,-731.2009 1703,-785.8018"/>
<text text-anchor="middle" x="1415" y="-754.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; grammar_template : &#160;A function with one parameter, which must be =_ENV=.</text>
<text text-anchor="middle" x="1415" y="-739.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; metas : &#160;A map with keys of string and values of Node subclass constructors.</text>
</g>
<!-- raw_19&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>raw_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1841.4226,-1396.4274C1835.0193,-1387.4493 1826.1399,-1376.8259 1816,-1369.8024 1775.7907,-1341.9508 1748.9744,-1365.8241 1712,-1333.8024 1535.3851,-1180.8451 1449.773,-896.9953 1423.8208,-795.6527"/>
<polygon fill="#000000" stroke="#000000" points="1427.1932,-794.7121 1421.3567,-785.8698 1420.4052,-796.4218 1427.1932,-794.7121"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1996.5,-786.4028 1721.5,-786.4028 1721.5,-730.5998 1996.5,-730.5998 1996.5,-786.4028"/>
<text text-anchor="middle" x="1859" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">Both of these are reasonably complex.</text>
</g>
<!-- raw_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>raw_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1922.1937,-1395.0087C1913.4076,-1306.512 1875.0636,-920.2992 1862.7921,-796.6967"/>
<polygon fill="#000000" stroke="#000000" points="1866.2579,-796.1777 1861.787,-786.5724 1859.2921,-796.8693 1866.2579,-796.1777"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2171,-776.5013 2015,-776.5013 2015,-740.5013 2171,-740.5013 2171,-776.5013"/>
<text text-anchor="middle" x="2093" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">*** grammar_template</text>
</g>
<!-- header_23&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>header_23&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2066.7503,-1395.0087C2070.5048,-1303.9697 2087.2527,-897.8636 2091.8368,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2095.3382,-786.7429 2092.2533,-776.6072 2088.3441,-786.4544 2095.3382,-786.7429"/>
</g>
<!-- raw_32 -->
<g id="node33" class="node">
<title>raw_32</title>
<ellipse fill="none" stroke="#000000" cx="2216" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2216" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_24&#45;&gt;raw_32 -->
<g id="edge32" class="edge">
<title>prose_24&#45;&gt;raw_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2213.0834,-1395.0087C2213.5005,-1303.9697 2215.3614,-897.8636 2215.8708,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2219.3711,-786.6231 2215.917,-776.6072 2212.3712,-786.591 2219.3711,-786.6231"/>
</g>
<!-- raw_34 -->
<g id="node35" class="node">
<title>raw_34</title>
<ellipse fill="none" stroke="#000000" cx="2293" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2293" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_34 -->
<g id="edge34" class="edge">
<title>prose_25&#45;&gt;raw_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2294.9444,-1395.0087C2294.6663,-1303.9697 2293.4257,-897.8636 2293.0862,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2296.5859,-786.5964 2293.0553,-776.6072 2289.586,-786.6178 2296.5859,-786.5964"/>
</g>
<!-- raw_36 -->
<g id="node37" class="node">
<title>raw_36</title>
<ellipse fill="none" stroke="#000000" cx="2371" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2371" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_26&#45;&gt;raw_36 -->
<g id="edge36" class="edge">
<title>prose_26&#45;&gt;raw_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2376.8333,-1395.0087C2375.9989,-1303.9697 2372.2772,-897.8636 2371.2585,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2374.7575,-786.5746 2371.1659,-776.6072 2367.7578,-786.6389 2374.7575,-786.5746"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2451" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2451" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_27&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_27&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2458.7777,-1395.0087C2457.6653,-1303.9697 2452.7029,-897.8636 2451.3447,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2454.8433,-786.5636 2451.2212,-776.6072 2447.8438,-786.6492 2454.8433,-786.5636"/>
</g>
<!-- raw_40 -->
<g id="node41" class="node">
<title>raw_40</title>
<ellipse fill="none" stroke="#000000" cx="2532" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2532" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_28&#45;&gt;raw_40 -->
<g id="edge40" class="edge">
<title>prose_28&#45;&gt;raw_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2540.7499,-1395.0087C2539.4984,-1303.9697 2533.9158,-897.8636 2532.3877,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2535.8861,-786.5581 2532.2489,-776.6072 2528.8868,-786.6544 2535.8861,-786.5581"/>
</g>
<!-- raw_42 -->
<g id="node43" class="node">
<title>raw_42</title>
<ellipse fill="none" stroke="#000000" cx="2815" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="2815" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_29&#45;&gt;raw_42 -->
<g id="edge42" class="edge">
<title>prose_29&#45;&gt;raw_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2690.557,-1395.0087C2708.356,-1303.9697 2787.7534,-897.8636 2809.4854,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="2812.9763,-787.093 2811.4601,-776.6072 2806.1063,-785.7498 2812.9763,-787.093"/>
</g>
<!-- raw_44 -->
<g id="node45" class="node">
<title>raw_44</title>
<ellipse fill="none" stroke="#000000" cx="3103" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="3103" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_30&#45;&gt;raw_44 -->
<g id="edge44" class="edge">
<title>prose_30&#45;&gt;raw_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2895.8077,-1395.3512C2925.2615,-1304.8187 3058.1266,-896.4293 3094.0322,-786.0659"/>
<polygon fill="#000000" stroke="#000000" points="3097.4319,-786.9288 3097.1975,-776.3366 3090.7754,-784.7631 3097.4319,-786.9288"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="562,-116.8005 0,-116.8005 0,-30.3998 562,-30.3998 562,-116.8005"/>
<text text-anchor="middle" x="281" y="-69.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The internal function @define creates a custom environment variable, neatly</text>
<text text-anchor="middle" x="281" y="-54.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">sidestepping lua&#39;s pedantic insistance on prepending =local= to all values of </text>
<text text-anchor="middle" x="281" y="-38.7001" font-family="Inconsolata" font-size="14.00" fill="#000000">significance. </text>
</g>
<!-- raw_32&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_32&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2217.9319,-740.4716C2227.0175,-651.6471 2261.7306,-261.7156 2180,-183.2002 2147.7606,-152.2291 615.2961,-153.2375 571,-147.2002 526.0222,-141.0701 477.9578,-130.5484 434.1557,-119.3478"/>
<polygon fill="#000000" stroke="#000000" points="434.8516,-115.9126 424.2937,-116.7964 433.0983,-122.6895 434.8516,-115.9126"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="1121.5,-100.9006 580.5,-100.9006 580.5,-46.2997 1121.5,-46.2997 1121.5,-100.9006"/>
<text text-anchor="middle" x="851" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">More relevantly, it constructs a full grammar, which will return a table of</text>
<text text-anchor="middle" x="851" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">type Node. </text>
</g>
<!-- raw_34&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>raw_34&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2294.7483,-740.4751C2302.933,-651.6675 2333.7366,-261.8041 2252,-183.2002 2207.0479,-139.9711 1191.7109,-156.2115 1130,-147.2002 1067.1197,-138.0182 998.0498,-119.8639 944.3645,-103.8838"/>
<polygon fill="#000000" stroke="#000000" points="945.1084,-100.4529 934.5242,-100.928 943.0946,-107.1569 945.1084,-100.4529"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="1680.5,-116.2012 1139.5,-116.2012 1139.5,-30.9991 1680.5,-30.9991 1680.5,-116.2012"/>
<text text-anchor="middle" x="1410" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">If you stick to =lpeg= patterns, as you should, all array values will be of</text>
<text text-anchor="middle" x="1410" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">Node, as is intended. &#160;Captures will interpolate various other sorts of Lua</text>
<text text-anchor="middle" x="1410" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">values, which will induce halting in some places and silently corrupt</text>
<text text-anchor="middle" x="1410" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">execution in others. </text>
</g>
<!-- raw_36&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>raw_36&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2372.6767,-740.5117C2380.5141,-651.8795 2409.8618,-262.724 2329,-183.2002 2278.219,-133.2595 1759.3469,-158.3405 1689,-147.2002 1646.3108,-140.4399 1600.7054,-129.8763 1558.9985,-118.841"/>
<polygon fill="#000000" stroke="#000000" points="1559.8912,-115.4568 1549.3265,-116.2552 1558.0832,-122.2193 1559.8912,-115.4568"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2253.5,-116.2012 1698.5,-116.2012 1698.5,-30.9991 2253.5,-30.9991 2253.5,-116.2012"/>
<text text-anchor="middle" x="1976" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">Though as yet poorly thought through, the [[elpatt module][./elpatt]] is</text>
<text text-anchor="middle" x="1976" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">intended to provide only those patterns which are allowed in Grammars, while</text>
<text text-anchor="middle" x="1976" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">expanding the scope of some favorites to properly respect utf&#45;8 and otherwise</text>
<text text-anchor="middle" x="1976" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">behave. </text>
</g>
<!-- raw_38&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_38&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2456.178,-740.7962C2477.5353,-663.7486 2551.0889,-353.8958 2407,-183.2002 2364.4469,-132.7896 2326.9512,-163.394 2263,-147.2002 2226.9527,-138.0723 2188.3782,-128.2306 2151.5783,-118.8062"/>
<polygon fill="#000000" stroke="#000000" points="2152.3142,-115.3817 2141.7584,-116.2904 2150.5769,-122.1628 2152.3142,-115.3817"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="2736,-93.5022 2272,-93.5022 2272,-53.698 2736,-53.698 2736,-93.5022"/>
<text text-anchor="middle" x="2504" y="-62.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">There are examples of the format in the [[spec module][./spec]].</text>
</g>
<!-- raw_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>raw_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2531.2511,-740.1819C2527.4222,-646.5255 2510.029,-221.0744 2505.2297,-103.6804"/>
<polygon fill="#000000" stroke="#000000" points="2508.7235,-103.4546 2504.8179,-93.606 2501.7294,-103.7406 2508.7235,-103.4546"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="2931.5,-93.5022 2754.5,-93.5022 2754.5,-53.698 2931.5,-53.698 2931.5,-93.5022"/>
<text text-anchor="middle" x="2843" y="-62.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">Special fields include:</text>
</g>
<!-- raw_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>raw_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2815.7489,-740.1819C2819.5778,-646.5255 2836.971,-221.0744 2841.7703,-103.6804"/>
<polygon fill="#000000" stroke="#000000" points="2845.2706,-103.7406 2842.1821,-93.606 2838.2765,-103.4546 2845.2706,-103.7406"/>
</g>
<!-- leaf_45 -->
<g id="node46" class="node">
<title>leaf_45</title>
<polygon fill="none" stroke="#c0c0c0" points="3498,-132.1003 2950,-132.1003 2950,-15.1 3498,-15.1 3498,-132.1003"/>
<text text-anchor="middle" x="3224" y="-100.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;START : &#160;a string which must be the same as the starting rule.</text>
<text text-anchor="middle" x="3224" y="-85.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;SUPPRESS : &#160;either a string or an array of strings. These rules will be</text>
<text text-anchor="middle" x="3224" y="-70.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;removed from the Node. </text>
<text text-anchor="middle" x="3224" y="-54.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;P : &#160;The lpeg P function. &#160;Recognizes a certain pattern.</text>
<text text-anchor="middle" x="3224" y="-39.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;V : &#160;The lpeg V function. &#160;Used for non&#45;terminal rvalues in a grammar. </text>
</g>
<!-- raw_44&#45;&gt;leaf_45 -->
<g id="edge45" class="edge">
<title>raw_44&#45;&gt;leaf_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3106.1743,-740.5339C3121.1188,-655.9428 3184.8661,-295.111 3211.8536,-142.3529"/>
<polygon fill="#000000" stroke="#000000" points="3215.3614,-142.615 3213.6546,-132.1586 3208.4682,-141.3971 3215.3614,-142.615"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="4536.5,-776.5013 4457.5,-776.5013 4457.5,-740.5013 4536.5,-740.5013 4536.5,-776.5013"/>
<text text-anchor="middle" x="4497" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">*** metas</text>
</g>
<!-- header_46&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>header_46&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4497,-1395.0087C4497,-1303.9697 4497,-897.8636 4497,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="4500.5001,-786.6071 4497,-776.6072 4493.5001,-786.6072 4500.5001,-786.6071"/>
</g>
<!-- raw_53 -->
<g id="node54" class="node">
<title>raw_53</title>
<ellipse fill="none" stroke="#000000" cx="4588" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="4588" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_47&#45;&gt;raw_53 -->
<g id="edge53" class="edge">
<title>prose_47&#45;&gt;raw_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4593.8333,-1395.0087C4592.9989,-1303.9697 4589.2772,-897.8636 4588.2585,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="4591.7575,-786.5746 4588.1659,-776.6072 4584.7578,-786.6389 4591.7575,-786.5746"/>
</g>
<!-- raw_55 -->
<g id="node56" class="node">
<title>raw_55</title>
<ellipse fill="none" stroke="#000000" cx="4668" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="4668" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_48&#45;&gt;raw_55 -->
<g id="edge55" class="edge">
<title>prose_48&#45;&gt;raw_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4675.7777,-1395.0087C4674.6653,-1303.9697 4669.7029,-897.8636 4668.3447,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="4671.8433,-786.5636 4668.2212,-776.6072 4664.8438,-786.6492 4671.8433,-786.5636"/>
</g>
<!-- raw_57 -->
<g id="node58" class="node">
<title>raw_57</title>
<ellipse fill="none" stroke="#000000" cx="4944" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="4944" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_49&#45;&gt;raw_57 -->
<g id="edge57" class="edge">
<title>prose_49&#45;&gt;raw_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4885.6674,-1395.0087C4894.0106,-1303.9697 4931.2282,-897.8636 4941.415,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="4944.9134,-786.8849 4942.3407,-776.6072 4937.9426,-786.246 4944.9134,-786.8849"/>
</g>
<!-- raw_59 -->
<g id="node60" class="node">
<title>raw_59</title>
<ellipse fill="none" stroke="#000000" cx="5439" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="5439" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_50&#45;&gt;raw_59 -->
<g id="edge59" class="edge">
<title>prose_50&#45;&gt;raw_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5288.2263,-1395.3512C5309.6382,-1304.91 5406.1508,-897.2524 5432.3949,-786.4005"/>
<polygon fill="#000000" stroke="#000000" points="5435.8795,-786.8739 5434.7775,-776.3366 5429.0678,-785.2612 5435.8795,-786.8739"/>
</g>
<!-- raw_61 -->
<g id="node62" class="node">
<title>raw_61</title>
<ellipse fill="none" stroke="#000000" cx="5987" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="5987" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_51&#45;&gt;raw_61 -->
<g id="edge61" class="edge">
<title>prose_51&#45;&gt;raw_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5681.3987,-1395.6908C5724.6202,-1305.5725 5921.9733,-894.0842 5974.2577,-785.0694"/>
<polygon fill="#000000" stroke="#000000" points="5977.5525,-786.2931 5978.7212,-775.7629 5971.2409,-783.266 5977.5525,-786.2931"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="4113.5,-108.9005 3516.5,-108.9005 3516.5,-38.2998 4113.5,-38.2998 4113.5,-108.9005"/>
<text text-anchor="middle" x="3815" y="-61.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;By default a node will inherit from the Node class. &#160;If you want custom behavior,</text>
<text text-anchor="middle" x="3815" y="-46.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">you must pass in a table of metatable constructors.</text>
</g>
<!-- raw_53&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>raw_53&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4589.622,-740.2614C4597.1115,-651.2748 4624.7037,-263.7289 4545,-183.2002 4511.818,-149.6748 4168.5667,-154.7199 4122,-147.2002 4066.2234,-138.1933 4005.5877,-124.5062 3953.0501,-111.3685"/>
<polygon fill="#000000" stroke="#000000" points="3953.8893,-107.9706 3943.3374,-108.923 3952.1801,-114.7587 3953.8893,-107.9706"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="4700.5,-147.3005 4131.5,-147.3005 4131.5,.1003 4700.5,.1003 4700.5,-147.3005"/>
<text text-anchor="middle" x="4416" y="-116.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">That&#39;s a fairly specific beast. &#160;Any rule defined above will have an =id=</text>
<text text-anchor="middle" x="4416" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">corresonding to the name of the rule. &#160;Unless =SUPPRESS=ed, this will become</text>
<text text-anchor="middle" x="4416" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">a Node. &#160;If the =metas= parameter has a key corresponding to =id=, then it</text>
<text text-anchor="middle" x="4416" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">must return a function taking two parameters:</text>
<text text-anchor="middle" x="4416" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;</text>
<text text-anchor="middle" x="4416" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; node : &#160;The node under construction, which under normal circumstances will</text>
<text text-anchor="middle" x="4416" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;already have the =first= and =last= fields.</text>
<text text-anchor="middle" x="4416" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; str &#160;: &#160;The entire str the grammar is parsing.</text>
</g>
<!-- raw_55&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>raw_55&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4672.3375,-740.5896C4689.5137,-665.2087 4746.0708,-369.0786 4624,-183.2002 4617.0165,-172.5664 4608.6502,-162.8972 4599.3415,-154.1155"/>
<polygon fill="#000000" stroke="#000000" points="4601.4684,-151.322 4591.6824,-147.2616 4596.8003,-156.5383 4601.4684,-151.322"/>
</g>
<!-- leaf_58 -->
<g id="node59" class="node">
<title>leaf_58</title>
<polygon fill="none" stroke="#c0c0c0" points="5287.5,-93.5022 4718.5,-93.5022 4718.5,-53.698 5287.5,-53.698 5287.5,-93.5022"/>
<text text-anchor="middle" x="5003" y="-62.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">Which must return that same node, decorated in whatever fashion is appropriate.</text>
</g>
<!-- raw_57&#45;&gt;leaf_58 -->
<g id="edge58" class="edge">
<title>raw_57&#45;&gt;leaf_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4945.5781,-740.1819C4953.646,-646.5255 4990.296,-221.0744 5000.4088,-103.6804"/>
<polygon fill="#000000" stroke="#000000" points="5003.9054,-103.8695 5001.2766,-93.606 4996.9312,-103.2687 5003.9054,-103.8695"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="5882,-108.8005 5306,-108.8005 5306,-38.3997 5882,-38.3997 5882,-108.8005"/>
<text text-anchor="middle" x="5594" y="-77.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">The node will not have a metatable at this point, and the function must attach a</text>
<text text-anchor="middle" x="5594" y="-62.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">metatable with =__index= equal to some table which itself has the =__index=</text>
<text text-anchor="middle" x="5594" y="-46.7001" font-family="Inconsolata" font-size="14.00" fill="#000000">Node as some recursive backstop.</text>
</g>
<!-- raw_59&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>raw_59&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5443.0662,-740.5339C5463.2699,-651.2595 5553.1035,-254.31 5583.7309,-118.9765"/>
<polygon fill="#000000" stroke="#000000" points="5587.2081,-119.468 5586.0018,-108.9421 5580.3807,-117.9229 5587.2081,-119.468"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="6427.5,-108.9005 5900.5,-108.9005 5900.5,-38.2998 6427.5,-38.2998 6427.5,-108.9005"/>
<text text-anchor="middle" x="6164" y="-77.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">You might say the return value must /inherit/ from Node, if we were using</text>
<text text-anchor="middle" x="6164" y="-62.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">a language that did that sort of thing. </text>
</g>
<!-- raw_61&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>raw_61&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5983.3865,-740.43C5969.5049,-666.2146 5925.3405,-379.5211 6028,-183.2002 6042.392,-155.6777 6067.0373,-132.6344 6091.4277,-114.8916"/>
<polygon fill="#000000" stroke="#000000" points="6093.5171,-117.701 6099.6743,-109.0789 6089.4842,-111.9794 6093.5171,-117.701"/>
</g>
<!-- leaf_68 -->
<g id="node69" class="node">
<title>leaf_68</title>
<polygon fill="none" stroke="#c0c0c0" points="6137,-776.5013 6037,-776.5013 6037,-740.5013 6137,-740.5013 6137,-776.5013"/>
<text text-anchor="middle" x="6087" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">*** includes</text>
</g>
<!-- header_63&#45;&gt;leaf_68 -->
<g id="edge68" class="edge">
<title>header_63&#45;&gt;leaf_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6089.9166,-1395.0087C6089.4995,-1303.9697 6087.6386,-897.8636 6087.1292,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="6090.6288,-786.591 6087.083,-776.6072 6083.6289,-786.6231 6090.6288,-786.591"/>
</g>
<!-- raw_69 -->
<g id="node70" class="node">
<title>raw_69</title>
<ellipse fill="none" stroke="#000000" cx="6182" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="6182" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_64&#45;&gt;raw_69 -->
<g id="edge69" class="edge">
<title>prose_64&#45;&gt;raw_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6198.5276,-1395.0087C6196.1637,-1303.9697 6185.6187,-897.8636 6182.7324,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="6186.2286,-786.5129 6182.4701,-776.6072 6179.231,-786.6947 6186.2286,-786.5129"/>
</g>
<!-- leaf_71 -->
<g id="node72" class="node">
<title>leaf_71</title>
<polygon fill="none" stroke="#c0c0c0" points="6467,-793.7017 6227,-793.7017 6227,-723.3009 6467,-723.3009 6467,-793.7017"/>
<text text-anchor="middle" x="6347" y="-778.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="6347" y="-747.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot; </text>
<text text-anchor="middle" x="6347" y="-731.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;node/node&quot;</text>
</g>
<!-- codeblock_65&#45;&gt;leaf_71 -->
<g id="edge71" class="edge">
<title>codeblock_65&#45;&gt;leaf_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6334.3613,-1395.0087C6336.0861,-1308.1438 6343.5065,-934.4408 6346.1006,-803.7985"/>
<polygon fill="#000000" stroke="#000000" points="6349.6012,-803.7974 6346.3005,-793.7299 6342.6026,-803.6584 6349.6012,-803.7974"/>
</g>
<!-- raw_72 -->
<g id="node73" class="node">
<title>raw_72</title>
<ellipse fill="none" stroke="#000000" cx="6512" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="6512" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_66&#45;&gt;raw_72 -->
<g id="edge72" class="edge">
<title>prose_66&#45;&gt;raw_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6487.6947,-1395.0087C6491.1711,-1303.9697 6506.6784,-897.8636 6510.9229,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="6514.4244,-786.7335 6511.3086,-776.6072 6507.4295,-786.4663 6514.4244,-786.7335"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="6916.5,-870.1021 6557.5,-870.1021 6557.5,-646.9005 6916.5,-646.9005 6916.5,-870.1021"/>
<text text-anchor="middle" x="6737" y="-855.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">local assert = assert</text>
<text text-anchor="middle" x="6737" y="-839.7015" font-family="Inconsolata" font-size="14.00" fill="#000000">local string, io = assert( string ), assert( io )</text>
<text text-anchor="middle" x="6737" y="-824.3015" font-family="Inconsolata" font-size="14.00" fill="#000000">local V = string.sub( assert( _VERSION ), &#45;4 )</text>
<text text-anchor="middle" x="6737" y="-808.9015" font-family="Inconsolata" font-size="14.00" fill="#000000">local _G = assert( _G )</text>
<text text-anchor="middle" x="6737" y="-793.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">local error = assert( error )</text>
<text text-anchor="middle" x="6737" y="-778.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">local pairs = assert( pairs )</text>
<text text-anchor="middle" x="6737" y="-762.7014" font-family="Inconsolata" font-size="14.00" fill="#000000">local next = assert( next )</text>
<text text-anchor="middle" x="6737" y="-747.3013" font-family="Inconsolata" font-size="14.00" fill="#000000">local type = assert( type )</text>
<text text-anchor="middle" x="6737" y="-731.9013" font-family="Inconsolata" font-size="14.00" fill="#000000">local tostring = assert( tostring )</text>
<text text-anchor="middle" x="6737" y="-716.5013" font-family="Inconsolata" font-size="14.00" fill="#000000">local setmetatable = assert( setmetatable )</text>
<text text-anchor="middle" x="6737" y="-701.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">if V == &quot; 5.1&quot; then</text>
<text text-anchor="middle" x="6737" y="-685.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local setfenv = assert( setfenv )</text>
<text text-anchor="middle" x="6737" y="-670.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local getfenv = assert( getfenv )</text>
<text text-anchor="middle" x="6737" y="-654.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_67&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>codeblock_67&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6677.6952,-1395.0087C6684.5321,-1321.6293 6710.4404,-1043.5604 6725.6577,-880.236"/>
<polygon fill="#000000" stroke="#000000" points="6729.1563,-880.4128 6726.5992,-870.1312 6722.1865,-879.7633 6729.1563,-880.4128"/>
</g>
<!-- leaf_70 -->
<g id="node71" class="node">
<title>leaf_70</title>
<polygon fill="none" stroke="#c0c0c0" points="6500,-91.6001 6446,-91.6001 6446,-55.6001 6500,-55.6001 6500,-91.6001"/>
</g>
<!-- raw_69&#45;&gt;leaf_70 -->
<g id="edge70" class="edge">
<title>raw_69&#45;&gt;leaf_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6180.2704,-740.4019C6172.24,-652.0807 6142.0992,-267.196 6218,-183.2002 6283.8389,-110.3395 6356.9014,-205.3971 6436,-147.2002 6450.9304,-136.2152 6460.2268,-117.4877 6465.7669,-101.6732"/>
<polygon fill="#000000" stroke="#000000" points="6469.2072,-102.4022 6468.8866,-91.8122 6462.5332,-100.2908 6469.2072,-102.4022"/>
</g>
<!-- leaf_73 -->
<g id="node74" class="node">
<title>leaf_73</title>
<polygon fill="none" stroke="#c0c0c0" points="6849.5,-93.5022 6518.5,-93.5022 6518.5,-53.698 6849.5,-53.698 6849.5,-93.5022"/>
<text text-anchor="middle" x="6684" y="-62.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">It&#39;s the kind of thing I&#39;d like to automate. </text>
</g>
<!-- raw_72&#45;&gt;leaf_73 -->
<g id="edge73" class="edge">
<title>raw_72&#45;&gt;leaf_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6508.1854,-740.4481C6493.4865,-666.3037 6446.2497,-379.8495 6548,-183.2002 6567.0884,-146.3088 6604.6866,-117.5177 6635.5213,-98.7206"/>
<polygon fill="#000000" stroke="#000000" points="6637.6073,-101.5532 6644.4306,-93.4481 6634.0422,-95.529 6637.6073,-101.5532"/>
</g>
<!-- leaf_81 -->
<g id="node82" class="node">
<title>leaf_81</title>
<polygon fill="none" stroke="#c0c0c0" points="7021,-776.5013 6935,-776.5013 6935,-740.5013 7021,-740.5013 7021,-776.5013"/>
<text text-anchor="middle" x="6978" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">*** define</text>
</g>
<!-- header_75&#45;&gt;leaf_81 -->
<g id="edge81" class="edge">
<title>header_75&#45;&gt;leaf_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7014.944,-1395.0087C7009.6599,-1303.9697 6986.0888,-897.8636 6979.6372,-786.7078"/>
<polygon fill="#000000" stroke="#000000" points="6983.1245,-786.3875 6979.0509,-776.6072 6976.1363,-786.7932 6983.1245,-786.3875"/>
</g>
<!-- raw_82 -->
<g id="node83" class="node">
<title>raw_82</title>
<ellipse fill="none" stroke="#000000" cx="7066" cy="-758.5013" rx="27" ry="18"/>
<text text-anchor="middle" x="7066" y="-754.3013" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_76&#45;&gt;raw_82 -->
<g id="edge82" class="edge">
<title>prose_76&#45;&gt;raw_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7137.4605,-1396.7546C7125.7526,-1381.4802 7109.5553,-1357.5762 7102,-1333.8024 7037.9734,-1132.3345 7055.0991,-871.6374 7063.0449,-786.6351"/>
<polygon fill="#000000" stroke="#000000" points="7066.5471,-786.7812 7064.0293,-776.4899 7059.5798,-786.1052 7066.5471,-786.7812"/>
</g>
<!-- leaf_84 -->
<g id="node85" class="node">
<title>leaf_84</title>
<polygon fill="none" stroke="#c0c0c0" points="7617,-1333.6035 7111,-1333.6035 7111,-183.3991 7617,-183.3991 7617,-1333.6035"/>
<text text-anchor="middle" x="7364" y="-1318.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">local function make_ast_node(id, first, t, last, str, metas, offset)</text>
<text text-anchor="middle" x="7364" y="-1303.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local offset = offset or 0</text>
<text text-anchor="middle" x="7364" y="-1287.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;t.first = first + offset</text>
<text text-anchor="middle" x="7364" y="-1272.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;t.last &#160;= last + offset &#45; 1</text>
<text text-anchor="middle" x="7364" y="-1257.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;t.str &#160;&#160;= str</text>
<text text-anchor="middle" x="7364" y="-1241.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if metas[id] then</text>
<text text-anchor="middle" x="7364" y="-1226.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;t = metas[id](t, str)</text>
<text text-anchor="middle" x="7364" y="-1210.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;assert(t.id == id)</text>
<text text-anchor="middle" x="7364" y="-1195.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="7364" y="-1180.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;t.id = id</text>
<text text-anchor="middle" x="7364" y="-1164.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setmetatable(t, {__index = Node,</text>
<text text-anchor="middle" x="7364" y="-1149.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;__tostring = Node.toString})</text>
<text text-anchor="middle" x="7364" y="-1133.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="7364" y="-1118.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;assert(t.isNode, &quot;failed isNode: &quot; .. id)</text>
<text text-anchor="middle" x="7364" y="-1103.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;assert(t.str)</text>
<text text-anchor="middle" x="7364" y="-1087.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return t</text>
<text text-anchor="middle" x="7364" y="-1072.2019" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="7364" y="-1024.8019" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; some useful/common lpeg patterns</text>
<text text-anchor="middle" x="7364" y="-1009.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cp = L.Cp</text>
<text text-anchor="middle" x="7364" y="-994.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local Cc = L.Cc</text>
<text text-anchor="middle" x="7364" y="-978.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">local Ct = L.Ct</text>
<text text-anchor="middle" x="7364" y="-963.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local arg1_str = L.Carg(1)</text>
<text text-anchor="middle" x="7364" y="-947.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local arg2_metas = L.Carg(2)</text>
<text text-anchor="middle" x="7364" y="-932.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local arg3_offset = L.Carg(3)</text>
<text text-anchor="middle" x="7364" y="-885.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; setup an environment where you can easily define lpeg grammars</text>
<text text-anchor="middle" x="7364" y="-869.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; with lots of syntax sugar</text>
<text text-anchor="middle" x="7364" y="-854.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function define(func, g, e)</text>
<text text-anchor="middle" x="7364" y="-838.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;g = g or {}</text>
<text text-anchor="middle" x="7364" y="-823.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if e == nil then</text>
<text text-anchor="middle" x="7364" y="-808.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;e = V == &quot; 5.1&quot; and getfenv(func) or _G</text>
<text text-anchor="middle" x="7364" y="-792.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="7364" y="-777.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local suppressed = {}</text>
<text text-anchor="middle" x="7364" y="-761.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local env = {}</text>
<text text-anchor="middle" x="7364" y="-746.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local env_index = {</text>
<text text-anchor="middle" x="7364" y="-731.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;START = function(name) g[1] = name end,</text>
<text text-anchor="middle" x="7364" y="-715.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;SUPPRESS = function(...)</text>
<text text-anchor="middle" x="7364" y="-700.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;suppressed = {}</text>
<text text-anchor="middle" x="7364" y="-684.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = 1, select(&#39;#&#39;, ...) do</text>
<text text-anchor="middle" x="7364" y="-669.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;suppressed[select(i, ... )] = true</text>
<text text-anchor="middle" x="7364" y="-654.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7364" y="-638.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end,</text>
<text text-anchor="middle" x="7364" y="-623.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;V = L.V,</text>
<text text-anchor="middle" x="7364" y="-607.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;P = L.P,</text>
<text text-anchor="middle" x="7364" y="-592.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;}</text>
<text text-anchor="middle" x="7364" y="-561.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;setmetatable(env_index, { __index = e })</text>
<text text-anchor="middle" x="7364" y="-545.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;setmetatable(env, {</text>
<text text-anchor="middle" x="7364" y="-530.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;__index = env_index,</text>
<text text-anchor="middle" x="7364" y="-514.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;__newindex = function( _, name, val )</text>
<text text-anchor="middle" x="7364" y="-499.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if suppressed[ name ] then</text>
<text text-anchor="middle" x="7364" y="-484.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;g[ name ] = val</text>
<text text-anchor="middle" x="7364" y="-468.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="7364" y="-453.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;g[ name ] = (Cc(name) </text>
<text text-anchor="middle" x="7364" y="-437.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* Cp() </text>
<text text-anchor="middle" x="7364" y="-422.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* Ct(val)</text>
<text text-anchor="middle" x="7364" y="-407.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* Cp()</text>
<text text-anchor="middle" x="7364" y="-391.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* arg1_str</text>
<text text-anchor="middle" x="7364" y="-376.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* arg2_metas)</text>
<text text-anchor="middle" x="7364" y="-360.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* arg3_offset / make_ast_node</text>
<text text-anchor="middle" x="7364" y="-345.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7364" y="-330.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7364" y="-314.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;})</text>
<text text-anchor="middle" x="7364" y="-299.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; call passed function with custom environment (5.1&#45; and 5.2&#45;style)</text>
<text text-anchor="middle" x="7364" y="-283.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if V == &quot; 5.1&quot; then</text>
<text text-anchor="middle" x="7364" y="-268.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setfenv( func, env )</text>
<text text-anchor="middle" x="7364" y="-253.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="7364" y="-237.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;func( env )</text>
<text text-anchor="middle" x="7364" y="-222.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;assert( g[ 1 ] and g[ g[ 1 ] ], &quot;no start rule defined&quot; )</text>
<text text-anchor="middle" x="7364" y="-206.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return g</text>
<text text-anchor="middle" x="7364" y="-191.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_77&#45;&gt;leaf_84 -->
<g id="edge84" class="edge">
<title>codeblock_77&#45;&gt;leaf_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7364,-1395.0087C7364,-1383.0094 7364,-1365.5369 7364,-1343.9877"/>
<polygon fill="#000000" stroke="#000000" points="7367.5001,-1343.8048 7364,-1333.8048 7360.5001,-1343.8049 7367.5001,-1343.8048"/>
</g>
<!-- leaf_85 -->
<g id="node86" class="node">
<title>leaf_85</title>
<polygon fill="none" stroke="#c0c0c0" points="7910.5,-824.2017 7635.5,-824.2017 7635.5,-692.8009 7910.5,-692.8009 7910.5,-824.2017"/>
<text text-anchor="middle" x="7773" y="-808.9015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function refineMetas(metas)</text>
<text text-anchor="middle" x="7773" y="-793.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for _,v in pairs(metas) do</text>
<text text-anchor="middle" x="7773" y="-778.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not v[&quot;__tostring&quot;] then</text>
<text text-anchor="middle" x="7773" y="-762.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;v[&quot;__tostring&quot;] = Node.toString</text>
<text text-anchor="middle" x="7773" y="-747.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="7773" y="-731.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="7773" y="-716.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return metas</text>
<text text-anchor="middle" x="7773" y="-701.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_78&#45;&gt;leaf_85 -->
<g id="edge85" class="edge">
<title>codeblock_78&#45;&gt;leaf_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7668.0013,-1395.0087C7681.339,-1314.1546 7735.672,-984.7857 7760.507,-834.2346"/>
<polygon fill="#000000" stroke="#000000" points="7763.9969,-834.5817 7762.1713,-824.1454 7757.0903,-833.4423 7763.9969,-834.5817"/>
</g>
<!-- leaf_86 -->
<g id="node87" class="node">
<title>leaf_86</title>
<polygon fill="none" stroke="#c0c0c0" points="8413.5,-862.7018 7928.5,-862.7018 7928.5,-654.3008 8413.5,-654.3008 8413.5,-862.7018"/>
<text text-anchor="middle" x="8171" y="-847.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(grammar_template, metas)</text>
<text text-anchor="middle" x="8171" y="-832.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if type(grammar_template) == &#39;function&#39; then</text>
<text text-anchor="middle" x="8171" y="-816.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local metas = metas or {}</text>
<text text-anchor="middle" x="8171" y="-801.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local grammar = define(grammar_template, nil, metas)</text>
<text text-anchor="middle" x="8171" y="-785.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local parse = function(str, offset)</text>
<text text-anchor="middle" x="8171" y="-770.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local offset = offset or 0</text>
<text text-anchor="middle" x="8171" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return L.match(grammar, str, 1, str, metas, offset) &#45;&#45; other </text>
<text text-anchor="middle" x="8171" y="-739.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="8171" y="-724.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return parse</text>
<text text-anchor="middle" x="8171" y="-708.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="8171" y="-693.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;s:halt(&quot;no way to build grammar out of &quot; .. type(template))</text>
<text text-anchor="middle" x="8171" y="-678.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="8171" y="-662.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_79&#45;&gt;leaf_86 -->
<g id="edge86" class="edge">
<title>codeblock_79&#45;&gt;leaf_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8018.3629,-1395.0087C8036.2264,-1320.5168 8104.675,-1035.0812 8143.5698,-872.8873"/>
<polygon fill="#000000" stroke="#000000" points="8147.0447,-873.4053 8145.9732,-862.8648 8140.2377,-871.7729 8147.0447,-873.4053"/>
</g>
<!-- leaf_87 -->
<g id="node88" class="node">
<title>leaf_87</title>
<polygon fill="none" stroke="#c0c0c0" points="8518,-776.5013 8432,-776.5013 8432,-740.5013 8518,-740.5013 8518,-776.5013"/>
<text text-anchor="middle" x="8475" y="-755.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_80&#45;&gt;leaf_87 -->
<g id="edge87" class="edge">
<title>codeblock_80&#45;&gt;leaf_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8366.6042,-1395.7631C8385.8353,-1381.5624 8410.5394,-1359.6736 8423,-1333.8024 8515.2284,-1142.3142 8490.3894,-873.5855 8479.106,-786.748"/>
<polygon fill="#000000" stroke="#000000" points="8482.5461,-786.0678 8477.7428,-776.6244 8475.6087,-787.002 8482.5461,-786.0678"/>
</g>
<!-- leaf_83 -->
<g id="node84" class="node">
<title>leaf_83</title>
<polygon fill="none" stroke="#c0c0c0" points="7093,-91.6001 7039,-91.6001 7039,-55.6001 7093,-55.6001 7093,-91.6001"/>
</g>
<!-- raw_82&#45;&gt;leaf_83 -->
<g id="edge83" class="edge">
<title>raw_82&#45;&gt;leaf_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7066,-740.1819C7066,-646.0016 7066,-216.3039 7066,-101.7393"/>
<polygon fill="#000000" stroke="#000000" points="7069.5001,-101.658 7066,-91.658 7062.5001,-101.658 7069.5001,-101.658"/>
</g>
</g>
</svg>