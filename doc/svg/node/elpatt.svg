<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3466pt" height="915pt"
 viewBox="0.00 0.00 3465.50 915.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 911.4007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-911.4007 3461.5,-911.4007 3461.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1035.5" cy="-889.4007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="1035.5" y="-885.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 85</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1035.5" cy="-817.4007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1035.5" y="-813.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035.5,-871.232C1035.5,-863.5316 1035.5,-854.375 1035.5,-845.8173"/>
<polygon fill="#000000" stroke="#000000" points="1039.0001,-845.8139 1035.5,-835.8139 1032.0001,-845.814 1039.0001,-845.8139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="688.5" cy="-745.4007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="688.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M985.4138,-807.0081C928.3763,-795.1733 834.444,-775.683 767.5096,-761.7946"/>
<polygon fill="#000000" stroke="#000000" points="767.926,-758.3065 757.4235,-759.7018 766.5038,-765.1605 767.926,-758.3065"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="865.5" cy="-745.4007" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="865.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;6</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1000.2759,-802.4822C972.927,-790.8992 934.9632,-774.8204 906.2949,-762.6785"/>
<polygon fill="#000000" stroke="#000000" points="907.531,-759.4011 896.9578,-758.724 904.801,-765.8468 907.531,-759.4011"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="975.5" cy="-745.4007" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="975.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 7&#45;9</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1020.6685,-799.6029C1013.3485,-790.8188 1004.3933,-780.0726 996.3928,-770.4721"/>
<polygon fill="#000000" stroke="#000000" points="999.0445,-768.1868 989.9538,-762.7452 993.6669,-772.6681 999.0445,-768.1868"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="1095.5" cy="-745.4007" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1095.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 10&#45;40</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1050.3315,-799.6029C1057.5973,-790.8839 1066.4741,-780.2317 1074.4292,-770.6856"/>
<polygon fill="#000000" stroke="#000000" points="1077.126,-772.9166 1080.8391,-762.9937 1071.7485,-768.4353 1077.126,-772.9166"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1574.5" cy="-745.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1574.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1090.9007,-810.0002C1189.9238,-796.7726 1397.0217,-769.1083 1505.2546,-754.6505"/>
<polygon fill="#000000" stroke="#000000" points="1505.9647,-758.0868 1515.4132,-753.2935 1505.0378,-751.1485 1505.9647,-758.0868"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="2797.5" cy="-745.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2797.5" y="-741.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1095.8969,-814.9327C1361.888,-804.0636 2428.6897,-760.4712 2722.3444,-748.4717"/>
<polygon fill="#000000" stroke="#000000" points="2722.6132,-751.9637 2732.4619,-748.0583 2722.3273,-744.9696 2722.6132,-751.9637"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-691.301 0,-691.301 0,-620.7003 443,-620.7003 443,-691.301"/>
<text text-anchor="middle" x="221.5" y="-644.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="221.5" y="-628.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- block_3&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>block_3&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M831.7794,-733.0969C824.8177,-730.9168 817.4792,-728.8755 810.5,-727.4007 657.2502,-695.0163 612.9502,-710.8356 453.2617,-691.4538"/>
<polygon fill="#000000" stroke="#000000" points="453.4327,-687.9482 443.0776,-690.1893 452.5701,-694.8949 453.4327,-687.9482"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-675.3012 461.5,-675.3012 461.5,-636.7 939.5,-636.7 939.5,-675.3012"/>
<text text-anchor="middle" x="700.5" y="-660.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="700.5" y="-644.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M940.0007,-733.7685C933.5141,-731.6471 926.8046,-729.4554 920.5,-727.4007 870.0976,-710.9741 813.1737,-692.5018 769.8581,-678.4622"/>
<polygon fill="#000000" stroke="#000000" points="770.8644,-675.1091 760.2724,-675.3555 768.7062,-681.7681 770.8644,-675.1091"/>
</g>
<!-- codeblock_10 -->
<g id="node11" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="1034.5" cy="-656.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1034.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- block_5&#45;&gt;codeblock_10 -->
<g id="edge10" class="edge">
<title>block_5&#45;&gt;codeblock_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1083.4484,-727.7381C1074.6498,-714.8431 1062.5703,-697.1397 1052.6128,-682.5463"/>
<polygon fill="#000000" stroke="#000000" points="1055.2628,-680.2201 1046.7354,-673.9325 1049.4806,-684.1655 1055.2628,-680.2201"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1183.5,-674.0006 1129.5,-674.0006 1129.5,-638.0006 1183.5,-638.0006 1183.5,-674.0006"/>
</g>
<!-- block_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>block_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1107.5516,-727.7381C1116.2927,-714.9274 1128.272,-697.3709 1138.1917,-682.8328"/>
<polygon fill="#000000" stroke="#000000" points="1141.3094,-684.4733 1144.0546,-674.2403 1135.5272,-680.5279 1141.3094,-684.4733"/>
</g>
<!-- header_13 -->
<g id="node14" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1318.5" cy="-656.0006" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1318.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1533.936,-731.235C1491.2006,-716.3109 1423.557,-692.6885 1375.4763,-675.8978"/>
<polygon fill="#000000" stroke="#000000" points="1376.4269,-672.5226 1365.832,-672.5299 1374.119,-679.1312 1376.4269,-672.5226"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="1509.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1509.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 16&#45;19</text>
</g>
<!-- section_6&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1561.6581,-727.7381C1552.1323,-714.6364 1538.9973,-696.5708 1528.292,-681.8468"/>
<polygon fill="#000000" stroke="#000000" points="1531.0268,-679.6564 1522.3152,-673.6265 1525.3651,-683.7729 1531.0268,-679.6564"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="1639.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1639.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 20&#45;21</text>
</g>
<!-- section_6&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1587.3419,-727.7381C1596.8677,-714.6364 1610.0027,-696.5708 1620.708,-681.8468"/>
<polygon fill="#000000" stroke="#000000" points="1623.6349,-683.7729 1626.6848,-673.6265 1617.9732,-679.6564 1623.6349,-683.7729"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="1889.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1889.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 22&#45;23</text>
</g>
<!-- section_6&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1620.3037,-732.4011C1678.0076,-716.0242 1776.9233,-687.951 1837.4367,-670.7767"/>
<polygon fill="#000000" stroke="#000000" points="1838.5079,-674.111 1847.1723,-668.0136 1836.5966,-667.3769 1838.5079,-674.111"/>
</g>
<!-- block_17 -->
<g id="node18" class="node">
<title>block_17</title>
<ellipse fill="none" stroke="#000000" cx="2262.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2262.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 24&#45;40</text>
</g>
<!-- section_6&#45;&gt;block_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;block_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1634.0526,-737.6623C1763.3798,-720.8573 2068.8438,-681.1647 2200.426,-664.0666"/>
<polygon fill="#000000" stroke="#000000" points="2200.8841,-667.5366 2210.3497,-662.7771 2199.9821,-660.595 2200.8841,-667.5366"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2621.5" cy="-656.0006" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="2621.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_7&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2766.0347,-729.4177C2737.5974,-714.9729 2695.501,-693.5898 2664.0644,-677.6214"/>
<polygon fill="#000000" stroke="#000000" points="2665.5907,-674.4711 2655.0899,-673.0628 2662.4205,-680.7121 2665.5907,-674.4711"/>
</g>
<!-- block_25 -->
<g id="node26" class="node">
<title>block_25</title>
<ellipse fill="none" stroke="#000000" cx="2797.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2797.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 41&#45;45</text>
</g>
<!-- section_7&#45;&gt;block_25 -->
<g id="edge25" class="edge">
<title>section_7&#45;&gt;block_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2797.5,-727.3092C2797.5,-714.9493 2797.5,-698.3219 2797.5,-684.2322"/>
<polygon fill="#000000" stroke="#000000" points="2801.0001,-684.0651 2797.5,-674.0651 2794.0001,-684.0652 2801.0001,-684.0651"/>
</g>
<!-- block_26 -->
<g id="node27" class="node">
<title>block_26</title>
<ellipse fill="none" stroke="#000000" cx="3038.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3038.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 46&#45;82</text>
</g>
<!-- section_7&#45;&gt;block_26 -->
<g id="edge26" class="edge">
<title>section_7&#45;&gt;block_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2836.7572,-730.838C2879.2546,-715.0734 2946.9873,-689.9477 2992.0892,-673.2169"/>
<polygon fill="#000000" stroke="#000000" points="2993.4745,-676.4362 3001.6329,-669.6766 2991.0399,-669.8732 2993.4745,-676.4362"/>
</g>
<!-- block_27 -->
<g id="node28" class="node">
<title>block_27</title>
<ellipse fill="none" stroke="#000000" cx="3308.5" cy="-656.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3308.5" y="-651.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 83&#45;85</text>
</g>
<!-- section_7&#45;&gt;block_27 -->
<g id="edge27" class="edge">
<title>section_7&#45;&gt;block_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2853.1587,-735.6631C2950.316,-718.6653 3149.9722,-683.7352 3249.4557,-666.3305"/>
<polygon fill="#000000" stroke="#000000" points="3250.0957,-669.7718 3259.3429,-664.6007 3248.8893,-662.8765 3250.0957,-669.7718"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1147,-487.9012 802,-487.9012 802,-449.3 1147,-449.3 1147,-487.9012"/>
<text text-anchor="middle" x="974.5" y="-472.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="974.5" y="-457.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, {__index = lpeg})</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1028.7469,-638.0319C1018.3539,-605.5709 996.3645,-536.8908 983.8074,-497.6706"/>
<polygon fill="#000000" stroke="#000000" points="987.0645,-496.3653 980.6819,-487.9088 980.3979,-498.4998 987.0645,-496.3653"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1363.5,-488.5027 1165.5,-488.5027 1165.5,-448.6985 1363.5,-448.6985 1363.5,-488.5027"/>
<text text-anchor="middle" x="1264.5" y="-457.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- block_14&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>block_14&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1481.1396,-640.2751C1469.7935,-634.0573 1456.5741,-626.9045 1444.5,-620.6006 1412.7853,-604.0422 1401.1459,-606.0345 1372.5,-584.6006 1338.4544,-559.1264 1306.1584,-522.1387 1285.9051,-496.8197"/>
<polygon fill="#000000" stroke="#000000" points="1288.4536,-494.399 1279.5132,-488.714 1282.9571,-498.7336 1288.4536,-494.399"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1713,-486.6006 1382,-486.6006 1382,-450.6006 1713,-450.6006 1713,-486.6006"/>
<text text-anchor="middle" x="1547.5" y="-465.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- block_15&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>block_15&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1630.6787,-638.0319C1614.509,-605.095 1580.0331,-534.869 1560.9338,-495.9646"/>
<polygon fill="#000000" stroke="#000000" points="1563.9786,-494.2244 1556.4298,-486.7902 1557.6949,-497.3093 1563.9786,-494.2244"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="2167.5,-486.6006 1731.5,-486.6006 1731.5,-450.6006 2167.5,-450.6006 2167.5,-486.6006"/>
<text text-anchor="middle" x="1949.5" y="-465.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- block_16&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_16&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1895.2531,-638.0319C1905.7538,-605.2345 1928.0925,-535.4635 1940.58,-496.4608"/>
<polygon fill="#000000" stroke="#000000" points="1943.9602,-497.3813 1943.6762,-486.7902 1937.2936,-495.2468 1943.9602,-497.3813"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="2262.5" cy="-468.6006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2262.5" y="-464.4006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- block_17&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>block_17&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2262.5,-637.6907C2262.5,-604.8588 2262.5,-535.7751 2262.5,-496.8369"/>
<polygon fill="#000000" stroke="#000000" points="2266.0001,-496.7089 2262.5,-486.7089 2259.0001,-496.709 2266.0001,-496.7089"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2411.5,-486.6006 2357.5,-486.6006 2357.5,-450.6006 2411.5,-450.6006 2411.5,-486.6006"/>
</g>
<!-- block_17&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>block_17&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2288.9596,-640.0308C2308.048,-627.2439 2333.0747,-607.6684 2348.5,-584.6006 2366.4482,-557.76 2375.8051,-521.5264 2380.427,-496.7395"/>
<polygon fill="#000000" stroke="#000000" points="2383.8771,-497.3277 2382.1291,-486.8781 2376.9791,-496.137 2383.8771,-497.3277"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2473.5,-262.5008 2051.5,-262.5008 2051.5,-54.0998 2473.5,-54.0998 2473.5,-262.5008"/>
<text text-anchor="middle" x="2262.5" y="-247.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="2262.5" y="-231.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="2262.5" y="-216.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="2262.5" y="-201.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="2262.5" y="-185.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="2262.5" y="-170.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="2262.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="2262.5" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="2262.5" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="2262.5" y="-108.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="2262.5" y="-93.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="2262.5" y="-77.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2262.5" y="-62.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2262.5,-450.5763C2262.5,-416.3121 2262.5,-339.2648 2262.5,-272.8772"/>
<polygon fill="#000000" stroke="#000000" points="2266.0001,-272.7447 2262.5,-262.7448 2259.0001,-272.7448 2266.0001,-272.7447"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="2943,-495.901 2430,-495.901 2430,-441.3002 2943,-441.3002 2943,-495.901"/>
<text text-anchor="middle" x="2686.5" y="-464.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="2686.5" y="-449.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- block_25&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>block_25&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2786.8569,-638.0319C2768.7463,-607.4561 2731.6021,-544.7459 2707.9349,-504.7889"/>
<polygon fill="#000000" stroke="#000000" points="2710.9181,-502.9575 2702.8104,-496.1373 2704.8953,-506.525 2710.9181,-502.9575"/>
</g>
<!-- codeblock_29 -->
<g id="node30" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="3038.5" cy="-468.6006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3038.5" y="-464.4006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- block_26&#45;&gt;codeblock_29 -->
<g id="edge29" class="edge">
<title>block_26&#45;&gt;codeblock_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3038.5,-637.6907C3038.5,-604.8588 3038.5,-535.7751 3038.5,-496.8369"/>
<polygon fill="#000000" stroke="#000000" points="3042.0001,-496.7089 3038.5,-486.7089 3035.0001,-496.709 3042.0001,-496.7089"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="3187.5,-584.6006 3133.5,-584.6006 3133.5,-352.6006 3187.5,-352.6006 3187.5,-584.6006"/>
</g>
<!-- block_26&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>block_26&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3064.9596,-640.0308C3084.048,-627.2439 3109.0747,-607.6684 3124.5,-584.6006 3125.8095,-582.6423 3127.0732,-580.6341 3128.2928,-578.5839"/>
<polygon fill="#000000" stroke="#000000" points="3131.6169,-579.8017 3133.3611,-569.3514 3125.4807,-576.4331 3131.6169,-579.8017"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="3308.5" cy="-468.6006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3308.5" y="-464.4006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 83&#45;85</text>
</g>
<!-- block_27&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>block_27&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3308.5,-637.6907C3308.5,-604.8588 3308.5,-535.7751 3308.5,-496.8369"/>
<polygon fill="#000000" stroke="#000000" points="3312.0001,-496.7089 3308.5,-486.7089 3305.0001,-496.709 3312.0001,-496.7089"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3457.5,-486.6006 3403.5,-486.6006 3403.5,-450.6006 3457.5,-450.6006 3457.5,-486.6006"/>
</g>
<!-- block_27&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>block_27&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3334.9596,-640.0308C3354.048,-627.2439 3379.0747,-607.6684 3394.5,-584.6006 3412.4482,-557.76 3421.8051,-521.5264 3426.427,-496.7395"/>
<polygon fill="#000000" stroke="#000000" points="3429.8771,-497.3277 3428.1291,-486.8781 3422.9791,-496.137 3429.8771,-497.3277"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3256.5,-316.4011 2792.5,-316.4011 2792.5,-.1995 3256.5,-.1995 3256.5,-316.4011"/>
<text text-anchor="middle" x="3024.5" y="-301.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="3024.5" y="-286.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="3024.5" y="-270.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="3024.5" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="3024.5" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="3024.5" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="3024.5" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="3024.5" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="3024.5" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3024.5" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="3024.5" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="3024.5" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3024.5" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="3024.5" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="3024.5" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="3024.5" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="3024.5" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="3024.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="3024.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_29&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3037.6868,-450.5763C3036.5488,-425.3536 3034.3648,-376.9478 3032.0967,-326.6765"/>
<polygon fill="#000000" stroke="#000000" points="3035.5895,-326.4357 3031.6423,-316.6036 3028.5966,-326.7513 3035.5895,-326.4357"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="3368,-176.3003 3275,-176.3003 3275,-140.3003 3368,-140.3003 3368,-176.3003"/>
<text text-anchor="middle" x="3321.5" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>codeblock_32&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3309.2551,-450.5763C3311.4226,-398.8395 3317.6766,-249.5611 3320.3094,-186.7191"/>
<polygon fill="#000000" stroke="#000000" points="3323.821,-186.5121 3320.7428,-176.3743 3316.8272,-186.219 3323.821,-186.5121"/>
</g>
</g>
</svg>