<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2673pt" height="722pt"
 viewBox="0.00 0.00 2673.00 722.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 718.2007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-718.2007 2669,-718.2007 2669,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="775.5" cy="-696.2007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="775.5" y="-692.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 85</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="775.5" cy="-624.2007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="775.5" y="-620.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.5,-678.0321C775.5,-670.3317 775.5,-661.1751 775.5,-652.6174"/>
<polygon fill="#000000" stroke="#000000" points="779.0001,-652.6139 775.5,-642.614 772.0001,-652.614 779.0001,-652.6139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="465.5" cy="-552.2007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="465.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M727.4026,-613.0297C677.1637,-601.3613 597.711,-582.9078 539.48,-569.3832"/>
<polygon fill="#000000" stroke="#000000" points="540.1292,-565.9409 529.5967,-567.0877 538.5455,-572.7594 540.1292,-565.9409"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="629.5" cy="-552.2007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="629.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M744.1793,-608.7549C720.3612,-597.009 687.6407,-580.8728 663.2451,-568.8421"/>
<polygon fill="#000000" stroke="#000000" points="664.5272,-565.572 654.0104,-564.288 661.4311,-571.8501 664.5272,-565.572"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="711.5" cy="-552.2007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="711.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M760.0074,-606.7715C751.834,-597.5765 741.6821,-586.1556 732.7811,-576.142"/>
<polygon fill="#000000" stroke="#000000" points="735.2322,-573.6312 725.9726,-568.4824 730.0003,-578.2818 735.2322,-573.6312"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="839.5" cy="-552.2007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="839.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M790.9926,-606.7715C798.7383,-598.0577 808.2608,-587.3449 816.8116,-577.7252"/>
<polygon fill="#000000" stroke="#000000" points="819.6777,-579.769 823.7054,-569.9696 814.4458,-575.1184 819.6777,-579.769"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1354.5" cy="-552.2007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1354.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M831.543,-617.2316C937.7436,-604.0253 1168.0556,-575.3855 1284.3307,-560.9264"/>
<polygon fill="#000000" stroke="#000000" points="1285.0488,-564.3642 1294.5404,-559.6568 1284.1849,-557.4177 1285.0488,-564.3642"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="2071.5" cy="-552.2007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2071.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M835.4096,-620.8724C1047.5627,-609.0861 1762.9203,-569.344 1996.8133,-556.35"/>
<polygon fill="#000000" stroke="#000000" points="1997.1317,-559.8378 2006.9221,-555.7884 1996.7433,-552.8486 1997.1317,-559.8378"/>
</g>
<!-- raw_8 -->
<g id="node9" class="node">
<title>raw_8</title>
<ellipse fill="none" stroke="#000000" cx="449.5" cy="-478.8007" rx="27" ry="18"/>
<text text-anchor="middle" x="449.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;raw_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M603.7743,-541.064C598.4061,-538.7714 592.7757,-536.3898 587.5,-534.2007 551.6647,-519.331 510.3463,-502.828 482.3315,-491.7335"/>
<polygon fill="#000000" stroke="#000000" points="483.5944,-488.4692 473.008,-488.0463 481.0201,-494.9786 483.5944,-488.4692"/>
</g>
<!-- raw_10 -->
<g id="node11" class="node">
<title>raw_10</title>
<ellipse fill="none" stroke="#000000" cx="621.5" cy="-478.8007" rx="27" ry="18"/>
<text text-anchor="middle" x="621.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_10 -->
<g id="edge10" class="edge">
<title>prose_4&#45;&gt;raw_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.2872,-537.3471C679.8523,-526.3903 661.4091,-511.3488 646.5809,-499.2555"/>
<polygon fill="#000000" stroke="#000000" points="648.7313,-496.493 638.7697,-492.8851 644.3072,-501.9176 648.7313,-496.493"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1012,-498.1013 667,-498.1013 667,-459.5001 1012,-459.5001 1012,-498.1013"/>
<text text-anchor="middle" x="839.5" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="839.5" y="-467.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, {__index = lpeg})</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.5,-534.0569C839.5,-526.3305 839.5,-517.115 839.5,-508.4454"/>
<polygon fill="#000000" stroke="#000000" points="843.0001,-508.2778 839.5,-498.2778 836.0001,-508.2779 843.0001,-508.2778"/>
</g>
<!-- header_13 -->
<g id="node14" class="node">
<title>header_13</title>
<ellipse fill="none" stroke="#000000" cx="1146.5" cy="-478.8007" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1146.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;header_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1313.9017,-537.8742C1282.3464,-526.7388 1238.1985,-511.1597 1203.1624,-498.796"/>
<polygon fill="#000000" stroke="#000000" points="1204.1348,-495.4277 1193.54,-495.4004 1201.8054,-502.0287 1204.1348,-495.4277"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1313.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1313.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1344.3652,-534.0569C1339.4772,-525.3063 1333.5224,-514.6457 1328.152,-505.0313"/>
<polygon fill="#000000" stroke="#000000" points="1331.1682,-503.2539 1323.2359,-496.2304 1325.057,-506.6675 1331.1682,-503.2539"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1395.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1395.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1364.6348,-534.0569C1369.5228,-525.3063 1375.4776,-514.6457 1380.848,-505.0313"/>
<polygon fill="#000000" stroke="#000000" points="1383.943,-506.6675 1385.7641,-496.2304 1377.8318,-503.2539 1383.943,-506.6675"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="1477.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1477.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1382.1036,-535.7283C1401.2673,-524.2924 1426.8167,-509.0458 1446.6515,-497.2095"/>
<polygon fill="#000000" stroke="#000000" points="1448.5254,-500.1671 1455.3191,-492.0371 1444.9383,-494.156 1448.5254,-500.1671"/>
</g>
<!-- codeblock_17 -->
<g id="node18" class="node">
<title>codeblock_17</title>
<ellipse fill="none" stroke="#000000" cx="1705.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1705.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- section_6&#45;&gt;codeblock_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;codeblock_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1407.0482,-541.212C1468.5326,-528.3546 1570.4776,-507.0362 1637.8285,-492.9519"/>
<polygon fill="#000000" stroke="#000000" points="1638.8454,-496.3151 1647.9172,-490.8422 1637.4125,-489.4633 1638.8454,-496.3151"/>
</g>
<!-- header_25 -->
<g id="node26" class="node">
<title>header_25</title>
<ellipse fill="none" stroke="#000000" cx="1919.5" cy="-478.8007" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="1919.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_25 -->
<g id="edge25" class="edge">
<title>section_7&#45;&gt;header_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2038.8922,-536.4546C2017.0216,-525.8934 1987.9412,-511.8506 1963.9564,-500.2685"/>
<polygon fill="#000000" stroke="#000000" points="1965.2301,-496.9969 1954.7031,-495.8001 1962.1861,-503.3004 1965.2301,-496.9969"/>
</g>
<!-- prose_26 -->
<g id="node27" class="node">
<title>prose_26</title>
<ellipse fill="none" stroke="#000000" cx="2071.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2071.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_26 -->
<g id="edge26" class="edge">
<title>section_7&#45;&gt;prose_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2071.5,-534.0569C2071.5,-525.9404 2071.5,-516.1808 2071.5,-507.1369"/>
<polygon fill="#000000" stroke="#000000" points="2075.0001,-506.9901 2071.5,-496.9902 2068.0001,-506.9902 2075.0001,-506.9901"/>
</g>
<!-- codeblock_27 -->
<g id="node28" class="node">
<title>codeblock_27</title>
<ellipse fill="none" stroke="#000000" cx="2273.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2273.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- section_7&#45;&gt;codeblock_27 -->
<g id="edge27" class="edge">
<title>section_7&#45;&gt;codeblock_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2111.4087,-537.6992C2143.1481,-526.1662 2187.7805,-509.9483 2222.1771,-497.4497"/>
<polygon fill="#000000" stroke="#000000" points="2223.3846,-500.7349 2231.588,-494.0301 2220.9939,-494.1558 2223.3846,-500.7349"/>
</g>
<!-- codeblock_28 -->
<g id="node29" class="node">
<title>codeblock_28</title>
<ellipse fill="none" stroke="#000000" cx="2545.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2545.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 83&#45;85</text>
</g>
<!-- section_7&#45;&gt;codeblock_28 -->
<g id="edge28" class="edge">
<title>section_7&#45;&gt;codeblock_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2128.6755,-543.347C2214.3206,-530.0846 2375.9702,-505.0528 2470.831,-490.3634"/>
<polygon fill="#000000" stroke="#000000" points="2471.5809,-493.789 2480.9275,-488.7999 2470.5096,-486.8715 2471.5809,-493.789"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-308.4007 0,-308.4007 0,-221.8001 443,-221.8001 443,-308.4007"/>
<text text-anchor="middle" x="221.5" y="-245.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="221.5" y="-229.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- raw_8&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>raw_8&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M433.8286,-464.1122C401.7046,-434.0029 327.0706,-364.0498 275.4407,-315.658"/>
<polygon fill="#000000" stroke="#000000" points="277.6876,-312.9669 267.9979,-308.682 272.9005,-318.0742 277.6876,-312.9669"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-292.4008 461.5,-292.4008 461.5,-237.7999 939.5,-237.7999 939.5,-292.4008"/>
<text text-anchor="middle" x="700.5" y="-261.3004" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="700.5" y="-245.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- raw_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>raw_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M627.9649,-461.3127C640.7974,-426.5999 669.728,-348.3407 686.9227,-301.828"/>
<polygon fill="#000000" stroke="#000000" points="690.2191,-303.0048 690.4037,-292.4116 683.6533,-300.5776 690.2191,-303.0048"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1087.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1087.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_14&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_14&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1296.8817,-463.0868C1257.0839,-425.455 1156.2353,-330.0949 1110.5821,-286.9263"/>
<polygon fill="#000000" stroke="#000000" points="1112.9063,-284.307 1103.2355,-279.9795 1108.0969,-289.3932 1112.9063,-284.307"/>
</g>
<!-- raw_20 -->
<g id="node21" class="node">
<title>raw_20</title>
<ellipse fill="none" stroke="#000000" cx="1343.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1343.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_20 -->
<g id="edge20" class="edge">
<title>prose_15&#45;&gt;raw_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1391.1559,-460.9483C1382.0942,-423.7079 1361.119,-337.5079 1350.2707,-292.9255"/>
<polygon fill="#000000" stroke="#000000" points="1353.6334,-291.9412 1347.8683,-283.0522 1346.8319,-293.5963 1353.6334,-291.9412"/>
</g>
<!-- raw_22 -->
<g id="node23" class="node">
<title>raw_22</title>
<ellipse fill="none" stroke="#000000" cx="1477.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1477.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_16&#45;&gt;raw_22 -->
<g id="edge22" class="edge">
<title>prose_16&#45;&gt;raw_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1477.5,-460.5807C1477.5,-423.2821 1477.5,-337.9957 1477.5,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="1481.0001,-293.2742 1477.5,-283.2742 1474.0001,-293.2742 1481.0001,-293.2742"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="1944.5,-369.3009 1522.5,-369.3009 1522.5,-160.8999 1944.5,-160.8999 1944.5,-369.3009"/>
<text text-anchor="middle" x="1733.5" y="-354.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="1733.5" y="-338.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="1733.5" y="-323.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="1733.5" y="-307.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="1733.5" y="-292.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="1733.5" y="-277.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="1733.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="1733.5" y="-246.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="1733.5" y="-230.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="1733.5" y="-215.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="1733.5" y="-200.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="1733.5" y="-184.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1733.5" y="-169.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_17&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>codeblock_17&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1707.8873,-460.5807C1710.3336,-441.9097 1714.3555,-411.2139 1718.4952,-379.6192"/>
<polygon fill="#000000" stroke="#000000" points="1722.0127,-379.7137 1719.8416,-369.3437 1715.072,-378.8043 1722.0127,-379.7137"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1081.5,-63.3015 883.5,-63.3015 883.5,-7.4985 1081.5,-7.4985 1081.5,-63.3015"/>
<text text-anchor="middle" x="982.5" y="-15.9" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1079.6079,-247.8355C1062.6714,-210.7848 1022.5144,-122.9365 999.4949,-72.5784"/>
<polygon fill="#000000" stroke="#000000" points="1002.6091,-70.9723 995.2685,-63.3326 996.2427,-73.8825 1002.6091,-70.9723"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1431,-55.3021 1100,-55.3021 1100,-15.4979 1431,-15.4979 1431,-55.3021"/>
<text text-anchor="middle" x="1265.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- raw_20&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>raw_20&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1337.509,-247.4576C1324.1873,-208.2268 1291.9911,-113.413 1275.5403,-64.9674"/>
<polygon fill="#000000" stroke="#000000" points="1278.8109,-63.7137 1272.2813,-55.3701 1272.1826,-65.9645 1278.8109,-63.7137"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1885.5,-55.3021 1449.5,-55.3021 1449.5,-15.4979 1885.5,-15.4979 1885.5,-55.3021"/>
<text text-anchor="middle" x="1667.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- raw_22&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>raw_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1476.726,-247.0106C1476.3233,-215.1138 1479.9108,-148.3252 1513.5,-106.8001 1530.9969,-85.1692 1556.5321,-69.7822 1581.7976,-58.9755"/>
<polygon fill="#000000" stroke="#000000" points="1583.1355,-62.2098 1591.0783,-55.1983 1580.4966,-55.7263 1583.1355,-62.2098"/>
</g>
<!-- raw_29 -->
<g id="node30" class="node">
<title>raw_29</title>
<ellipse fill="none" stroke="#000000" cx="2044.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="2044.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_26&#45;&gt;raw_29 -->
<g id="edge29" class="edge">
<title>prose_26&#45;&gt;raw_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2069.198,-460.5807C2064.4855,-423.2821 2053.71,-337.9957 2048.0781,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="2051.5221,-292.7566 2046.7962,-283.2742 2044.5774,-293.6341 2051.5221,-292.7566"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2553.5,-423.2012 2089.5,-423.2012 2089.5,-106.9995 2553.5,-106.9995 2553.5,-423.2012"/>
<text text-anchor="middle" x="2321.5" y="-408.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="2321.5" y="-392.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="2321.5" y="-377.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="2321.5" y="-362.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="2321.5" y="-346.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="2321.5" y="-331.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="2321.5" y="-315.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="2321.5" y="-300.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="2321.5" y="-285.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2321.5" y="-269.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="2321.5" y="-254.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="2321.5" y="-238.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2321.5" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="2321.5" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="2321.5" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="2321.5" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="2321.5" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="2321.5" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="2321.5" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>codeblock_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2277.5925,-460.5807C2279.2588,-453.162 2281.3516,-443.8448 2283.714,-433.3271"/>
<polygon fill="#000000" stroke="#000000" points="2287.1782,-433.8745 2285.9549,-423.3505 2280.3483,-432.3404 2287.1782,-433.8745"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2665,-283.1004 2572,-283.1004 2572,-247.1004 2665,-247.1004 2665,-283.1004"/>
<text text-anchor="middle" x="2618.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>codeblock_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2551.7239,-460.5807C2564.519,-423.1244 2593.8456,-337.2736 2609.0183,-292.857"/>
<polygon fill="#000000" stroke="#000000" points="2612.3712,-293.8688 2612.2918,-283.2742 2605.7471,-291.6059 2612.3712,-293.8688"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2417,-70.7004 1904,-70.7004 1904,-.0997 2417,-.0997 2417,-70.7004"/>
<text text-anchor="middle" x="2160.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="2160.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- raw_29&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_29&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2045.1008,-246.6934C2046.8577,-215.7386 2053.7253,-152.1973 2080.5,-106.8001 2086.6324,-96.4024 2094.7909,-86.6912 2103.5556,-77.9857"/>
<polygon fill="#000000" stroke="#000000" points="2106.1694,-80.3311 2111.0294,-70.9167 2101.3592,-75.2456 2106.1694,-80.3311"/>
</g>
</g>
</svg>