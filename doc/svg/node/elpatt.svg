<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="4029pt" height="647pt"
 viewBox="0.00 0.00 4028.50 647.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 643.4007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-643.4007 4024.5,-643.4007 4024.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1042" cy="-621.4007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="1042" y="-617.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 85</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1042" cy="-549.4007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1042" y="-545.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042,-603.232C1042,-595.5316 1042,-586.375 1042,-577.8173"/>
<polygon fill="#000000" stroke="#000000" points="1045.5001,-577.8139 1042,-567.8139 1038.5001,-577.814 1045.5001,-577.8139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="196" cy="-477.4007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="196" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.5172,-544.4234C843.57,-532.513 487.5705,-502.2152 306.0501,-486.7666"/>
<polygon fill="#000000" stroke="#000000" points="306.2054,-483.2673 295.9446,-485.9066 305.6118,-490.2421 306.2054,-483.2673"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="602" cy="-477.4007" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="602" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;6</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M988.4873,-540.644C903.5369,-526.7431 738.8292,-499.7909 654.5108,-485.9933"/>
<polygon fill="#000000" stroke="#000000" points="655.0713,-482.5386 644.6374,-484.3777 653.9409,-489.4467 655.0713,-482.5386"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="827" cy="-477.4007" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="827" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 7&#45;9</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1001.5601,-535.858C964.7114,-523.518 910.3598,-505.3165 872.1161,-492.5093"/>
<polygon fill="#000000" stroke="#000000" points="872.8673,-489.0699 862.2734,-489.2131 870.6444,-495.7076 872.8673,-489.0699"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1096" cy="-477.4007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1096" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1055.3483,-531.6029C1061.709,-523.122 1069.4413,-512.8122 1076.4478,-503.4702"/>
<polygon fill="#000000" stroke="#000000" points="1079.4181,-505.3432 1082.6181,-495.2432 1073.818,-501.1432 1079.4181,-505.3432"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1766" cy="-477.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1766" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1099.7198,-543.6606C1230.7447,-530.6305 1550.3878,-498.8428 1694.0236,-484.5585"/>
<polygon fill="#000000" stroke="#000000" points="1694.4516,-488.0333 1704.0561,-483.5608 1693.7588,-481.0677 1694.4516,-488.0333"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="3170" cy="-477.4007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3170" y="-473.2007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1102.5414,-547.3523C1405.866,-537.0894 2758.9936,-491.3069 3094.5258,-479.9543"/>
<polygon fill="#000000" stroke="#000000" points="3094.7484,-483.4489 3104.6243,-479.6126 3094.5116,-476.4529 3094.7484,-483.4489"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="54,-406.0006 0,-406.0006 0,-370.0006 54,-370.0006 54,-406.0006"/>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M143.4699,-461.4354C118.0095,-452.3916 87.6801,-439.6175 63,-423.4007 58.536,-420.4674 54.1573,-416.9248 50.0764,-413.2291"/>
<polygon fill="#000000" stroke="#000000" points="52.2744,-410.4859 42.6513,-406.0535 47.4099,-415.5196 52.2744,-410.4859"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="515.5,-423.301 72.5,-423.301 72.5,-352.7003 515.5,-352.7003 515.5,-423.301"/>
<text text-anchor="middle" x="294" y="-376.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="294" y="-360.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- block_3&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_3&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M564.848,-466.6169C530.1264,-456.5386 476.18,-440.8802 425.5437,-426.1825"/>
<polygon fill="#000000" stroke="#000000" points="426.3799,-422.7808 415.8006,-423.3544 424.4285,-429.5033 426.3799,-422.7808"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="1012,-407.3012 534,-407.3012 534,-368.7 1012,-368.7 1012,-407.3012"/>
<text text-anchor="middle" x="773" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="773" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- block_4&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>block_4&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M816.3313,-459.7381C808.8681,-447.3822 798.7381,-430.6115 790.1493,-416.3922"/>
<polygon fill="#000000" stroke="#000000" points="792.9375,-414.2388 784.7713,-407.4887 786.9457,-417.858 792.9375,-414.2388"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1375.5,-407.3012 1030.5,-407.3012 1030.5,-368.7 1375.5,-368.7 1375.5,-407.3012"/>
<text text-anchor="middle" x="1203" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1203" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, {__index = lpeg})</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_5&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1116.8847,-459.9512C1132.496,-446.9077 1154.0987,-428.8584 1171.7615,-414.1009"/>
<polygon fill="#000000" stroke="#000000" points="1174.134,-416.6795 1179.5639,-407.5818 1169.6458,-411.3077 1174.134,-416.6795"/>
</g>
<!-- header_12 -->
<g id="node13" class="node">
<title>header_12</title>
<ellipse fill="none" stroke="#000000" cx="1510" cy="-388.0006" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1510" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_12 -->
<g id="edge12" class="edge">
<title>section_6&#45;&gt;header_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.436,-463.235C1682.7006,-448.3109 1615.057,-424.6885 1566.9763,-407.8978"/>
<polygon fill="#000000" stroke="#000000" points="1567.9269,-404.5226 1557.332,-404.5299 1565.619,-411.1312 1567.9269,-404.5226"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1701" cy="-388.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1701" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 16&#45;19</text>
</g>
<!-- section_6&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_6&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1753.1581,-459.7381C1743.6323,-446.6364 1730.4973,-428.5708 1719.792,-413.8468"/>
<polygon fill="#000000" stroke="#000000" points="1722.5268,-411.6564 1713.8152,-405.6265 1716.8651,-415.7729 1722.5268,-411.6564"/>
</g>
<!-- block_14 -->
<g id="node15" class="node">
<title>block_14</title>
<ellipse fill="none" stroke="#000000" cx="1831" cy="-388.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1831" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 20&#45;21</text>
</g>
<!-- section_6&#45;&gt;block_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;block_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1778.8419,-459.7381C1788.3677,-446.6364 1801.5027,-428.5708 1812.208,-413.8468"/>
<polygon fill="#000000" stroke="#000000" points="1815.1349,-415.7729 1818.1848,-405.6265 1809.4732,-411.6564 1815.1349,-415.7729"/>
</g>
<!-- block_15 -->
<g id="node16" class="node">
<title>block_15</title>
<ellipse fill="none" stroke="#000000" cx="2097" cy="-388.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2097" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 22&#45;23</text>
</g>
<!-- section_6&#45;&gt;block_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;block_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1813.0727,-464.6868C1874.1484,-448.1908 1980.4112,-419.4902 2044.1782,-402.2673"/>
<polygon fill="#000000" stroke="#000000" points="2045.2927,-405.5918 2054.0341,-399.6053 2043.4674,-398.8339 2045.2927,-405.5918"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2430" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- section_6&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1825.2174,-469.4277C1945.5697,-453.2236 2218.6675,-416.4541 2352.7732,-398.3983"/>
<polygon fill="#000000" stroke="#000000" points="2353.5227,-401.8291 2362.9663,-397.026 2352.5886,-394.8917 2353.5227,-401.8291"/>
</g>
<!-- header_22 -->
<g id="node23" class="node">
<title>header_22</title>
<ellipse fill="none" stroke="#000000" cx="2931" cy="-388.0006" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="2931" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_22 -->
<g id="edge22" class="edge">
<title>section_7&#45;&gt;header_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3131.0686,-462.838C3091.142,-447.9031 3028.7545,-424.5666 2984.2675,-407.9258"/>
<polygon fill="#000000" stroke="#000000" points="2985.3722,-404.6022 2974.7798,-404.3768 2982.9197,-411.1586 2985.3722,-404.6022"/>
</g>
<!-- block_23 -->
<g id="node24" class="node">
<title>block_23</title>
<ellipse fill="none" stroke="#000000" cx="3170" cy="-388.0006" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3170" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 41&#45;45</text>
</g>
<!-- section_7&#45;&gt;block_23 -->
<g id="edge23" class="edge">
<title>section_7&#45;&gt;block_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3170,-459.3092C3170,-446.9493 3170,-430.3219 3170,-416.2322"/>
<polygon fill="#000000" stroke="#000000" points="3173.5001,-416.0651 3170,-406.0651 3166.5001,-416.0652 3173.5001,-416.0651"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="3499" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3499" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- section_7&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_7&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3216.7883,-464.6868C3275.0532,-448.8543 3374.6918,-421.7792 3438.65,-404.3997"/>
<polygon fill="#000000" stroke="#000000" points="3439.8645,-407.6967 3448.5968,-401.6968 3438.0289,-400.9416 3439.8645,-407.6967"/>
</g>
<!-- codeblock_25 -->
<g id="node26" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="3912" cy="-388.0006" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3912" y="-383.8006" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 83&#45;85</text>
</g>
<!-- section_7&#45;&gt;codeblock_25 -->
<g id="edge25" class="edge">
<title>section_7&#45;&gt;codeblock_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3230.4064,-470.1226C3363.9225,-454.0359 3684.0754,-415.4622 3833.1467,-397.5013"/>
<polygon fill="#000000" stroke="#000000" points="3833.6376,-400.9675 3843.1471,-396.2964 3832.8002,-394.0178 3833.6376,-400.9675"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1363,-176.3003 1309,-176.3003 1309,-140.3003 1363,-140.3003 1363,-176.3003"/>
</g>
<!-- header_12&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>header_12&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1454.7832,-371.9963C1426.0183,-360.918 1392.6329,-343.2698 1372,-316.6006 1342.5876,-278.5834 1336.3865,-220.9653 1335.524,-186.734"/>
<polygon fill="#000000" stroke="#000000" points="1339.0212,-186.4561 1335.4089,-176.4962 1332.0216,-186.5349 1339.0212,-186.4561"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1579,-178.2024 1381,-178.2024 1381,-138.3982 1579,-138.3982 1579,-178.2024"/>
<text text-anchor="middle" x="1480" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- block_13&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>block_13&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1673.2748,-372.2376C1644.4747,-355.5588 1601.732,-329.8576 1588,-316.6006 1547.5248,-277.5255 1513.398,-221.0015 1494.8932,-187.1301"/>
<polygon fill="#000000" stroke="#000000" points="1497.9152,-185.3598 1490.0959,-178.2107 1491.7503,-188.6756 1497.9152,-185.3598"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1928.5,-176.3003 1597.5,-176.3003 1597.5,-140.3003 1928.5,-140.3003 1928.5,-176.3003"/>
<text text-anchor="middle" x="1763" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- block_14&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>block_14&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1825.6642,-369.9764C1813.8507,-330.0712 1785.417,-234.0238 1771.2751,-186.2531"/>
<polygon fill="#000000" stroke="#000000" points="1774.5999,-185.1537 1768.4052,-176.5586 1767.8878,-187.1408 1774.5999,-185.1537"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="2383,-176.3003 1947,-176.3003 1947,-140.3003 2383,-140.3003 2383,-176.3003"/>
<text text-anchor="middle" x="2165" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- block_15&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>block_15&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2102.3358,-369.9764C2114.1493,-330.0712 2142.583,-234.0238 2156.7249,-186.2531"/>
<polygon fill="#000000" stroke="#000000" points="2160.1122,-187.1408 2159.5948,-176.5586 2153.4001,-185.1537 2160.1122,-187.1408"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2823,-262.5008 2401,-262.5008 2401,-54.0998 2823,-54.0998 2823,-262.5008"/>
<text text-anchor="middle" x="2612" y="-247.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="2612" y="-231.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="2612" y="-216.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="2612" y="-201.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="2612" y="-185.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="2612" y="-170.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="2612" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="2612" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="2612" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="2612" y="-108.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="2612" y="-93.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="2612" y="-77.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2612" y="-62.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_16&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2444.2812,-369.9764C2461.6491,-348.0566 2492.4389,-309.1971 2522.9383,-270.7042"/>
<polygon fill="#000000" stroke="#000000" points="2525.9701,-272.5135 2529.4372,-262.502 2520.4836,-268.1663 2525.9701,-272.5135"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2895,-176.3003 2841,-176.3003 2841,-140.3003 2895,-140.3003 2895,-176.3003"/>
</g>
<!-- header_22&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>header_22&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2923.4199,-370.0431C2917.5776,-355.7451 2909.5805,-335.1271 2904,-316.6006 2890.489,-271.7457 2879.3469,-218.4059 2873.193,-186.5073"/>
<polygon fill="#000000" stroke="#000000" points="2876.6071,-185.7251 2871.3011,-176.5546 2869.7303,-187.0324 2876.6071,-185.7251"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="3426.5,-185.6007 2913.5,-185.6007 2913.5,-130.9999 3426.5,-130.9999 3426.5,-185.6007"/>
<text text-anchor="middle" x="3170" y="-154.5003" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="3170" y="-139.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- block_23&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>block_23&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3170,-369.9764C3170,-332.5547 3170,-245.7615 3170,-195.7081"/>
<polygon fill="#000000" stroke="#000000" points="3173.5001,-195.6158 3170,-185.6158 3166.5001,-195.6159 3173.5001,-195.6158"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="3909,-316.4011 3445,-316.4011 3445,-.1995 3909,-.1995 3909,-316.4011"/>
<text text-anchor="middle" x="3677" y="-301.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="3677" y="-286.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="3677" y="-270.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="3677" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="3677" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="3677" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="3677" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="3677" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="3677" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3677" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="3677" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="3677" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3677" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="3677" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="3677" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="3677" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="3677" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="3677" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="3677" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>codeblock_24&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3512.9674,-369.9764C3521.8238,-358.5476 3534.2488,-342.5138 3548.3415,-324.3279"/>
<polygon fill="#000000" stroke="#000000" points="3551.1189,-326.4576 3554.4777,-316.4093 3545.5858,-322.1699 3551.1189,-326.4576"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="4020.5,-176.3003 3927.5,-176.3003 3927.5,-140.3003 4020.5,-140.3003 4020.5,-176.3003"/>
<text text-anchor="middle" x="3974" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>codeblock_25&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3916.865,-369.9764C3927.6361,-330.0712 3953.561,-234.0238 3966.4551,-186.2531"/>
<polygon fill="#000000" stroke="#000000" points="3969.8449,-187.1252 3969.0718,-176.5586 3963.0867,-185.301 3969.8449,-187.1252"/>
</g>
</g>
</svg>