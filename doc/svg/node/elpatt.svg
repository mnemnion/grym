<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2856pt" height="722pt"
 viewBox="0.00 0.00 2856.00 722.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 718.2007)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-718.2007 2852,-718.2007 2852,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="745.5" cy="-696.2007" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="745.5" y="-692.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 85</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="745.5" cy="-624.2007" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="745.5" y="-620.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;40</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M745.5,-678.0321C745.5,-670.3317 745.5,-661.1751 745.5,-652.6174"/>
<polygon fill="#000000" stroke="#000000" points="749.0001,-652.6139 745.5,-642.614 742.0001,-652.614 749.0001,-652.6139"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="418.5" cy="-552.2007" rx="113.2139" ry="18"/>
<text text-anchor="middle" x="418.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Extended Lpeg module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M696.5448,-613.4216C643.1873,-601.6731 557.1219,-582.723 494.8668,-569.0154"/>
<polygon fill="#000000" stroke="#000000" points="495.607,-565.5946 485.0883,-566.8624 494.1017,-572.4309 495.607,-565.5946"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="593.5" cy="-552.2007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="593.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M713.2647,-608.9314C688.0737,-596.9988 653.1514,-580.4566 627.5162,-568.3136"/>
<polygon fill="#000000" stroke="#000000" points="628.7213,-565.0117 618.1856,-563.8939 625.7246,-571.3379 628.7213,-565.0117"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="681.5" cy="-552.2007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="681.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M730.0074,-606.7715C721.834,-597.5765 711.6821,-586.1556 702.7811,-576.142"/>
<polygon fill="#000000" stroke="#000000" points="705.2322,-573.6312 695.9726,-568.4824 700.0003,-578.2818 705.2322,-573.6312"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="812.5" cy="-552.2007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="812.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;14</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M761.7188,-606.7715C769.9086,-597.9705 779.996,-587.1304 789.0163,-577.4369"/>
<polygon fill="#000000" stroke="#000000" points="791.715,-579.6746 795.9651,-569.9696 786.5905,-574.906 791.715,-579.6746"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1350.5" cy="-552.2007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1350.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 16&#45;40</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M801.8736,-617.4918C912.6097,-604.3133 1158.2938,-575.0748 1279.7342,-560.6224"/>
<polygon fill="#000000" stroke="#000000" points="1280.5133,-564.0545 1290.0296,-559.3972 1279.686,-557.1035 1280.5133,-564.0545"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="2238.5" cy="-552.2007" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2238.5" y="-548.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 41&#45;85</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M805.8765,-621.2891C1042.0767,-609.8983 1903.2678,-568.3673 2163.5131,-555.817"/>
<polygon fill="#000000" stroke="#000000" points="2163.7991,-559.3073 2173.6189,-555.3296 2163.4618,-552.3155 2163.7991,-559.3073"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="500.5,-496.8007 330.5,-496.8007 330.5,-460.8007 500.5,-460.8007 500.5,-496.8007"/>
<text text-anchor="middle" x="415.5" y="-475.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">* Extended Lpeg module</text>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M417.7584,-534.0569C417.4267,-525.9404 417.0278,-516.1808 416.6582,-507.1369"/>
<polygon fill="#000000" stroke="#000000" points="420.149,-506.8389 416.2434,-496.9902 413.1548,-507.1248 420.149,-506.8389"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="545.5" cy="-478.8007" rx="27" ry="18"/>
<text text-anchor="middle" x="545.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M582.3672,-535.1768C576.3267,-525.9399 568.7423,-514.3421 562.0256,-504.071"/>
<polygon fill="#000000" stroke="#000000" points="564.8094,-501.9329 556.4069,-495.4792 558.9508,-505.7641 564.8094,-501.9329"/>
</g>
<!-- raw_11 -->
<g id="node12" class="node">
<title>raw_11</title>
<ellipse fill="none" stroke="#000000" cx="617.5" cy="-478.8007" rx="27" ry="18"/>
<text text-anchor="middle" x="617.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_11 -->
<g id="edge11" class="edge">
<title>prose_4&#45;&gt;raw_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M667.2963,-535.9109C658.6434,-525.987 647.4449,-513.1437 637.8596,-502.1507"/>
<polygon fill="#000000" stroke="#000000" points="640.4347,-499.7782 631.2247,-494.5412 635.1586,-504.3786 640.4347,-499.7782"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1008,-498.1013 663,-498.1013 663,-459.5001 1008,-459.5001 1008,-498.1013"/>
<text text-anchor="middle" x="835.5" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="835.5" y="-467.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = setmetatable({}, {__index = lpeg})</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_5&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.1854,-534.0569C820.6597,-526.1607 823.6213,-516.7092 826.3897,-507.8746"/>
<polygon fill="#000000" stroke="#000000" points="829.7465,-508.8669 829.3968,-498.2778 823.0667,-506.7738 829.7465,-508.8669"/>
</g>
<!-- header_14 -->
<g id="node15" class="node">
<title>header_14</title>
<ellipse fill="none" stroke="#000000" cx="1142.5" cy="-478.8007" rx="116.5627" ry="18"/>
<text text-anchor="middle" x="1142.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- section_6&#45;&gt;header_14 -->
<g id="edge14" class="edge">
<title>section_6&#45;&gt;header_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1309.9017,-537.8742C1278.3464,-526.7388 1234.1985,-511.1597 1199.1624,-498.796"/>
<polygon fill="#000000" stroke="#000000" points="1200.1348,-495.4277 1189.54,-495.4004 1197.8054,-502.0287 1200.1348,-495.4277"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1309.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1309.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_6&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1340.3652,-534.0569C1335.4772,-525.3063 1329.5224,-514.6457 1324.152,-505.0313"/>
<polygon fill="#000000" stroke="#000000" points="1327.1682,-503.2539 1319.2359,-496.2304 1321.057,-506.6675 1327.1682,-503.2539"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="1391.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1391.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>section_6&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1360.6348,-534.0569C1365.5228,-525.3063 1371.4776,-514.6457 1376.848,-505.0313"/>
<polygon fill="#000000" stroke="#000000" points="1379.943,-506.6675 1381.7641,-496.2304 1373.8318,-503.2539 1379.943,-506.6675"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="1473.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1473.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_6&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1378.1036,-535.7283C1397.2673,-524.2924 1422.8167,-509.0458 1442.6515,-497.2095"/>
<polygon fill="#000000" stroke="#000000" points="1444.5254,-500.1671 1451.3191,-492.0371 1440.9383,-494.156 1444.5254,-500.1671"/>
</g>
<!-- codeblock_18 -->
<g id="node19" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="1665.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1665.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 24&#45;38</text>
</g>
<!-- section_6&#45;&gt;codeblock_18 -->
<g id="edge18" class="edge">
<title>section_6&#45;&gt;codeblock_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1400.761,-540.4891C1454.9464,-527.863 1541.3814,-507.7223 1600.6526,-493.9112"/>
<polygon fill="#000000" stroke="#000000" points="1601.7103,-497.2586 1610.6551,-491.5804 1600.1217,-490.4412 1601.7103,-497.2586"/>
</g>
<!-- header_27 -->
<g id="node28" class="node">
<title>header_27</title>
<ellipse fill="none" stroke="#000000" cx="2086.5" cy="-478.8007" rx="102.0437" ry="18"/>
<text text-anchor="middle" x="2086.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Csp &#45;&#45; Capture span</text>
</g>
<!-- section_7&#45;&gt;header_27 -->
<g id="edge27" class="edge">
<title>section_7&#45;&gt;header_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2205.8922,-536.4546C2184.0216,-525.8934 2154.9412,-511.8506 2130.9564,-500.2685"/>
<polygon fill="#000000" stroke="#000000" points="2132.2301,-496.9969 2121.7031,-495.8001 2129.1861,-503.3004 2132.2301,-496.9969"/>
</g>
<!-- prose_28 -->
<g id="node29" class="node">
<title>prose_28</title>
<ellipse fill="none" stroke="#000000" cx="2238.5" cy="-478.8007" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2238.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_28 -->
<g id="edge28" class="edge">
<title>section_7&#45;&gt;prose_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2238.5,-534.0569C2238.5,-525.9404 2238.5,-516.1808 2238.5,-507.1369"/>
<polygon fill="#000000" stroke="#000000" points="2242.0001,-506.9901 2238.5,-496.9902 2235.0001,-506.9902 2242.0001,-506.9901"/>
</g>
<!-- codeblock_29 -->
<g id="node30" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="2440.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2440.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 46&#45;67</text>
</g>
<!-- section_7&#45;&gt;codeblock_29 -->
<g id="edge29" class="edge">
<title>section_7&#45;&gt;codeblock_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2278.4087,-537.6992C2310.1481,-526.1662 2354.7805,-509.9483 2389.1771,-497.4497"/>
<polygon fill="#000000" stroke="#000000" points="2390.3846,-500.7349 2398.588,-494.0301 2387.9939,-494.1558 2390.3846,-500.7349"/>
</g>
<!-- codeblock_30 -->
<g id="node31" class="node">
<title>codeblock_30</title>
<ellipse fill="none" stroke="#000000" cx="2712.5" cy="-478.8007" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2712.5" y="-474.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 83&#45;85</text>
</g>
<!-- section_7&#45;&gt;codeblock_30 -->
<g id="edge30" class="edge">
<title>section_7&#45;&gt;codeblock_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2295.6755,-543.347C2381.3206,-530.0846 2542.9702,-505.0528 2637.831,-490.3634"/>
<polygon fill="#000000" stroke="#000000" points="2638.5809,-493.789 2647.9275,-488.7999 2637.5096,-486.8715 2638.5809,-493.789"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-308.4007 0,-308.4007 0,-221.8001 443,-221.8001 443,-308.4007"/>
<text text-anchor="middle" x="221.5" y="-245.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;This is where we add extended captures a la the old =epeg= </text>
<text text-anchor="middle" x="221.5" y="-229.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">module.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.954,-467.0643C505.9567,-456.0944 477.04,-439.0959 452.5,-423.4007 397.3636,-388.1365 336.3366,-346.1854 290.8613,-314.3319"/>
<polygon fill="#000000" stroke="#000000" points="292.7526,-311.3833 282.556,-308.5056 288.7325,-317.1139 292.7526,-311.3833"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-292.4008 461.5,-292.4008 461.5,-237.7999 939.5,-237.7999 939.5,-292.4008"/>
<text text-anchor="middle" x="700.5" y="-261.3004" font-family="Inconsolata" font-size="14.00" fill="#000000">The difference here is that we include lpeg as a metatable __index</text>
<text text-anchor="middle" x="700.5" y="-245.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">and can therefore use elpeg as L everywhere we currently use lpeg.</text>
</g>
<!-- raw_11&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>raw_11&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M624.2922,-461.3127C637.7745,-426.5999 668.1699,-348.3407 686.2352,-301.828"/>
<polygon fill="#000000" stroke="#000000" points="689.5345,-303.0004 689.8925,-292.4116 683.0094,-300.466 689.5345,-303.0004"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1245,-283.1004 1040,-283.1004 1040,-247.1004 1245,-247.1004 1245,-283.1004"/>
<text text-anchor="middle" x="1142.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">** Ppt &#45;&#45; Codepoint pattern</text>
</g>
<!-- header_14&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>header_14&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1142.5,-460.5807C1142.5,-423.2821 1142.5,-337.9957 1142.5,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="1146.0001,-293.2742 1142.5,-283.2742 1139.0001,-293.2742 1146.0001,-293.2742"/>
</g>
<!-- raw_20 -->
<g id="node21" class="node">
<title>raw_20</title>
<ellipse fill="none" stroke="#000000" cx="1300.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1300.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_15&#45;&gt;raw_20 -->
<g id="edge20" class="edge">
<title>prose_15&#45;&gt;raw_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1308.7327,-460.5807C1307.1618,-423.2821 1303.57,-337.9957 1301.6927,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="1305.1832,-293.118 1301.2654,-283.2742 1298.1894,-293.4127 1305.1832,-293.118"/>
</g>
<!-- raw_22 -->
<g id="node23" class="node">
<title>raw_22</title>
<ellipse fill="none" stroke="#000000" cx="1386.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1386.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_16&#45;&gt;raw_22 -->
<g id="edge22" class="edge">
<title>prose_16&#45;&gt;raw_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1391.0737,-460.5807C1390.201,-423.2821 1388.2056,-337.9957 1387.1626,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="1390.6583,-293.1896 1386.9252,-283.2742 1383.6602,-293.3534 1390.6583,-293.1896"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1473.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="1473.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_17&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_17&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1473.5,-460.5807C1473.5,-423.2821 1473.5,-337.9957 1473.5,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="1477.0001,-293.2742 1473.5,-283.2742 1470.0001,-293.2742 1477.0001,-293.2742"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1940.5,-369.3009 1518.5,-369.3009 1518.5,-160.8999 1940.5,-160.8999 1940.5,-369.3009"/>
<text text-anchor="middle" x="1729.5" y="-354.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function num_bytes(str)</text>
<text text-anchor="middle" x="1729.5" y="-338.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;returns the number of bytes in the next character in str</text>
<text text-anchor="middle" x="1729.5" y="-323.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local c = str:byte(1)</text>
<text text-anchor="middle" x="1729.5" y="-307.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if c &gt;= 0x00 and c &lt;= 0x7F then</text>
<text text-anchor="middle" x="1729.5" y="-292.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 1</text>
<text text-anchor="middle" x="1729.5" y="-277.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xC2 and c &lt;= 0xDF then</text>
<text text-anchor="middle" x="1729.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 2</text>
<text text-anchor="middle" x="1729.5" y="-246.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xE0 and c &lt;= 0xEF then</text>
<text text-anchor="middle" x="1729.5" y="-230.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 3</text>
<text text-anchor="middle" x="1729.5" y="-215.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif c &gt;= 0xF0 and c &lt;= 0xF4 then</text>
<text text-anchor="middle" x="1729.5" y="-200.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 4</text>
<text text-anchor="middle" x="1729.5" y="-184.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1729.5" y="-169.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_18&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1670.9566,-460.5807C1676.5725,-441.8289 1685.8209,-410.9479 1695.3262,-379.2088"/>
<polygon fill="#000000" stroke="#000000" points="1698.7645,-379.9275 1698.2807,-369.3437 1692.0588,-377.9192 1698.7645,-379.9275"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1169.5,-63.3015 971.5,-63.3015 971.5,-7.4985 1169.5,-7.4985 1169.5,-63.3015"/>
<text text-anchor="middle" x="1070.5" y="-15.9" font-family="Inconsolata" font-size="14.00" fill="#000000">Captures one Unicode point</text>
</g>
<!-- raw_20&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>raw_20&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1300.0923,-246.9539C1298.4044,-214.6689 1290.3773,-146.8881 1253.5,-106.8001 1246.3494,-99.0269 1203.2664,-82.0571 1160.7016,-66.6116"/>
<polygon fill="#000000" stroke="#000000" points="1161.6631,-63.2377 1151.0687,-63.1379 1159.2885,-69.8227 1161.6631,-63.2377"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1519,-55.3021 1188,-55.3021 1188,-15.4979 1519,-15.4979 1519,-55.3021"/>
<text text-anchor="middle" x="1353.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000">I actually have no idea how to do this yet...</text>
</g>
<!-- raw_22&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>raw_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1383.9105,-247.0762C1378.2602,-207.7462 1364.775,-113.8811 1357.817,-65.4487"/>
<polygon fill="#000000" stroke="#000000" points="1361.243,-64.6833 1356.3564,-55.2827 1354.3142,-65.6788 1361.243,-64.6833"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1973.5,-55.3021 1537.5,-55.3021 1537.5,-15.4979 1973.5,-15.4979 1973.5,-55.3021"/>
<text text-anchor="middle" x="1755.5" y="-23.9" font-family="Inconsolata" font-size="14.00" fill="#000000">Looks like byte 97 is just =\97= in Lua. That&#39;s easy enough.</text>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1472.1307,-246.9867C1470.7177,-214.4491 1472.6683,-145.8664 1509.5,-106.8001 1528.1342,-87.0353 1585.0044,-69.8746 1639.3741,-57.3336"/>
<polygon fill="#000000" stroke="#000000" points="1640.151,-60.7464 1649.1316,-55.1251 1638.6056,-53.9191 1640.151,-60.7464"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2171.5,-283.1004 2001.5,-283.1004 2001.5,-247.1004 2171.5,-247.1004 2171.5,-283.1004"/>
<text text-anchor="middle" x="2086.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">** Csp &#45;&#45; Capture span</text>
</g>
<!-- header_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>header_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2086.5,-460.5807C2086.5,-423.2821 2086.5,-337.9957 2086.5,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="2090.0001,-293.2742 2086.5,-283.2742 2083.0001,-293.2742 2090.0001,-293.2742"/>
</g>
<!-- raw_32 -->
<g id="node33" class="node">
<title>raw_32</title>
<ellipse fill="none" stroke="#000000" cx="2227.5" cy="-265.1004" rx="27" ry="18"/>
<text text-anchor="middle" x="2227.5" y="-260.9004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_28&#45;&gt;raw_32 -->
<g id="edge32" class="edge">
<title>prose_28&#45;&gt;raw_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2237.5621,-460.5807C2235.6422,-423.2821 2231.2522,-337.9957 2228.9577,-293.4203"/>
<polygon fill="#000000" stroke="#000000" points="2232.445,-293.081 2228.4355,-283.2742 2225.4543,-293.4409 2232.445,-293.081"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2736.5,-423.2012 2272.5,-423.2012 2272.5,-106.9995 2736.5,-106.9995 2736.5,-423.2012"/>
<text text-anchor="middle" x="2504.5" y="-408.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function spanner(first, last, str, root)</text>
<text text-anchor="middle" x="2504.5" y="-392.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local vals = {}</text>
<text text-anchor="middle" x="2504.5" y="-377.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.span = true</text>
<text text-anchor="middle" x="2504.5" y="-362.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.val = string.sub(str, first, last &#45; 1)</text>
<text text-anchor="middle" x="2504.5" y="-346.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.first = first</text>
<text text-anchor="middle" x="2504.5" y="-331.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;vals.last = last &#45; 1</text>
<text text-anchor="middle" x="2504.5" y="-315.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if vals.last &gt;= vals.first then</text>
<text text-anchor="middle" x="2504.5" y="-300.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return vals</text>
<text text-anchor="middle" x="2504.5" y="-285.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2504.5" y="-269.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; If a capture contains nothing, we don&#39;t want a node for it</text>
<text text-anchor="middle" x="2504.5" y="-254.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="2504.5" y="-238.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2504.5" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">function epeg.Csp (patt)</text>
<text text-anchor="middle" x="2504.5" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lpeg.Cp() </text>
<text text-anchor="middle" x="2504.5" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cmt(patt, function() return true end) </text>
<text text-anchor="middle" x="2504.5" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Cp() </text>
<text text-anchor="middle" x="2504.5" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(1) </text>
<text text-anchor="middle" x="2504.5" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;* lpeg.Carg(2) / spanner</text>
<text text-anchor="middle" x="2504.5" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_29&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2445.9566,-460.5807C2448.2011,-453.0863 2451.0258,-443.6545 2454.2152,-433.0048"/>
<polygon fill="#000000" stroke="#000000" points="2457.5903,-433.9343 2457.1065,-423.3505 2450.8846,-431.926 2457.5903,-433.9343"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="2848,-283.1004 2755,-283.1004 2755,-247.1004 2848,-247.1004 2848,-283.1004"/>
<text text-anchor="middle" x="2801.5" y="-261.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">return epeg</text>
</g>
<!-- codeblock_30&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>codeblock_30&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2724.4357,-460.8306C2731.1643,-450.2239 2739.4143,-436.3739 2745.5,-423.4007 2766.279,-379.1052 2783.8823,-324.8496 2793.5426,-292.733"/>
<polygon fill="#000000" stroke="#000000" points="2796.9045,-293.7067 2796.394,-283.1241 2790.1937,-291.7153 2796.9045,-293.7067"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2505,-70.7004 1992,-70.7004 1992,-.0997 2505,-.0997 2505,-70.7004"/>
<text text-anchor="middle" x="2248.5" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">This is the old&#45;school capture that plays into making named Nodes using</text>
<text text-anchor="middle" x="2248.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">epnf.</text>
</g>
<!-- raw_32&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_32&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2229.1478,-247.0762C2232.3862,-211.654 2239.6689,-131.9955 2244.3189,-81.1328"/>
<polygon fill="#000000" stroke="#000000" points="2247.8153,-81.3316 2245.2404,-71.0544 2240.8444,-80.6942 2247.8153,-81.3316"/>
</g>
</g>
</svg>