<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="15418pt" height="1215pt"
 viewBox="0.00 0.00 15418.00 1215.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1211.2015)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1211.2015 15414,-1211.2015 15414,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="623" cy="-1189.2015" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="623" y="-1185.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 272</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="623" cy="-1117.2015" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="623" y="-1113.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;177</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M623,-1171.0329C623,-1163.3325 623,-1154.1758 623,-1145.6181"/>
<polygon fill="#000000" stroke="#000000" points="626.5001,-1145.6147 623,-1135.6148 619.5001,-1145.6148 626.5001,-1145.6147"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="113" cy="-1045.2015" rx="43.5751" ry="18"/>
<text text-anchor="middle" x="113" y="-1041.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Node</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M564.4965,-1108.9422C463.8979,-1094.74 259.7742,-1065.9226 164.3426,-1052.4499"/>
<polygon fill="#000000" stroke="#000000" points="164.7451,-1048.9721 154.354,-1051.0397 163.7665,-1055.9033 164.7451,-1048.9721"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="402" cy="-1045.2015" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="402" y="-1041.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;177</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M580.6505,-1103.4044C543.6769,-1091.3587 490.0023,-1073.8719 451.1462,-1061.2129"/>
<polygon fill="#000000" stroke="#000000" points="452.1984,-1057.8747 441.606,-1058.1048 450.0299,-1064.5304 452.1984,-1057.8747"/>
</g>
<!-- section_4 -->
<g id="node5" class="node">
<title>section_4</title>
<ellipse fill="none" stroke="#000000" cx="623" cy="-1045.2015" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="623" y="-1041.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 6&#45;12</text>
</g>
<!-- section_1&#45;&gt;section_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;section_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M623,-1099.0329C623,-1091.3325 623,-1082.1758 623,-1073.6181"/>
<polygon fill="#000000" stroke="#000000" points="626.5001,-1073.6147 623,-1063.6148 619.5001,-1073.6148 626.5001,-1073.6147"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1379" cy="-1045.2015" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1379" y="-1041.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 13&#45;35</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M685.1879,-1111.2788C824.0217,-1098.0566 1158.6036,-1066.1916 1306.5537,-1052.1011"/>
<polygon fill="#000000" stroke="#000000" points="1307.2553,-1055.5503 1316.8784,-1051.1178 1306.5915,-1048.5818 1307.2553,-1055.5503"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="7138" cy="-1045.2015" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7138" y="-1041.0015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 178&#45;237</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M688.8037,-1116.4743C1322.4707,-1109.4714 6334.5931,-1054.0803 7052.5,-1046.1464"/>
<polygon fill="#000000" stroke="#000000" points="7052.546,-1049.6462 7062.5066,-1046.0358 7052.4685,-1042.6466 7052.546,-1049.6462"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="54,-981.5015 0,-981.5015 0,-945.5015 54,-945.5015 54,-981.5015"/>
</g>
<!-- header_2&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>header_2&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M95.5966,-1028.6683C83.5043,-1017.1806 67.1658,-1001.659 53.4677,-988.6458"/>
<polygon fill="#000000" stroke="#000000" points="55.8336,-986.0658 46.173,-981.7158 51.0124,-991.1409 55.8336,-986.0658"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="431.5,-991.403 72.5,-991.403 72.5,-935.6 431.5,-935.6 431.5,-991.403"/>
<text text-anchor="middle" x="252" y="-944.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Time to stabilize this class once and for all. </text>
</g>
<!-- block_3&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>block_3&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.4331,-1029.642C356.0289,-1020.1626 333.1248,-1007.6875 311.9031,-996.1287"/>
<polygon fill="#000000" stroke="#000000" points="313.3879,-992.952 302.9319,-991.2424 310.0397,-999.0993 313.3879,-992.952"/>
</g>
<!-- header_9 -->
<g id="node10" class="node">
<title>header_9</title>
<ellipse fill="none" stroke="#000000" cx="504" cy="-963.5015" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="504" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : includes</text>
</g>
<!-- section_4&#45;&gt;header_9 -->
<g id="edge9" class="edge">
<title>section_4&#45;&gt;header_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.9186,-1028.6683C580.934,-1016.3209 556.1616,-999.3133 536.4339,-985.7691"/>
<polygon fill="#000000" stroke="#000000" points="538.2707,-982.7847 528.0456,-980.0101 534.3087,-988.5556 538.2707,-982.7847"/>
</g>
<!-- block_10 -->
<g id="node11" class="node">
<title>block_10</title>
<ellipse fill="none" stroke="#000000" cx="623" cy="-963.5015" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="623" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 6&#45;7</text>
</g>
<!-- section_4&#45;&gt;block_10 -->
<g id="edge10" class="edge">
<title>section_4&#45;&gt;block_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M623,-1027.0696C623,-1016.7038 623,-1003.4762 623,-991.7744"/>
<polygon fill="#000000" stroke="#000000" points="626.5001,-991.5826 623,-981.5827 619.5001,-991.5827 626.5001,-991.5826"/>
</g>
<!-- codeblock_11 -->
<g id="node12" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="759" cy="-963.5015" rx="71.7805" ry="18"/>
<text text-anchor="middle" x="759" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 8&#45;11</text>
</g>
<!-- section_4&#45;&gt;codeblock_11 -->
<g id="edge11" class="edge">
<title>section_4&#45;&gt;codeblock_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M650.1948,-1028.8646C670.8613,-1016.4495 699.5074,-999.2408 722.2191,-985.597"/>
<polygon fill="#000000" stroke="#000000" points="724.1476,-988.5216 730.9174,-980.3717 720.5428,-982.5211 724.1476,-988.5216"/>
</g>
<!-- header_15 -->
<g id="node16" class="node">
<title>header_15</title>
<ellipse fill="none" stroke="#000000" cx="970" cy="-963.5015" rx="84.6634" ry="18"/>
<text text-anchor="middle" x="970" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Node metatable</text>
</g>
<!-- section_5&#45;&gt;header_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;header_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1325.5304,-1034.5206C1252.9565,-1020.0236 1123.045,-994.0731 1041.9643,-977.8768"/>
<polygon fill="#000000" stroke="#000000" points="1042.3291,-974.3805 1031.8372,-975.8538 1040.9578,-981.2449 1042.3291,-974.3805"/>
</g>
<!-- block_16 -->
<g id="node17" class="node">
<title>block_16</title>
<ellipse fill="none" stroke="#000000" cx="1269" cy="-963.5015" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1269" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 13&#45;18</text>
</g>
<!-- section_5&#45;&gt;block_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;block_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1356.2079,-1028.2732C1339.8759,-1016.1429 1317.6936,-999.6675 1299.7884,-986.3688"/>
<polygon fill="#000000" stroke="#000000" points="1301.5014,-983.2814 1291.3865,-980.1286 1297.3276,-988.9009 1301.5014,-983.2814"/>
</g>
<!-- codeblock_17 -->
<g id="node18" class="node">
<title>codeblock_17</title>
<ellipse fill="none" stroke="#000000" cx="1490" cy="-963.5015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1490" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 19&#45;24</text>
</g>
<!-- section_5&#45;&gt;codeblock_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;codeblock_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1401.9993,-1028.2732C1418.2615,-1016.3036 1440.2719,-1000.1032 1458.2116,-986.8989"/>
<polygon fill="#000000" stroke="#000000" points="1460.6694,-989.4358 1466.6483,-980.6892 1456.5199,-983.7982 1460.6694,-989.4358"/>
</g>
<!-- section_18 -->
<g id="node19" class="node">
<title>section_18</title>
<ellipse fill="none" stroke="#000000" cx="1686" cy="-963.5015" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1686" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 28&#45;35</text>
</g>
<!-- section_5&#45;&gt;section_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;section_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1426.296,-1032.6149C1480.8319,-1018.1016 1570.4487,-994.2524 1628.8422,-978.7125"/>
<polygon fill="#000000" stroke="#000000" points="1629.8868,-982.0564 1638.6503,-976.1024 1628.0865,-975.2919 1629.8868,-982.0564"/>
</g>
<!-- section_19 -->
<g id="node20" class="node">
<title>section_19</title>
<ellipse fill="none" stroke="#000000" cx="2892" cy="-963.5015" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2892" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 36&#45;159</text>
</g>
<!-- section_5&#45;&gt;section_19 -->
<g id="edge19" class="edge">
<title>section_5&#45;&gt;section_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1443.5277,-1041.7171C1686.4853,-1028.5977 2545.8495,-982.1932 2812.4934,-967.7947"/>
<polygon fill="#000000" stroke="#000000" points="2813.0633,-971.2692 2822.86,-967.235 2812.6858,-964.2793 2813.0633,-971.2692"/>
</g>
<!-- header_63 -->
<g id="node64" class="node">
<title>header_63</title>
<ellipse fill="none" stroke="#000000" cx="5759" cy="-963.5015" rx="83.6943" ry="18"/>
<text text-anchor="middle" x="5759" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Node Instances</text>
</g>
<!-- section_6&#45;&gt;header_63 -->
<g id="edge63" class="edge">
<title>section_6&#45;&gt;header_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7063.7061,-1041.6222C6898.274,-1033.5528 6487.0107,-1012.9424 6143,-991.2015 6041.9724,-984.8167 5926.0837,-976.2916 5848.2766,-970.3933"/>
<polygon fill="#000000" stroke="#000000" points="5848.2679,-966.8826 5838.0315,-969.6151 5847.7377,-973.8625 5848.2679,-966.8826"/>
</g>
<!-- block_64 -->
<g id="node65" class="node">
<title>block_64</title>
<ellipse fill="none" stroke="#000000" cx="6218" cy="-963.5015" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="6218" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 178&#45;182</text>
</g>
<!-- section_6&#45;&gt;block_64 -->
<g id="edge64" class="edge">
<title>section_6&#45;&gt;block_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7066.9562,-1038.8925C6895.9775,-1023.7088 6462.9862,-985.2573 6290.5152,-969.9411"/>
<polygon fill="#000000" stroke="#000000" points="6290.7929,-966.4521 6280.5224,-969.0537 6290.1736,-973.4247 6290.7929,-966.4521"/>
</g>
<!-- block_65 -->
<g id="node66" class="node">
<title>block_65</title>
<ellipse fill="none" stroke="#000000" cx="6784" cy="-963.5015" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="6784" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 183&#45;186</text>
</g>
<!-- section_6&#45;&gt;block_65 -->
<g id="edge65" class="edge">
<title>section_6&#45;&gt;block_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7083.4633,-1032.6149C7018.8048,-1017.6923 6911.3813,-992.8999 6844.2996,-977.4181"/>
<polygon fill="#000000" stroke="#000000" points="6844.8299,-973.9485 6834.2989,-975.11 6843.2557,-980.7692 6844.8299,-973.9485"/>
</g>
<!-- block_66 -->
<g id="node67" class="node">
<title>block_66</title>
<ellipse fill="none" stroke="#000000" cx="7138" cy="-963.5015" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="7138" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 187&#45;190</text>
</g>
<!-- section_6&#45;&gt;block_66 -->
<g id="edge66" class="edge">
<title>section_6&#45;&gt;block_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7138,-1027.0696C7138,-1016.7038 7138,-1003.4762 7138,-991.7744"/>
<polygon fill="#000000" stroke="#000000" points="7141.5001,-991.5826 7138,-981.5827 7134.5001,-991.5827 7141.5001,-991.5826"/>
</g>
<!-- block_67 -->
<g id="node68" class="node">
<title>block_67</title>
<ellipse fill="none" stroke="#000000" cx="7487" cy="-963.5015" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="7487" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 191&#45;196</text>
</g>
<!-- section_6&#45;&gt;block_67 -->
<g id="edge67" class="edge">
<title>section_6&#45;&gt;block_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7192.1483,-1032.5255C7255.7963,-1017.6257 7361.0942,-992.9757 7427.1243,-977.5182"/>
<polygon fill="#000000" stroke="#000000" points="7428.0328,-980.9003 7436.9718,-975.213 7426.4372,-974.0845 7428.0328,-980.9003"/>
</g>
<!-- block_68 -->
<g id="node69" class="node">
<title>block_68</title>
<ellipse fill="none" stroke="#000000" cx="7929" cy="-963.5015" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="7929" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 197&#45;237</text>
</g>
<!-- section_6&#45;&gt;block_68 -->
<g id="edge68" class="edge">
<title>section_6&#45;&gt;block_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7207.5027,-1038.0228C7356.662,-1022.6166 7706.1498,-986.519 7857.2755,-970.9097"/>
<polygon fill="#000000" stroke="#000000" points="7857.7863,-974.3756 7867.3738,-969.8667 7857.0671,-967.4127 7857.7863,-974.3756"/>
</g>
<!-- section_69 -->
<g id="node70" class="node">
<title>section_69</title>
<ellipse fill="none" stroke="#000000" cx="8892" cy="-963.5015" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="8892" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 202&#45;224</text>
</g>
<!-- section_6&#45;&gt;section_69 -->
<g id="edge69" class="edge">
<title>section_6&#45;&gt;section_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7212.2469,-1041.7431C7495.4629,-1028.5511 8507.0359,-981.4328 8807.3538,-967.4442"/>
<polygon fill="#000000" stroke="#000000" points="8807.9083,-970.9223 8817.7346,-966.9607 8807.5825,-963.9299 8807.9083,-970.9223"/>
</g>
<!-- section_70 -->
<g id="node71" class="node">
<title>section_70</title>
<ellipse fill="none" stroke="#000000" cx="13078" cy="-963.5015" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="13078" y="-959.3015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 238&#45;272</text>
</g>
<!-- section_6&#45;&gt;section_70 -->
<g id="edge70" class="edge">
<title>section_6&#45;&gt;section_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7213.3735,-1044.1648C7849.6905,-1035.4128 12316.6878,-973.9727 12992.4425,-964.6783"/>
<polygon fill="#000000" stroke="#000000" points="12992.6358,-968.176 13002.5867,-964.5387 12992.5394,-961.1767 12992.6358,-968.176"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="531,-875.3014 477,-875.3014 477,-839.3014 531,-839.3014 531,-875.3014"/>
</g>
<!-- header_9&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>header_9&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504,-945.4861C504,-929.0849 504,-904.6006 504,-885.5899"/>
<polygon fill="#000000" stroke="#000000" points="507.5001,-885.4051 504,-875.4052 500.5001,-885.4052 507.5001,-885.4051"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="615,-875.3014 561,-875.3014 561,-839.3014 615,-839.3014 615,-875.3014"/>
</g>
<!-- block_10&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>block_10&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M617.0627,-945.4861C611.6072,-928.9323 603.4379,-904.1444 597.1486,-885.0608"/>
<polygon fill="#000000" stroke="#000000" points="600.4207,-883.8071 593.9664,-875.4052 593.7724,-885.9982 600.4207,-883.8071"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="859,-876.602 633,-876.602 633,-838.0008 859,-838.0008 859,-876.602"/>
<text text-anchor="middle" x="746" y="-861.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot;</text>
<text text-anchor="middle" x="746" y="-846.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">local dot = require &quot;node/dot&quot;</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>codeblock_11&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M756.7947,-945.4861C754.8357,-929.4825 751.9347,-905.783 749.6332,-886.982"/>
<polygon fill="#000000" stroke="#000000" points="753.0819,-886.3484 748.3927,-876.8478 746.1337,-887.199 753.0819,-886.3484"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="931,-875.3014 877,-875.3014 877,-839.3014 931,-839.3014 931,-875.3014"/>
</g>
<!-- header_15&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>header_15&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M958.804,-945.4861C948.3267,-928.6272 932.5418,-903.2278 920.5994,-884.0114"/>
<polygon fill="#000000" stroke="#000000" points="923.5021,-882.0512 915.2509,-875.4052 917.5567,-885.7461 923.5021,-882.0512"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1483,-892.5018 949,-892.5018 949,-822.101 1483,-822.101 1483,-892.5018"/>
<text text-anchor="middle" x="1216" y="-861.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The Node metatable is the root table for any Node. &#160;I&#39;m planning to make</text>
<text text-anchor="middle" x="1216" y="-845.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">an intermediate class/table called Root that is in common for any instance</text>
<text text-anchor="middle" x="1216" y="-830.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">Node. &#160;All Root absolutely has to contain is =str=. </text>
</g>
<!-- block_16&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>block_16&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1260.0093,-945.4861C1254.0417,-933.5283 1245.9298,-917.274 1238.2957,-901.9769"/>
<polygon fill="#000000" stroke="#000000" points="1241.2246,-900.0077 1233.6275,-892.623 1234.9613,-903.1335 1241.2246,-900.0077"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1622.5,-892.5018 1501.5,-892.5018 1501.5,-822.101 1622.5,-822.101 1622.5,-892.5018"/>
<text text-anchor="middle" x="1562" y="-861.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">local N = {}</text>
<text text-anchor="middle" x="1562" y="-845.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">N.__index = N</text>
<text text-anchor="middle" x="1562" y="-830.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">N.isNode = true</text>
</g>
<!-- codeblock_17&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_17&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1502.2138,-945.4861C1510.4737,-933.3027 1521.7575,-916.6592 1532.2978,-901.1121"/>
<polygon fill="#000000" stroke="#000000" points="1535.3385,-902.8642 1538.0532,-892.623 1529.5446,-898.936 1535.3385,-902.8642"/>
</g>
<!-- header_23 -->
<g id="node24" class="node">
<title>header_23</title>
<ellipse fill="none" stroke="#000000" cx="1686" cy="-857.3014" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="1686" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Fields</text>
</g>
<!-- section_18&#45;&gt;header_23 -->
<g id="edge23" class="edge">
<title>section_18&#45;&gt;header_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1686,-945.4861C1686,-929.0849 1686,-904.6006 1686,-885.5899"/>
<polygon fill="#000000" stroke="#000000" points="1689.5001,-885.4051 1686,-875.4052 1682.5001,-885.4052 1689.5001,-885.4051"/>
</g>
<!-- block_24 -->
<g id="node25" class="node">
<title>block_24</title>
<ellipse fill="none" stroke="#000000" cx="1806" cy="-857.3014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1806" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 28&#45;35</text>
</g>
<!-- section_18&#45;&gt;block_24 -->
<g id="edge24" class="edge">
<title>section_18&#45;&gt;block_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1705.5471,-946.2022C1725.6272,-928.4314 1757.022,-900.6469 1779.3658,-880.8727"/>
<polygon fill="#000000" stroke="#000000" points="1781.6892,-883.4903 1786.8581,-874.2419 1777.05,-878.2483 1781.6892,-883.4903"/>
</g>
<!-- header_27 -->
<g id="node28" class="node">
<title>header_27</title>
<ellipse fill="none" stroke="#000000" cx="2204" cy="-857.3014" rx="56.1302" ry="18"/>
<text text-anchor="middle" x="2204" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Methods</text>
</g>
<!-- section_19&#45;&gt;header_27 -->
<g id="edge27" class="edge">
<title>section_19&#45;&gt;header_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2826.4934,-956.6724C2732.4353,-946.4807 2553.8282,-925.6878 2403,-899.8015 2354.0499,-891.4003 2298.8484,-879.4091 2259.0241,-870.3046"/>
<polygon fill="#000000" stroke="#000000" points="2259.7737,-866.8857 2249.2437,-868.056 2258.2052,-873.7077 2259.7737,-866.8857"/>
</g>
<!-- block_28 -->
<g id="node29" class="node">
<title>block_28</title>
<ellipse fill="none" stroke="#000000" cx="2468" cy="-857.3014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="2468" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 36&#45;37</text>
</g>
<!-- section_19&#45;&gt;block_28 -->
<g id="edge28" class="edge">
<title>section_19&#45;&gt;block_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2835.0844,-952.7799C2775.9475,-941.245 2680.9126,-921.598 2600,-899.8015 2571.6792,-892.1723 2540.4193,-882.1794 2515.4315,-873.8002"/>
<polygon fill="#000000" stroke="#000000" points="2516.428,-870.4426 2505.8338,-870.558 2514.1876,-877.0744 2516.428,-870.4426"/>
</g>
<!-- codeblock_29 -->
<g id="node30" class="node">
<title>codeblock_29</title>
<ellipse fill="none" stroke="#000000" cx="2686" cy="-857.3014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2686" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 38&#45;53</text>
</g>
<!-- section_19&#45;&gt;codeblock_29 -->
<g id="edge29" class="edge">
<title>section_19&#45;&gt;codeblock_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2860.264,-947.1405C2824.5303,-928.7185 2766.3513,-898.7253 2727.1519,-878.5166"/>
<polygon fill="#000000" stroke="#000000" points="2728.6037,-875.3274 2718.1115,-873.856 2725.3961,-881.5492 2728.6037,-875.3274"/>
</g>
<!-- codeblock_30 -->
<g id="node31" class="node">
<title>codeblock_30</title>
<ellipse fill="none" stroke="#000000" cx="2892" cy="-857.3014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2892" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 55&#45;76</text>
</g>
<!-- section_19&#45;&gt;codeblock_30 -->
<g id="edge30" class="edge">
<title>section_19&#45;&gt;codeblock_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2892,-945.4861C2892,-929.0849 2892,-904.6006 2892,-885.5899"/>
<polygon fill="#000000" stroke="#000000" points="2895.5001,-885.4051 2892,-875.4052 2888.5001,-885.4052 2895.5001,-885.4051"/>
</g>
<!-- section_31 -->
<g id="node32" class="node">
<title>section_31</title>
<ellipse fill="none" stroke="#000000" cx="3249" cy="-857.3014" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3249" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 78&#45;98</text>
</g>
<!-- section_19&#45;&gt;section_31 -->
<g id="edge31" class="edge">
<title>section_19&#45;&gt;section_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2937.9407,-949.8351C3003.635,-930.2924 3124.2089,-894.4241 3194.3831,-873.5488"/>
<polygon fill="#000000" stroke="#000000" points="3195.7716,-876.7874 3204.3585,-870.5813 3193.7756,-870.078 3195.7716,-876.7874"/>
</g>
<!-- section_32 -->
<g id="node33" class="node">
<title>section_32</title>
<ellipse fill="none" stroke="#000000" cx="3680" cy="-857.3014" rx="70.655" ry="18"/>
<text text-anchor="middle" x="3680" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 99&#45;121</text>
</g>
<!-- section_19&#45;&gt;section_32 -->
<g id="edge32" class="edge">
<title>section_19&#45;&gt;section_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2954.4917,-955.0794C3098.6088,-935.6565 3453.6404,-887.8083 3607.2382,-867.1076"/>
<polygon fill="#000000" stroke="#000000" points="3608.059,-870.5287 3617.5019,-865.7244 3607.1239,-863.5915 3608.059,-870.5287"/>
</g>
<!-- section_33 -->
<g id="node34" class="node">
<title>section_33</title>
<ellipse fill="none" stroke="#000000" cx="4529" cy="-857.3014" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4529" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 122&#45;159</text>
</g>
<!-- section_19&#45;&gt;section_33 -->
<g id="edge33" class="edge">
<title>section_19&#45;&gt;section_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2960.5147,-959.0566C3222.3903,-942.0675 4159.6388,-881.2636 4445.5773,-862.7134"/>
<polygon fill="#000000" stroke="#000000" points="4446.1248,-866.1854 4455.8772,-862.0452 4445.6715,-859.2 4446.1248,-866.1854"/>
</g>
<!-- section_34 -->
<g id="node35" class="node">
<title>section_34</title>
<ellipse fill="none" stroke="#000000" cx="5560" cy="-857.3014" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5560" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 160&#45;177</text>
</g>
<!-- section_19&#45;&gt;section_34 -->
<g id="edge34" class="edge">
<title>section_19&#45;&gt;section_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2962.0887,-961.1048C3196.0922,-953.0609 3971.8314,-926.0544 4613,-899.8015 4931.5064,-886.7601 5310.1684,-869.1233 5475.62,-861.3109"/>
<polygon fill="#000000" stroke="#000000" points="5475.9057,-864.8014 5485.7293,-860.8332 5475.5753,-857.8092 5475.9057,-864.8014"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1497,-645.6011 1443,-645.6011 1443,-609.6011 1497,-609.6011 1497,-645.6011"/>
</g>
<!-- header_23&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>header_23&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1667.8567,-840.4517C1657.6677,-831.7494 1644.3466,-821.5667 1631,-814.8013 1579.4329,-788.6621 1545.9155,-820.6244 1506,-778.8013 1474.2277,-745.5106 1468.811,-689.4726 1468.7351,-655.7695"/>
<polygon fill="#000000" stroke="#000000" points="1472.236,-655.7152 1468.8714,-645.6688 1465.2366,-655.6206 1472.236,-655.7152"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2028.5,-678.1012 1515.5,-678.1012 1515.5,-577.1009 2028.5,-577.1009 2028.5,-678.1012"/>
<text text-anchor="middle" x="1772" y="-646.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; id : &#160;A string naming the Node. </text>
<text text-anchor="middle" x="1772" y="-631.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;This is identical to the name of the pattern that recognizes</text>
<text text-anchor="middle" x="1772" y="-616.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or captures it.</text>
<text text-anchor="middle" x="1772" y="-600.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; line_first : &#160;Always &#45;1.</text>
<text text-anchor="middle" x="1772" y="-585.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45; line_last &#160;: &#160;Always &#45;1. </text>
</g>
<!-- block_24&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>block_24&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1803.3321,-839.2772C1798.5869,-807.2192 1788.4785,-738.9282 1781.0204,-688.5421"/>
<polygon fill="#000000" stroke="#000000" points="1784.4459,-687.7806 1779.5193,-678.4009 1777.5214,-688.8056 1784.4459,-687.7806"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="2101,-645.6011 2047,-645.6011 2047,-609.6011 2101,-609.6011 2101,-645.6011"/>
</g>
<!-- header_27&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>header_27&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2176.7705,-841.4608C2155.3941,-827.6123 2126.5648,-805.5557 2110,-778.8013 2086.2627,-740.4624 2078.1755,-687.7486 2075.4212,-655.7635"/>
<polygon fill="#000000" stroke="#000000" points="2078.9094,-655.4744 2074.6767,-645.7618 2071.9288,-655.9941 2078.9094,-655.4744"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2173,-645.6011 2119,-645.6011 2119,-609.6011 2173,-609.6011 2173,-645.6011"/>
</g>
<!-- block_28&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>block_28&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2421.4365,-847.2435C2344.7869,-830.2906 2198.795,-796.1796 2182,-778.8013 2150.0197,-745.7103 2144.6721,-689.6059 2144.6655,-655.8362"/>
<polygon fill="#000000" stroke="#000000" points="2148.1669,-655.768 2144.8241,-645.7143 2141.1678,-655.6583 2148.1669,-655.768"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="2676.5,-739.2019 2191.5,-739.2019 2191.5,-516.0003 2676.5,-516.0003 2676.5,-739.2019"/>
<text text-anchor="middle" x="2434" y="-724.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.toString(node, depth)</text>
<text text-anchor="middle" x="2434" y="-708.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local depth = depth or 0</text>
<text text-anchor="middle" x="2434" y="-693.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2434" y="-678.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;phrase = (&quot; &#160;&quot;):rep(depth) .. &quot;id: &quot; .. node.id .. &quot;, &#160;&quot;</text>
<text text-anchor="middle" x="2434" y="-662.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;.. &quot;first: &quot; .. node.first .. &quot;, last: &quot; .. node.last .. &quot;\n&quot;</text>
<text text-anchor="middle" x="2434" y="-647.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if node[1] then</text>
<text text-anchor="middle" x="2434" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _,v in ipairs(node) do</text>
<text text-anchor="middle" x="2434" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if(v.isNode) then</text>
<text text-anchor="middle" x="2434" y="-601.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. N.toString(v, depth + 1)</text>
<text text-anchor="middle" x="2434" y="-585.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2434" y="-570.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2434" y="-554.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end </text>
<text text-anchor="middle" x="2434" y="-539.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="2434" y="-524.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_29&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>codeblock_29&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2666.6444,-839.6586C2643.9682,-818.989 2604.3645,-782.8898 2564.1919,-746.2722"/>
<polygon fill="#000000" stroke="#000000" points="2566.4365,-743.5823 2556.6882,-739.4325 2561.7209,-748.7557 2566.4365,-743.5823"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="3089,-779.0018 2695,-779.0018 2695,-476.2003 3089,-476.2003 3089,-779.0018"/>
<text text-anchor="middle" x="2892" y="-763.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.dotLabel(node)</text>
<text text-anchor="middle" x="2892" y="-748.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return node.id</text>
<text text-anchor="middle" x="2892" y="-732.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2892" y="-701.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.toMarkdown(node)</text>
<text text-anchor="middle" x="2892" y="-686.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if not node[1] then</text>
<text text-anchor="middle" x="2892" y="-670.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return string.sub(node.str, node.first, node.last)</text>
<text text-anchor="middle" x="2892" y="-655.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="2892" y="-639.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;s:halt(&quot;no toMarkdown for &quot; .. node.id)</text>
<text text-anchor="middle" x="2892" y="-624.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="2892" y="-609.001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2892" y="-577.601" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.dot(node)</text>
<text text-anchor="middle" x="2892" y="-562.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return dot.dot(node)</text>
<text text-anchor="middle" x="2892" y="-546.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2892" y="-515.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.toValue(node)</text>
<text text-anchor="middle" x="2892" y="-500.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return node.str:sub(node.first,node.last)</text>
<text text-anchor="middle" x="2892" y="-484.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_30&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>codeblock_30&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2892,-839.2772C2892,-826.8709 2892,-809.0382 2892,-788.9168"/>
<polygon fill="#000000" stroke="#000000" points="2895.5001,-788.8689 2892,-778.8689 2888.5001,-788.869 2895.5001,-788.8689"/>
</g>
<!-- header_39 -->
<g id="node40" class="node">
<title>header_39</title>
<ellipse fill="none" stroke="#000000" cx="3177" cy="-627.6011" rx="70.1446" ry="18"/>
<text text-anchor="middle" x="3177" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : N.walkDeep</text>
</g>
<!-- section_31&#45;&gt;header_39 -->
<g id="edge39" class="edge">
<title>section_31&#45;&gt;header_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3243.3503,-839.2772C3230.8419,-799.372 3200.7357,-703.3245 3185.7619,-655.5539"/>
<polygon fill="#000000" stroke="#000000" points="3189.054,-654.3547 3182.7231,-645.8594 3182.3744,-656.4485 3189.054,-654.3547"/>
</g>
<!-- block_40 -->
<g id="node41" class="node">
<title>block_40</title>
<ellipse fill="none" stroke="#000000" cx="3321" cy="-627.6011" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="3321" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 78&#45;81</text>
</g>
<!-- section_31&#45;&gt;block_40 -->
<g id="edge40" class="edge">
<title>section_31&#45;&gt;block_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3254.6497,-839.2772C3267.189,-799.2734 3297.4131,-702.8499 3312.3488,-655.2009"/>
<polygon fill="#000000" stroke="#000000" points="3315.7252,-656.1306 3315.3765,-645.5415 3309.0457,-654.0369 3315.7252,-656.1306"/>
</g>
<!-- codeblock_41 -->
<g id="node42" class="node">
<title>codeblock_41</title>
<ellipse fill="none" stroke="#000000" cx="3472" cy="-627.6011" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3472" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 82&#45;97</text>
</g>
<!-- section_31&#45;&gt;codeblock_41 -->
<g id="edge41" class="edge">
<title>section_31&#45;&gt;codeblock_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3286.5849,-842.383C3316.3229,-829.1349 3357.4546,-807.4375 3386,-778.8013 3422.1308,-742.5555 3448.1129,-688.0382 3461.5494,-655.3242"/>
<polygon fill="#000000" stroke="#000000" points="3464.8484,-656.5006 3465.3139,-645.916 3458.3494,-653.9001 3464.8484,-656.5006"/>
</g>
<!-- header_45 -->
<g id="node46" class="node">
<title>header_45</title>
<ellipse fill="none" stroke="#000000" cx="3616" cy="-627.6011" rx="48.8618" ry="18"/>
<text text-anchor="middle" x="3616" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : N.walk</text>
</g>
<!-- section_32&#45;&gt;header_45 -->
<g id="edge45" class="edge">
<title>section_32&#45;&gt;header_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3674.978,-839.2772C3663.832,-799.2734 3636.9661,-702.8499 3623.69,-655.2009"/>
<polygon fill="#000000" stroke="#000000" points="3627.0543,-654.2352 3620.9986,-645.5415 3620.3111,-656.114 3627.0543,-654.2352"/>
</g>
<!-- block_46 -->
<g id="node47" class="node">
<title>block_46</title>
<ellipse fill="none" stroke="#000000" cx="3744" cy="-627.6011" rx="60.9913" ry="18"/>
<text text-anchor="middle" x="3744" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 99&#45;102</text>
</g>
<!-- section_32&#45;&gt;block_46 -->
<g id="edge46" class="edge">
<title>section_32&#45;&gt;block_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3685.022,-839.2772C3696.168,-799.2734 3723.0339,-702.8499 3736.31,-655.2009"/>
<polygon fill="#000000" stroke="#000000" points="3739.6889,-656.114 3739.0014,-645.5415 3732.9457,-654.2352 3739.6889,-656.114"/>
</g>
<!-- codeblock_47 -->
<g id="node48" class="node">
<title>codeblock_47</title>
<ellipse fill="none" stroke="#000000" cx="4019" cy="-627.6011" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="4019" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 103&#45;119</text>
</g>
<!-- section_32&#45;&gt;codeblock_47 -->
<g id="edge47" class="edge">
<title>section_32&#45;&gt;codeblock_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3710.0876,-840.8766C3737.6122,-825.5707 3779.2182,-801.7243 3814,-778.8013 3878.1207,-736.5425 3949.576,-682.0444 3988.913,-651.3549"/>
<polygon fill="#000000" stroke="#000000" points="3991.0859,-654.0989 3996.8054,-645.1805 3986.7727,-648.5856 3991.0859,-654.0989"/>
</g>
<!-- header_51 -->
<g id="node52" class="node">
<title>header_51</title>
<ellipse fill="none" stroke="#000000" cx="4403" cy="-627.6011" rx="102.5369" ry="18"/>
<text text-anchor="middle" x="4403" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : N.select(node, pred)</text>
</g>
<!-- section_33&#45;&gt;header_51 -->
<g id="edge51" class="edge">
<title>section_33&#45;&gt;header_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4519.113,-839.2772C4497.0773,-799.1057 4443.833,-702.0403 4417.8123,-654.6042"/>
<polygon fill="#000000" stroke="#000000" points="4420.7191,-652.6258 4412.8411,-645.5415 4414.5818,-655.9924 4420.7191,-652.6258"/>
</g>
<!-- block_52 -->
<g id="node53" class="node">
<title>block_52</title>
<ellipse fill="none" stroke="#000000" cx="4623" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="4623" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 122&#45;127</text>
</g>
<!-- section_33&#45;&gt;block_52 -->
<g id="edge52" class="edge">
<title>section_33&#45;&gt;block_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4536.376,-839.2772C4552.781,-799.1896 4592.3716,-702.4453 4611.8277,-654.9019"/>
<polygon fill="#000000" stroke="#000000" points="4615.11,-656.1222 4615.6582,-645.5415 4608.6315,-653.4709 4615.11,-656.1222"/>
</g>
<!-- codeblock_53 -->
<g id="node54" class="node">
<title>codeblock_53</title>
<ellipse fill="none" stroke="#000000" cx="5021" cy="-627.6011" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5021" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 128&#45;157</text>
</g>
<!-- section_33&#45;&gt;codeblock_53 -->
<g id="edge53" class="edge">
<title>section_33&#45;&gt;codeblock_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4563.6465,-841.2447C4597.8176,-825.3997 4651.5278,-800.4715 4698,-778.8013 4797.5449,-732.3832 4914.227,-677.6934 4976.4975,-648.4842"/>
<polygon fill="#000000" stroke="#000000" points="4978.0806,-651.6075 4985.6475,-644.1918 4975.1077,-645.2702 4978.0806,-651.6075"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="5560" cy="-627.6011" rx="82.7165" ry="18"/>
<text text-anchor="middle" x="5560" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : N.tokens(node)</text>
</g>
<!-- section_34&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_34&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5560,-839.2772C5560,-799.5393 5560,-704.129 5560,-656.1573"/>
<polygon fill="#000000" stroke="#000000" points="5563.5001,-655.8593 5560,-645.8594 5556.5001,-655.8594 5563.5001,-655.8593"/>
</g>
<!-- block_58 -->
<g id="node59" class="node">
<title>block_58</title>
<ellipse fill="none" stroke="#000000" cx="5765" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="5765" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 160&#45;163</text>
</g>
<!-- section_34&#45;&gt;block_58 -->
<g id="edge58" class="edge">
<title>section_34&#45;&gt;block_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5583.1787,-839.8891C5602.577,-824.7803 5630.4606,-801.7787 5652,-778.8013 5689.9417,-738.3267 5727.1175,-685.263 5747.9486,-653.9597"/>
<polygon fill="#000000" stroke="#000000" points="5751.0378,-655.6329 5753.6246,-645.3587 5745.1953,-651.7773 5751.0378,-655.6329"/>
</g>
<!-- codeblock_59 -->
<g id="node60" class="node">
<title>codeblock_59</title>
<ellipse fill="none" stroke="#000000" cx="6075" cy="-627.6011" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6075" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 164&#45;176</text>
</g>
<!-- section_34&#45;&gt;codeblock_59 -->
<g id="edge59" class="edge">
<title>section_34&#45;&gt;codeblock_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5588.2677,-840.4293C5604.1591,-831.6108 5624.64,-821.3251 5644,-814.8013 5727.9311,-786.5187 5757.6414,-811.3804 5840,-778.8013 5920.7795,-746.8469 6003.5278,-685.6198 6045.9695,-651.7041"/>
<polygon fill="#000000" stroke="#000000" points="6048.3211,-654.304 6053.9079,-645.3018 6043.9267,-648.8552 6048.3211,-654.304"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="2871,-238.2004 2817,-238.2004 2817,-202.2004 2871,-202.2004 2871,-238.2004"/>
</g>
<!-- header_39&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>header_39&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3173.1077,-609.4682C3165.1344,-577.0548 3143.7057,-509.4806 3098,-476.4008 3018.4483,-418.8249 2949.3829,-509.8952 2880,-440.4008 2828.8368,-389.1553 2833.1988,-295.3334 2839.2758,-248.4419"/>
<polygon fill="#000000" stroke="#000000" points="2842.7638,-248.7729 2840.7017,-238.3807 2835.8331,-247.7906 2842.7638,-248.7729"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3059,-240.1025 2889,-240.1025 2889,-200.2983 3059,-200.2983 3059,-240.1025"/>
<text text-anchor="middle" x="2974" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">Depth&#45;first iterator. </text>
</g>
<!-- block_40&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>block_40&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3318.7044,-609.4149C3313.6238,-577.2243 3298.3157,-510.41 3256,-476.4008 3189.6885,-423.1062 3134.2437,-493.7797 3068,-440.4008 3007.969,-392.0281 2985.5822,-298.1636 2977.8036,-250.1162"/>
<polygon fill="#000000" stroke="#000000" points="2981.2358,-249.4044 2976.2793,-240.0404 2974.3145,-250.4515 2981.2358,-249.4044"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="3485,-332.5009 3077,-332.5009 3077,-107.8999 3485,-107.8999 3485,-332.5009"/>
<text text-anchor="middle" x="3281" y="-317.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.walkDeep(node)</text>
<text text-anchor="middle" x="3281" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local function traverse(ast)</text>
<text text-anchor="middle" x="3281" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not ast.isNode then return nil end</text>
<text text-anchor="middle" x="3281" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, v in ipairs(ast) do</text>
<text text-anchor="middle" x="3281" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(v) == &#39;table&#39; and v.isNode then</text>
<text text-anchor="middle" x="3281" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;traverse(v)</text>
<text text-anchor="middle" x="3281" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3281" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3281" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;coroutine.yield(ast)</text>
<text text-anchor="middle" x="3281" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3281" y="-131.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return coroutine.wrap(function() traverse(node) end)</text>
<text text-anchor="middle" x="3281" y="-116.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_41&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_41&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3463.5465,-609.5699C3441.9352,-563.4731 3383.1957,-438.1826 3338.1298,-342.0575"/>
<polygon fill="#000000" stroke="#000000" points="3341.2269,-340.4183 3333.8129,-332.8497 3334.8889,-343.3898 3341.2269,-340.4183"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="3557,-238.2004 3503,-238.2004 3503,-202.2004 3557,-202.2004 3557,-238.2004"/>
</g>
<!-- header_45&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>header_45&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3610.5756,-609.6736C3600.6831,-576.5072 3579.4897,-503.2199 3566,-440.4008 3551.2986,-371.9391 3539.4095,-290.3701 3533.6911,-248.3388"/>
<polygon fill="#000000" stroke="#000000" points="3537.1422,-247.7401 3532.3403,-238.2959 3530.2047,-248.6733 3537.1422,-247.7401"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="3913,-240.1025 3575,-240.1025 3575,-200.2983 3913,-200.2983 3913,-240.1025"/>
<text text-anchor="middle" x="3744" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">Breadth&#45;first iterator. &#160;This is the default. </text>
</g>
<!-- block_46&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>block_46&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3744,-609.5699C3744,-545.7393 3744,-330.0612 3744,-250.236"/>
<polygon fill="#000000" stroke="#000000" points="3747.5001,-249.9039 3744,-239.9039 3740.5001,-249.904 3747.5001,-249.9039"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="4325,-332.5009 3931,-332.5009 3931,-107.8999 4325,-107.8999 4325,-332.5009"/>
<text text-anchor="middle" x="4128" y="-317.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.walk(node)</text>
<text text-anchor="middle" x="4128" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local function traverse(ast)</text>
<text text-anchor="middle" x="4128" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not ast.isNode then return nil end</text>
<text text-anchor="middle" x="4128" y="-255.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;coroutine.yield(ast)</text>
<text text-anchor="middle" x="4128" y="-239.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(ast) do</text>
<text text-anchor="middle" x="4128" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(v) == &#39;table&#39; and v.isNode then</text>
<text text-anchor="middle" x="4128" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;traverse(v)</text>
<text text-anchor="middle" x="4128" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4128" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4128" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="4128" y="-131.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return coroutine.wrap(function() traverse(node) end)</text>
<text text-anchor="middle" x="4128" y="-116.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_47&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>codeblock_47&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4023.8242,-609.5699C4036.1326,-563.5661 4069.5438,-438.6875 4095.2415,-342.6392"/>
<polygon fill="#000000" stroke="#000000" points="4098.6571,-343.4146 4097.8607,-332.8497 4091.8949,-341.6053 4098.6571,-343.4146"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="4397,-238.2004 4343,-238.2004 4343,-202.2004 4397,-202.2004 4397,-238.2004"/>
</g>
<!-- header_51&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>header_51&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4401.5395,-609.5699C4396.3333,-545.2981 4378.6568,-327.0722 4372.3004,-248.6002"/>
<polygon fill="#000000" stroke="#000000" points="4375.7772,-248.1703 4371.4811,-238.4856 4368.8,-248.7355 4375.7772,-248.1703"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="4963,-255.4008 4415,-255.4008 4415,-185 4963,-185 4963,-255.4008"/>
<text text-anchor="middle" x="4689" y="-224.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Takes the Node and walks it, yielding the Nodes which match the predicate.</text>
<text text-anchor="middle" x="4689" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">=pred= is either a string, which matches to =id=, or a function, which takes</text>
<text text-anchor="middle" x="4689" y="-193.3004" font-family="Inconsolata" font-size="14.00" fill="#000000">a Node and returns true or false on some premise. </text>
</g>
<!-- block_52&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>block_52&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4625.9211,-609.5699C4635.6639,-549.43 4667.244,-354.4948 4681.6792,-265.3895"/>
<polygon fill="#000000" stroke="#000000" points="4685.1665,-265.7492 4683.3108,-255.3181 4678.2566,-264.6297 4685.1665,-265.7492"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="5515,-440.6014 4981,-440.6014 4981,.2006 5515,.2006 5515,-440.6014"/>
<text text-anchor="middle" x="5248" y="-425.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.select(node, pred)</text>
<text text-anchor="middle" x="5248" y="-409.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local function qualifies(node, pred)</text>
<text text-anchor="middle" x="5248" y="-394.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(pred) == &#39;string&#39; then</text>
<text text-anchor="middle" x="5248" y="-379.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(node) == &#39;table&#39; and node.isNode and node.id == pred then</text>
<text text-anchor="middle" x="5248" y="-363.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="5248" y="-348.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="5248" y="-332.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="5248" y="-317.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-302.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type(pred) == &#39;function&#39; then</text>
<text text-anchor="middle" x="5248" y="-286.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return pred(node)</text>
<text text-anchor="middle" x="5248" y="-271.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="5248" y="-255.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:halt(&quot;cannot select on predicate of type &quot; .. type(pred))</text>
<text text-anchor="middle" x="5248" y="-240.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-225.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-193.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local function traverse(ast)</text>
<text text-anchor="middle" x="5248" y="-178.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if qualifies(ast, pred) then</text>
<text text-anchor="middle" x="5248" y="-162.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;coroutine.yield(ast)</text>
<text text-anchor="middle" x="5248" y="-147.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-132.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if ast.isNode then</text>
<text text-anchor="middle" x="5248" y="-116.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, v in ipairs(ast) do</text>
<text text-anchor="middle" x="5248" y="-101.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;traverse(v)</text>
<text text-anchor="middle" x="5248" y="-85.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-70.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5248" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return coroutine.wrap(function() traverse(node) end)</text>
<text text-anchor="middle" x="5248" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_53&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_53&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5031.0468,-609.5699C5047.6959,-579.6894 5082.8859,-516.5335 5120.1721,-449.6152"/>
<polygon fill="#000000" stroke="#000000" points="5123.3956,-451.0208 5125.2055,-440.5817 5117.2807,-447.6136 5123.3956,-451.0208"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="5587,-238.2004 5533,-238.2004 5533,-202.2004 5587,-202.2004 5587,-238.2004"/>
</g>
<!-- header_57&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>header_57&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5560,-609.5699C5560,-545.2981 5560,-327.0722 5560,-248.6002"/>
<polygon fill="#000000" stroke="#000000" points="5563.5001,-248.4855 5560,-238.4856 5556.5001,-248.4856 5563.5001,-248.4855"/>
</g>
<!-- leaf_61 -->
<g id="node62" class="node">
<title>leaf_61</title>
<polygon fill="none" stroke="#c0c0c0" points="5999,-240.1025 5605,-240.1025 5605,-200.2983 5999,-200.2983 5999,-240.1025"/>
<text text-anchor="middle" x="5802" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Iterator returning all &#39;captured&#39; values as strings.</text>
</g>
<!-- block_58&#45;&gt;leaf_61 -->
<g id="edge61" class="edge">
<title>block_58&#45;&gt;leaf_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5766.6376,-609.5699C5772.4347,-545.7393 5792.0225,-330.0612 5799.2722,-250.236"/>
<polygon fill="#000000" stroke="#000000" points="5802.7916,-250.1795 5800.2105,-239.9039 5795.8203,-249.5463 5802.7916,-250.1795"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="6411,-309.2007 6017,-309.2007 6017,-131.2001 6411,-131.2001 6411,-309.2007"/>
<text text-anchor="middle" x="6214" y="-294.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">function N.tokens(node)</text>
<text text-anchor="middle" x="6214" y="-278.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local function traverse(ast)</text>
<text text-anchor="middle" x="6214" y="-263.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for node in N.walk(ast) do</text>
<text text-anchor="middle" x="6214" y="-247.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not node[1] then</text>
<text text-anchor="middle" x="6214" y="-232.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;coroutine.yield(node:toValue())</text>
<text text-anchor="middle" x="6214" y="-217.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6214" y="-201.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6214" y="-186.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="6214" y="-154.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return coroutine.wrap(function() traverse(node) end)</text>
<text text-anchor="middle" x="6214" y="-139.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">end &#160;</text>
</g>
<!-- codeblock_59&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>codeblock_59&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6081.152,-609.5699C6098.1604,-559.7193 6146.7685,-417.2519 6180.2182,-319.2129"/>
<polygon fill="#000000" stroke="#000000" points="6183.591,-320.1663 6183.5076,-309.5718 6176.9659,-317.9059 6183.591,-320.1663"/>
</g>
<!-- leaf_71 -->
<g id="node72" class="node">
<title>leaf_71</title>
<polygon fill="none" stroke="#c0c0c0" points="5707,-875.3014 5653,-875.3014 5653,-839.3014 5707,-839.3014 5707,-875.3014"/>
</g>
<!-- header_63&#45;&gt;leaf_71 -->
<g id="edge71" class="edge">
<title>header_63&#45;&gt;leaf_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5745.5987,-945.4861C5732.9442,-928.4746 5713.8212,-902.7674 5699.4821,-883.4912"/>
<polygon fill="#000000" stroke="#000000" points="5702.2438,-881.3397 5693.467,-875.4052 5696.6273,-885.5177 5702.2438,-881.3397"/>
</g>
<!-- leaf_72 -->
<g id="node73" class="node">
<title>leaf_72</title>
<polygon fill="none" stroke="#c0c0c0" points="6287,-884.6018 5725,-884.6018 5725,-830.001 6287,-830.001 6287,-884.6018"/>
<text text-anchor="middle" x="6006" y="-853.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;To be a Node, currently, indexed elements of the Array portion must also be </text>
<text text-anchor="middle" x="6006" y="-838.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">Nodes. </text>
</g>
<!-- block_64&#45;&gt;leaf_72 -->
<g id="edge72" class="edge">
<title>block_64&#45;&gt;leaf_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6186.2615,-947.6023C6155.5707,-932.2279 6108.1886,-908.4921 6069.704,-889.2135"/>
<polygon fill="#000000" stroke="#000000" points="6071.1415,-886.019 6060.6329,-884.6694 6068.0062,-892.2777 6071.1415,-886.019"/>
</g>
<!-- leaf_73 -->
<g id="node74" class="node">
<title>leaf_73</title>
<polygon fill="none" stroke="#c0c0c0" points="6853,-884.5019 6305,-884.5019 6305,-830.1009 6853,-830.1009 6853,-884.5019"/>
<text text-anchor="middle" x="6579" y="-869.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;m mostly convinced that indexed elements can also be strings, and that </text>
<text text-anchor="middle" x="6579" y="-853.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">this is the form leaf nodes should take. &#160;Currently, they have a &#39;val&#39; field</text>
<text text-anchor="middle" x="6579" y="-838.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">and no children, which we should replace with a child string at [1].</text>
</g>
<!-- block_65&#45;&gt;leaf_73 -->
<g id="edge73" class="edge">
<title>block_65&#45;&gt;leaf_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6752.8649,-947.372C6723.23,-932.0196 6677.7951,-908.4821 6640.8031,-889.3184"/>
<polygon fill="#000000" stroke="#000000" points="6642.0842,-886.0404 6631.595,-884.5482 6638.8643,-892.2559 6642.0842,-886.0404"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="7405,-884.5019 6871,-884.5019 6871,-830.1009 7405,-830.1009 7405,-884.5019"/>
<text text-anchor="middle" x="7138" y="-869.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">This gives us a lighter way to handle the circumstance where we have, say,</text>
<text text-anchor="middle" x="7138" y="-853.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">a list, =(foo bar baz)=. We currently either need a &quot;left&#45;per&quot; or &quot;pal&quot;</text>
<text text-anchor="middle" x="7138" y="-838.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">Node class to hold the =(=, or we would have to skip it entirely.</text>
</g>
<!-- block_66&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>block_66&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7138,-945.4861C7138,-931.6661 7138,-912.107 7138,-894.9194"/>
<polygon fill="#000000" stroke="#000000" points="7141.5001,-894.5966 7138,-884.5967 7134.5001,-894.5967 7141.5001,-894.5966"/>
</g>
<!-- leaf_75 -->
<g id="node76" class="node">
<title>leaf_75</title>
<polygon fill="none" stroke="#c0c0c0" points="7950.5,-899.8015 7423.5,-899.8015 7423.5,-814.8012 7950.5,-814.8012 7950.5,-899.8015"/>
<text text-anchor="middle" x="7687" y="-884.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">Quipu can&#39;t lose any information from the string, so they have to include</text>
<text text-anchor="middle" x="7687" y="-869.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">whitespace. &#160;We&#39;re not limited in the same way and can reconstruct less </text>
<text text-anchor="middle" x="7687" y="-853.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">semantically crucial parts of a document using the span and the original </text>
<text text-anchor="middle" x="7687" y="-838.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">string, since we&#39;re not /currently/ editing our strings once they&#39;re</text>
<text text-anchor="middle" x="7687" y="-823.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">entered in.</text>
</g>
<!-- block_67&#45;&gt;leaf_75 -->
<g id="edge75" class="edge">
<title>block_67&#45;&gt;leaf_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7517.3757,-947.372C7538.8655,-935.9609 7568.8715,-920.0277 7597.6813,-904.7297"/>
<polygon fill="#000000" stroke="#000000" points="7599.3825,-907.7892 7606.5731,-900.0081 7596.0996,-901.6068 7599.3825,-907.7892"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="8475,-892.5018 7969,-892.5018 7969,-822.101 8475,-822.101 8475,-892.5018"/>
<text text-anchor="middle" x="8222" y="-877.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">Nodes are meant to be broadly compatible with everything we intend to</text>
<text text-anchor="middle" x="8222" y="-861.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">do with abstract syntax trees. &#160;The more I think about this the better</text>
<text text-anchor="middle" x="8222" y="-846.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">it strikes me as an approach. </text>
</g>
<!-- block_68&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>block_68&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7968.8202,-949.0683C8006.4554,-935.4272 8064.6057,-914.3502 8115.6899,-895.8343"/>
<polygon fill="#000000" stroke="#000000" points="8116.9309,-899.1074 8125.1397,-892.4092 8114.5455,-892.5263 8116.9309,-899.1074"/>
</g>
<!-- header_77 -->
<g id="node78" class="node">
<title>header_77</title>
<ellipse fill="none" stroke="#000000" cx="8539" cy="-857.3014" rx="45.9718" ry="18"/>
<text text-anchor="middle" x="8539" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Fields</text>
</g>
<!-- section_69&#45;&gt;header_77 -->
<g id="edge77" class="edge">
<title>section_69&#45;&gt;header_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8820.8417,-957.2923C8758.6309,-949.8 8667.0721,-933.6895 8594,-899.8015 8583.4393,-894.9038 8573.0277,-887.6623 8564.1525,-880.5388"/>
<polygon fill="#000000" stroke="#000000" points="8566.3852,-877.8434 8556.4735,-874.1006 8561.8879,-883.2075 8566.3852,-877.8434"/>
</g>
<!-- block_78 -->
<g id="node79" class="node">
<title>block_78</title>
<ellipse fill="none" stroke="#000000" cx="8669" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="8669" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 202&#45;208</text>
</g>
<!-- section_69&#45;&gt;block_78 -->
<g id="edge78" class="edge">
<title>section_69&#45;&gt;block_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8852.8319,-948.0089C8822.6891,-935.7599 8780.2019,-917.7825 8744,-899.8015 8731.1826,-893.4352 8717.4761,-885.895 8705.3331,-878.9462"/>
<polygon fill="#000000" stroke="#000000" points="8706.8016,-875.7524 8696.3926,-873.7769 8703.2978,-881.8124 8706.8016,-875.7524"/>
</g>
<!-- block_79 -->
<g id="node80" class="node">
<title>block_79</title>
<ellipse fill="none" stroke="#000000" cx="8818" cy="-857.3014" rx="65.0229" ry="18"/>
<text text-anchor="middle" x="8818" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 209&#45;211</text>
</g>
<!-- section_69&#45;&gt;block_79 -->
<g id="edge79" class="edge">
<title>section_69&#45;&gt;block_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8879.4469,-945.4861C8867.575,-928.4482 8849.6251,-902.6877 8836.1866,-883.4017"/>
<polygon fill="#000000" stroke="#000000" points="8838.9564,-881.2544 8830.3677,-875.0507 8833.2131,-885.2563 8838.9564,-881.2544"/>
</g>
<!-- block_80 -->
<g id="node81" class="node">
<title>block_80</title>
<ellipse fill="none" stroke="#000000" cx="8967" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="8967" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 212&#45;215</text>
</g>
<!-- section_69&#45;&gt;block_80 -->
<g id="edge80" class="edge">
<title>section_69&#45;&gt;block_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8904.7227,-945.4861C8916.7551,-928.4482 8934.9475,-902.6877 8948.5676,-883.4017"/>
<polygon fill="#000000" stroke="#000000" points="8951.5554,-885.2382 8954.4652,-875.0507 8945.8375,-881.2001 8951.5554,-885.2382"/>
</g>
<!-- block_81 -->
<g id="node82" class="node">
<title>block_81</title>
<ellipse fill="none" stroke="#000000" cx="9309" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="9309" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 216&#45;220</text>
</g>
<!-- section_69&#45;&gt;block_81 -->
<g id="edge81" class="edge">
<title>section_69&#45;&gt;block_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8943.9702,-950.2659C9021.9619,-930.4033 9168.8146,-893.0033 9250.4748,-872.2064"/>
<polygon fill="#000000" stroke="#000000" points="9251.7575,-875.4915 9260.5844,-869.6317 9250.0299,-868.708 9251.7575,-875.4915"/>
</g>
<!-- block_82 -->
<g id="node83" class="node">
<title>block_82</title>
<ellipse fill="none" stroke="#000000" cx="9694" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="9694" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 221&#45;224</text>
</g>
<!-- section_69&#45;&gt;block_82 -->
<g id="edge82" class="edge">
<title>section_69&#45;&gt;block_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8958.8675,-955.0053C9053.5331,-942.9404 9232.0331,-920.056 9384,-899.8015 9467.0141,-888.7371 9562.4694,-875.5858 9625.275,-866.8737"/>
<polygon fill="#000000" stroke="#000000" points="9626.029,-870.3027 9635.4528,-865.4611 9625.0666,-863.3692 9626.029,-870.3027"/>
</g>
<!-- section_83 -->
<g id="node84" class="node">
<title>section_83</title>
<ellipse fill="none" stroke="#000000" cx="10573" cy="-857.3014" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="10573" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 225&#45;237</text>
</g>
<!-- section_69&#45;&gt;section_83 -->
<g id="edge83" class="edge">
<title>section_69&#45;&gt;section_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8965.0405,-958.887C9238.3572,-941.6198 10199.9041,-880.8724 10489.7142,-862.5631"/>
<polygon fill="#000000" stroke="#000000" points="10489.9786,-866.0535 10499.738,-861.9298 10489.5372,-859.0674 10489.9786,-866.0535"/>
</g>
<!-- header_100 -->
<g id="node101" class="node">
<title>header_100</title>
<ellipse fill="none" stroke="#000000" cx="11258" cy="-857.3014" rx="67.7307" ry="18"/>
<text text-anchor="middle" x="11258" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Other fields</text>
</g>
<!-- section_70&#45;&gt;header_100 -->
<g id="edge100" class="edge">
<title>section_70&#45;&gt;header_100</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13003.0626,-961.021C12799.4453,-954.0477 12218.9322,-932.6141 11737,-899.8015 11593.1461,-890.0071 11425.3809,-874.0848 11331.4402,-864.7605"/>
<polygon fill="#000000" stroke="#000000" points="11331.7677,-861.2759 11321.4701,-863.7681 11331.0743,-868.2415 11331.7677,-861.2759"/>
</g>
<!-- block_101 -->
<g id="node102" class="node">
<title>block_101</title>
<ellipse fill="none" stroke="#000000" cx="11812" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="11812" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 238&#45;243</text>
</g>
<!-- section_70&#45;&gt;block_101 -->
<g id="edge101" class="edge">
<title>section_70&#45;&gt;block_101</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13003.2136,-960.9725C12837.7015,-954.8768 12428.0561,-937.0422 12087,-899.8015 12014.7763,-891.9152 11932.5047,-878.6275 11876.9157,-869.0062"/>
<polygon fill="#000000" stroke="#000000" points="11877.3071,-865.5218 11866.855,-867.2545 11876.1064,-872.4181 11877.3071,-865.5218"/>
</g>
<!-- block_102 -->
<g id="node103" class="node">
<title>block_102</title>
<ellipse fill="none" stroke="#000000" cx="12162" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="12162" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 244&#45;246</text>
</g>
<!-- section_70&#45;&gt;block_102 -->
<g id="edge102" class="edge">
<title>section_70&#45;&gt;block_102</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13009.8995,-955.606C12841.0739,-936.0325 12404.5072,-885.4174 12232.8326,-865.5136"/>
<polygon fill="#000000" stroke="#000000" points="12232.9842,-862.0079 12222.6476,-864.3328 12232.1779,-868.9613 12232.9842,-862.0079"/>
</g>
<!-- block_103 -->
<g id="node104" class="node">
<title>block_103</title>
<ellipse fill="none" stroke="#000000" cx="12723" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="12723" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 247&#45;249</text>
</g>
<!-- section_70&#45;&gt;block_103 -->
<g id="edge103" class="edge">
<title>section_70&#45;&gt;block_103</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13030.8587,-949.3989C12965.244,-929.7699 12846.6626,-894.2957 12777.3868,-873.5715"/>
<polygon fill="#000000" stroke="#000000" points="12778.1193,-870.1374 12767.5357,-870.6245 12776.113,-876.8438 12778.1193,-870.1374"/>
</g>
<!-- block_104 -->
<g id="node105" class="node">
<title>block_104</title>
<ellipse fill="none" stroke="#000000" cx="13078" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="13078" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 250&#45;253</text>
</g>
<!-- section_70&#45;&gt;block_104 -->
<g id="edge104" class="edge">
<title>section_70&#45;&gt;block_104</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13078,-945.4861C13078,-929.0849 13078,-904.6006 13078,-885.5899"/>
<polygon fill="#000000" stroke="#000000" points="13081.5001,-885.4051 13078,-875.4052 13074.5001,-885.4052 13081.5001,-885.4051"/>
</g>
<!-- block_105 -->
<g id="node106" class="node">
<title>block_105</title>
<ellipse fill="none" stroke="#000000" cx="13441" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="13441" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 254&#45;258</text>
</g>
<!-- section_70&#45;&gt;block_105 -->
<g id="edge105" class="edge">
<title>section_70&#45;&gt;block_105</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13125.8292,-949.5085C13193.1262,-929.8199 13315.4398,-894.0356 13386.2782,-873.3109"/>
<polygon fill="#000000" stroke="#000000" points="13387.3062,-876.657 13395.9211,-870.4898 13385.3406,-869.9386 13387.3062,-876.657"/>
</g>
<!-- block_106 -->
<g id="node107" class="node">
<title>block_106</title>
<ellipse fill="none" stroke="#000000" cx="13834" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="13834" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 259&#45;260</text>
</g>
<!-- section_70&#45;&gt;block_106 -->
<g id="edge106" class="edge">
<title>section_70&#45;&gt;block_106</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13143.1105,-954.355C13284.8531,-934.4435 13620.2513,-887.328 13765.2467,-866.9596"/>
<polygon fill="#000000" stroke="#000000" points="13765.9362,-870.3972 13775.3521,-865.54 13764.9624,-863.4653 13765.9362,-870.3972"/>
</g>
<!-- block_107 -->
<g id="node108" class="node">
<title>block_107</title>
<ellipse fill="none" stroke="#000000" cx="14237" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="14237" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 261&#45;263</text>
</g>
<!-- section_70&#45;&gt;block_107 -->
<g id="edge107" class="edge">
<title>section_70&#45;&gt;block_107</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13151.4827,-959.1652C13296.5224,-950.3197 13629.772,-928.5739 13909,-899.8015 13999.0505,-890.5224 14102.586,-876.5534 14168.8439,-867.1903"/>
<polygon fill="#000000" stroke="#000000" points="14169.3369,-870.6555 14178.7463,-865.786 14168.3539,-863.7249 14169.3369,-870.6555"/>
</g>
<!-- block_108 -->
<g id="node109" class="node">
<title>block_108</title>
<ellipse fill="none" stroke="#000000" cx="14589" cy="-857.3014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="14589" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 264&#45;266</text>
</g>
<!-- section_70&#45;&gt;block_108 -->
<g id="edge108" class="edge">
<title>section_70&#45;&gt;block_108</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13153.3227,-962.2512C13346.3855,-958.4748 13874.5128,-944.5403 14312,-899.8015 14385.0173,-892.3345 14468.1711,-878.909 14524.1577,-869.1407"/>
<polygon fill="#000000" stroke="#000000" points="14525.0432,-872.5388 14534.2869,-867.3616 14523.8322,-865.6444 14525.0432,-872.5388"/>
</g>
<!-- codeblock_109 -->
<g id="node110" class="node">
<title>codeblock_109</title>
<ellipse fill="none" stroke="#000000" cx="15194" cy="-857.3014" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15194" y="-853.1014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 267&#45;269</text>
</g>
<!-- section_70&#45;&gt;codeblock_109 -->
<g id="edge109" class="edge">
<title>section_70&#45;&gt;codeblock_109</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13153.1771,-961.5468C13380.8632,-955.398 14082.9104,-934.7554 14664,-899.8015 14818.7156,-890.495 14998.4813,-875.1132 15103.8786,-865.6293"/>
<polygon fill="#000000" stroke="#000000" points="15104.5116,-869.0865 15114.1566,-864.7019 15103.8825,-862.1148 15104.5116,-869.0865"/>
</g>
<!-- leaf_84 -->
<g id="node85" class="node">
<title>leaf_84</title>
<polygon fill="none" stroke="#c0c0c0" points="7557,-645.6011 7503,-645.6011 7503,-609.6011 7557,-609.6011 7557,-645.6011"/>
</g>
<!-- header_77&#45;&gt;leaf_84 -->
<g id="edge84" class="edge">
<title>header_77&#45;&gt;leaf_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8522.8597,-840.443C8512.6968,-831.0349 8498.7441,-820.159 8484,-814.8013 8388.0594,-779.9386 7644.8493,-843.6302 7566,-778.8013 7530.0159,-749.2156 7526.1933,-690.7702 7527.5192,-655.8448"/>
<polygon fill="#000000" stroke="#000000" points="7531.0161,-655.9949 7528.0661,-645.819 7524.0265,-655.6135 7531.0161,-655.9949"/>
</g>
<!-- leaf_85 -->
<g id="node86" class="node">
<title>leaf_85</title>
<polygon fill="none" stroke="#c0c0c0" points="8088.5,-670.2021 7575.5,-670.2021 7575.5,-585 8088.5,-585 8088.5,-670.2021"/>
<text text-anchor="middle" x="7832" y="-639.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;There are invariant fields a Node is also expected to have, they are:</text>
<text text-anchor="middle" x="7832" y="-623.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="7832" y="-608.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; first : &#160;Index into =str= which begins the span.</text>
<text text-anchor="middle" x="7832" y="-593.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; last &#160;: &#160;Index into =str= which ends the span.</text>
</g>
<!-- block_78&#45;&gt;leaf_85 -->
<g id="edge85" class="edge">
<title>block_78&#45;&gt;leaf_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8645.5825,-840.4301C8631.378,-831.1426 8612.4783,-820.3946 8594,-814.8013 8382.0305,-750.6388 8308.8748,-843.276 8097,-778.8013 8023.7966,-756.5251 7948.827,-711.2438 7897.3942,-676.0137"/>
<polygon fill="#000000" stroke="#000000" points="7899.2435,-673.0372 7889.0276,-670.2291 7895.2626,-678.7951 7899.2435,-673.0372"/>
</g>
<!-- leaf_86 -->
<g id="node87" class="node">
<title>leaf_86</title>
<polygon fill="none" stroke="#c0c0c0" points="8591.5,-646.9016 8106.5,-646.9016 8106.5,-608.3005 8591.5,-608.3005 8591.5,-646.9016"/>
<text text-anchor="middle" x="8349" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">In principle, we want the Node to be localized. We could include a </text>
<text text-anchor="middle" x="8349" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">reference to the whole =str= and derive substrings lazily.</text>
</g>
<!-- block_79&#45;&gt;leaf_86 -->
<g id="edge86" class="edge">
<title>block_79&#45;&gt;leaf_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8792.852,-840.5447C8778.9274,-831.8696 8761.0333,-821.6832 8744,-814.8013 8683.2337,-790.2499 8661.5291,-803.9317 8601,-778.8013 8518.2685,-744.453 8430.4852,-686.1001 8383.4932,-652.8247"/>
<polygon fill="#000000" stroke="#000000" points="8385.3782,-649.8702 8375.2039,-646.9148 8381.3145,-655.5699 8385.3782,-649.8702"/>
</g>
<!-- leaf_87 -->
<g id="node88" class="node">
<title>leaf_87</title>
<polygon fill="none" stroke="#c0c0c0" points="9130,-654.8015 8610,-654.8015 8610,-600.4006 9130,-600.4006 9130,-654.8015"/>
<text text-anchor="middle" x="8870" y="-639.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">If we included the full span as a substring on each Node, we&#39;d end up</text>
<text text-anchor="middle" x="8870" y="-624.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">with a lot of spans, and wouldn&#39;t use most of them. Even slicing a piece</text>
<text text-anchor="middle" x="8870" y="-608.701" font-family="Inconsolata" font-size="14.00" fill="#000000">out is costly if we&#39;re not going to use it. </text>
</g>
<!-- block_80&#45;&gt;leaf_87 -->
<g id="edge87" class="edge">
<title>block_80&#45;&gt;leaf_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8959.3886,-839.2772C8943.5197,-801.6989 8906.6268,-714.3351 8885.5324,-664.3825"/>
<polygon fill="#000000" stroke="#000000" points="8888.6497,-662.7673 8881.5351,-654.9166 8882.2011,-665.4905 8888.6497,-662.7673"/>
</g>
<!-- leaf_88 -->
<g id="node89" class="node">
<title>leaf_88</title>
<polygon fill="none" stroke="#c0c0c0" points="9661.5,-662.2023 9148.5,-662.2023 9148.5,-592.9998 9661.5,-592.9998 9661.5,-662.2023"/>
<text text-anchor="middle" x="9405" y="-647.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">So our constructor for a Node class takes (Constructor, node, str) as </text>
<text text-anchor="middle" x="9405" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">the standard interface. &#160;If a module needs a non&#45;standard constructor,</text>
<text text-anchor="middle" x="9405" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">as our Section and Block modules currently take an array of lines, that</text>
<text text-anchor="middle" x="9405" y="-601.001" font-family="Inconsolata" font-size="14.00" fill="#000000">will need to be provided as the second return from the module. </text>
</g>
<!-- block_81&#45;&gt;leaf_88 -->
<g id="edge88" class="edge">
<title>block_81&#45;&gt;leaf_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9316.533,-839.2772C9331.482,-803.5084 9365.2826,-722.6333 9386.5072,-671.8491"/>
<polygon fill="#000000" stroke="#000000" points="9389.8189,-673.0015 9390.4457,-662.4252 9383.3602,-670.3021 9389.8189,-673.0015"/>
</g>
<!-- leaf_89 -->
<g id="node90" class="node">
<title>leaf_89</title>
<polygon fill="none" stroke="#c0c0c0" points="10178.5,-654.9015 9679.5,-654.9015 9679.5,-600.3006 10178.5,-600.3006 10178.5,-654.9015"/>
<text text-anchor="middle" x="9929" y="-639.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">This will allow for the kind of multi&#45;pass recursive&#45;descent that I&#39;m</text>
<text text-anchor="middle" x="9929" y="-624.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">aiming for. </text>
</g>
<!-- block_82&#45;&gt;leaf_89 -->
<g id="edge89" class="edge">
<title>block_82&#45;&gt;leaf_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9712.0498,-839.6586C9750.8742,-801.7098 9842.9082,-711.7513 9893.7433,-662.0627"/>
<polygon fill="#000000" stroke="#000000" points="9896.2286,-664.5277 9900.9333,-655.0348 9891.3356,-659.5218 9896.2286,-664.5277"/>
</g>
<!-- header_90 -->
<g id="node91" class="node">
<title>header_90</title>
<ellipse fill="none" stroke="#000000" cx="10305" cy="-627.6011" rx="108.8185" ry="18"/>
<text text-anchor="middle" x="10305" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : line tracking (optional)</text>
</g>
<!-- section_83&#45;&gt;header_90 -->
<g id="edge90" class="edge">
<title>section_83&#45;&gt;header_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10532.9481,-841.9147C10501.0183,-828.3983 10456.2944,-806.5684 10423,-778.8013 10379.2901,-742.3478 10341.3436,-687.1665 10320.9508,-654.5178"/>
<polygon fill="#000000" stroke="#000000" points="10323.8952,-652.6242 10315.6742,-645.941 10317.9331,-656.2922 10323.8952,-652.6242"/>
</g>
<!-- block_91 -->
<g id="node92" class="node">
<title>block_91</title>
<ellipse fill="none" stroke="#000000" cx="10498" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="10498" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 225&#45;228</text>
</g>
<!-- section_83&#45;&gt;block_91 -->
<g id="edge91" class="edge">
<title>section_83&#45;&gt;block_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10567.1149,-839.2772C10554.0532,-799.2734 10522.5697,-702.8499 10507.0117,-655.2009"/>
<polygon fill="#000000" stroke="#000000" points="10510.2889,-653.9613 10503.8578,-645.5415 10503.6346,-656.134 10510.2889,-653.9613"/>
</g>
<!-- block_92 -->
<g id="node93" class="node">
<title>block_92</title>
<ellipse fill="none" stroke="#000000" cx="10647" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="10647" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 229&#45;231</text>
</g>
<!-- section_83&#45;&gt;block_92 -->
<g id="edge92" class="edge">
<title>section_83&#45;&gt;block_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10578.8067,-839.2772C10591.6942,-799.2734 10622.7579,-702.8499 10638.1085,-655.2009"/>
<polygon fill="#000000" stroke="#000000" points="10641.4853,-656.1331 10641.2203,-645.5415 10634.8225,-653.9865 10641.4853,-656.1331"/>
</g>
<!-- block_93 -->
<g id="node94" class="node">
<title>block_93</title>
<ellipse fill="none" stroke="#000000" cx="10796" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="10796" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 232&#45;234</text>
</g>
<!-- section_83&#45;&gt;block_93 -->
<g id="edge93" class="edge">
<title>section_83&#45;&gt;block_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10617.1029,-842.5882C10649.4974,-829.9276 10692.7763,-808.9076 10722,-778.8013 10756.5316,-743.2269 10777.7925,-688.4053 10788.2072,-655.4665"/>
<polygon fill="#000000" stroke="#000000" points="10791.6488,-656.1789 10791.2105,-645.5932 10784.9517,-654.1417 10791.6488,-656.1789"/>
</g>
<!-- block_94 -->
<g id="node95" class="node">
<title>block_94</title>
<ellipse fill="none" stroke="#000000" cx="10945" cy="-627.6011" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="10945" y="-623.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 235&#45;237</text>
</g>
<!-- section_83&#45;&gt;block_94 -->
<g id="edge94" class="edge">
<title>section_83&#45;&gt;block_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10635.3759,-847.1483C10711.7006,-833.6738 10835.2084,-808.1381 10871,-778.8013 10909.8167,-746.985 10929.8557,-689.8123 10938.8422,-655.6212"/>
<polygon fill="#000000" stroke="#000000" points="10942.2673,-656.3508 10941.2848,-645.8016 10935.4743,-654.661 10942.2673,-656.3508"/>
</g>
<!-- leaf_95 -->
<g id="node96" class="node">
<title>leaf_95</title>
<polygon fill="none" stroke="#c0c0c0" points="9929,-238.2004 9875,-238.2004 9875,-202.2004 9929,-202.2004 9929,-238.2004"/>
</g>
<!-- header_90&#45;&gt;leaf_95 -->
<g id="edge95" class="edge">
<title>header_90&#45;&gt;leaf_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10296.6798,-609.4822C10280.6185,-576.7783 10242.0066,-508.3239 10187,-476.4008 10090.2892,-420.2747 10017.7936,-518.734 9938,-440.4008 9886.3249,-389.6715 9890.9227,-295.6119 9897.1641,-248.5546"/>
<polygon fill="#000000" stroke="#000000" points="9900.657,-248.8548 9898.6267,-238.4563 9893.7293,-247.8513 9900.657,-248.8548"/>
</g>
<!-- leaf_96 -->
<g id="node97" class="node">
<title>leaf_96</title>
<polygon fill="none" stroke="#c0c0c0" points="10439,-240.1025 9947,-240.1025 9947,-200.2983 10439,-200.2983 10439,-240.1025"/>
<text text-anchor="middle" x="10193" y="-208.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">It may be wise to always track lines, in which case we will include:</text>
</g>
<!-- block_91&#45;&gt;leaf_96 -->
<g id="edge96" class="edge">
<title>block_91&#45;&gt;leaf_96</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10490.9151,-609.5137C10479.0465,-580.2468 10453.43,-521.2628 10423,-476.4008 10360.8618,-384.7923 10268.2644,-291.6514 10221.7935,-247.1345"/>
<polygon fill="#000000" stroke="#000000" points="10224.1286,-244.525 10214.4745,-240.1605 10219.2997,-249.5928 10224.1286,-244.525"/>
</g>
<!-- leaf_97 -->
<g id="node98" class="node">
<title>leaf_97</title>
<polygon fill="none" stroke="#c0c0c0" points="10837,-239.501 10457,-239.501 10457,-200.8998 10837,-200.8998 10837,-239.501"/>
<text text-anchor="middle" x="10647" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; line_first : &#160;The line at which the match begins</text>
<text text-anchor="middle" x="10647" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; line_last &#160;: &#160;The line at which the match ends</text>
</g>
<!-- block_92&#45;&gt;leaf_97 -->
<g id="edge97" class="edge">
<title>block_92&#45;&gt;leaf_97</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10647,-609.5699C10647,-545.7393 10647,-330.0612 10647,-250.236"/>
<polygon fill="#000000" stroke="#000000" points="10650.5001,-249.9039 10647,-239.9039 10643.5001,-249.904 10650.5001,-249.9039"/>
</g>
<!-- leaf_98 -->
<g id="node99" class="node">
<title>leaf_98</title>
<polygon fill="none" stroke="#c0c0c0" points="11410.5,-239.501 10855.5,-239.501 10855.5,-200.8998 11410.5,-200.8998 11410.5,-239.501"/>
<text text-anchor="middle" x="11133" y="-224.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">This is, at least, a frequent enough pattern that the metatable should return</text>
<text text-anchor="middle" x="11133" y="-209.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">a negative number if these aren&#39;t assigned. </text>
</g>
<!-- block_93&#45;&gt;leaf_98 -->
<g id="edge98" class="edge">
<title>block_93&#45;&gt;leaf_98</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10802.6005,-609.266C10813.7635,-579.6514 10838.286,-520.1893 10870,-476.4008 10939.3505,-380.6465 11046.2671,-289.156 11099.9099,-246.0158"/>
<polygon fill="#000000" stroke="#000000" points="11102.1107,-248.7373 11107.7377,-239.7602 11097.7407,-243.269 11102.1107,-248.7373"/>
</g>
<!-- leaf_99 -->
<g id="node100" class="node">
<title>leaf_99</title>
<polygon fill="none" stroke="#c0c0c0" points="11829.5,-240.1025 11428.5,-240.1025 11428.5,-200.2983 11829.5,-200.2983 11829.5,-240.1025"/>
<text text-anchor="middle" x="11629" y="-224.7004" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; [ ] #todo decide if line tracking is in fact optional</text>
</g>
<!-- block_94&#45;&gt;leaf_99 -->
<g id="edge99" class="edge">
<title>block_94&#45;&gt;leaf_99</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10948.1173,-609.4214C10954.7967,-576.6185 10973.8135,-508.0092 11020,-476.4008 11093.4692,-426.1211 11338.8184,-479.0878 11419,-440.4008 11509.029,-396.9625 11580.7002,-297.4339 11611.9652,-248.4657"/>
<polygon fill="#000000" stroke="#000000" points="11614.9686,-250.2643 11617.3282,-239.9356 11609.0425,-246.5385 11614.9686,-250.2643"/>
</g>
<!-- leaf_110 -->
<g id="node111" class="node">
<title>leaf_110</title>
<polygon fill="none" stroke="#c0c0c0" points="11083,-645.6011 11029,-645.6011 11029,-609.6011 11083,-609.6011 11083,-645.6011"/>
</g>
<!-- header_100&#45;&gt;leaf_110 -->
<g id="edge110" class="edge">
<title>header_100&#45;&gt;leaf_110</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11206.3075,-845.6154C11169.1464,-834.5534 11120.7149,-814.2086 11092,-778.8013 11063.4442,-743.5902 11056.8643,-689.4733 11055.7146,-656.4311"/>
<polygon fill="#000000" stroke="#000000" points="11059.2073,-656.0196 11055.5091,-646.0912 11052.2086,-656.1588 11059.2073,-656.0196"/>
</g>
<!-- leaf_111 -->
<g id="node112" class="node">
<title>leaf_111</title>
<polygon fill="none" stroke="#c0c0c0" points="11656.5,-662.8014 11101.5,-662.8014 11101.5,-592.4007 11656.5,-592.4007 11656.5,-662.8014"/>
<text text-anchor="middle" x="11379" y="-631.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The way the Grammar class will work: each =V&quot;patt&quot;= can have a metatable.</text>
<text text-anchor="middle" x="11379" y="-616.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">These are passed in as the second parameter during construction, with the key</text>
<text text-anchor="middle" x="11379" y="-600.701" font-family="Inconsolata" font-size="14.00" fill="#000000">the same name as the rule. </text>
</g>
<!-- block_101&#45;&gt;leaf_111 -->
<g id="edge111" class="edge">
<title>block_101&#45;&gt;leaf_111</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11781.5523,-841.1493C11714.1636,-805.4006 11550.7371,-718.7052 11454.1049,-667.4431"/>
<polygon fill="#000000" stroke="#000000" points="11455.7292,-664.3428 11445.255,-662.7484 11452.4487,-670.5266 11455.7292,-664.3428"/>
</g>
<!-- leaf_112 -->
<g id="node113" class="node">
<title>leaf_112</title>
<polygon fill="none" stroke="#c0c0c0" points="12237,-646.9016 11675,-646.9016 11675,-608.3005 12237,-608.3005 12237,-646.9016"/>
<text text-anchor="middle" x="11956" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">If a pattern doesn&#39;t have a metatable, it&#39;s given a Node class and consists of</text>
<text text-anchor="middle" x="11956" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">only the above fields, plus an array representing any subrules. </text>
</g>
<!-- block_102&#45;&gt;leaf_112 -->
<g id="edge112" class="edge">
<title>block_102&#45;&gt;leaf_112</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12146.1776,-839.6586C12110.3009,-799.6543 12022.5911,-701.8534 11979.9958,-654.3576"/>
<polygon fill="#000000" stroke="#000000" points="11982.6004,-652.0196 11973.3181,-646.9117 11977.3891,-656.6932 11982.6004,-652.0196"/>
</g>
<!-- leaf_113 -->
<g id="node114" class="node">
<title>leaf_113</title>
<polygon fill="none" stroke="#c0c0c0" points="12775,-646.9016 12255,-646.9016 12255,-608.3005 12775,-608.3005 12775,-646.9016"/>
<text text-anchor="middle" x="12515" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">If it does, the metatable will have a =__call= method, which expects two</text>
<text text-anchor="middle" x="12515" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">parameters, itself, and the node, which will include the span. </text>
</g>
<!-- block_103&#45;&gt;leaf_113 -->
<g id="edge113" class="edge">
<title>block_103&#45;&gt;leaf_113</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12707.024,-839.6586C12670.799,-799.6543 12582.2376,-701.8534 12539.2288,-654.3576"/>
<polygon fill="#000000" stroke="#000000" points="12541.793,-651.9749 12532.4863,-646.9117 12536.6042,-656.6735 12541.793,-651.9749"/>
</g>
<!-- leaf_114 -->
<g id="node115" class="node">
<title>leaf_114</title>
<polygon fill="none" stroke="#c0c0c0" points="13362.5,-654.8015 12793.5,-654.8015 12793.5,-600.4006 13362.5,-600.4006 13362.5,-654.8015"/>
<text text-anchor="middle" x="13078" y="-639.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">This will require reattunement of basically every class in the =/grym= folder,</text>
<text text-anchor="middle" x="13078" y="-624.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">but let&#39;s build the Prose parse first. &#160;I do want the whole shebang in a single</text>
<text text-anchor="middle" x="13078" y="-608.701" font-family="Inconsolata" font-size="14.00" fill="#000000">grammar eventually.</text>
</g>
<!-- block_104&#45;&gt;leaf_114 -->
<g id="edge114" class="edge">
<title>block_104&#45;&gt;leaf_114</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13078,-839.2772C13078,-801.8555 13078,-715.0622 13078,-665.0088"/>
<polygon fill="#000000" stroke="#000000" points="13081.5001,-664.9166 13078,-654.9166 13074.5001,-664.9166 13081.5001,-664.9166"/>
</g>
<!-- leaf_115 -->
<g id="node116" class="node">
<title>leaf_115</title>
<polygon fill="none" stroke="#c0c0c0" points="13929,-662.2023 13381,-662.2023 13381,-592.9998 13929,-592.9998 13929,-662.2023"/>
<text text-anchor="middle" x="13655" y="-647.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">The intention is to allow multiple grammars to coexist peacefully. Currently</text>
<text text-anchor="middle" x="13655" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">the parser is handrolled and we have special case values for everything.</text>
<text text-anchor="middle" x="13655" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">The idea is to stabilize this, so that multi&#45;pass parsing works but in a</text>
<text text-anchor="middle" x="13655" y="-601.001" font-family="Inconsolata" font-size="14.00" fill="#000000">standard way where the Node constructor is a consistent interface. </text>
</g>
<!-- block_105&#45;&gt;leaf_115 -->
<g id="edge115" class="edge">
<title>block_105&#45;&gt;leaf_115</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13457.4369,-839.6586C13490.9506,-803.6861 13568.0036,-720.98 13615.3683,-670.1404"/>
<polygon fill="#000000" stroke="#000000" points="13618.1622,-672.276 13622.418,-662.5735 13613.0405,-667.5044 13618.1622,-672.276"/>
</g>
<!-- leaf_116 -->
<g id="node117" class="node">
<title>leaf_116</title>
<polygon fill="none" stroke="#c0c0c0" points="14208.5,-645.6011 13947.5,-645.6011 13947.5,-609.6011 14208.5,-609.6011 14208.5,-645.6011"/>
<text text-anchor="middle" x="14078" y="-624.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">In the meantime we have things like</text>
</g>
<!-- block_106&#45;&gt;leaf_116 -->
<g id="edge116" class="edge">
<title>block_106&#45;&gt;leaf_116</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13858.9194,-840.3801C13880.6147,-825.2146 13912.497,-801.8646 13938,-778.8013 13983.0608,-738.0512 14029.9465,-684.828 14056.4062,-653.6133"/>
<polygon fill="#000000" stroke="#000000" points="14059.2258,-655.6988 14062.9944,-645.7969 14053.8734,-651.1874 14059.2258,-655.6988"/>
</g>
<!-- leaf_117 -->
<g id="node118" class="node">
<title>leaf_117</title>
<polygon fill="none" stroke="#c0c0c0" points="14753.5,-646.9016 14226.5,-646.9016 14226.5,-608.3005 14753.5,-608.3005 14753.5,-646.9016"/>
<text text-anchor="middle" x="14490" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; lines : &#160;If this exists, there&#39;s a collection of lines which need to be</text>
<text text-anchor="middle" x="14490" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;joined with =\n= to reconstruct the actual span.</text>
</g>
<!-- block_107&#45;&gt;leaf_117 -->
<g id="edge117" class="edge">
<title>block_107&#45;&gt;leaf_117</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14256.0161,-840.0365C14299.9575,-800.1419 14408.7681,-701.352 14461.0491,-653.8858"/>
<polygon fill="#000000" stroke="#000000" points="14463.5861,-656.3098 14468.6372,-646.9965 14458.8807,-651.1271 14463.5861,-656.3098"/>
</g>
<!-- leaf_118 -->
<g id="node119" class="node">
<title>leaf_118</title>
<polygon fill="none" stroke="#c0c0c0" points="15320,-646.9016 14772,-646.9016 14772,-608.3005 15320,-608.3005 15320,-646.9016"/>
<text text-anchor="middle" x="15046" y="-631.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;We want to do this the other way, and use the span itself for the</text>
<text text-anchor="middle" x="15046" y="-616.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;inner parse. </text>
</g>
<!-- block_108&#45;&gt;leaf_118 -->
<g id="edge118" class="edge">
<title>block_108&#45;&gt;leaf_118</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14624.4273,-842.0103C14659.6118,-826.6407 14714.9539,-801.9698 14762,-778.8013 14848.3925,-736.2561 14947.2261,-682.4409 15002.5624,-651.8306"/>
<polygon fill="#000000" stroke="#000000" points="15004.3388,-654.8478 15011.3901,-646.9401 15000.9466,-648.7246 15004.3388,-654.8478"/>
</g>
<!-- leaf_119 -->
<g id="node120" class="node">
<title>leaf_119</title>
<polygon fill="none" stroke="#c0c0c0" points="15410,-645.6011 15338,-645.6011 15338,-609.6011 15410,-609.6011 15410,-645.6011"/>
<text text-anchor="middle" x="15374" y="-624.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">return N</text>
</g>
<!-- codeblock_109&#45;&gt;leaf_119 -->
<g id="edge119" class="edge">
<title>codeblock_109&#45;&gt;leaf_119</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15238.2171,-841.6568C15267.8985,-829.0152 15305.6958,-808.4174 15329,-778.8013 15357.4544,-742.6402 15367.9423,-688.8202 15371.7905,-656.0944"/>
<polygon fill="#000000" stroke="#000000" points="15375.3015,-656.1698 15372.8573,-645.8607 15368.3392,-655.4439 15375.3015,-656.1698"/>
</g>
</g>
</svg>