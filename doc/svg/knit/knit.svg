<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1596pt" height="1916pt"
 viewBox="0.00 0.00 1596.10 1916.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1912.4027)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1912.4027 1592.0964,-1912.4027 1592.0964,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="266.0964" cy="-1890.4027" rx="46.1547" ry="18"/>
<text text-anchor="middle" x="266.0964" y="-1886.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 118</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="266.0964" cy="-1818.4027" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="266.0964" y="-1814.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;39</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M266.0964,-1872.234C266.0964,-1864.5336 266.0964,-1855.377 266.0964,-1846.8193"/>
<polygon fill="#000000" stroke="#000000" points="269.5965,-1846.8159 266.0964,-1836.816 262.5965,-1846.816 269.5965,-1846.8159"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="69.0964" cy="-1746.4027" rx="69.1929" ry="18"/>
<text text-anchor="middle" x="69.0964" y="-1742.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Knit module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M227.6451,-1804.3494C196.6634,-1793.0262 152.8648,-1777.0186 119.1498,-1764.6963"/>
<polygon fill="#000000" stroke="#000000" points="120.0761,-1761.3085 109.4823,-1761.163 117.6732,-1767.8832 120.0761,-1761.3085"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="205.0964" cy="-1746.4027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="205.0964" y="-1742.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M251.0177,-1800.6049C243.4103,-1791.6256 234.0658,-1780.5961 225.7966,-1770.8358"/>
<polygon fill="#000000" stroke="#000000" points="228.2999,-1768.3759 219.1652,-1763.0085 222.9589,-1772.9009 228.2999,-1768.3759"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="336.0964" cy="-1746.4027" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="336.0964" y="-1742.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 4&#45;37</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M283.0414,-1800.9735C291.7471,-1792.019 302.5051,-1780.9537 312.0532,-1771.1328"/>
<polygon fill="#000000" stroke="#000000" points="314.6034,-1773.5307 319.0647,-1763.9209 309.5844,-1768.6511 314.6034,-1773.5307"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="857.0964" cy="-1746.4027" rx="69.851" ry="18"/>
<text text-anchor="middle" x="857.0964" y="-1742.2027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 40&#45;118</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M322.4962,-1811.5316C430.0109,-1798.4334 664.2072,-1769.9019 783.7332,-1755.3403"/>
<polygon fill="#000000" stroke="#000000" points="784.3826,-1758.7872 793.886,-1754.1034 783.5361,-1751.8386 784.3826,-1758.7872"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="117.0964,-1465.9023 3.0964,-1465.9023 3.0964,-1429.9023 117.0964,-1429.9023 117.0964,-1465.9023"/>
<text text-anchor="middle" x="60.0964" y="-1444.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> * Knit module</text>
</g>
<!-- header_2&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>header_2&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M68.5469,-1728.1795C67.0312,-1677.9078 62.7823,-1536.9846 60.9524,-1476.2935"/>
<polygon fill="#000000" stroke="#000000" points="64.4499,-1476.1562 60.6501,-1466.2663 57.4531,-1476.3672 64.4499,-1476.1562"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="162.0964" cy="-1447.9023" rx="27" ry="18"/>
<text text-anchor="middle" x="162.0964" y="-1443.7023" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.4713,-1728.1795C195.2122,-1677.7884 174.8325,-1536.3146 166.1241,-1475.8624"/>
<polygon fill="#000000" stroke="#000000" points="169.5773,-1475.2857 164.6871,-1465.887 162.6488,-1476.2839 169.5773,-1475.2857"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="531.0964,-1692.4031 207.0964,-1692.4031 207.0964,-1203.4015 531.0964,-1203.4015 531.0964,-1692.4031"/>
<text text-anchor="middle" x="369.0964" y="-1677.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1645.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1630.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;ansi&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1615.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = true</text>
<text text-anchor="middle" x="369.0964" y="-1583.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1568.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1552.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1537.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="369.0964" y="-1522.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="369.0964" y="-1506.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="369.0964" y="-1491.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="369.0964" y="-1475.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="369.0964" y="-1460.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="369.0964" y="-1445.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="369.0964" y="-1429.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="369.0964" y="-1414.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local delete = pl_file.delete</text>
<text text-anchor="middle" x="369.0964" y="-1398.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="369.0964" y="-1367.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1336.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local knitter = require &quot;knit/knitter&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1304.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="369.0964" y="-1289.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="369.0964" y="-1273.802" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="369.0964" y="-1258.402" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="369.0964" y="-1243.002" font-family="Inconsolata" font-size="14.00" fill="#000000">local writeOnChange = walk.writeOnChange</text>
<text text-anchor="middle" x="369.0964" y="-1211.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>codeblock_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M338.111,-1728.1795C338.8719,-1721.2967 339.8207,-1712.7147 340.9088,-1702.872"/>
<polygon fill="#000000" stroke="#000000" points="344.4215,-1702.9494 342.0416,-1692.6253 337.4639,-1702.1801 344.4215,-1702.9494"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="678.0964" cy="-1447.9023" rx="128.6478" ry="18"/>
<text text-anchor="middle" x="678.0964" y="-1443.7023" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : knit_dir(knitter, pwd, depth)</text>
</g>
<!-- section_5&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M842.4195,-1728.3572C834.304,-1718.0705 824.2445,-1704.7955 816.0964,-1692.4027 765.9715,-1616.1659 715.3677,-1520.6962 691.7843,-1474.879"/>
<polygon fill="#000000" stroke="#000000" points="694.8481,-1473.1831 687.1719,-1465.8806 688.6188,-1476.3761 694.8481,-1473.1831"/>
</g>
<!-- prose_11 -->
<g id="node12" class="node">
<title>prose_11</title>
<ellipse fill="none" stroke="#000000" cx="857.0964" cy="-1447.9023" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="857.0964" y="-1443.7023" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;prose_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.0964,-1728.1795C857.0964,-1677.9078 857.0964,-1536.9846 857.0964,-1476.2935"/>
<polygon fill="#000000" stroke="#000000" points="860.5965,-1476.2662 857.0964,-1466.2663 853.5965,-1476.2663 860.5965,-1476.2662"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="939.0964" cy="-1447.9023" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="939.0964" y="-1443.7023" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873.9402,-1728.8249C882.5078,-1718.8902 892.3081,-1705.802 898.0964,-1692.4027 929.8576,-1618.8787 937.1082,-1523.0574 938.6995,-1476.201"/>
<polygon fill="#000000" stroke="#000000" points="942.2061,-1476.0051 938.9828,-1465.9125 935.2088,-1475.8123 942.2061,-1476.0051"/>
</g>
<!-- codeblock_13 -->
<g id="node14" class="node">
<title>codeblock_13</title>
<ellipse fill="none" stroke="#000000" cx="1179.0964" cy="-1447.9023" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="1179.0964" y="-1443.7023" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 48&#45;117</text>
</g>
<!-- section_5&#45;&gt;codeblock_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;codeblock_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M901.9495,-1732.5395C926.5533,-1723.5611 956.7152,-1710.2016 980.0964,-1692.4027 1063.3513,-1629.025 1133.2399,-1523.9498 1163.2948,-1474.8014"/>
<polygon fill="#000000" stroke="#000000" points="1166.4242,-1476.3903 1168.6024,-1466.0218 1160.4337,-1472.7688 1166.4242,-1476.3903"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="189.0964,-657.0031 135.0964,-657.0031 135.0964,-617.1989 189.0964,-617.1989 189.0964,-657.0031"/>
<text text-anchor="middle" x="162.0964" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162.0964,-1429.8308C162.0964,-1325.401 162.0964,-799.2361 162.0964,-667.1935"/>
<polygon fill="#000000" stroke="#000000" points="165.5965,-667.0099 162.0964,-657.01 158.5965,-667.01 165.5965,-667.0099"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="801.5964,-655.101 554.5964,-655.101 554.5964,-619.101 801.5964,-619.101 801.5964,-655.101"/>
<text text-anchor="middle" x="678.0964" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">*** knit_dir(knitter, pwd, depth)</text>
</g>
<!-- header_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>header_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M678.0964,-1429.8308C678.0964,-1324.9383 678.0964,-794.5647 678.0964,-665.4615"/>
<polygon fill="#000000" stroke="#000000" points="681.5965,-665.2161 678.0964,-655.2161 674.5965,-665.2162 681.5965,-665.2161"/>
</g>
<!-- raw_15 -->
<g id="node16" class="node">
<title>raw_15</title>
<ellipse fill="none" stroke="#000000" cx="852.0964" cy="-637.101" rx="27" ry="18"/>
<text text-anchor="middle" x="852.0964" y="-632.901" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_11&#45;&gt;raw_15 -->
<g id="edge15" class="edge">
<title>prose_11&#45;&gt;raw_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M856.9849,-1429.8308C856.3381,-1324.9383 853.0674,-794.5647 852.2713,-665.4615"/>
<polygon fill="#000000" stroke="#000000" points="855.7698,-665.1943 852.2081,-655.2161 848.7699,-665.2376 855.7698,-665.1943"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="939.0964" cy="-637.101" rx="27" ry="18"/>
<text text-anchor="middle" x="939.0964" y="-632.901" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_12&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_12&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M939.0964,-1429.8308C939.0964,-1324.9383 939.0964,-794.5647 939.0964,-665.4615"/>
<polygon fill="#000000" stroke="#000000" points="942.5965,-665.2161 939.0964,-655.2161 935.5965,-665.2162 942.5965,-665.2161"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1588.0964,-1167.2029 984.0964,-1167.2029 984.0964,-106.9991 1588.0964,-106.9991 1588.0964,-1167.2029"/>
<text text-anchor="middle" x="1286.0964" y="-1152.2019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_dir(knitter, orb_dir, pwd)</text>
<text text-anchor="middle" x="1286.0964" y="-1136.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local knits = {}</text>
<text text-anchor="middle" x="1286.0964" y="-1121.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(orb_dir, false, false) do</text>
<text text-anchor="middle" x="1286.0964" y="-1106.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1286.0964" y="-1090.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1286.0964" y="-1059.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1286.0964" y="-1043.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot; &#160;* &quot; .. dir)</text>
<text text-anchor="middle" x="1286.0964" y="-1028.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1286.0964" y="-1013.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1286.0964" y="-997.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1286.0964" y="-982.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; read and knit</text>
<text text-anchor="middle" x="1286.0964" y="-966.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:verb(&quot; &#160;&#160;&#160;&#45; &quot; .. f)</text>
<text text-anchor="middle" x="1286.0964" y="-951.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1286.0964" y="-936.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local knitted = knitter:knit(Doc(orb_f))</text>
<text text-anchor="middle" x="1286.0964" y="-920.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local src_dir = subLastFor(&quot;/orb&quot;, &quot;/src&quot;, dirname(f))</text>
<text text-anchor="middle" x="1286.0964" y="-905.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(src_dir)</text>
<text text-anchor="middle" x="1286.0964" y="-889.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; 4 == #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1286.0964" y="-874.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = src_dir .. &quot;/&quot; .. bare_name .. &quot;.lua&quot;</text>
<text text-anchor="middle" x="1286.0964" y="-859.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local current_src = read(out_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1286.0964" y="-843.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local changed = writeOnChange(knitted, current_src, out_name, 0)</text>
<text text-anchor="middle" x="1286.0964" y="-828.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if changed then</text>
<text text-anchor="middle" x="1286.0964" y="-812.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_dir = &quot;../tmp&quot; .. src_dir</text>
<text text-anchor="middle" x="1286.0964" y="-797.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(tmp_dir)</text>
<text text-anchor="middle" x="1286.0964" y="-782.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_out = &quot;../tmp&quot; .. out_name</text>
<text text-anchor="middle" x="1286.0964" y="-766.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(tmp_out, current_src)</text>
<text text-anchor="middle" x="1286.0964" y="-751.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;knits[#knits + 1] = out_name</text>
<text text-anchor="middle" x="1286.0964" y="-735.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end &#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="1286.0964" y="-720.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-705.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-689.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-674.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-610.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; collect changed files if any</text>
<text text-anchor="middle" x="1286.0964" y="-595.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local grymbacks = &quot;&quot;</text>
<text text-anchor="middle" x="1286.0964" y="-580.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(knits) do</text>
<text text-anchor="middle" x="1286.0964" y="-564.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;grymbacks = grymbacks .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1286.0964" y="-549.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-533.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if grymbacks ~= &quot;&quot; then</text>
<text text-anchor="middle" x="1286.0964" y="-518.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;grymbacks: \n&quot; .. grymbacks)</text>
<text text-anchor="middle" x="1286.0964" y="-503.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-487.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; if nothing changes, no rollback is needed, empty file</text>
<text text-anchor="middle" x="1286.0964" y="-472.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;write(pwd .. &quot;/.grymback&quot;, grymbacks)</text>
<text text-anchor="middle" x="1286.0964" y="-456.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1286.0964" y="-441.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1286.0964" y="-410.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_all(knitter, pwd)</text>
<text text-anchor="middle" x="1286.0964" y="-394.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local did_knit = false</text>
<text text-anchor="middle" x="1286.0964" y="-379.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1286.0964" y="-363.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1286.0964" y="-348.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1286.0964" y="-317.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Knit: &quot; .. dir))</text>
<text text-anchor="middle" x="1286.0964" y="-301.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;did_knit = knit_dir(knitter, dir, pwd)</text>
<text text-anchor="middle" x="1286.0964" y="-286.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-270.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-255.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not did_knit then</text>
<text text-anchor="middle" x="1286.0964" y="-240.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;No orb directory to knit. No action taken.&quot;)</text>
<text text-anchor="middle" x="1286.0964" y="-224.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1286.0964" y="-209.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return did_knit</text>
<text text-anchor="middle" x="1286.0964" y="-193.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1286.0964" y="-162.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">knitter.knit_all = knit_all</text>
<text text-anchor="middle" x="1286.0964" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">return knitter</text>
</g>
<!-- codeblock_13&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_13&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1181.4812,-1429.8308C1186.6497,-1390.6663 1199.646,-1292.1856 1214.791,-1177.4229"/>
<polygon fill="#000000" stroke="#000000" points="1218.2821,-1177.72 1216.1206,-1167.348 1211.3423,-1176.8041 1218.2821,-1177.72"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="874.5964,-70.7004 459.5964,-70.7004 459.5964,-.0997 874.5964,-.0997 874.5964,-70.7004"/>
<text text-anchor="middle" x="667.0964" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, kniting the contents of =/org/=</text>
<text text-anchor="middle" x="667.0964" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/src/=. </text>
</g>
<!-- raw_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M856.4664,-619.0762C872.8362,-547.0472 923.9645,-275.6311 810.0964,-106.8001 802.028,-94.8372 791.3372,-84.7882 779.4224,-76.3693"/>
<polygon fill="#000000" stroke="#000000" points="781.2672,-73.3933 770.9952,-70.7978 777.4067,-79.2325 781.2672,-73.3933"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1357.0964,-62.7005 893.0964,-62.7005 893.0964,-8.0996 1357.0964,-8.0996 1357.0964,-62.7005"/>
<text text-anchor="middle" x="1125.0964" y="-31.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [X] TODO fix up the orb/notes directory so it doesn&#39;t explode</text>
<text text-anchor="middle" x="1125.0964" y="-16.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;the knit.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M934.3808,-619.0432C916.6571,-546.8887 860.6847,-275.0596 975.0964,-106.8001 986.2825,-90.3491 1002.3304,-77.5798 1019.8079,-67.7024"/>
<polygon fill="#000000" stroke="#000000" points="1021.8646,-70.5735 1029.0597,-62.7966 1018.5852,-64.3892 1021.8646,-70.5735"/>
</g>
</g>
</svg>