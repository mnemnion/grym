<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1687pt" height="1949pt"
 viewBox="0.00 0.00 1687.10 1949.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1945.4028)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1945.4028 1683.0964,-1945.4028 1683.0964,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="249.0964" cy="-1923.4028" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="249.0964" y="-1919.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 127</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="249.0964" cy="-1851.4028" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="249.0964" y="-1847.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;38</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M249.0964,-1905.2342C249.0964,-1897.5338 249.0964,-1888.3772 249.0964,-1879.8195"/>
<polygon fill="#000000" stroke="#000000" points="252.5965,-1879.8161 249.0964,-1869.8161 245.5965,-1879.8161 252.5965,-1879.8161"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="69.0964" cy="-1779.4028" rx="69.1929" ry="18"/>
<text text-anchor="middle" x="69.0964" y="-1775.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Knit module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M212.6707,-1836.8326C184.9547,-1825.7462 146.581,-1810.3967 116.478,-1798.3555"/>
<polygon fill="#000000" stroke="#000000" points="117.6036,-1795.0361 107.0189,-1794.5719 115.0038,-1801.5355 117.6036,-1795.0361"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="188.0964" cy="-1779.4028" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="188.0964" y="-1775.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M234.0177,-1833.6051C226.4103,-1824.6258 217.0658,-1813.5963 208.7966,-1803.8359"/>
<polygon fill="#000000" stroke="#000000" points="211.2999,-1801.3761 202.1652,-1796.0087 205.9589,-1805.901 211.2999,-1801.3761"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="311.0964" cy="-1779.4028" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="311.0964" y="-1775.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 4&#45;36</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.4222,-1833.6051C271.8742,-1824.9511 280.9661,-1814.3928 289.139,-1804.9017"/>
<polygon fill="#000000" stroke="#000000" points="291.8589,-1807.1069 295.732,-1797.2454 286.5545,-1802.5393 291.8589,-1807.1069"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="799.0964" cy="-1779.4028" rx="70.655" ry="18"/>
<text text-anchor="middle" x="799.0964" y="-1775.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 39&#45;127</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M304.86,-1844.1029C404.8334,-1831.0155 614.5027,-1803.5678 725.8996,-1788.985"/>
<polygon fill="#000000" stroke="#000000" points="726.5779,-1792.4261 736.0389,-1787.6576 725.6692,-1785.4853 726.5779,-1792.4261"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="131.0964,-1506.6025 77.0964,-1506.6025 77.0964,-1470.6025 131.0964,-1470.6025 131.0964,-1506.6025"/>
<text text-anchor="middle" x="104.0964" y="-1485.1025" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prose_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>prose_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M170.1717,-1764.2181C159.672,-1754.2803 147.1301,-1740.3917 140.0964,-1725.4028 107.388,-1655.7012 103.1612,-1562.9516 103.3267,-1516.9556"/>
<polygon fill="#000000" stroke="#000000" points="106.8278,-1516.8688 103.4388,-1506.8307 99.8282,-1516.7913 106.8278,-1516.8688"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="473.0964,-1725.2034 149.0964,-1725.2034 149.0964,-1252.0015 473.0964,-1252.0015 473.0964,-1725.2034"/>
<text text-anchor="middle" x="311.0964" y="-1710.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1678.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1663.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;ansi&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1648.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = true</text>
<text text-anchor="middle" x="311.0964" y="-1616.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1601.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1585.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1570.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="311.0964" y="-1555.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="311.0964" y="-1539.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="311.0964" y="-1524.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="311.0964" y="-1508.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="311.0964" y="-1493.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="311.0964" y="-1478.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="311.0964" y="-1462.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="311.0964" y="-1447.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local delete = pl_file.delete</text>
<text text-anchor="middle" x="311.0964" y="-1431.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="311.0964" y="-1400.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1369.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local knitter = require &quot;knit/knitter&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1337.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="311.0964" y="-1322.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="311.0964" y="-1306.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="311.0964" y="-1291.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="311.0964" y="-1260.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>codeblock_4&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M311.0964,-1761.212C311.0964,-1754.192 311.0964,-1745.4055 311.0964,-1735.3274"/>
<polygon fill="#000000" stroke="#000000" points="314.5965,-1735.2847 311.0964,-1725.2847 307.5965,-1735.2848 314.5965,-1735.2847"/>
</g>
<!-- header_8 -->
<g id="node9" class="node">
<title>header_8</title>
<ellipse fill="none" stroke="#000000" cx="620.0964" cy="-1488.6025" rx="128.6478" ry="18"/>
<text text-anchor="middle" x="620.0964" y="-1484.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : knit_dir(knitter, pwd, depth)</text>
</g>
<!-- section_5&#45;&gt;header_8 -->
<g id="edge8" class="edge">
<title>section_5&#45;&gt;header_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784.4856,-1761.3137C776.3907,-1751.0133 766.3299,-1737.7391 758.0964,-1725.4028 709.0008,-1651.8432 658.453,-1560.2755 634.4405,-1515.6225"/>
<polygon fill="#000000" stroke="#000000" points="637.4019,-1513.7386 629.5944,-1506.5766 631.2316,-1517.0442 637.4019,-1513.7386"/>
</g>
<!-- prose_9 -->
<g id="node10" class="node">
<title>prose_9</title>
<ellipse fill="none" stroke="#000000" cx="799.0964" cy="-1488.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="799.0964" y="-1484.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_9 -->
<g id="edge9" class="edge">
<title>section_5&#45;&gt;prose_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M799.0964,-1761.212C799.0964,-1712.0482 799.0964,-1576.2426 799.0964,-1516.9326"/>
<polygon fill="#000000" stroke="#000000" points="802.5965,-1516.7864 799.0964,-1506.7865 795.5965,-1516.7865 802.5965,-1516.7864"/>
</g>
<!-- prose_10 -->
<g id="node11" class="node">
<title>prose_10</title>
<ellipse fill="none" stroke="#000000" cx="881.0964" cy="-1488.6025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="881.0964" y="-1484.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;prose_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M815.9119,-1761.8127C824.4712,-1751.8744 834.2726,-1738.7868 840.0964,-1725.4028 870.9198,-1654.566 878.6038,-1562.3233 880.4961,-1516.6948"/>
<polygon fill="#000000" stroke="#000000" points="883.9955,-1516.7713 880.8485,-1506.6546 876.9998,-1516.5257 883.9955,-1516.7713"/>
</g>
<!-- codeblock_11 -->
<g id="node12" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="1210.0964" cy="-1488.6025" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1210.0964" y="-1484.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 47&#45;126</text>
</g>
<!-- section_5&#45;&gt;codeblock_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;codeblock_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M840.0985,-1764.6802C864.7084,-1755.0557 896.1648,-1741.3344 922.0964,-1725.4028 1027.8932,-1660.4046 1136.8411,-1559.8606 1184.8178,-1513.5333"/>
<polygon fill="#000000" stroke="#000000" points="1187.5154,-1515.7926 1192.2525,-1506.3158 1182.6395,-1510.7701 1187.5154,-1515.7926"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="630.5964,-635.2015 215.5964,-635.2015 215.5964,-580.6006 630.5964,-580.6006 630.5964,-635.2015"/>
<text text-anchor="middle" x="423.0964" y="-604.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, kniting the contents of =/org/=</text>
<text text-anchor="middle" x="423.0964" y="-588.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/src/=. </text>
</g>
<!-- prose_9&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>prose_9&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M801.7583,-1470.5217C807.0824,-1426.9969 814.1392,-1315.3068 758.0964,-1251.8021 721.8157,-1210.6908 679.7633,-1253.6565 640.0964,-1215.8021 470.6045,-1054.0547 433.2222,-751.0502 425.2123,-645.3918"/>
<polygon fill="#000000" stroke="#000000" points="428.6894,-644.9435 424.4869,-635.2178 421.7071,-645.4415 428.6894,-644.9435"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1113.0964,-627.2016 649.0964,-627.2016 649.0964,-588.6005 1113.0964,-588.6005 1113.0964,-627.2016"/>
<text text-anchor="middle" x="881.0964" y="-612.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [X] TODO fix up the orb/notes directory so it doesn&#39;t explode</text>
<text text-anchor="middle" x="881.0964" y="-596.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;the knit.</text>
</g>
<!-- prose_10&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>prose_10&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M881.0964,-1470.2078C881.0964,-1358.9757 881.0964,-776.3861 881.0964,-637.5998"/>
<polygon fill="#000000" stroke="#000000" points="884.5965,-637.3189 881.0964,-627.3189 877.5965,-637.3189 884.5965,-637.3189"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="1679.0964,-1215.7032 1131.0964,-1215.7032 1131.0964,-.0989 1679.0964,-.0989 1679.0964,-1215.7032"/>
<text text-anchor="middle" x="1405.0964" y="-1200.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_dir(knitter, orb_dir, pwd)</text>
<text text-anchor="middle" x="1405.0964" y="-1185.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local knits = {}</text>
<text text-anchor="middle" x="1405.0964" y="-1169.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(orb_dir, false, false) do</text>
<text text-anchor="middle" x="1405.0964" y="-1154.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1405.0964" y="-1139.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1405.0964" y="-1107.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1405.0964" y="-1092.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot; &#160;* &quot; .. dir)</text>
<text text-anchor="middle" x="1405.0964" y="-1076.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1405.0964" y="-1061.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1405.0964" y="-1046.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1405.0964" y="-1030.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; read and knit</text>
<text text-anchor="middle" x="1405.0964" y="-1015.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1405.0964" y="-999.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local knitted = knitter:knit(Doc(orb_f))</text>
<text text-anchor="middle" x="1405.0964" y="-984.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local src_dir = subLastFor(&quot;/orb&quot;, &quot;/src&quot;, dirname(f))</text>
<text text-anchor="middle" x="1405.0964" y="-969.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(src_dir)</text>
<text text-anchor="middle" x="1405.0964" y="-953.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; 4 == #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1405.0964" y="-938.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = src_dir .. &quot;/&quot; .. bare_name .. &quot;.lua&quot;</text>
<text text-anchor="middle" x="1405.0964" y="-922.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local current_src = read(out_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1405.0964" y="-891.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if knitted ~= &quot;&quot; then &#160;&#160;&#160;</text>
<text text-anchor="middle" x="1405.0964" y="-876.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if knitted ~= current_src then</text>
<text text-anchor="middle" x="1405.0964" y="-860.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name))</text>
<text text-anchor="middle" x="1405.0964" y="-845.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, knitted)</text>
<text text-anchor="middle" x="1405.0964" y="-829.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; make a copy of current_src just in case</text>
<text text-anchor="middle" x="1405.0964" y="-814.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_dir = &quot;../tmp&quot; .. src_dir</text>
<text text-anchor="middle" x="1405.0964" y="-799.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(tmp_dir)</text>
<text text-anchor="middle" x="1405.0964" y="-783.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_out = &quot;../tmp&quot; .. out_name</text>
<text text-anchor="middle" x="1405.0964" y="-752.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(tmp_out, current_src)</text>
<text text-anchor="middle" x="1405.0964" y="-736.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;knits[#knits + 1] = out_name</text>
<text text-anchor="middle" x="1405.0964" y="-721.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1405.0964" y="-706.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:verb(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name)</text>
<text text-anchor="middle" x="1405.0964" y="-690.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-675.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif current_src ~= &quot;&quot; then</text>
<text text-anchor="middle" x="1405.0964" y="-659.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.red(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name))</text>
<text text-anchor="middle" x="1405.0964" y="-644.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;delete(out_name)</text>
<text text-anchor="middle" x="1405.0964" y="-629.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-613.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-598.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-582.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-567.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-504.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; collect changed files if any</text>
<text text-anchor="middle" x="1405.0964" y="-488.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local grymbacks = &quot;&quot;</text>
<text text-anchor="middle" x="1405.0964" y="-473.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(knits) do</text>
<text text-anchor="middle" x="1405.0964" y="-457.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;grymbacks = grymbacks .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1405.0964" y="-442.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-427.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if grymbacks ~= &quot;&quot; then</text>
<text text-anchor="middle" x="1405.0964" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;grymbacks: \n&quot; .. grymbacks)</text>
<text text-anchor="middle" x="1405.0964" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; if nothing changes, no rollback is needed, empty file</text>
<text text-anchor="middle" x="1405.0964" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;write(pwd .. &quot;/.grymback&quot;, grymbacks)</text>
<text text-anchor="middle" x="1405.0964" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1405.0964" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1405.0964" y="-303.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_all(knitter, pwd)</text>
<text text-anchor="middle" x="1405.0964" y="-287.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local did_knit = false</text>
<text text-anchor="middle" x="1405.0964" y="-272.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1405.0964" y="-257.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1405.0964" y="-241.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1405.0964" y="-210.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Knit: &quot; .. dir))</text>
<text text-anchor="middle" x="1405.0964" y="-194.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;did_knit = knit_dir(knitter, dir, pwd)</text>
<text text-anchor="middle" x="1405.0964" y="-179.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-164.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not did_knit then</text>
<text text-anchor="middle" x="1405.0964" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;No orb directory to knit. No action taken.&quot;)</text>
<text text-anchor="middle" x="1405.0964" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1405.0964" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return did_knit</text>
<text text-anchor="middle" x="1405.0964" y="-87.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1405.0964" y="-55.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">knitter.knit_all = knit_all</text>
<text text-anchor="middle" x="1405.0964" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return knitter</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>codeblock_11&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1214.0799,-1470.611C1222.4845,-1432.6523 1243.3269,-1338.5197 1268.2999,-1225.7311"/>
<polygon fill="#000000" stroke="#000000" points="1271.7492,-1226.3427 1270.4938,-1215.8225 1264.9147,-1224.8294 1271.7492,-1226.3427"/>
</g>
</g>
</svg>