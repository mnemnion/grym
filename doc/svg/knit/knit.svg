<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1567pt" height="2041pt"
 viewBox="0.00 0.00 1567.00 2041.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2037.4028)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2037.4028 1563,-2037.4028 1563,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="248" cy="-2015.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="248" y="-2011.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">27 &#160;</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="248" cy="-1943.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="248" y="-1939.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">38 &#160;</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M248,-1997.2342C248,-1989.5338 248,-1980.3772 248,-1971.8195"/>
<polygon fill="#000000" stroke="#000000" points="251.5001,-1971.8161 248,-1961.8161 244.5001,-1971.8161 251.5001,-1971.8161"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="140" cy="-1871.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="140" y="-1867.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">le &#160;</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M228.6918,-1930.5307C211.6445,-1919.1659 186.5981,-1902.4682 167.4656,-1889.7132"/>
<polygon fill="#000000" stroke="#000000" points="169.4031,-1886.7984 159.1411,-1884.1636 165.5201,-1892.6228 169.4031,-1886.7984"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="212" cy="-1871.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="212" y="-1867.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">&#45;3 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M239.2854,-1925.9736C235.0403,-1917.4835 229.8464,-1907.0957 225.1337,-1897.6703"/>
<polygon fill="#000000" stroke="#000000" points="228.237,-1896.0505 220.6343,-1888.6715 221.976,-1899.1811 228.237,-1896.0505"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="284" cy="-1871.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="284" y="-1867.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">38 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256.7146,-1925.9736C260.9597,-1917.4835 266.1536,-1907.0957 270.8663,-1897.6703"/>
<polygon fill="#000000" stroke="#000000" points="274.024,-1899.1811 275.3657,-1888.6715 267.763,-1896.0505 274.024,-1899.1811"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="646" cy="-1871.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="646" y="-1867.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">27 &#160;</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.1139,-1938.6787C343.1304,-1926.1933 530.4967,-1892.2979 609.7845,-1877.9544"/>
<polygon fill="#000000" stroke="#000000" points="610.5728,-1881.3687 619.79,-1876.1444 609.3266,-1874.4805 610.5728,-1881.3687"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="203,-1817.3049 149,-1817.3049 149,-1777.5008 203,-1777.5008 203,-1817.3049"/>
<text text-anchor="middle" x="176" y="-1801.9029" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M203.6504,-1854.2398C199.6312,-1845.9781 194.7006,-1835.843 190.1216,-1826.4306"/>
<polygon fill="#000000" stroke="#000000" points="193.2286,-1824.8164 185.7065,-1817.3552 186.9339,-1827.8787 193.2286,-1824.8164"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="248" cy="-1797.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="248" y="-1793.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">36 &#160;</text>
</g>
<!-- block_4&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M275.6504,-1854.2398C271.2745,-1845.2449 265.8183,-1834.0294 260.9117,-1823.9436"/>
<polygon fill="#000000" stroke="#000000" points="263.9511,-1822.1904 256.429,-1814.7292 257.6564,-1825.2527 263.9511,-1822.1904"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="347,-1817.4028 293,-1817.4028 293,-1777.4028 347,-1777.4028 347,-1817.4028"/>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.3496,-1854.2398C296.3376,-1846.0421 301.223,-1836 305.7718,-1826.6496"/>
<polygon fill="#000000" stroke="#000000" points="308.9355,-1828.1472 310.1628,-1817.6237 302.6408,-1825.0849 308.9355,-1828.1472"/>
</g>
<!-- header_10 -->
<g id="node11" class="node">
<title>header_10</title>
<ellipse fill="none" stroke="#000000" cx="574" cy="-1797.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="574" y="-1793.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">h) &#160;</text>
</g>
<!-- section_5&#45;&gt;header_10 -->
<g id="edge10" class="edge">
<title>section_5&#45;&gt;header_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M631.0816,-1856.07C620.945,-1845.6518 607.3654,-1831.695 595.9944,-1820.0082"/>
<polygon fill="#000000" stroke="#000000" points="598.3815,-1817.4426 588.8993,-1812.716 593.3644,-1822.3241 598.3815,-1817.4426"/>
</g>
<!-- block_11 -->
<g id="node12" class="node">
<title>block_11</title>
<ellipse fill="none" stroke="#000000" cx="646" cy="-1797.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="646" y="-1793.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">43 &#160;</text>
</g>
<!-- section_5&#45;&gt;block_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;block_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M646,-1853.1107C646,-1844.8664 646,-1834.9404 646,-1825.7651"/>
<polygon fill="#000000" stroke="#000000" points="649.5001,-1825.4845 646,-1815.4846 642.5001,-1825.4846 649.5001,-1825.4845"/>
</g>
<!-- block_12 -->
<g id="node13" class="node">
<title>block_12</title>
<ellipse fill="none" stroke="#000000" cx="815" cy="-1797.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="815" y="-1793.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">46 &#160;</text>
</g>
<!-- section_5&#45;&gt;block_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;block_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M668.7921,-1861.4229C698.231,-1848.5325 749.6414,-1826.0214 782.9904,-1811.4189"/>
<polygon fill="#000000" stroke="#000000" points="784.5433,-1814.5598 792.2998,-1807.3426 781.7355,-1808.1476 784.5433,-1814.5598"/>
</g>
<!-- block_13 -->
<g id="node14" class="node">
<title>block_13</title>
<ellipse fill="none" stroke="#000000" cx="1285" cy="-1797.4028" rx="27" ry="18"/>
<text text-anchor="middle" x="1285" y="-1793.2028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">27 &#160;</text>
</g>
<!-- section_5&#45;&gt;block_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;block_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M672.6435,-1868.3174C773.4262,-1856.6461 1131.5061,-1815.1783 1248.0492,-1801.682"/>
<polygon fill="#000000" stroke="#000000" points="1248.7118,-1805.1287 1258.2428,-1800.5015 1247.9065,-1798.1752 1248.7118,-1805.1287"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-1741.2034 0,-1741.2034 0,-1252.0016 324,-1252.0016 324,-1741.2034"/>
<text text-anchor="middle" x="162" y="-1726.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="162" y="-1694.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;status&quot;</text>
<text text-anchor="middle" x="162" y="-1679.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;ansi&quot;</text>
<text text-anchor="middle" x="162" y="-1664.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">s.chatty = true</text>
<text text-anchor="middle" x="162" y="-1632.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="162" y="-1617.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="162" y="-1601.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="162" y="-1586.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="162" y="-1571.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="162" y="-1555.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="162" y="-1540.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="162" y="-1524.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="162" y="-1509.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="162" y="-1494.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="162" y="-1478.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="162" y="-1463.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local delete = pl_file.delete</text>
<text text-anchor="middle" x="162" y="-1447.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="162" y="-1416.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="162" y="-1385.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local knitter = require &quot;knit/knitter&quot;</text>
<text text-anchor="middle" x="162" y="-1353.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="162" y="-1338.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="162" y="-1322.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="162" y="-1307.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="162" y="-1276.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242.8779,-1779.4872C240.7167,-1771.9282 237.9581,-1762.2793 234.7709,-1751.1316"/>
<polygon fill="#000000" stroke="#000000" points="238.1107,-1750.0805 231.9965,-1741.4279 231.3803,-1752.0048 238.1107,-1750.0805"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="757.5,-1531.9028 342.5,-1531.9028 342.5,-1461.3021 757.5,-1461.3021 757.5,-1531.9028"/>
<text text-anchor="middle" x="550" y="-1500.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, kniting the contents of =/org/=</text>
<text text-anchor="middle" x="550" y="-1485.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/src/=. </text>
</g>
<!-- block_11&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>block_11&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M640.2823,-1779.4872C625.558,-1733.3513 585.9884,-1609.3664 564.4494,-1541.8774"/>
<polygon fill="#000000" stroke="#000000" points="567.6555,-1540.4111 561.2807,-1531.9486 560.9868,-1542.5394 567.6555,-1540.4111"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="1240,-1523.9029 776,-1523.9029 776,-1469.302 1240,-1469.302 1240,-1523.9029"/>
<text text-anchor="middle" x="1008" y="-1508.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; [X] TODO fix up the orb/notes directory so it doesn&#39;t explode</text>
<text text-anchor="middle" x="1008" y="-1493.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;the knit.</text>
</g>
<!-- block_12&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>block_12&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.6514,-1780.802C855.9166,-1733.6323 942.9341,-1598.011 984.8658,-1532.6583"/>
<polygon fill="#000000" stroke="#000000" points="988.0182,-1534.2263 990.4727,-1523.9197 982.1266,-1530.4461 988.0182,-1534.2263"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="1285" cy="-1496.6025" rx="27" ry="18"/>
<text text-anchor="middle" x="1285" y="-1492.4025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">26 &#160;</text>
</g>
<!-- block_13&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>block_13&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1285,-1779.0392C1285,-1728.2599 1285,-1585.696 1285,-1524.778"/>
<polygon fill="#000000" stroke="#000000" points="1288.5001,-1524.7257 1285,-1514.7257 1281.5001,-1524.7258 1288.5001,-1524.7257"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1384,-1514.6025 1330,-1514.6025 1330,-1478.6025 1384,-1478.6025 1384,-1514.6025"/>
</g>
<!-- block_13&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>block_13&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1298.0311,-1781.2508C1305.9547,-1770.5683 1315.5634,-1755.9048 1321,-1741.4028 1348.9903,-1666.7403 1355.3169,-1571.6499 1356.6799,-1525.0076"/>
<polygon fill="#000000" stroke="#000000" points="1360.1848,-1524.839 1356.9207,-1514.7595 1353.1867,-1524.6745 1360.1848,-1524.839"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1559,-1215.7032 1011,-1215.7032 1011,-.0989 1559,-.0989 1559,-1215.7032"/>
<text text-anchor="middle" x="1285" y="-1200.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_dir(knitter, orb_dir, pwd)</text>
<text text-anchor="middle" x="1285" y="-1185.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local knits = {}</text>
<text text-anchor="middle" x="1285" y="-1169.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(orb_dir, false, false) do</text>
<text text-anchor="middle" x="1285" y="-1154.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1285" y="-1139.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1285" y="-1107.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1285" y="-1092.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot; &#160;* &quot; .. dir)</text>
<text text-anchor="middle" x="1285" y="-1076.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1285" y="-1061.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1285" y="-1046.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1285" y="-1030.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; read and knit</text>
<text text-anchor="middle" x="1285" y="-1015.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1285" y="-999.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local knitted = knitter:knit(Doc(orb_f))</text>
<text text-anchor="middle" x="1285" y="-984.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local src_dir = subLastFor(&quot;/orb&quot;, &quot;/src&quot;, dirname(f))</text>
<text text-anchor="middle" x="1285" y="-969.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(src_dir)</text>
<text text-anchor="middle" x="1285" y="-953.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; 4 == #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1285" y="-938.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = src_dir .. &quot;/&quot; .. bare_name .. &quot;.lua&quot;</text>
<text text-anchor="middle" x="1285" y="-922.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local current_src = read(out_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1285" y="-891.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if knitted ~= &quot;&quot; then &#160;&#160;&#160;</text>
<text text-anchor="middle" x="1285" y="-876.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if knitted ~= current_src then</text>
<text text-anchor="middle" x="1285" y="-860.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name))</text>
<text text-anchor="middle" x="1285" y="-845.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, knitted)</text>
<text text-anchor="middle" x="1285" y="-829.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; make a copy of current_src just in case</text>
<text text-anchor="middle" x="1285" y="-814.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_dir = &quot;../tmp&quot; .. src_dir</text>
<text text-anchor="middle" x="1285" y="-799.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(tmp_dir)</text>
<text text-anchor="middle" x="1285" y="-783.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local tmp_out = &quot;../tmp&quot; .. out_name</text>
<text text-anchor="middle" x="1285" y="-752.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(tmp_out, current_src)</text>
<text text-anchor="middle" x="1285" y="-736.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;knits[#knits + 1] = out_name</text>
<text text-anchor="middle" x="1285" y="-721.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1285" y="-706.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:verb(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name)</text>
<text text-anchor="middle" x="1285" y="-690.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-675.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif current_src ~= &quot;&quot; then</text>
<text text-anchor="middle" x="1285" y="-659.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.red(&quot; &#160;&#160;&#160;&#45; &quot; .. out_name))</text>
<text text-anchor="middle" x="1285" y="-644.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;delete(out_name)</text>
<text text-anchor="middle" x="1285" y="-629.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-613.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-598.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-582.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-567.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-504.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; collect changed files if any</text>
<text text-anchor="middle" x="1285" y="-488.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local grymbacks = &quot;&quot;</text>
<text text-anchor="middle" x="1285" y="-473.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(knits) do</text>
<text text-anchor="middle" x="1285" y="-457.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;grymbacks = grymbacks .. v .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1285" y="-442.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-427.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if grymbacks ~= &quot;&quot; then</text>
<text text-anchor="middle" x="1285" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;grymbacks: \n&quot; .. grymbacks)</text>
<text text-anchor="middle" x="1285" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; if nothing changes, no rollback is needed, empty file</text>
<text text-anchor="middle" x="1285" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;write(pwd .. &quot;/.grymback&quot;, grymbacks)</text>
<text text-anchor="middle" x="1285" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1285" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1285" y="-303.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function knit_all(knitter, pwd)</text>
<text text-anchor="middle" x="1285" y="-287.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local did_knit = false</text>
<text text-anchor="middle" x="1285" y="-272.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1285" y="-257.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1285" y="-241.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1285" y="-210.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Knit: &quot; .. dir))</text>
<text text-anchor="middle" x="1285" y="-194.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;did_knit = knit_dir(knitter, dir, pwd)</text>
<text text-anchor="middle" x="1285" y="-179.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-164.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if not did_knit then</text>
<text text-anchor="middle" x="1285" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(&quot;No orb directory to knit. No action taken.&quot;)</text>
<text text-anchor="middle" x="1285" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1285" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return did_knit</text>
<text text-anchor="middle" x="1285" y="-87.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1285" y="-55.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">knitter.knit_all = knit_all</text>
<text text-anchor="middle" x="1285" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return knitter</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>codeblock_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1285,-1478.4476C1285,-1439.5442 1285,-1342.1671 1285,-1225.982"/>
<polygon fill="#000000" stroke="#000000" points="1288.5001,-1225.7761 1285,-1215.7761 1281.5001,-1225.7762 1288.5001,-1225.7761"/>
</g>
</g>
</svg>