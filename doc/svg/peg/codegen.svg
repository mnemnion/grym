<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1891pt" height="1254pt"
 viewBox="0.00 0.00 1891.00 1253.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1249.6014)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1249.6014 1887,-1249.6014 1887,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="668" cy="-1227.6014" rx="46.1547" ry="18"/>
<text text-anchor="middle" x="668" y="-1223.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 117</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="668" cy="-1155.6014" rx="65.0143" ry="18"/>
<text text-anchor="middle" x="668" y="-1151.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;117</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M668,-1209.4327C668,-1201.7323 668,-1192.5757 668,-1184.018"/>
<polygon fill="#000000" stroke="#000000" points="671.5001,-1184.0146 668,-1174.0146 664.5001,-1184.0147 671.5001,-1184.0146"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="272" cy="-1083.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="272" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">0 : </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M604.2083,-1152.0976C531.169,-1146.7071 408.6313,-1133.4228 308,-1101.6014 306.1012,-1101.0009 304.179,-1100.3111 302.2621,-1099.5592"/>
<polygon fill="#000000" stroke="#000000" points="303.4173,-1096.2434 292.8553,-1095.4092 300.5918,-1102.6479 303.4173,-1096.2434"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="363" cy="-1083.6014" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="363" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;1</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M613.4776,-1145.5148C562.5682,-1135.6986 484.6464,-1119.6529 418,-1101.6014 414.5998,-1100.6804 411.0993,-1099.6741 407.5897,-1098.623"/>
<polygon fill="#000000" stroke="#000000" points="408.3385,-1095.191 397.7506,-1095.5762 406.2678,-1101.8777 408.3385,-1095.191"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="478" cy="-1083.6014" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="478" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 2&#45;13</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M629.5507,-1141.0311C598.5959,-1129.3009 555.0468,-1112.7981 522.5703,-1100.4912"/>
<polygon fill="#000000" stroke="#000000" points="523.4645,-1097.0872 512.8731,-1096.8165 520.984,-1103.633 523.4645,-1097.0872"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="603" cy="-1083.6014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="603" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 14&#45;25</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M651.9326,-1137.8036C643.9232,-1128.9317 634.1069,-1118.0582 625.3742,-1108.3851"/>
<polygon fill="#000000" stroke="#000000" points="627.9573,-1106.0233 618.6583,-1100.946 622.7614,-1110.714 627.9573,-1106.0233"/>
</g>
<!-- block_6 -->
<g id="node7" class="node">
<title>block_6</title>
<ellipse fill="none" stroke="#000000" cx="733" cy="-1083.6014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="733" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 26&#45;29</text>
</g>
<!-- section_1&#45;&gt;block_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;block_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M684.0674,-1137.8036C692.0768,-1128.9317 701.8931,-1118.0582 710.6258,-1108.3851"/>
<polygon fill="#000000" stroke="#000000" points="713.2386,-1110.714 717.3417,-1100.946 708.0427,-1106.0233 713.2386,-1110.714"/>
</g>
<!-- block_7 -->
<g id="node8" class="node">
<title>block_7</title>
<ellipse fill="none" stroke="#000000" cx="945" cy="-1083.6014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="945" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 30&#45;60</text>
</g>
<!-- section_1&#45;&gt;block_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;block_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M715.618,-1143.2241C764.4886,-1130.5213 840.3882,-1110.7929 891.351,-1097.5462"/>
<polygon fill="#000000" stroke="#000000" points="892.3978,-1100.8905 901.1957,-1094.9873 890.6368,-1094.1156 892.3978,-1100.8905"/>
</g>
<!-- block_8 -->
<g id="node9" class="node">
<title>block_8</title>
<ellipse fill="none" stroke="#000000" cx="1191" cy="-1083.6014" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1191" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 61&#45;63</text>
</g>
<!-- section_1&#45;&gt;block_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;block_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.2202,-1147.5864C825.7109,-1133.8897 1027.5392,-1106.1046 1129.3372,-1092.0903"/>
<polygon fill="#000000" stroke="#000000" points="1130.0341,-1095.5275 1139.4633,-1090.6963 1129.0794,-1088.5929 1130.0341,-1095.5275"/>
</g>
<!-- block_9 -->
<g id="node10" class="node">
<title>block_9</title>
<ellipse fill="none" stroke="#000000" cx="1471" cy="-1083.6014" rx="60.1864" ry="18"/>
<text text-anchor="middle" x="1471" y="-1079.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 64&#45;117</text>
</g>
<!-- section_1&#45;&gt;block_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;block_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M730.0089,-1150.0414C877.7188,-1136.7972 1249.4708,-1103.4645 1403.0219,-1089.6965"/>
<polygon fill="#000000" stroke="#000000" points="1403.608,-1093.1581 1413.2554,-1088.779 1402.9828,-1086.1861 1403.608,-1093.1581"/>
</g>
<!-- prose_10 -->
<g id="node11" class="node">
<title>prose_10</title>
<ellipse fill="none" stroke="#000000" cx="154" cy="-1011.6014" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="154" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_3&#45;&gt;prose_10 -->
<g id="edge10" class="edge">
<title>block_3&#45;&gt;prose_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.0181,-1071.5502C290.2559,-1058.5412 230.3284,-1037.8963 191.5836,-1024.5488"/>
<polygon fill="#000000" stroke="#000000" points="192.3297,-1021.1041 181.735,-1021.156 190.0497,-1027.7224 192.3297,-1021.1041"/>
</g>
<!-- codeblock_12 -->
<g id="node13" class="node">
<title>codeblock_12</title>
<ellipse fill="none" stroke="#000000" cx="313" cy="-1011.6014" rx="67.748" ry="18"/>
<text text-anchor="middle" x="313" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 2&#45;4</text>
</g>
<!-- block_4&#45;&gt;codeblock_12 -->
<g id="edge12" class="edge">
<title>block_4&#45;&gt;codeblock_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M445.7946,-1069.5481C420.7104,-1058.6023 385.595,-1043.2792 357.7741,-1031.1392"/>
<polygon fill="#000000" stroke="#000000" points="358.8314,-1027.7819 348.2662,-1026.9902 356.0317,-1034.1976 358.8314,-1027.7819"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="497" cy="-1011.6014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="497" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 14&#45;24</text>
</g>
<!-- block_5&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>block_5&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M578.947,-1067.2635C564.7223,-1057.6014 546.4846,-1045.2136 530.8272,-1034.5784"/>
<polygon fill="#000000" stroke="#000000" points="532.6748,-1031.6023 522.436,-1028.8786 528.7416,-1037.3928 532.6748,-1031.6023"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="733" cy="-1011.6014" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="733" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- block_6&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>block_6&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M733,-1065.4327C733,-1057.7323 733,-1048.5757 733,-1040.018"/>
<polygon fill="#000000" stroke="#000000" points="736.5001,-1040.0146 733,-1030.0146 729.5001,-1040.0147 736.5001,-1040.0146"/>
</g>
<!-- codeblock_18 -->
<g id="node19" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="986" cy="-1011.6014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="986" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 30&#45;59</text>
</g>
<!-- block_7&#45;&gt;codeblock_18 -->
<g id="edge18" class="edge">
<title>block_7&#45;&gt;codeblock_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M955.1348,-1065.8036C959.8301,-1057.5583 965.5098,-1047.5842 970.7103,-1038.4515"/>
<polygon fill="#000000" stroke="#000000" points="973.79,-1040.1163 975.697,-1029.6945 967.7071,-1036.6524 973.79,-1040.1163"/>
</g>
<!-- structure_20 -->
<g id="node21" class="node">
<title>structure_20</title>
<ellipse fill="none" stroke="#000000" cx="1349" cy="-1011.6014" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1349" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_8&#45;&gt;structure_20 -->
<g id="edge20" class="edge">
<title>block_8&#45;&gt;structure_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1223.3549,-1068.8574C1248.4424,-1057.4251 1283.3074,-1041.5372 1309.9475,-1029.3975"/>
<polygon fill="#000000" stroke="#000000" points="1311.7084,-1032.4414 1319.3568,-1025.1097 1308.8057,-1026.0715 1311.7084,-1032.4414"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="1658" cy="-1011.6014" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="1658" y="-1007.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 64&#45;117</text>
</g>
<!-- block_9&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>block_9&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1507.9452,-1069.3765C1536.4978,-1058.383 1576.3213,-1043.0498 1607.7678,-1030.9421"/>
<polygon fill="#000000" stroke="#000000" points="1609.1619,-1034.1559 1617.2364,-1027.2964 1606.6466,-1027.6234 1609.1619,-1034.1559"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="54,-568.8007 0,-568.8007 0,-532.8007 54,-532.8007 54,-568.8007"/>
</g>
<!-- prose_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>prose_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M125.514,-1002.6638C104.4989,-994.4754 77.1891,-980.1455 63,-957.6014 -14.0755,-835.1414 8.8587,-649.4003 21.3312,-579.0987"/>
<polygon fill="#000000" stroke="#000000" points="24.8524,-579.3036 23.2262,-568.8343 17.9687,-578.0327 24.8524,-579.3036"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="214,-568.8007 72,-568.8007 72,-532.8007 214,-532.8007 214,-568.8007"/>
<text text-anchor="middle" x="143" y="-547.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45; Code Generator</text>
</g>
<!-- codeblock_12&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_12&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.5103,-996.783C255.4448,-988.0447 235.3577,-975.197 223,-957.6014 138.5753,-837.3921 137.9149,-650.3132 141.1194,-579.3765"/>
<polygon fill="#000000" stroke="#000000" points="144.634,-579.1841 141.6547,-569.0168 137.6433,-578.8228 144.634,-579.1841"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="549.5,-625.3008 232.5,-625.3008 232.5,-476.3005 549.5,-476.3005 549.5,-625.3008"/>
<text text-anchor="middle" x="391" y="-610.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local file = require &#39;pl.file&#39;</text>
<text text-anchor="middle" x="391" y="-578.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">local transform = require &quot;peg/transform&quot;</text>
<text text-anchor="middle" x="391" y="-531.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">local isrecursive = transform.isrecursive</text>
<text text-anchor="middle" x="391" y="-515.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local notrecursive = transform.notrecursive</text>
<text text-anchor="middle" x="391" y="-484.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;We start with pegylator.lua</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>codeblock_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M492.8447,-993.5374C479.3386,-934.8241 436.0778,-746.7618 410.4885,-635.5207"/>
<polygon fill="#000000" stroke="#000000" points="413.874,-634.625 408.2212,-625.6641 407.0521,-636.1943 413.874,-634.625"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="898.5,-578.0012 567.5,-578.0012 567.5,-523.6002 898.5,-523.6002 898.5,-578.0012"/>
<text text-anchor="middle" x="733" y="-562.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> Eventually all the imports are replaced with</text>
<text text-anchor="middle" x="733" y="-547.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> require &quot;pegylator&quot;</text>
<text text-anchor="middle" x="733" y="-531.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> but first we must write it. </text>
</g>
<!-- prose_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>prose_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M733,-993.5374C733,-925.2827 733,-682.2229 733,-588.2592"/>
<polygon fill="#000000" stroke="#000000" points="736.5001,-588.0781 733,-578.0781 729.5001,-588.0782 736.5001,-588.0781"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1381,-771.4016 917,-771.4016 917,-330.1998 1381,-330.1998 1381,-771.4016"/>
<text text-anchor="middle" x="1149" y="-756.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local prefix = [[ </text>
<text text-anchor="middle" x="1149" y="-741.001" font-family="Inconsolata" font-size="14.00" fill="#000000">require &#39;pl.strict&#39;</text>
<text text-anchor="middle" x="1149" y="-709.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1149" y="-694.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local clu = require &quot;clu/prelude&quot;</text>
<text text-anchor="middle" x="1149" y="-678.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local util = require &quot;util&quot;</text>
<text text-anchor="middle" x="1149" y="-663.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1149" y="-648.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local core = require &quot;peg/core&#45;rules&quot;</text>
<text text-anchor="middle" x="1149" y="-632.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local dump_ast = util.dump_ast</text>
<text text-anchor="middle" x="1149" y="-617.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local clear = ansi.clear()</text>
<text text-anchor="middle" x="1149" y="-601.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="1149" y="-586.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local ast = require &quot;peg/ast&quot;</text>
<text text-anchor="middle" x="1149" y="-571.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local grammar = require &quot;peg/grammars&quot;</text>
<text text-anchor="middle" x="1149" y="-555.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local t = require &quot;peg/transform&quot;</text>
<text text-anchor="middle" x="1149" y="-524.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local match = lpeg.match &#45;&#45; match a pattern against a string</text>
<text text-anchor="middle" x="1149" y="-508.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = lpeg.P &#45;&#45; match a string literally</text>
<text text-anchor="middle" x="1149" y="-493.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local S = lpeg.S &#160;&#45;&#45; match anything in a set</text>
<text text-anchor="middle" x="1149" y="-478.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local R = epeg.R &#160;&#45;&#45; match anything in a range</text>
<text text-anchor="middle" x="1149" y="-462.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = lpeg.B</text>
<text text-anchor="middle" x="1149" y="-447.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = lpeg.C &#160;&#45;&#45; captures a match</text>
<text text-anchor="middle" x="1149" y="-431.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp &#45;&#45; captures start and end position of match</text>
<text text-anchor="middle" x="1149" y="-416.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Ct = lpeg.Ct &#45;&#45; a table with all captures from the pattern</text>
<text text-anchor="middle" x="1149" y="-401.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local V = lpeg.V &#45;&#45; create a variable within a grammar</text>
<text text-anchor="middle" x="1149" y="-369.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = P&#39; &#39; + P&#39;\n&#39; + P&#39;,&#39; + P&#39;\09&#39;</text>
<text text-anchor="middle" x="1149" y="-338.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.3898,-993.5374C1005.4233,-956.6918 1036.4759,-868.906 1067.5239,-781.1333"/>
<polygon fill="#000000" stroke="#000000" points="1070.8817,-782.1361 1070.917,-771.5413 1064.2824,-779.8016 1070.8817,-782.1361"/>
</g>
<!-- handleline_21 -->
<g id="node22" class="node">
<title>handleline_21</title>
<ellipse fill="none" stroke="#000000" cx="1449" cy="-550.8007" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1449" y="-546.6007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_20&#45;&gt;handleline_21 -->
<g id="edge21" class="edge">
<title>structure_20&#45;&gt;handleline_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1365.547,-994.5514C1374.2475,-984.5762 1384.2692,-971.281 1390,-957.6014 1445.7668,-824.483 1450.2439,-647.8056 1449.665,-579.473"/>
<polygon fill="#000000" stroke="#000000" points="1453.1598,-579.0476 1449.5293,-569.0943 1446.1604,-579.1392 1453.1598,-579.0476"/>
</g>
<!-- handle_22 -->
<g id="node23" class="node">
<title>handle_22</title>
<ellipse fill="none" stroke="#000000" cx="1449" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1449" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_21&#45;&gt;handle_22 -->
<g id="edge22" class="edge">
<title>handleline_21&#45;&gt;handle_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1449,-532.7368C1449,-462.126 1449,-204.4338 1449,-118.2743"/>
<polygon fill="#000000" stroke="#000000" points="1452.5001,-118.1886 1449,-108.1886 1445.5001,-118.1887 1452.5001,-118.1886"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1476,-36 1422,-36 1422,0 1476,0 1476,-36"/>
</g>
<!-- handle_22&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>handle_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1449,-71.8314C1449,-64.131 1449,-54.9743 1449,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="1452.5001,-46.4132 1449,-36.4133 1445.5001,-46.4133 1452.5001,-46.4132"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1883,-957.4022 1517,-957.4022 1517,-144.1992 1883,-144.1992 1883,-957.4022"/>
<text text-anchor="middle" x="1700" y="-942.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local definer = [[</text>
<text text-anchor="middle" x="1700" y="-927.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local _generator = function{}</text>
<text text-anchor="middle" x="1700" y="-911.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local function generated(_ENV)</text>
<text text-anchor="middle" x="1700" y="-896.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1700" y="-864.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local end_definer = [[</text>
<text text-anchor="middle" x="1700" y="-849.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1700" y="-834.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return generated</text>
<text text-anchor="middle" x="1700" y="-818.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1700" y="-803.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1700" y="-771.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local caller = [[</text>
<text text-anchor="middle" x="1700" y="-740.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local peg = epnf.define(_generator(),nil,false)</text>
<text text-anchor="middle" x="1700" y="-725.001" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1700" y="-693.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local function local_rules(ast)</text>
<text text-anchor="middle" x="1700" y="-678.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local locals = ast:select(notrecursive)</text>
<text text-anchor="middle" x="1700" y="-662.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1700" y="-647.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1, #locals do</text>
<text text-anchor="middle" x="1700" y="-632.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase..&quot; &#160;&#160;&#160;&quot;..locals[i]:flatten()</text>
<text text-anchor="middle" x="1700" y="-616.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1700" y="-601.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1700" y="-585.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1700" y="-554.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function cursive_rules(ast)</text>
<text text-anchor="middle" x="1700" y="-539.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursives = ast:select(isrecursive)</text>
<text text-anchor="middle" x="1700" y="-523.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase &#160;= &quot;&quot;</text>
<text text-anchor="middle" x="1700" y="-508.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1, #cursives do</text>
<text text-anchor="middle" x="1700" y="-492.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase..&quot; &#160;&quot;..cursives[i]:flatten()</text>
<text text-anchor="middle" x="1700" y="-477.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1700" y="-462.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1700" y="-446.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1700" y="-415.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function write(str)</text>
<text text-anchor="middle" x="1700" y="-399.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return file.write(&quot;gen.lua&quot;,str)</text>
<text text-anchor="middle" x="1700" y="-384.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1700" y="-353.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function build(ast)</text>
<text text-anchor="middle" x="1700" y="-337.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = prefix..ast:root().imports..</text>
<text text-anchor="middle" x="1700" y="-322.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45;local_rules(ast)..&quot;\n\n&quot;..</text>
<text text-anchor="middle" x="1700" y="-306.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;definer..ast:root().start_rule..</text>
<text text-anchor="middle" x="1700" y="-291.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45;cursive_rules(ast)..end_definer</text>
<text text-anchor="middle" x="1700" y="-276.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local_rules(ast)..end_definer..</text>
<text text-anchor="middle" x="1700" y="-260.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;caller</text>
<text text-anchor="middle" x="1700" y="-245.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write(phrase)</text>
<text text-anchor="middle" x="1700" y="-229.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1700" y="-214.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1700" y="-183.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">return { local_rules = local_rules,</text>
<text text-anchor="middle" x="1700" y="-167.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;cursive_rules = cursive_rules,</text>
<text text-anchor="middle" x="1700" y="-152.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;build = build }</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>codeblock_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1659.6464,-993.5374C1660.2786,-986.6021 1661.0752,-977.8619 1662.0054,-967.6567"/>
<polygon fill="#000000" stroke="#000000" points="1665.5148,-967.711 1662.9371,-957.4345 1658.5437,-967.0755 1665.5148,-967.711"/>
</g>
</g>
</svg>