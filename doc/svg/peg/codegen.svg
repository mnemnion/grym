<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1614pt" height="1216pt"
 viewBox="0.00 0.00 1614.00 1215.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1211.8015)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1211.8015 1610,-1211.8015 1610,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="531" cy="-1189.8015" rx="46.1547" ry="18"/>
<text text-anchor="middle" x="531" y="-1185.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 117</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="531" cy="-1117.8015" rx="65.0143" ry="18"/>
<text text-anchor="middle" x="531" y="-1113.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;117</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531,-1171.6328C531,-1163.9324 531,-1154.7758 531,-1146.2181"/>
<polygon fill="#000000" stroke="#000000" points="534.5001,-1146.2147 531,-1136.2147 527.5001,-1146.2148 534.5001,-1146.2147"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="109" cy="-1045.8015" rx="27" ry="18"/>
<text text-anchor="middle" x="109" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">0 : </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M466.4308,-1115.1516C388.6289,-1110.5148 254.6887,-1097.891 145,-1063.8015 143.0982,-1063.2104 141.1737,-1062.5279 139.2551,-1061.7816"/>
<polygon fill="#000000" stroke="#000000" points="140.4069,-1058.4647 129.8437,-1057.6465 137.5911,-1064.8734 140.4069,-1058.4647"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="186" cy="-1045.8015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="186" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M470.3062,-1111.3334C408.2221,-1103.7203 309.4525,-1088.8329 227,-1063.8015 224.5918,-1063.0704 222.1369,-1062.2363 219.6857,-1061.337"/>
<polygon fill="#000000" stroke="#000000" points="220.942,-1058.07 210.3565,-1057.625 218.3541,-1064.5741 220.942,-1058.07"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="304" cy="-1045.8015" rx="67.748" ry="18"/>
<text text-anchor="middle" x="304" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 2&#45;4</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M488.0362,-1104.1742C450.8694,-1092.3856 396.9839,-1075.2941 357.1185,-1062.6496"/>
<polygon fill="#000000" stroke="#000000" points="358.1508,-1059.3053 347.5606,-1059.6181 356.0344,-1065.9777 358.1508,-1059.3053"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="467" cy="-1045.8015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="467" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 14&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M515.1798,-1100.0037C507.4874,-1091.3498 498.1022,-1080.7914 489.6656,-1071.3003"/>
<polygon fill="#000000" stroke="#000000" points="492.1197,-1068.7928 482.86,-1063.644 486.8878,-1073.4434 492.1197,-1068.7928"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="595" cy="-1045.8015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="595" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M546.8202,-1100.0037C554.8816,-1090.9346 564.8021,-1079.7741 573.5416,-1069.9421"/>
<polygon fill="#000000" stroke="#000000" points="576.2115,-1072.2067 580.2393,-1062.4073 570.9796,-1067.5561 576.2115,-1072.2067"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="797" cy="-1045.8015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="797" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 30&#45;59</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M577.6381,-1105.1776C621.8265,-1093.2168 688.4228,-1075.1908 736.6423,-1062.1389"/>
<polygon fill="#000000" stroke="#000000" points="737.5952,-1065.507 746.3334,-1059.5157 735.7662,-1058.7501 737.5952,-1065.507"/>
</g>
<!-- structure_8 -->
<g id="node9" class="node">
<title>structure_8</title>
<ellipse fill="none" stroke="#000000" cx="1054" cy="-1045.8015" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1054" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_1&#45;&gt;structure_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;structure_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M589.2202,-1109.7865C691.8248,-1095.6611 903.2734,-1066.5516 1001.5955,-1053.0159"/>
<polygon fill="#000000" stroke="#000000" points="1002.1701,-1056.4699 1011.5993,-1051.6387 1001.2153,-1049.5353 1002.1701,-1056.4699"/>
</g>
<!-- codeblock_9 -->
<g id="node10" class="node">
<title>codeblock_9</title>
<ellipse fill="none" stroke="#000000" cx="1310" cy="-1045.8015" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="1310" y="-1041.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 64&#45;117</text>
</g>
<!-- section_1&#45;&gt;codeblock_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;codeblock_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M592.778,-1112.0916C731.0778,-1099.309 1065.8526,-1068.3671 1224.2303,-1053.7288"/>
<polygon fill="#000000" stroke="#000000" points="1224.7679,-1057.1942 1234.4033,-1052.7886 1224.1236,-1050.2239 1224.7679,-1057.1942"/>
</g>
<!-- raw_10 -->
<g id="node11" class="node">
<title>raw_10</title>
<ellipse fill="none" stroke="#000000" cx="27" cy="-585.0008" rx="27" ry="18"/>
<text text-anchor="middle" x="27" y="-580.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;raw_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M160.5143,-1034.6126C124.4869,-1018.7957 63,-991.8015 63,-991.8015 -21.7601,-873.7466 6.1336,-683.9393 20.6193,-612.9691"/>
<polygon fill="#000000" stroke="#000000" points="24.0817,-613.5125 22.7271,-603.0046 17.2332,-612.0638 24.0817,-613.5125"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="214,-603.0008 72,-603.0008 72,-567.0008 214,-567.0008 214,-603.0008"/>
<text text-anchor="middle" x="143" y="-581.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45; Code Generator</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_4&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M268.8277,-1030.3317C252.4518,-1021.375 234.1643,-1008.5304 223,-991.8015 141.4589,-869.6178 139.0845,-683.7125 141.4752,-613.3329"/>
<polygon fill="#000000" stroke="#000000" points="144.9837,-613.1894 141.8885,-603.0568 137.9894,-612.9081 144.9837,-613.1894"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="549.5,-659.5009 232.5,-659.5009 232.5,-510.5006 549.5,-510.5006 549.5,-659.5009"/>
<text text-anchor="middle" x="391" y="-644.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">local file = require &#39;pl.file&#39;</text>
<text text-anchor="middle" x="391" y="-612.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local transform = require &quot;peg/transform&quot;</text>
<text text-anchor="middle" x="391" y="-565.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">local isrecursive = transform.isrecursive</text>
<text text-anchor="middle" x="391" y="-550.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local notrecursive = transform.notrecursive</text>
<text text-anchor="middle" x="391" y="-518.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;We start with pegylator.lua</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_5&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0207,-1027.7375C454.3468,-969.0832 423.3823,-781.3402 405.0283,-670.0567"/>
<polygon fill="#000000" stroke="#000000" points="408.428,-669.1614 403.3473,-659.8642 401.5213,-670.3005 408.428,-669.1614"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="595" cy="-585.0008" rx="27" ry="18"/>
<text text-anchor="middle" x="595" y="-580.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_6&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M595,-1027.7375C595,-957.1268 595,-699.4346 595,-613.2751"/>
<polygon fill="#000000" stroke="#000000" points="598.5001,-613.1894 595,-603.1894 591.5001,-613.1895 598.5001,-613.1894"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1104,-805.6017 640,-805.6017 640,-364.3999 1104,-364.3999 1104,-805.6017"/>
<text text-anchor="middle" x="872" y="-790.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">local prefix = [[ </text>
<text text-anchor="middle" x="872" y="-775.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">require &#39;pl.strict&#39;</text>
<text text-anchor="middle" x="872" y="-743.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="872" y="-728.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local clu = require &quot;clu/prelude&quot;</text>
<text text-anchor="middle" x="872" y="-713.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local util = require &quot;util&quot;</text>
<text text-anchor="middle" x="872" y="-697.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="872" y="-682.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local core = require &quot;peg/core&#45;rules&quot;</text>
<text text-anchor="middle" x="872" y="-666.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local dump_ast = util.dump_ast</text>
<text text-anchor="middle" x="872" y="-651.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local clear = ansi.clear()</text>
<text text-anchor="middle" x="872" y="-636.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local epnf = require &quot;peg/epnf&quot;</text>
<text text-anchor="middle" x="872" y="-620.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local ast = require &quot;peg/ast&quot;</text>
<text text-anchor="middle" x="872" y="-605.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local grammar = require &quot;peg/grammars&quot;</text>
<text text-anchor="middle" x="872" y="-589.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local t = require &quot;peg/transform&quot;</text>
<text text-anchor="middle" x="872" y="-558.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local match = lpeg.match &#45;&#45; match a pattern against a string</text>
<text text-anchor="middle" x="872" y="-543.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local P = lpeg.P &#45;&#45; match a string literally</text>
<text text-anchor="middle" x="872" y="-527.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local S = lpeg.S &#160;&#45;&#45; match anything in a set</text>
<text text-anchor="middle" x="872" y="-512.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local R = epeg.R &#160;&#45;&#45; match anything in a range</text>
<text text-anchor="middle" x="872" y="-496.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local B = lpeg.B</text>
<text text-anchor="middle" x="872" y="-481.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local C = lpeg.C &#160;&#45;&#45; captures a match</text>
<text text-anchor="middle" x="872" y="-466.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local Csp = epeg.Csp &#45;&#45; captures start and end position of match</text>
<text text-anchor="middle" x="872" y="-450.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local Ct = lpeg.Ct &#45;&#45; a table with all captures from the pattern</text>
<text text-anchor="middle" x="872" y="-435.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local V = lpeg.V &#45;&#45; create a variable within a grammar</text>
<text text-anchor="middle" x="872" y="-403.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = P&#39; &#39; + P&#39;\n&#39; + P&#39;,&#39; + P&#39;\09&#39;</text>
<text text-anchor="middle" x="872" y="-372.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_7&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M799.9401,-1027.7375C805.9249,-990.9665 820.1673,-903.4613 834.4243,-815.8665"/>
<polygon fill="#000000" stroke="#000000" points="837.9202,-816.1738 836.0722,-805.7414 831.0111,-815.0492 837.9202,-816.1738"/>
</g>
<!-- handleline_17 -->
<g id="node18" class="node">
<title>handleline_17</title>
<ellipse fill="none" stroke="#000000" cx="1172" cy="-585.0008" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1172" y="-580.8008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_8&#45;&gt;handleline_17 -->
<g id="edge17" class="edge">
<title>structure_8&#45;&gt;handleline_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1077.5612,-1030.3579C1090.1652,-1020.7991 1104.7501,-1007.3875 1113,-991.8015 1180.8171,-863.6791 1178.1579,-682.7529 1174.1673,-613.4899"/>
<polygon fill="#000000" stroke="#000000" points="1177.6508,-613.1165 1173.526,-603.3576 1170.6648,-613.5587 1177.6508,-613.1165"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1606,-991.6023 1240,-991.6023 1240,-178.3993 1606,-178.3993 1606,-991.6023"/>
<text text-anchor="middle" x="1423" y="-976.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local definer = [[</text>
<text text-anchor="middle" x="1423" y="-961.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">local _generator = function{}</text>
<text text-anchor="middle" x="1423" y="-945.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local function generated(_ENV)</text>
<text text-anchor="middle" x="1423" y="-930.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1423" y="-899.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local end_definer = [[</text>
<text text-anchor="middle" x="1423" y="-883.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1423" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return generated</text>
<text text-anchor="middle" x="1423" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1423" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1423" y="-806.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local caller = [[</text>
<text text-anchor="middle" x="1423" y="-774.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">local peg = epnf.define(_generator(),nil,false)</text>
<text text-anchor="middle" x="1423" y="-759.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="1423" y="-727.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function local_rules(ast)</text>
<text text-anchor="middle" x="1423" y="-712.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local locals = ast:select(notrecursive)</text>
<text text-anchor="middle" x="1423" y="-697.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="1423" y="-681.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1, #locals do</text>
<text text-anchor="middle" x="1423" y="-666.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase..&quot; &#160;&#160;&#160;&quot;..locals[i]:flatten()</text>
<text text-anchor="middle" x="1423" y="-650.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1423" y="-635.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1423" y="-620.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1423" y="-588.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function cursive_rules(ast)</text>
<text text-anchor="middle" x="1423" y="-573.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursives = ast:select(isrecursive)</text>
<text text-anchor="middle" x="1423" y="-557.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase &#160;= &quot;&quot;</text>
<text text-anchor="middle" x="1423" y="-542.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1, #cursives do</text>
<text text-anchor="middle" x="1423" y="-527.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase..&quot; &#160;&quot;..cursives[i]:flatten()</text>
<text text-anchor="middle" x="1423" y="-511.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1423" y="-496.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1423" y="-480.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1423" y="-449.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local function write(str)</text>
<text text-anchor="middle" x="1423" y="-434.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return file.write(&quot;gen.lua&quot;,str)</text>
<text text-anchor="middle" x="1423" y="-418.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1423" y="-387.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function build(ast)</text>
<text text-anchor="middle" x="1423" y="-371.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = prefix..ast:root().imports..</text>
<text text-anchor="middle" x="1423" y="-356.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45;local_rules(ast)..&quot;\n\n&quot;..</text>
<text text-anchor="middle" x="1423" y="-341.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;definer..ast:root().start_rule..</text>
<text text-anchor="middle" x="1423" y="-325.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45;cursive_rules(ast)..end_definer</text>
<text text-anchor="middle" x="1423" y="-310.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local_rules(ast)..end_definer..</text>
<text text-anchor="middle" x="1423" y="-294.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;caller</text>
<text text-anchor="middle" x="1423" y="-279.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write(phrase)</text>
<text text-anchor="middle" x="1423" y="-264.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="1423" y="-248.6002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1423" y="-217.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">return { local_rules = local_rules,</text>
<text text-anchor="middle" x="1423" y="-201.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;cursive_rules = cursive_rules,</text>
<text text-anchor="middle" x="1423" y="-186.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;build = build }</text>
</g>
<!-- codeblock_9&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_9&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1314.4297,-1027.7375C1316.148,-1020.7306 1318.318,-1011.8816 1320.8539,-1001.5407"/>
<polygon fill="#000000" stroke="#000000" points="1324.3006,-1002.1805 1323.2831,-991.6346 1317.502,-1000.5132 1324.3006,-1002.1805"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="54,-125.1 0,-125.1 0,-89.1 54,-89.1 54,-125.1"/>
</g>
<!-- raw_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>raw_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M27,-566.8501C27,-494.1805 27,-223.8941 27,-135.3696"/>
<polygon fill="#000000" stroke="#000000" points="30.5001,-135.2688 27,-125.2689 23.5001,-135.2689 30.5001,-135.2688"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="760.5,-142.3004 429.5,-142.3004 429.5,-71.8997 760.5,-71.8997 760.5,-142.3004"/>
<text text-anchor="middle" x="595" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> Eventually all the imports are replaced with</text>
<text text-anchor="middle" x="595" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> require &quot;pegylator&quot;</text>
<text text-anchor="middle" x="595" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> but first we must write it. </text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M595,-566.8501C595,-498.43 595,-254.8296 595,-152.6884"/>
<polygon fill="#000000" stroke="#000000" points="598.5001,-152.3897 595,-142.3898 591.5001,-152.3898 598.5001,-152.3897"/>
</g>
<!-- handle_18 -->
<g id="node19" class="node">
<title>handle_18</title>
<ellipse fill="none" stroke="#000000" cx="1172" cy="-107.1" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1172" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_17&#45;&gt;handle_18 -->
<g id="edge18" class="edge">
<title>handleline_17&#45;&gt;handle_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172,-566.8501C1172,-494.1805 1172,-223.8941 1172,-135.3696"/>
<polygon fill="#000000" stroke="#000000" points="1175.5001,-135.2688 1172,-125.2689 1168.5001,-135.2689 1175.5001,-135.2688"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1199,-36 1145,-36 1145,0 1199,0 1199,-36"/>
</g>
<!-- handle_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>handle_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172,-89.0693C1172,-76.7509 1172,-60.1792 1172,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="1175.5001,-46.0039 1172,-36.0039 1168.5001,-46.0039 1175.5001,-46.0039"/>
</g>
</g>
</svg>