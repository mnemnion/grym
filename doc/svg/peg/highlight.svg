<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3381pt" height="1204pt"
 viewBox="0.00 0.00 3381.33 1204.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1200.4014)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1200.4014 3377.3324,-1200.4014 3377.3324,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1422.3324" cy="-1178.4014" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1422.3324" y="-1174.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 196</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1422.3324" cy="-1106.4014" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1422.3324" y="-1102.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;196</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1422.3324,-1160.2328C1422.3324,-1152.5324 1422.3324,-1143.3758 1422.3324,-1134.8181"/>
<polygon fill="#000000" stroke="#000000" points="1425.8325,-1134.8147 1422.3324,-1124.8147 1418.8325,-1134.8147 1425.8325,-1134.8147"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="860.3324" cy="-1034.4014" rx="27" ry="18"/>
<text text-anchor="middle" x="860.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">0 : </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1357.8992,-1102.6939C1237.1645,-1095.2677 981.3957,-1077.136 896.3324,-1052.4014 894.2062,-1051.7832 892.0549,-1051.0422 889.9171,-1050.2184"/>
<polygon fill="#000000" stroke="#000000" points="891.3159,-1047.0101 880.7521,-1046.1994 888.5046,-1053.4208 891.3159,-1047.0101"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="937.3324" cy="-1034.4014" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="937.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1356.8491,-1104.4036C1269.2068,-1100.388 1109.5816,-1088.3527 978.3324,-1052.4014 975.905,-1051.7365 973.4359,-1050.9519 970.9744,-1050.0885"/>
<polygon fill="#000000" stroke="#000000" points="972.2114,-1046.8143 961.6227,-1046.4545 969.6759,-1053.339 972.2114,-1046.8143"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="1060.3324" cy="-1034.4014" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1060.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 2&#45;10</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1367.7874,-1096.3091C1311.2989,-1085.7571 1220.5182,-1068.5194 1142.3324,-1052.4014 1136.5711,-1051.2138 1130.5884,-1049.9532 1124.5971,-1048.6722"/>
<polygon fill="#000000" stroke="#000000" points="1125.0567,-1045.191 1114.5439,-1046.5064 1123.5825,-1052.034 1125.0567,-1045.191"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1228.3324" cy="-1034.4014" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1228.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 15&#45;61</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1383.0736,-1091.8312C1353.173,-1080.734 1311.7633,-1065.3655 1279.3049,-1053.319"/>
<polygon fill="#000000" stroke="#000000" points="1280.1346,-1049.8938 1269.5416,-1049.6956 1277.6989,-1056.4564 1280.1346,-1049.8938"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1356.3324" cy="-1034.4014" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1356.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1406.0178,-1088.6037C1397.584,-1079.4032 1387.177,-1068.0501 1378.0703,-1058.1155"/>
<polygon fill="#000000" stroke="#000000" points="1380.4455,-1055.5269 1371.1081,-1050.5204 1375.2854,-1060.257 1380.4455,-1055.5269"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1488.3324" cy="-1034.4014" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="1488.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 67&#45;117</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1438.647,-1088.6037C1446.6591,-1079.8632 1456.452,-1069.18 1465.2192,-1059.6159"/>
<polygon fill="#000000" stroke="#000000" points="1467.7995,-1061.9806 1471.9767,-1052.244 1462.6394,-1057.2505 1467.7995,-1061.9806"/>
</g>
<!-- block_8 -->
<g id="node9" class="node">
<title>block_8</title>
<ellipse fill="none" stroke="#000000" cx="1897.3324" cy="-1034.4014" rx="65.0229" ry="18"/>
<text text-anchor="middle" x="1897.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 119&#45;127</text>
</g>
<!-- section_1&#45;&gt;block_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;block_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1480.1018,-1097.6448C1568.3656,-1084.2659 1736.3855,-1058.7976 1830.0314,-1044.6029"/>
<polygon fill="#000000" stroke="#000000" points="1830.6018,-1048.0565 1839.9643,-1043.0972 1829.5527,-1041.1355 1830.6018,-1048.0565"/>
</g>
<!-- codeblock_9 -->
<g id="node10" class="node">
<title>codeblock_9</title>
<ellipse fill="none" stroke="#000000" cx="2231.3324" cy="-1034.4014" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2231.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 128&#45;176</text>
</g>
<!-- section_1&#45;&gt;codeblock_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;codeblock_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1484.8047,-1100.8415C1627.0182,-1088.1847 1975.3702,-1057.1818 2141.0048,-1042.4405"/>
<polygon fill="#000000" stroke="#000000" points="2141.5144,-1045.9091 2151.1647,-1041.5363 2140.8938,-1038.9366 2141.5144,-1045.9091"/>
</g>
<!-- block_10 -->
<g id="node11" class="node">
<title>block_10</title>
<ellipse fill="none" stroke="#000000" cx="2786.3324" cy="-1034.4014" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="2786.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 178&#45;182</text>
</g>
<!-- section_1&#45;&gt;block_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;block_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1487.2033,-1102.9772C1713.8545,-1091.0132 2469.7325,-1051.1135 2711.3709,-1038.3583"/>
<polygon fill="#000000" stroke="#000000" points="2711.6603,-1041.848 2721.4619,-1037.8257 2711.2913,-1034.8578 2711.6603,-1041.848"/>
</g>
<!-- codeblock_11 -->
<g id="node12" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="3087.3324" cy="-1034.4014" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3087.3324" y="-1030.2014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 183&#45;196</text>
</g>
<!-- section_1&#45;&gt;codeblock_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;codeblock_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1487.9972,-1104.9186C1691.8473,-1100.1046 2331.9221,-1083.4038 2861.3324,-1052.4014 2906.0722,-1049.7815 2955.7218,-1045.9313 2997.0633,-1042.4635"/>
<polygon fill="#000000" stroke="#000000" points="2997.4427,-1045.944 3007.1125,-1041.6144 2996.8533,-1038.9688 2997.4427,-1045.944"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="57.3324,-616.2007 3.3324,-616.2007 3.3324,-580.2007 57.3324,-580.2007 57.3324,-616.2007"/>
</g>
<!-- prose_3&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M913.5623,-1022.2038C908.0382,-1019.87 902.0869,-1017.7398 896.3324,-1016.4014 806.4232,-995.4903 133.234,-1044.0027 66.3324,-980.4014 -32.6792,-886.2742 3.7851,-697.8484 22.2533,-626.4784"/>
<polygon fill="#000000" stroke="#000000" points="25.7351,-627.0057 24.9345,-616.4411 18.9723,-625.1991 25.7351,-627.0057"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="546.8324,-656.6016 75.8324,-656.6016 75.8324,-539.7998 546.8324,-539.7998 546.8324,-656.6016"/>
<text text-anchor="middle" x="311.3324" y="-641.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45; Generates a terminal syntax highlighter for a given grammar. </text>
<text text-anchor="middle" x="311.3324" y="-609.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;local clu = require &quot;clu/prelude&quot;</text>
<text text-anchor="middle" x="311.3324" y="-594.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local lpeg = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="311.3324" y="-579.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local ast = require &quot;peg/ast&quot;</text>
<text text-anchor="middle" x="311.3324" y="-563.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local util = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="311.3324" y="-548.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local tableand = util.tableand</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_4&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.0301,-1021.8489C998.2052,-1019.7962 987.9873,-1017.8655 978.3324,-1016.4014 885.0589,-1002.2574 636.0657,-1029.2086 555.3324,-980.4014 436.8687,-908.7844 366.0249,-755.2259 333.2748,-666.0845"/>
<polygon fill="#000000" stroke="#000000" points="336.5385,-664.8175 329.8461,-656.604 329.9558,-667.1983 336.5385,-664.8175"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="979.8324,-950.302 564.8324,-950.302 564.8324,-246.0994 979.8324,-246.0994 979.8324,-950.302"/>
<text text-anchor="middle" x="772.3324" y="-935.3013" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;local p = clu.env.palette</text>
<text text-anchor="middle" x="772.3324" y="-903.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> testrules = { atom &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;White&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-888.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pattern &#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Blue&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-873.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;optional &#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-857.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;more_than_one &#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-842.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;some_number &#160;&#160;&#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-826.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;some_suffix &#160;&#160;&#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-811.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;which_suffix &#160;&#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-796.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;maybe &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Green&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-780.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;set &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Yellow&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-765.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;range &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Yellow&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-749.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;literal &#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Yellow&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-734.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;PEL &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Grey&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-719.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;PER &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Grey&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-703.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;hidden_rule &#160;&#160;&#160;= {&quot;Cyan&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-688.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;hidden_pattern = {&quot;Cyan&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-672.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;hidden_match &#160;&#160;= {&quot;Cyan&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-657.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeats &#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Red&quot;,&quot;Clear&quot;},</text>
<text text-anchor="middle" x="772.3324" y="-642.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment &#160;&#160;&#160;&#160;&#160;&#160;&#160;= {&quot;Grey&quot;,&quot;Clear&quot;}}</text>
<text text-anchor="middle" x="772.3324" y="-594.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">function makerules(rules)</text>
<text text-anchor="middle" x="772.3324" y="-579.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local rule_table = {}</text>
<text text-anchor="middle" x="772.3324" y="-563.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local p = nil</text>
<text text-anchor="middle" x="772.3324" y="-548.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; this logic belongs in a palette </text>
<text text-anchor="middle" x="772.3324" y="-533.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; object which may be called. </text>
<text text-anchor="middle" x="772.3324" y="-517.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if clu.env.ansi then </text>
<text text-anchor="middle" x="772.3324" y="-502.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;p = clu.env.palette.default</text>
<text text-anchor="middle" x="772.3324" y="-486.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="772.3324" y="-471.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;p = clu.env.palette.no_color</text>
<text text-anchor="middle" x="772.3324" y="-456.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end </text>
<text text-anchor="middle" x="772.3324" y="-440.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for k,v in pairs(rules) do</text>
<text text-anchor="middle" x="772.3324" y="-425.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(v) == &quot;table&quot; then </text>
<text text-anchor="middle" x="772.3324" y="-409.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;rule_table[k] = { p[v[1]] , p[v[2]] }</text>
<text text-anchor="middle" x="772.3324" y="-394.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else &#45;&#45; string or function</text>
<text text-anchor="middle" x="772.3324" y="-379.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error &quot;error in makerules, non&#45;table values NYI&quot;</text>
<text text-anchor="middle" x="772.3324" y="-363.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="772.3324" y="-348.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="772.3324" y="-332.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return rule_table</text>
<text text-anchor="middle" x="772.3324" y="-317.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="772.3324" y="-254.1001" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;local testrules = { atom = {&quot;&quot;,&quot;&quot;}, lhs = {&quot;&quot;,&quot;&quot;}}</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>codeblock_5&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1171.3827,-1022.182C1101.595,-1007.1223 992.0609,-983.1709 988.3324,-980.4014 978.7721,-973.3004 969.5742,-965.6423 960.73,-957.5217"/>
<polygon fill="#000000" stroke="#000000" points="963.0603,-954.9085 953.3839,-950.5937 958.2576,-960.001 963.0603,-954.9085"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="1230.8324,-625.5011 997.8324,-625.5011 997.8324,-570.9003 1230.8324,-570.9003 1230.8324,-625.5011"/>
<text text-anchor="middle" x="1114.3324" y="-594.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> wraps a value in a rule, or</text>
<text text-anchor="middle" x="1114.3324" y="-579.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> returns it if the rule is nil.</text>
</g>
<!-- prose_6&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>prose_6&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1330.9432,-1023.1973C1297.8009,-1008.4826 1243.5982,-984.0744 1240.3324,-980.4014 1150.0659,-878.8801 1124.2321,-711.0928 1117.0273,-636.2653"/>
<polygon fill="#000000" stroke="#000000" points="1120.4783,-635.5637 1116.094,-625.9186 1113.5066,-636.1927 1120.4783,-635.5637"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1727.3324,-980.6023 1249.3324,-980.6023 1249.3324,-215.7992 1727.3324,-215.7992 1727.3324,-980.6023"/>
<text text-anchor="middle" x="1488.3324" y="-965.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">local function rulewrap_value(ast,rules)</text>
<text text-anchor="middle" x="1488.3324" y="-949.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if rules[ast.id] then</text>
<text text-anchor="middle" x="1488.3324" y="-934.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;local rule = rules[ast.id]</text>
<text text-anchor="middle" x="1488.3324" y="-919.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;if type (rule) == &quot;string&quot; then &#45;&#45; pre only</text>
<text text-anchor="middle" x="1488.3324" y="-903.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return rule..ast.val..p.Clear</text>
<text text-anchor="middle" x="1488.3324" y="-888.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type (rule) == &quot;table&quot; then &#45;&#45; pre and post</text>
<text text-anchor="middle" x="1488.3324" y="-872.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return rule[1]..ast.val..rule[2]</text>
<text text-anchor="middle" x="1488.3324" y="-857.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type (rule) == &quot;function&quot; then &#45;&#45; function over value</text>
<text text-anchor="middle" x="1488.3324" y="-842.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print &quot;function reached in rulewrap_value&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-826.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-811.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-795.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1488.3324" y="-780.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;return ast.val</text>
<text text-anchor="middle" x="1488.3324" y="-765.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-749.601" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1488.3324" y="-718.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local function rulewrap_open(ast,rules)</text>
<text text-anchor="middle" x="1488.3324" y="-702.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if rules[ast.id] then</text>
<text text-anchor="middle" x="1488.3324" y="-687.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local rule = rules[ast.id]</text>
<text text-anchor="middle" x="1488.3324" y="-672.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(rule) == &quot;string&quot; then &#45;&#45; pre only</text>
<text text-anchor="middle" x="1488.3324" y="-656.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return rule</text>
<text text-anchor="middle" x="1488.3324" y="-641.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type(rule) == &quot;table&quot; then &#45;&#45; use pre</text>
<text text-anchor="middle" x="1488.3324" y="-625.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return rule[1]</text>
<text text-anchor="middle" x="1488.3324" y="-610.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type(rule) == &quot;function&quot; then &#45;&#45; fn over span</text>
<text text-anchor="middle" x="1488.3324" y="-595.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print &quot;function reached in rulewrap_start&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-579.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-564.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-548.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else </text>
<text text-anchor="middle" x="1488.3324" y="-533.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;&quot; </text>
<text text-anchor="middle" x="1488.3324" y="-518.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-502.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1488.3324" y="-471.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local function rulewrap_close(ast,rules)</text>
<text text-anchor="middle" x="1488.3324" y="-455.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if rules[ast.id] then</text>
<text text-anchor="middle" x="1488.3324" y="-440.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local rule = rules[ast.id]</text>
<text text-anchor="middle" x="1488.3324" y="-425.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(rule) == &quot;string&quot; then </text>
<text text-anchor="middle" x="1488.3324" y="-409.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-394.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type(rule) == &quot;table&quot; then</text>
<text text-anchor="middle" x="1488.3324" y="-378.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return rule[2]</text>
<text text-anchor="middle" x="1488.3324" y="-363.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif type(rule) == &quot;function&quot; then</text>
<text text-anchor="middle" x="1488.3324" y="-348.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print &quot;function reached in rulewrap_close&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-332.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-317.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-301.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="1488.3324" y="-286.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1488.3324" y="-271.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1488.3324" y="-255.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1488.3324" y="-224.2" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45; highlights a Node.</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_7&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1488.3324,-1016.2138C1488.3324,-1009.3101 1488.3324,-1000.6378 1488.3324,-990.541"/>
<polygon fill="#000000" stroke="#000000" points="1491.8325,-990.4352 1488.3324,-980.4352 1484.8325,-990.4353 1491.8325,-990.4352"/>
</g>
<!-- structure_17 -->
<g id="node18" class="node">
<title>structure_17</title>
<ellipse fill="none" stroke="#000000" cx="1790.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1790.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_8&#45;&gt;structure_17 -->
<g id="edge17" class="edge">
<title>block_8&#45;&gt;structure_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1874.3568,-1017.4082C1863.1381,-1007.8266 1850.5364,-994.8837 1843.3324,-980.4014 1783.2755,-859.6686 1784.896,-692.4963 1788.3312,-626.5617"/>
<polygon fill="#000000" stroke="#000000" points="1791.8289,-626.7019 1788.9115,-616.5166 1784.8405,-626.2981 1791.8289,-626.7019"/>
</g>
<!-- structure_18 -->
<g id="node19" class="node">
<title>structure_18</title>
<ellipse fill="none" stroke="#000000" cx="1897.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="1897.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_8&#45;&gt;structure_18 -->
<g id="edge18" class="edge">
<title>block_8&#45;&gt;structure_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1897.3324,-1016.2138C1897.3324,-948.3171 1897.3324,-709.3503 1897.3324,-626.633"/>
<polygon fill="#000000" stroke="#000000" points="1900.8325,-626.466 1897.3324,-616.466 1893.8325,-626.466 1900.8325,-626.466"/>
</g>
<!-- structure_19 -->
<g id="node20" class="node">
<title>structure_19</title>
<ellipse fill="none" stroke="#000000" cx="2004.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2004.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_8&#45;&gt;structure_19 -->
<g id="edge19" class="edge">
<title>block_8&#45;&gt;structure_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1920.3081,-1017.4082C1931.5267,-1007.8266 1944.1284,-994.8837 1951.3324,-980.4014 2011.3894,-859.6686 2009.7688,-692.4963 2006.3336,-626.5617"/>
<polygon fill="#000000" stroke="#000000" points="2009.8243,-626.2981 2005.7533,-616.5166 2002.836,-626.7019 2009.8243,-626.2981"/>
</g>
<!-- structure_20 -->
<g id="node21" class="node">
<title>structure_20</title>
<ellipse fill="none" stroke="#000000" cx="2111.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2111.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_8&#45;&gt;structure_20 -->
<g id="edge20" class="edge">
<title>block_8&#45;&gt;structure_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1948.785,-1023.3457C1990.3059,-1013.3462 2044.0742,-997.5898 2058.3324,-980.4014 2145.4144,-875.4236 2127.5026,-695.6642 2116.5236,-626.4827"/>
<polygon fill="#000000" stroke="#000000" points="2119.9327,-625.6469 2114.8382,-616.3573 2113.0277,-626.7963 2119.9327,-625.6469"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2616.8324,-964.7021 2173.8324,-964.7021 2173.8324,-231.6993 2616.8324,-231.6993 2616.8324,-964.7021"/>
<text text-anchor="middle" x="2395.3324" y="-949.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">local function light(ast, rules)</text>
<text text-anchor="middle" x="2395.3324" y="-934.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if rules then </text>
<text text-anchor="middle" x="2395.3324" y="-918.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;rules = makerules(rules)</text>
<text text-anchor="middle" x="2395.3324" y="-903.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else </text>
<text text-anchor="middle" x="2395.3324" y="-887.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;rules = makerules(testrules) </text>
<text text-anchor="middle" x="2395.3324" y="-872.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-841.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local source = ast:root().str</text>
<text text-anchor="middle" x="2395.3324" y="-825.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local queue = {}</text>
<text text-anchor="middle" x="2395.3324" y="-810.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2395.3324" y="-794.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursor = 1</text>
<text text-anchor="middle" x="2395.3324" y="-779.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local gap = &quot;&quot;</text>
<text text-anchor="middle" x="2395.3324" y="-764.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local ndx, first, last = ast:range()</text>
<text text-anchor="middle" x="2395.3324" y="-748.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local new = true</text>
<text text-anchor="middle" x="2395.3324" y="-733.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = first, last do</text>
<text text-anchor="middle" x="2395.3324" y="-717.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local node, close, _ = ndx(i)</text>
<text text-anchor="middle" x="2395.3324" y="-702.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if rules[node.id] </text>
<text text-anchor="middle" x="2395.3324" y="-687.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;and node.val == nil then &#45;&#45; open regional rule</text>
<text text-anchor="middle" x="2395.3324" y="-671.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;gap = source:sub(cursor,node.first&#45;1)</text>
<text text-anchor="middle" x="2395.3324" y="-656.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursor = node.first</text>
<text text-anchor="middle" x="2395.3324" y="-640.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;queue[close] = node</text>
<text text-anchor="middle" x="2395.3324" y="-625.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase..gap..rulewrap_open(node,rules)</text>
<text text-anchor="middle" x="2395.3324" y="-610.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;elseif node.id and node.val then &#45;&#45; wrap values in rule</text>
<text text-anchor="middle" x="2395.3324" y="-594.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if new then </text>
<text text-anchor="middle" x="2395.3324" y="-579.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase..source:sub(1,ndx[1].first&#45;1)</text>
<text text-anchor="middle" x="2395.3324" y="-563.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;new = false</text>
<text text-anchor="middle" x="2395.3324" y="-548.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-533.1006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if cursor &lt;= node.first then</text>
<text text-anchor="middle" x="2395.3324" y="-517.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;gap = source:sub(cursor,node.first&#45;1)</text>
<text text-anchor="middle" x="2395.3324" y="-502.3005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-486.9005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursor = node.last+1</text>
<text text-anchor="middle" x="2395.3324" y="-471.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase..gap..rulewrap_value(node,rules)</text>
<text text-anchor="middle" x="2395.3324" y="-456.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-440.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if queue[i] then &#45;&#45; close regional rule</text>
<text text-anchor="middle" x="2395.3324" y="-425.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;gap = source:sub(cursor,queue[i].last&#45;1)</text>
<text text-anchor="middle" x="2395.3324" y="-409.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursor = queue[i].last</text>
<text text-anchor="middle" x="2395.3324" y="-394.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase</text>
<text text-anchor="middle" x="2395.3324" y="-379.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;..rulewrap_open(queue[i],rules)</text>
<text text-anchor="middle" x="2395.3324" y="-363.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;..gap</text>
<text text-anchor="middle" x="2395.3324" y="-348.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;..rulewrap_close(queue[i],rules)</text>
<text text-anchor="middle" x="2395.3324" y="-332.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-317.5002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2395.3324" y="-302.1001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;phrase = phrase..source:sub(cursor,&#45;1)</text>
<text text-anchor="middle" x="2395.3324" y="-286.7001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="2395.3324" y="-271.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2395.3324" y="-239.9" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45; generates a highlighter from a rule table</text>
</g>
<!-- codeblock_9&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>codeblock_9&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2238.1705,-1016.2138C2242.0323,-1005.9424 2247.366,-991.7559 2253.7456,-974.7876"/>
<polygon fill="#000000" stroke="#000000" points="2257.1516,-975.6738 2257.3948,-965.0817 2250.5994,-973.2103 2257.1516,-975.6738"/>
</g>
<!-- structure_34 -->
<g id="node35" class="node">
<title>structure_34</title>
<ellipse fill="none" stroke="#000000" cx="2679.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2679.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_10&#45;&gt;structure_34 -->
<g id="edge34" class="edge">
<title>block_10&#45;&gt;structure_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2763.3568,-1017.4082C2752.1381,-1007.8266 2739.5364,-994.8837 2732.3324,-980.4014 2672.2755,-859.6686 2673.896,-692.4963 2677.3312,-626.5617"/>
<polygon fill="#000000" stroke="#000000" points="2680.8289,-626.7019 2677.9115,-616.5166 2673.8405,-626.2981 2680.8289,-626.7019"/>
</g>
<!-- structure_35 -->
<g id="node36" class="node">
<title>structure_35</title>
<ellipse fill="none" stroke="#000000" cx="2786.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2786.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_10&#45;&gt;structure_35 -->
<g id="edge35" class="edge">
<title>block_10&#45;&gt;structure_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2786.3324,-1016.2138C2786.3324,-948.3171 2786.3324,-709.3503 2786.3324,-626.633"/>
<polygon fill="#000000" stroke="#000000" points="2789.8325,-626.466 2786.3324,-616.466 2782.8325,-626.466 2789.8325,-626.466"/>
</g>
<!-- structure_36 -->
<g id="node37" class="node">
<title>structure_36</title>
<ellipse fill="none" stroke="#000000" cx="2893.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="2893.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_10&#45;&gt;structure_36 -->
<g id="edge36" class="edge">
<title>block_10&#45;&gt;structure_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2809.3081,-1017.4082C2820.5267,-1007.8266 2833.1284,-994.8837 2840.3324,-980.4014 2900.3894,-859.6686 2898.7688,-692.4963 2895.3336,-626.5617"/>
<polygon fill="#000000" stroke="#000000" points="2898.8243,-626.2981 2894.7533,-616.5166 2891.836,-626.7019 2898.8243,-626.2981"/>
</g>
<!-- structure_37 -->
<g id="node38" class="node">
<title>structure_37</title>
<ellipse fill="none" stroke="#000000" cx="3000.3324" cy="-598.2007" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3000.3324" y="-594.0007" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- block_10&#45;&gt;structure_37 -->
<g id="edge37" class="edge">
<title>block_10&#45;&gt;structure_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2838.1965,-1023.2465C2879.6604,-1013.2422 2933.1213,-997.5331 2947.3324,-980.4014 3034.4144,-875.4236 3016.5026,-695.6642 3005.5236,-626.4827"/>
<polygon fill="#000000" stroke="#000000" points="3008.9327,-625.6469 3003.8382,-616.3573 3002.0277,-626.7963 3008.9327,-625.6469"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="3373.3324,-695.1015 3063.3324,-695.1015 3063.3324,-501.3 3373.3324,-501.3 3373.3324,-695.1015"/>
<text text-anchor="middle" x="3218.3324" y="-679.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">local function Highlighter(parser, rules)</text>
<text text-anchor="middle" x="3218.3324" y="-664.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local function lighter(source)</text>
<text text-anchor="middle" x="3218.3324" y="-648.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if type(source) == &quot;string&quot; then</text>
<text text-anchor="middle" x="3218.3324" y="-633.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;source = ast.parse(parser,source)</text>
<text text-anchor="middle" x="3218.3324" y="-618.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3218.3324" y="-602.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return light(source, rules)</text>
<text text-anchor="middle" x="3218.3324" y="-587.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3218.3324" y="-571.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lighter</text>
<text text-anchor="middle" x="3218.3324" y="-556.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3218.3324" y="-525.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">return {Highlighter = Highlighter,</text>
<text text-anchor="middle" x="3218.3324" y="-509.7006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;light = light}</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>codeblock_11&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3092.7945,-1016.2138C3108.4783,-963.9903 3154.5564,-810.5605 3186.298,-704.8681"/>
<polygon fill="#000000" stroke="#000000" points="3189.7032,-705.6977 3189.2275,-695.1136 3182.999,-703.6843 3189.7032,-705.6977"/>
</g>
<!-- handleline_21 -->
<g id="node22" class="node">
<title>handleline_21</title>
<ellipse fill="none" stroke="#000000" cx="1772.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1772.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_17&#45;&gt;handleline_21 -->
<g id="edge21" class="edge">
<title>structure_17&#45;&gt;handleline_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1789.5819,-580.0131C1786.7801,-512.1164 1776.919,-273.1496 1773.5057,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="1776.9956,-190.1125 1773.0861,-180.2653 1770.0015,-190.4011 1776.9956,-190.1125"/>
</g>
<!-- handleline_24 -->
<g id="node25" class="node">
<title>handleline_24</title>
<ellipse fill="none" stroke="#000000" cx="1891.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="1891.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_18&#45;&gt;handleline_24 -->
<g id="edge24" class="edge">
<title>structure_18&#45;&gt;handleline_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1897.0822,-580.0131C1896.1483,-512.1164 1892.8613,-273.1496 1891.7235,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="1895.221,-190.2162 1891.5836,-180.2653 1888.2216,-190.3125 1895.221,-190.2162"/>
</g>
<!-- handleline_27 -->
<g id="node28" class="node">
<title>handleline_27</title>
<ellipse fill="none" stroke="#000000" cx="2010.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2010.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_19&#45;&gt;handleline_27 -->
<g id="edge27" class="edge">
<title>structure_19&#45;&gt;handleline_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2004.5826,-580.0131C2005.5165,-512.1164 2008.8035,-273.1496 2009.9413,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="2013.4432,-190.3125 2010.0812,-180.2653 2006.4439,-190.2162 2013.4432,-190.3125"/>
</g>
<!-- handleline_30 -->
<g id="node31" class="node">
<title>handleline_30</title>
<ellipse fill="none" stroke="#000000" cx="2129.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2129.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_20&#45;&gt;handleline_30 -->
<g id="edge30" class="edge">
<title>structure_20&#45;&gt;handleline_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2112.0829,-580.0131C2114.8847,-512.1164 2124.7458,-273.1496 2128.1591,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="2131.6633,-190.4011 2128.5787,-180.2653 2124.6693,-190.1125 2131.6633,-190.4011"/>
</g>
<!-- handle_22 -->
<g id="node23" class="node">
<title>handle_22</title>
<ellipse fill="none" stroke="#000000" cx="1772.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1772.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_21&#45;&gt;handle_22 -->
<g id="edge22" class="edge">
<title>handleline_21&#45;&gt;handle_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1772.3324,-143.8314C1772.3324,-136.131 1772.3324,-126.9743 1772.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="1775.8325,-118.4132 1772.3324,-108.4133 1768.8325,-118.4133 1775.8325,-118.4132"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1799.3324,-36 1745.3324,-36 1745.3324,0 1799.3324,0 1799.3324,-36"/>
</g>
<!-- handle_22&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>handle_22&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1772.3324,-71.8314C1772.3324,-64.131 1772.3324,-54.9743 1772.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="1775.8325,-46.4132 1772.3324,-36.4133 1768.8325,-46.4133 1775.8325,-46.4132"/>
</g>
<!-- handle_25 -->
<g id="node26" class="node">
<title>handle_25</title>
<ellipse fill="none" stroke="#000000" cx="1891.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="1891.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_24&#45;&gt;handle_25 -->
<g id="edge25" class="edge">
<title>handleline_24&#45;&gt;handle_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1891.3324,-143.8314C1891.3324,-136.131 1891.3324,-126.9743 1891.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="1894.8325,-118.4132 1891.3324,-108.4133 1887.8325,-118.4133 1894.8325,-118.4132"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1918.3324,-36 1864.3324,-36 1864.3324,0 1918.3324,0 1918.3324,-36"/>
</g>
<!-- handle_25&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>handle_25&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1891.3324,-71.8314C1891.3324,-64.131 1891.3324,-54.9743 1891.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="1894.8325,-46.4132 1891.3324,-36.4133 1887.8325,-46.4133 1894.8325,-46.4132"/>
</g>
<!-- handle_28 -->
<g id="node29" class="node">
<title>handle_28</title>
<ellipse fill="none" stroke="#000000" cx="2010.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2010.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_27&#45;&gt;handle_28 -->
<g id="edge28" class="edge">
<title>handleline_27&#45;&gt;handle_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2010.3324,-143.8314C2010.3324,-136.131 2010.3324,-126.9743 2010.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2013.8325,-118.4132 2010.3324,-108.4133 2006.8325,-118.4133 2013.8325,-118.4132"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="2037.3324,-36 1983.3324,-36 1983.3324,0 2037.3324,0 2037.3324,-36"/>
</g>
<!-- handle_28&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>handle_28&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2010.3324,-71.8314C2010.3324,-64.131 2010.3324,-54.9743 2010.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2013.8325,-46.4132 2010.3324,-36.4133 2006.8325,-46.4133 2013.8325,-46.4132"/>
</g>
<!-- handle_31 -->
<g id="node32" class="node">
<title>handle_31</title>
<ellipse fill="none" stroke="#000000" cx="2129.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2129.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_30&#45;&gt;handle_31 -->
<g id="edge31" class="edge">
<title>handleline_30&#45;&gt;handle_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2129.3324,-143.8314C2129.3324,-136.131 2129.3324,-126.9743 2129.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2132.8325,-118.4132 2129.3324,-108.4133 2125.8325,-118.4133 2132.8325,-118.4132"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2156.3324,-36 2102.3324,-36 2102.3324,0 2156.3324,0 2156.3324,-36"/>
</g>
<!-- handle_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>handle_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2129.3324,-71.8314C2129.3324,-64.131 2129.3324,-54.9743 2129.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2132.8325,-46.4132 2129.3324,-36.4133 2125.8325,-46.4133 2132.8325,-46.4132"/>
</g>
<!-- handleline_38 -->
<g id="node39" class="node">
<title>handleline_38</title>
<ellipse fill="none" stroke="#000000" cx="2661.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2661.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_34&#45;&gt;handleline_38 -->
<g id="edge38" class="edge">
<title>structure_34&#45;&gt;handleline_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2678.5819,-580.0131C2675.7801,-512.1164 2665.919,-273.1496 2662.5057,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="2665.9956,-190.1125 2662.0861,-180.2653 2659.0015,-190.4011 2665.9956,-190.1125"/>
</g>
<!-- handleline_41 -->
<g id="node42" class="node">
<title>handleline_41</title>
<ellipse fill="none" stroke="#000000" cx="2780.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2780.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_35&#45;&gt;handleline_41 -->
<g id="edge41" class="edge">
<title>structure_35&#45;&gt;handleline_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2786.0822,-580.0131C2785.1483,-512.1164 2781.8613,-273.1496 2780.7235,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="2784.221,-190.2162 2780.5836,-180.2653 2777.2216,-190.3125 2784.221,-190.2162"/>
</g>
<!-- handleline_44 -->
<g id="node45" class="node">
<title>handleline_44</title>
<ellipse fill="none" stroke="#000000" cx="2899.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="2899.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_36&#45;&gt;handleline_44 -->
<g id="edge44" class="edge">
<title>structure_36&#45;&gt;handleline_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2893.5826,-580.0131C2894.5165,-512.1164 2897.8035,-273.1496 2898.9413,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="2902.4432,-190.3125 2899.0812,-180.2653 2895.4439,-190.2162 2902.4432,-190.3125"/>
</g>
<!-- handleline_47 -->
<g id="node48" class="node">
<title>handleline_47</title>
<ellipse fill="none" stroke="#000000" cx="3018.3324" cy="-162" rx="50.3585" ry="18"/>
<text text-anchor="middle" x="3018.3324" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handleline</text>
</g>
<!-- structure_37&#45;&gt;handleline_47 -->
<g id="edge47" class="edge">
<title>structure_37&#45;&gt;handleline_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3001.0829,-580.0131C3003.8847,-512.1164 3013.7458,-273.1496 3017.1591,-190.4323"/>
<polygon fill="#000000" stroke="#000000" points="3020.6633,-190.4011 3017.5787,-180.2653 3013.6693,-190.1125 3020.6633,-190.4011"/>
</g>
<!-- handle_39 -->
<g id="node40" class="node">
<title>handle_39</title>
<ellipse fill="none" stroke="#000000" cx="2661.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2661.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_38&#45;&gt;handle_39 -->
<g id="edge39" class="edge">
<title>handleline_38&#45;&gt;handle_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2661.3324,-143.8314C2661.3324,-136.131 2661.3324,-126.9743 2661.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2664.8325,-118.4132 2661.3324,-108.4133 2657.8325,-118.4133 2664.8325,-118.4132"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2688.3324,-36 2634.3324,-36 2634.3324,0 2688.3324,0 2688.3324,-36"/>
</g>
<!-- handle_39&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>handle_39&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2661.3324,-71.8314C2661.3324,-64.131 2661.3324,-54.9743 2661.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2664.8325,-46.4132 2661.3324,-36.4133 2657.8325,-46.4133 2664.8325,-46.4132"/>
</g>
<!-- handle_42 -->
<g id="node43" class="node">
<title>handle_42</title>
<ellipse fill="none" stroke="#000000" cx="2780.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2780.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_41&#45;&gt;handle_42 -->
<g id="edge42" class="edge">
<title>handleline_41&#45;&gt;handle_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2780.3324,-143.8314C2780.3324,-136.131 2780.3324,-126.9743 2780.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2783.8325,-118.4132 2780.3324,-108.4133 2776.8325,-118.4133 2783.8325,-118.4132"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="2807.3324,-36 2753.3324,-36 2753.3324,0 2807.3324,0 2807.3324,-36"/>
</g>
<!-- handle_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>handle_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2780.3324,-71.8314C2780.3324,-64.131 2780.3324,-54.9743 2780.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2783.8325,-46.4132 2780.3324,-36.4133 2776.8325,-46.4133 2783.8325,-46.4132"/>
</g>
<!-- handle_45 -->
<g id="node46" class="node">
<title>handle_45</title>
<ellipse fill="none" stroke="#000000" cx="2899.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="2899.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_44&#45;&gt;handle_45 -->
<g id="edge45" class="edge">
<title>handleline_44&#45;&gt;handle_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2899.3324,-143.8314C2899.3324,-136.131 2899.3324,-126.9743 2899.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="2902.8325,-118.4132 2899.3324,-108.4133 2895.8325,-118.4133 2902.8325,-118.4132"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2926.3324,-36 2872.3324,-36 2872.3324,0 2926.3324,0 2926.3324,-36"/>
</g>
<!-- handle_45&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>handle_45&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2899.3324,-71.8314C2899.3324,-64.131 2899.3324,-54.9743 2899.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="2902.8325,-46.4132 2899.3324,-36.4133 2895.8325,-46.4133 2902.8325,-46.4132"/>
</g>
<!-- handle_48 -->
<g id="node49" class="node">
<title>handle_48</title>
<ellipse fill="none" stroke="#000000" cx="3018.3324" cy="-90" rx="36.827" ry="18"/>
<text text-anchor="middle" x="3018.3324" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">handle</text>
</g>
<!-- handleline_47&#45;&gt;handle_48 -->
<g id="edge48" class="edge">
<title>handleline_47&#45;&gt;handle_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3018.3324,-143.8314C3018.3324,-136.131 3018.3324,-126.9743 3018.3324,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="3021.8325,-118.4132 3018.3324,-108.4133 3014.8325,-118.4133 3021.8325,-118.4132"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="3045.3324,-36 2991.3324,-36 2991.3324,0 3045.3324,0 3045.3324,-36"/>
</g>
<!-- handle_48&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>handle_48&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3018.3324,-71.8314C3018.3324,-64.131 3018.3324,-54.9743 3018.3324,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="3021.8325,-46.4132 3018.3324,-36.4133 3014.8325,-46.4133 3021.8325,-46.4132"/>
</g>
</g>
</svg>