<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3597pt" height="1219pt"
 viewBox="0.00 0.00 3597.00 1218.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1214.6015)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1214.6015 3593,-1214.6015 3593,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="368" cy="-1192.6015" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="368" y="-1188.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 123</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="368" cy="-1120.6015" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="368" y="-1116.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;41</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M368,-1174.4329C368,-1166.7325 368,-1157.5759 368,-1149.0182"/>
<polygon fill="#000000" stroke="#000000" points="371.5001,-1149.0148 368,-1139.0148 364.5001,-1149.0148 371.5001,-1149.0148"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="204" cy="-1048.6015" rx="58.5101" ry="18"/>
<text text-anchor="middle" x="204" y="-1044.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Grimoire </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M333.6202,-1105.508C308.4143,-1094.442 274.0217,-1079.3428 246.9972,-1067.4784"/>
<polygon fill="#000000" stroke="#000000" points="248.3362,-1064.2438 237.7727,-1063.4286 245.5222,-1070.6533 248.3362,-1064.2438"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="313" cy="-1048.6015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="313" y="-1044.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.4045,-1102.8038C347.6139,-1093.9143 339.2883,-1083.0153 331.8881,-1073.3278"/>
<polygon fill="#000000" stroke="#000000" points="334.5368,-1071.0294 325.685,-1065.2074 328.9741,-1075.2787 334.5368,-1071.0294"/>
</g>
<!-- section_4 -->
<g id="node5" class="node">
<title>section_4</title>
<ellipse fill="none" stroke="#000000" cx="424" cy="-1048.6015" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="424" y="-1044.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 5&#45;41</text>
</g>
<!-- section_1&#45;&gt;section_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;section_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M381.8427,-1102.8038C388.5563,-1094.1719 396.7436,-1083.6455 404.1109,-1074.1732"/>
<polygon fill="#000000" stroke="#000000" points="406.9398,-1076.2369 410.3165,-1066.1946 401.4143,-1071.9393 406.9398,-1076.2369"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1563" cy="-1048.6015" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1563" y="-1044.4015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 42&#45;101</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M427.6691,-1117.0064C625.6328,-1105.0789 1260.8034,-1066.8092 1484.3023,-1053.3431"/>
<polygon fill="#000000" stroke="#000000" points="1484.5412,-1056.8352 1494.3126,-1052.74 1484.1202,-1049.8479 1484.5412,-1056.8352"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="240,-994.8036 0,-994.8036 0,-954.9994 240,-954.9994 240,-994.8036"/>
<text text-anchor="middle" x="120" y="-963.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">A metalanguage for magic spells.</text>
</g>
<!-- prose_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>prose_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M287.5152,-1037.1193C282.4016,-1034.8985 277.0485,-1032.6324 272,-1030.6015 244.1332,-1019.3913 213.042,-1007.8332 186.2756,-998.1715"/>
<polygon fill="#000000" stroke="#000000" points="187.2184,-994.7912 176.6239,-994.7019 184.8503,-1001.3785 187.2184,-994.7912"/>
</g>
<!-- header_7 -->
<g id="node8" class="node">
<title>header_7</title>
<ellipse fill="none" stroke="#000000" cx="316" cy="-974.9015" rx="57.5753" ry="18"/>
<text text-anchor="middle" x="316" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Requires</text>
</g>
<!-- section_4&#45;&gt;header_7 -->
<g id="edge7" class="edge">
<title>section_4&#45;&gt;header_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M399.7627,-1032.0618C384.6162,-1021.7257 364.9265,-1008.2893 348.4429,-997.0408"/>
<polygon fill="#000000" stroke="#000000" points="350.3893,-994.1318 340.1564,-991.386 346.4436,-999.9138 350.3893,-994.1318"/>
</g>
<!-- prose_8 -->
<g id="node9" class="node">
<title>prose_8</title>
<ellipse fill="none" stroke="#000000" cx="424" cy="-974.9015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="424" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_4&#45;&gt;prose_8 -->
<g id="edge8" class="edge">
<title>section_4&#45;&gt;prose_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424,-1030.3835C424,-1022.1726 424,-1012.2869 424,-1003.1488"/>
<polygon fill="#000000" stroke="#000000" points="427.5001,-1002.9099 424,-992.9099 420.5001,-1002.91 427.5001,-1002.9099"/>
</g>
<!-- codeblock_9 -->
<g id="node10" class="node">
<title>codeblock_9</title>
<ellipse fill="none" stroke="#000000" cx="547" cy="-974.9015" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="547" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 9&#45;40</text>
</g>
<!-- section_4&#45;&gt;codeblock_9 -->
<g id="edge9" class="edge">
<title>section_4&#45;&gt;codeblock_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M450.9929,-1032.4277C468.4528,-1021.966 491.399,-1008.2169 510.4801,-996.7838"/>
<polygon fill="#000000" stroke="#000000" points="512.4388,-999.6904 519.2178,-991.5482 508.8409,-993.6858 512.4388,-999.6904"/>
</g>
<!-- header_12 -->
<g id="node13" class="node">
<title>header_12</title>
<ellipse fill="none" stroke="#000000" cx="1339" cy="-974.9015" rx="91.9296" ry="18"/>
<text text-anchor="middle" x="1339" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Argument parsing</text>
</g>
<!-- section_5&#45;&gt;header_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;header_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1519.5449,-1034.304C1484.2413,-1022.6885 1434.174,-1006.2155 1395.7152,-993.5618"/>
<polygon fill="#000000" stroke="#000000" points="1396.7967,-990.2331 1386.2037,-990.4324 1394.6089,-996.8825 1396.7967,-990.2331"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="1481" cy="-974.9015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1481" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1543.5671,-1031.1357C1532.2229,-1020.9396 1517.7991,-1007.9758 1505.6601,-997.0655"/>
<polygon fill="#000000" stroke="#000000" points="1507.8454,-994.3237 1498.0683,-990.2421 1503.1661,-999.5299 1507.8454,-994.3237"/>
</g>
<!-- prose_14 -->
<g id="node15" class="node">
<title>prose_14</title>
<ellipse fill="none" stroke="#000000" cx="1563" cy="-974.9015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1563" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;prose_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1563,-1030.3835C1563,-1022.1726 1563,-1012.2869 1563,-1003.1488"/>
<polygon fill="#000000" stroke="#000000" points="1566.5001,-1002.9099 1563,-992.9099 1559.5001,-1002.91 1566.5001,-1002.9099"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="1785" cy="-974.9015" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1785" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 50&#45;90</text>
</g>
<!-- section_5&#45;&gt;codeblock_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;codeblock_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1606.0671,-1034.304C1641.6017,-1022.5072 1692.2286,-1005.6999 1730.5678,-992.972"/>
<polygon fill="#000000" stroke="#000000" points="1732.1442,-996.1366 1740.5321,-989.6641 1729.9386,-989.4931 1732.1442,-996.1366"/>
</g>
<!-- section_16 -->
<g id="node17" class="node">
<title>section_16</title>
<ellipse fill="none" stroke="#000000" cx="2449" cy="-974.9015" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2449" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 92&#45;101</text>
</g>
<!-- section_5&#45;&gt;section_16 -->
<g id="edge16" class="edge">
<title>section_5&#45;&gt;section_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1630.3212,-1043.0016C1791.7856,-1029.5705 2200.3301,-995.5866 2371.5869,-981.341"/>
<polygon fill="#000000" stroke="#000000" points="2372.1058,-984.81 2381.7813,-980.493 2371.5255,-977.8341 2372.1058,-984.81"/>
</g>
<!-- section_17 -->
<g id="node18" class="node">
<title>section_17</title>
<ellipse fill="none" stroke="#000000" cx="3034" cy="-974.9015" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3034" y="-970.7015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 102&#45;123</text>
</g>
<!-- section_5&#45;&gt;section_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;section_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1632.4673,-1045.1211C1875.2441,-1032.9575 2685.372,-992.3685 2949.759,-979.1222"/>
<polygon fill="#000000" stroke="#000000" points="2950.2483,-982.6021 2960.0606,-978.606 2949.8979,-975.6109 2950.2483,-982.6021"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="366.5,-632.4031 7.5,-632.4031 7.5,-592.5989 366.5,-592.5989 366.5,-632.4031"/>
<text text-anchor="middle" x="187" y="-601.001" font-family="Inconsolata" font-size="14.00" fill="#000000">Like any main entry =grym.lua= is mostly imports.</text>
</g>
<!-- prose_8&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>prose_8&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M409.0057,-958.8941C399.1591,-948.0559 386.253,-933.2114 376,-919.2015 304.5933,-821.63 233.2557,-696.5264 202.6018,-641.1112"/>
<polygon fill="#000000" stroke="#000000" points="205.5897,-639.2813 197.698,-632.2122 199.4589,-642.6596 205.5897,-639.2813"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="709,-850.4018 385,-850.4018 385,-374.6002 709,-374.6002 709,-850.4018"/>
<text text-anchor="middle" x="547" y="-835.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">require &quot;pl.strict&quot;</text>
<text text-anchor="middle" x="547" y="-803.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">local verbose = false</text>
<text text-anchor="middle" x="547" y="-756.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file &#160;= require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="547" y="-740.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir &#160;&#160;= require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="547" y="-725.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path &#160;= require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="547" y="-710.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="547" y="-694.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="547" y="-679.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="547" y="-663.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="547" y="-648.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="547" y="-617.001" font-family="Inconsolata" font-size="14.00" fill="#000000">L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="547" y="-585.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local ansi = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="547" y="-570.201" font-family="Inconsolata" font-size="14.00" fill="#000000">u &#160;&#160;&#160;= require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="547" y="-522.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local ast &#160;= require &quot;peg/ast&quot;</text>
<text text-anchor="middle" x="547" y="-507.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="547" y="-476.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local P_grym = require &quot;grym/grymmyr&quot; </text>
<text text-anchor="middle" x="547" y="-460.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="547" y="-445.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">Doc = require &quot;grym/doc&quot;</text>
<text text-anchor="middle" x="547" y="-413.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local invert = require &quot;invert&quot;</text>
<text text-anchor="middle" x="547" y="-398.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local knit &#160;&#160;= require &quot;knit&quot;</text>
<text text-anchor="middle" x="547" y="-383.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local weave &#160;= require &quot;weave&quot;</text>
</g>
<!-- codeblock_9&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_9&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M547,-956.4318C547,-936.1109 547,-900.9324 547,-860.6115"/>
<polygon fill="#000000" stroke="#000000" points="550.5001,-860.5383 547,-850.5384 543.5001,-860.5384 550.5001,-860.5383"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1219,-639.8014 727,-639.8014 727,-585.2006 1219,-585.2006 1219,-639.8014"/>
<text text-anchor="middle" x="973" y="-608.701" font-family="Inconsolata" font-size="14.00" fill="#000000">This is done crudely, we can use =pl.lapp= in future to parse within</text>
<text text-anchor="middle" x="973" y="-593.301" font-family="Inconsolata" font-size="14.00" fill="#000000">commands to each verb.</text>
</g>
<!-- prose_13&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>prose_13&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1457.6126,-962.2825C1451.9688,-959.6276 1445.8698,-957.0692 1440,-955.2015 1348.9281,-926.2232 1310.8101,-966.9122 1228,-919.2015 1113.3893,-853.1691 1027.8428,-714.9229 991.7968,-648.9916"/>
<polygon fill="#000000" stroke="#000000" points="994.8719,-647.32 987.0412,-640.1834 988.7123,-650.6456 994.8719,-647.32"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1701,-631.8016 1237,-631.8016 1237,-593.2004 1701,-593.2004 1701,-631.8016"/>
<text text-anchor="middle" x="1469" y="-616.701" font-family="Inconsolata" font-size="14.00" fill="#000000">Note here that we pass in the pwd from a shell script. This may </text>
<text text-anchor="middle" x="1469" y="-601.301" font-family="Inconsolata" font-size="14.00" fill="#000000">change, now that we&#39;ve added [[sh][../lib/sh.lua]]]]</text>
</g>
<!-- prose_14&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>prose_14&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1558.3385,-956.93C1543.191,-898.5314 1495.2588,-713.737 1476.5674,-641.6757"/>
<polygon fill="#000000" stroke="#000000" points="1479.9279,-640.691 1474.0292,-631.8901 1473.1521,-642.4486 1479.9279,-640.691"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="2225,-919.4021 1719,-919.4021 1719,-305.5999 2225,-305.5999 2225,-919.4021"/>
<text text-anchor="middle" x="1972" y="-904.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">local pwd, verb = &quot;&quot;, &quot;&quot;</text>
<text text-anchor="middle" x="1972" y="-872.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">if (arg) then</text>
<text text-anchor="middle" x="1972" y="-857.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;pwd = table.remove(arg, 1)</text>
<text text-anchor="middle" x="1972" y="-841.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;verb = table.remove(arg, 1)</text>
<text text-anchor="middle" x="1972" y="-826.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(arg) do</text>
<text text-anchor="middle" x="1972" y="-811.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write(ansi.yellow(v)..&quot;\n&quot;)</text>
<text text-anchor="middle" x="1972" y="-795.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1972" y="-780.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1972" y="-732.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">local grym = {}</text>
<text text-anchor="middle" x="1972" y="-701.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">grym.invert = invert</text>
<text text-anchor="middle" x="1972" y="-686.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">grym.knit &#160;&#160;= knit</text>
<text text-anchor="middle" x="1972" y="-670.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">grym.weave &#160;= weave</text>
<text text-anchor="middle" x="1972" y="-639.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">samples = getfiles(&quot;samples&quot;)</text>
<text text-anchor="middle" x="1972" y="-607.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local own = require &quot;grym/own&quot;</text>
<text text-anchor="middle" x="1972" y="-576.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">if verb == &quot;invert&quot; then</text>
<text text-anchor="middle" x="1972" y="-561.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; If we allow inversion in its present no&#45;guards state,</text>
<text text-anchor="middle" x="1972" y="-545.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; we will lose all commentary</text>
<text text-anchor="middle" x="1972" y="-530.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;u.freeze(&quot;no&quot;)</text>
<text text-anchor="middle" x="1972" y="-514.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45;invert:invert_all(pwd)</text>
<text text-anchor="middle" x="1972" y="-499.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">elseif verb == &quot;knit&quot; then</text>
<text text-anchor="middle" x="1972" y="-484.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; knitter goes here</text>
<text text-anchor="middle" x="1972" y="-468.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;knit:knit_all(pwd)</text>
<text text-anchor="middle" x="1972" y="-453.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">elseif verb == &quot;weave&quot; then</text>
<text text-anchor="middle" x="1972" y="-437.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; local weaved = weave:weaveMd(Doc(read(&quot;../orb/grym/block.gm&quot;)))</text>
<text text-anchor="middle" x="1972" y="-422.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; io.write(weaved)</text>
<text text-anchor="middle" x="1972" y="-407.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;weave:weave_all(pwd) &#160;&#160;&#160;</text>
<text text-anchor="middle" x="1972" y="-375.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">elseif not verb then</text>
<text text-anchor="middle" x="1972" y="-360.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; do the things</text>
<text text-anchor="middle" x="1972" y="-344.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;weave:weave_all(pwd)</text>
<text text-anchor="middle" x="1972" y="-329.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;knit:knit_all(pwd)</text>
<text text-anchor="middle" x="1972" y="-314.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_15&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1794.2734,-956.93C1798.1787,-949.3616 1803.1795,-939.6701 1809.0072,-928.3763"/>
<polygon fill="#000000" stroke="#000000" points="1812.1451,-929.9277 1813.6204,-919.4361 1805.9244,-926.7178 1812.1451,-929.9277"/>
</g>
<!-- header_21 -->
<g id="node22" class="node">
<title>header_21</title>
<ellipse fill="none" stroke="#000000" cx="2364" cy="-612.501" rx="120.9043" ry="18"/>
<text text-anchor="middle" x="2364" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : Sample Doc for REPLing</text>
</g>
<!-- section_16&#45;&gt;header_21 -->
<g id="edge21" class="edge">
<title>section_16&#45;&gt;header_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2444.7848,-956.93C2431.0201,-898.2435 2387.3166,-711.9121 2370.5948,-640.6182"/>
<polygon fill="#000000" stroke="#000000" points="2373.9317,-639.5175 2368.2406,-630.581 2367.1167,-641.116 2373.9317,-639.5175"/>
</g>
<!-- prose_22 -->
<g id="node23" class="node">
<title>prose_22</title>
<ellipse fill="none" stroke="#000000" cx="2535" cy="-612.501" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2535" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_16&#45;&gt;prose_22 -->
<g id="edge22" class="edge">
<title>section_16&#45;&gt;prose_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2467.696,-957.0412C2477.1607,-946.8731 2487.9089,-933.3623 2494,-919.2015 2535.1933,-823.4343 2537.4935,-696.6156 2536.1953,-640.8556"/>
<polygon fill="#000000" stroke="#000000" points="2539.6887,-640.5749 2535.8981,-630.6813 2532.6916,-640.7793 2539.6887,-640.5749"/>
</g>
<!-- codeblock_23 -->
<g id="node24" class="node">
<title>codeblock_23</title>
<ellipse fill="none" stroke="#000000" cx="2668" cy="-612.501" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2668" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 94&#45;100</text>
</g>
<!-- section_16&#45;&gt;codeblock_23 -->
<g id="edge23" class="edge">
<title>section_16&#45;&gt;codeblock_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2501.9153,-962.8662C2527.5084,-954.5411 2556.7733,-940.9272 2576,-919.2015 2648.6601,-837.0974 2663.969,-699.465 2667.1685,-640.5944"/>
<polygon fill="#000000" stroke="#000000" points="2670.6672,-640.7017 2667.6361,-630.5497 2663.6747,-640.3761 2670.6672,-640.7017"/>
</g>
<!-- header_26 -->
<g id="node27" class="node">
<title>header_26</title>
<ellipse fill="none" stroke="#000000" cx="2929" cy="-612.501" rx="160.5556" ry="18"/>
<text text-anchor="middle" x="2929" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Run the samples and make dotfiles</text>
</g>
<!-- section_17&#45;&gt;header_26 -->
<g id="edge26" class="edge">
<title>section_17&#45;&gt;header_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3028.793,-956.93C3011.7895,-898.2435 2957.8028,-711.9121 2937.1465,-640.6182"/>
<polygon fill="#000000" stroke="#000000" points="2940.3831,-639.2119 2934.2384,-630.581 2933.6596,-641.16 2940.3831,-639.2119"/>
</g>
<!-- prose_27 -->
<g id="node28" class="node">
<title>prose_27</title>
<ellipse fill="none" stroke="#000000" cx="3140" cy="-612.501" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3140" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_17&#45;&gt;prose_27 -->
<g id="edge27" class="edge">
<title>section_17&#45;&gt;prose_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3062.0027,-957.952C3075.4263,-948.3107 3090.4169,-935.003 3099,-919.2015 3148.9845,-827.1802 3146.6189,-697.4654 3142.6464,-640.8196"/>
<polygon fill="#000000" stroke="#000000" points="3146.1328,-640.5077 3141.8719,-630.8074 3139.1537,-641.0476 3146.1328,-640.5077"/>
</g>
<!-- codeblock_28 -->
<g id="node29" class="node">
<title>codeblock_28</title>
<ellipse fill="none" stroke="#000000" cx="3340" cy="-612.501" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3340" y="-608.301" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 104&#45;122</text>
</g>
<!-- section_17&#45;&gt;codeblock_28 -->
<g id="edge28" class="edge">
<title>section_17&#45;&gt;codeblock_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3092.2224,-963.2915C3121.5792,-955.0276 3156.1304,-941.3397 3181,-919.2015 3269.7483,-840.2003 3316.357,-699.8037 3332.8992,-640.3427"/>
<polygon fill="#000000" stroke="#000000" points="3336.3186,-641.1058 3335.5563,-630.5384 3329.5623,-639.2747 3336.3186,-641.1058"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2502,-152.9003 2448,-152.9003 2448,-116.9003 2502,-116.9003 2502,-152.9003"/>
</g>
<!-- prose_22&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>prose_22&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2532.7212,-594.3617C2523.5976,-521.7378 2489.6634,-251.6211 2478.5492,-163.152"/>
<polygon fill="#000000" stroke="#000000" points="2482.0004,-162.5434 2477.2811,-153.0577 2475.0549,-163.416 2482.0004,-162.5434"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2935.5,-170.2006 2520.5,-170.2006 2520.5,-99.5999 2935.5,-99.5999 2935.5,-170.2006"/>
<text text-anchor="middle" x="2728" y="-155.1003" font-family="Inconsolata" font-size="14.00" fill="#000000">sample_doc = Doc(read(&quot;../orb/grym.orb&quot;)) or &quot;&quot;</text>
<text text-anchor="middle" x="2728" y="-123.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">dot_sh = (require &quot;sh&quot;):clear_G().command(&#39;dot&#39;, &#39;&#45;Tsvg&#39;)</text>
</g>
<!-- codeblock_23&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>codeblock_23&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2670.2788,-594.3617C2678.8672,-525.9978 2709.4409,-282.6312 2722.269,-180.5192"/>
<polygon fill="#000000" stroke="#000000" points="2725.7524,-180.8695 2723.5263,-170.5112 2718.807,-179.9969 2725.7524,-180.8695"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="3135,-152.9003 3081,-152.9003 3081,-116.9003 3135,-116.9003 3135,-152.9003"/>
</g>
<!-- prose_27&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>prose_27&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3138.7846,-594.3617C3133.9187,-521.7378 3115.8205,-251.6211 3109.8929,-163.152"/>
<polygon fill="#000000" stroke="#000000" points="3113.3774,-162.8013 3109.2166,-153.0577 3106.393,-163.2693 3113.3774,-162.8013"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="3589,-269.7009 3153,-269.7009 3153,-.0997 3589,-.0997 3589,-269.7009"/>
<text text-anchor="middle" x="3371" y="-254.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;&#45;[[</text>
<text text-anchor="middle" x="3371" y="-239.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">for _,v in ipairs(samples) do</text>
<text text-anchor="middle" x="3371" y="-223.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if v:match(&quot;~&quot;) == nil then</text>
<text text-anchor="middle" x="3371" y="-208.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if verbose then io.write(v) end</text>
<text text-anchor="middle" x="3371" y="-193.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local sample = read(v)</text>
<text text-anchor="middle" x="3371" y="-177.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45;io.write(v..&quot;\n&quot;)</text>
<text text-anchor="middle" x="3371" y="-162.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc = Doc(sample)</text>
<text text-anchor="middle" x="3371" y="-146.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_dot = doc:dot()</text>
<text text-anchor="middle" x="3371" y="-131.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local old_dot = read(&quot;../orb/dot/&quot; .. v .. &quot;.dot&quot;)</text>
<text text-anchor="middle" x="3371" y="-116.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if old_dot and old_dot ~= doc_dot then</text>
<text text-anchor="middle" x="3371" y="-100.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write(&quot; &#160;&#160;&#45;&#45; changed dotfile: &quot; .. v)</text>
<text text-anchor="middle" x="3371" y="-85.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(&quot;../orb/dot/&quot; .. v .. &quot;&#45;old.dot&quot;, old_dot)</text>
<text text-anchor="middle" x="3371" y="-69.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3371" y="-54.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;write(&quot;../orb/dot/&quot; .. v .. &quot;.dot&quot;, doc:dot())</text>
<text text-anchor="middle" x="3371" y="-39.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3371" y="-23.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3371" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;]]</text>
</g>
<!-- codeblock_28&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>codeblock_28&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3341.1774,-594.3617C3344.492,-543.2951 3354.1448,-394.5802 3361.5797,-280.0337"/>
<polygon fill="#000000" stroke="#000000" points="3365.0914,-279.965 3362.2466,-269.7593 3358.1061,-279.5116 3365.0914,-279.965"/>
</g>
</g>
</svg>