<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1087pt" height="989pt"
 viewBox="0.00 0.00 1087.00 989.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 985.2012)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-985.2012 1083,-985.2012 1083,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="256" cy="-963.2012" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="256" y="-959.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 80</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="256" cy="-891.2012" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="256" y="-887.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;80</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256,-945.0325C256,-937.3321 256,-928.1755 256,-919.6178"/>
<polygon fill="#000000" stroke="#000000" points="259.5001,-919.6144 256,-909.6145 252.5001,-919.6145 259.5001,-919.6144"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="108" cy="-819.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="108" y="-815.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">0 : </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M223.5927,-875.7279C201.1964,-864.9974 170.7396,-850.3314 144,-837.2012 142.2594,-836.3465 140.4732,-835.4656 138.6717,-834.5742"/>
<polygon fill="#000000" stroke="#000000" points="140.1896,-831.4202 129.6769,-830.1027 137.0735,-837.6884 140.1896,-831.4202"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="199" cy="-819.2012" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="199" y="-815.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;3</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M241.9101,-873.4034C235.0256,-864.7072 226.6187,-854.0879 219.0765,-844.561"/>
<polygon fill="#000000" stroke="#000000" points="221.6824,-842.2138 212.7311,-836.5458 216.194,-846.5587 221.6824,-842.2138"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="314" cy="-819.2012" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="314" y="-815.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 4&#45;37</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M270.3371,-873.4034C277.3424,-864.7072 285.8968,-854.0879 293.5713,-844.561"/>
<polygon fill="#000000" stroke="#000000" points="296.4803,-846.529 300.028,-836.5458 291.029,-842.1377 296.4803,-846.529"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="777" cy="-819.2012" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="777" y="-815.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 38&#45;80</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M311.2629,-883.5641C409.2476,-870.023 612.7353,-841.9019 715.2055,-827.7409"/>
<polygon fill="#000000" stroke="#000000" points="715.9705,-831.1686 725.3972,-826.3325 715.0122,-824.2345 715.9705,-831.1686"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="71,-740.1011 17,-740.1011 17,-704.1011 71,-704.1011 71,-740.1011"/>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M163.145,-807.737C138.2594,-798.679 105.1864,-784.3661 80,-765.2012 73.8124,-760.4929 67.9863,-754.5354 62.8969,-748.5639"/>
<polygon fill="#000000" stroke="#000000" points="65.4372,-746.1371 56.4488,-740.5283 59.9776,-750.5182 65.4372,-746.1371"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="162" cy="-722.1011" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="162" y="-717.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 4&#45;31</text>
</g>
<!-- block_4&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M289.2403,-803.3843C264.1907,-787.3822 225.2398,-762.4997 197.0301,-744.479"/>
<polygon fill="#000000" stroke="#000000" points="198.5913,-741.3231 188.2798,-738.8891 194.8229,-747.2222 198.5913,-741.3231"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="681.5,-765.3015 252.5,-765.3015 252.5,-678.9008 681.5,-678.9008 681.5,-765.3015"/>
<text text-anchor="middle" x="467" y="-718.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, inverting the contents of =/src/=</text>
<text text-anchor="middle" x="467" y="-702.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/org/=. </text>
<text text-anchor="middle" x="467" y="-687.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M338.9226,-803.3843C353.0947,-794.3901 371.6873,-782.5905 390.2959,-770.7807"/>
<polygon fill="#000000" stroke="#000000" points="392.2634,-773.6774 398.8312,-765.3639 388.5125,-767.7672 392.2634,-773.6774"/>
</g>
<!-- codeblock_10 -->
<g id="node11" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="777" cy="-722.1011" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="777" y="-717.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 38&#45;80</text>
</g>
<!-- block_5&#45;&gt;codeblock_10 -->
<g id="edge10" class="edge">
<title>block_5&#45;&gt;codeblock_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777,-800.9374C777,-786.6968 777,-766.6681 777,-750.3623"/>
<polygon fill="#000000" stroke="#000000" points="780.5001,-750.283 777,-740.283 773.5001,-750.2831 780.5001,-750.283"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="926,-740.1011 872,-740.1011 872,-704.1011 926,-704.1011 926,-740.1011"/>
</g>
<!-- block_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>block_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M806.446,-803.7892C823.829,-793.9652 845.7363,-780.2756 863,-765.2012 868.7557,-760.1754 874.3614,-754.1871 879.3695,-748.2969"/>
<polygon fill="#000000" stroke="#000000" points="882.1809,-750.3875 885.7863,-740.425 876.7551,-745.9647 882.1809,-750.3875"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-527.4014 0,-527.4014 0,-115.5997 324,-115.5997 324,-527.4014"/>
<text text-anchor="middle" x="162" y="-512.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="162" y="-480.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="162" y="-465.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="162" y="-449.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="162" y="-434.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="162" y="-419.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="162" y="-403.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="162" y="-388.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="162" y="-372.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="162" y="-357.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="162" y="-342.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="162" y="-326.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="162" y="-311.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="162" y="-263.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="162" y="-248.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="162" y="-233.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="162" y="-217.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="162" y="-186.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="162" y="-170.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="162" y="-155.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="162" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">local inverter = require &quot;invert/inverter&quot;</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162,-703.8472C162,-672.8091 162,-606.3832 162,-537.4686"/>
<polygon fill="#000000" stroke="#000000" points="165.5001,-537.2867 162,-527.2867 158.5001,-537.2868 165.5001,-537.2867"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1079,-643.0016 475,-643.0016 475,.0005 1079,.0005 1079,-643.0016"/>
<text text-anchor="middle" x="777" y="-627.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_dir(inverter, pwd, depth)</text>
<text text-anchor="middle" x="777" y="-612.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="777" y="-597.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="777" y="-581.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="777" y="-566.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="777" y="-534.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="777" y="-519.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="777" y="-504.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="777" y="-488.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="777" y="-473.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (inverter.extension == extension(f)) then</text>
<text text-anchor="middle" x="777" y="-457.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local org_dir = subLastFor(&quot;/src&quot;, &quot;/org&quot;, dirname(f))</text>
<text text-anchor="middle" x="777" y="-442.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(org_dir)</text>
<text text-anchor="middle" x="777" y="-427.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;(#inverter.extension + 1))</text>
<text text-anchor="middle" x="777" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = org_dir .. &quot;/&quot; .. bare_name .. &quot;.gm&quot;</text>
<text text-anchor="middle" x="777" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, inverter:invert(read(f)))</text>
<text text-anchor="middle" x="777" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. out_name .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="777" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, d in ipairs(subdirs) do</text>
<text text-anchor="middle" x="777" y="-319.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;invert_dir(inverter, d, depth)</text>
<text text-anchor="middle" x="777" y="-303.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-288.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-273.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-257.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="777" y="-226.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_all(inverter, pwd)</text>
<text text-anchor="middle" x="777" y="-210.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="777" y="-195.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="777" y="-180.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;src&quot;, dir) then</text>
<text text-anchor="middle" x="777" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return invert_dir(inverter, dir, 0)</text>
<text text-anchor="middle" x="777" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="777" y="-87.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="777" y="-55.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">inverter.invert_all = invert_all</text>
<text text-anchor="middle" x="777" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return inverter</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777,-703.8472C777,-691.7566 777,-674.2961 777,-653.4105"/>
<polygon fill="#000000" stroke="#000000" points="780.5001,-653.2374 777,-643.2374 773.5001,-653.2374 780.5001,-653.2374"/>
</g>
</g>
</svg>