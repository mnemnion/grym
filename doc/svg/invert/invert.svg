<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="1370pt" height="2187pt"
 viewBox="0.00 0.00 1370.00 2187.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2183.4032)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2183.4032 1366,-2183.4032 1366,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="467" cy="-2161.4032" rx="42.1216" ry="18"/>
<text text-anchor="middle" x="467" y="-2157.2032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 80</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="467" cy="-2089.4032" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="467" y="-2085.2032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;80</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M467,-2143.2345C467,-2135.5341 467,-2126.3775 467,-2117.8198"/>
<polygon fill="#000000" stroke="#000000" points="470.5001,-2117.8164 467,-2107.8164 463.5001,-2117.8165 470.5001,-2117.8164"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="261" cy="-1418.3022" rx="27" ry="18"/>
<text text-anchor="middle" x="261" y="-1414.1022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">0 : </text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M415.3734,-2079.6676C370.9426,-2070.1506 311.7287,-2054.3515 297,-2035.4032 154.9587,-1852.6683 226.6911,-1539.8583 252.8212,-1445.8235"/>
<polygon fill="#000000" stroke="#000000" points="256.1923,-1446.7644 255.5539,-1436.1888 249.4579,-1444.8543 256.1923,-1446.7644"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="352" cy="-1418.3022" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="352" y="-1414.1022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;3</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M441.1743,-2073.0771C428.6279,-2063.678 414.6429,-2050.6971 407,-2035.4032 304.3119,-1829.9184 334.6805,-1537.7984 347.5688,-1446.6067"/>
<polygon fill="#000000" stroke="#000000" points="351.0627,-1446.9018 349.0437,-1436.5011 344.1361,-1445.8908 351.0627,-1446.9018"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="467" cy="-1418.3022" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="467" y="-1414.1022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 4&#45;37</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M467,-2071.1048C467,-1978.398 467,-1560.5288 467,-1446.9002"/>
<polygon fill="#000000" stroke="#000000" points="470.5001,-1446.5841 467,-1436.5842 463.5001,-1446.5842 470.5001,-1446.5841"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="684" cy="-1418.3022" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="684" y="-1414.1022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 38&#45;80</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M491.5382,-2072.7681C503.8858,-2063.1985 518.0851,-2050.1563 527,-2035.4032 649.2424,-1833.1066 676.8077,-1538.2682 682.5734,-1446.5783"/>
<polygon fill="#000000" stroke="#000000" points="686.0774,-1446.6126 683.1733,-1436.4236 679.0895,-1446.1997 686.0774,-1446.6126"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1362,-2035.5042 758,-2035.5042 758,-801.1002 1362,-801.1002 1362,-2035.5042"/>
<text text-anchor="middle" x="1060" y="-1988.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="1060" y="-1972.8031" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1060" y="-1941.4031" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="1060" y="-1926.0031" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="1060" y="-1910.603" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="1060" y="-1895.203" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="1060" y="-1879.803" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="1060" y="-1864.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="1060" y="-1849.0029" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="1060" y="-1833.6029" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="1060" y="-1818.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="1060" y="-1802.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="1060" y="-1787.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="1060" y="-1772.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="1060" y="-1724.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="1060" y="-1709.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="1060" y="-1693.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="1060" y="-1678.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="1060" y="-1647.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1060" y="-1631.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="1060" y="-1616.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="1060" y="-1584.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local inverter = require &quot;invert/inverter&quot;</text>
<text text-anchor="middle" x="1060" y="-1569.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="1060" y="-1522.0024" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, inverting the contents of =/src/=</text>
<text text-anchor="middle" x="1060" y="-1506.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/org/=. </text>
<text text-anchor="middle" x="1060" y="-1491.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1060" y="-1459.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="1060" y="-1444.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_dir(inverter, pwd, depth)</text>
<text text-anchor="middle" x="1060" y="-1429.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="1060" y="-1413.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1060" y="-1398.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1060" y="-1382.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1060" y="-1351.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1060" y="-1336.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1060" y="-1320.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1060" y="-1305.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1060" y="-1289.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (inverter.extension == extension(f)) then</text>
<text text-anchor="middle" x="1060" y="-1274.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local org_dir = subLastFor(&quot;/src&quot;, &quot;/org&quot;, dirname(f))</text>
<text text-anchor="middle" x="1060" y="-1259.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(org_dir)</text>
<text text-anchor="middle" x="1060" y="-1243.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;(#inverter.extension + 1))</text>
<text text-anchor="middle" x="1060" y="-1228.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = org_dir .. &quot;/&quot; .. bare_name .. &quot;.gm&quot;</text>
<text text-anchor="middle" x="1060" y="-1212.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, inverter:invert(read(f)))</text>
<text text-anchor="middle" x="1060" y="-1197.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. out_name .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1060" y="-1182.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-1166.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-1151.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, d in ipairs(subdirs) do</text>
<text text-anchor="middle" x="1060" y="-1135.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;invert_dir(inverter, d, depth)</text>
<text text-anchor="middle" x="1060" y="-1120.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-1105.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-1089.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-1074.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1060" y="-1042.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_all(inverter, pwd)</text>
<text text-anchor="middle" x="1060" y="-1027.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1060" y="-1012.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1060" y="-996.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;src&quot;, dir) then</text>
<text text-anchor="middle" x="1060" y="-965.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return invert_dir(inverter, dir, 0)</text>
<text text-anchor="middle" x="1060" y="-949.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-934.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1060" y="-919.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="1060" y="-903.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1060" y="-872.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">inverter.invert_all = invert_all</text>
<text text-anchor="middle" x="1060" y="-824.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">return inverter</text>
<text text-anchor="middle" x="1060" y="-809.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
</g>
<!-- section_1&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>section_1&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.543,-2084.2787C597.563,-2076.9535 714.5356,-2061.4181 749,-2035.4032 749.2805,-2035.1914 749.5608,-2034.9793 749.8409,-2034.7669"/>
<polygon fill="#000000" stroke="#000000" points="752.1408,-2037.4125 757.8971,-2028.5178 747.8504,-2031.8814 752.1408,-2037.4125"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="71,-740.1011 17,-740.1011 17,-704.1011 71,-704.1011 71,-740.1011"/>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M357.2396,-1400.3422C379.8825,-1318.5972 460.9975,-978.0744 297,-801.2012 230.53,-729.5125 164.8568,-813.7486 80,-765.2012 72.7408,-761.0481 66.3044,-754.839 60.9544,-748.418"/>
<polygon fill="#000000" stroke="#000000" points="63.6224,-746.1446 54.7786,-740.3103 58.0539,-750.3862 63.6224,-746.1446"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="162" cy="-722.1011" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="162" y="-717.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 4&#45;31</text>
</g>
<!-- block_4&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M471.9237,-1400.2397C492.9474,-1318.7551 567.0397,-981.5451 407,-801.2012 357.4683,-745.3854 313.0348,-790.9677 243,-765.2012 227.8167,-759.6151 211.9319,-751.6777 198.2918,-744.1338"/>
<polygon fill="#000000" stroke="#000000" points="199.6696,-740.8917 189.2436,-739.0077 196.2191,-746.9822 199.6696,-740.8917"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="681.5,-765.3015 252.5,-765.3015 252.5,-678.9008 681.5,-678.9008 681.5,-765.3015"/>
<text text-anchor="middle" x="467" y="-718.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, inverting the contents of =/src/=</text>
<text text-anchor="middle" x="467" y="-702.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/org/=. </text>
<text text-anchor="middle" x="467" y="-687.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M467,-1400.0383C467,-1310.8745 467,-919.7791 467,-775.6674"/>
<polygon fill="#000000" stroke="#000000" points="470.5001,-775.3208 467,-765.3209 463.5001,-775.3209 470.5001,-775.3208"/>
</g>
<!-- codeblock_10 -->
<g id="node11" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="777" cy="-722.1011" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="777" y="-717.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 38&#45;80</text>
</g>
<!-- block_5&#45;&gt;codeblock_10 -->
<g id="edge10" class="edge">
<title>block_5&#45;&gt;codeblock_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M684.3595,-1400.1275C686.1647,-1325.2512 696.385,-1033.6701 749,-801.2012 752.9454,-783.7694 759.5401,-764.8783 765.3387,-749.9304"/>
<polygon fill="#000000" stroke="#000000" points="768.7344,-750.8635 769.1835,-740.2782 762.2313,-748.273 768.7344,-750.8635"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="926,-740.1011 872,-740.1011 872,-704.1011 926,-704.1011 926,-740.1011"/>
</g>
<!-- block_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>block_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M679.5748,-1400.2771C660.9256,-1319.6492 596.5121,-987.8792 749,-801.2012 782.6129,-760.0517 818.8615,-794.7799 863,-765.2012 869.8336,-760.6218 876.0733,-754.3791 881.3682,-748.067"/>
<polygon fill="#000000" stroke="#000000" points="884.1501,-750.1912 887.5435,-740.1545 878.6318,-745.8844 884.1501,-750.1912"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-527.4014 0,-527.4014 0,-115.5997 324,-115.5997 324,-527.4014"/>
<text text-anchor="middle" x="162" y="-512.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="162" y="-480.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="162" y="-465.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="162" y="-449.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="162" y="-434.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="162" y="-419.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="162" y="-403.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="162" y="-388.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="162" y="-372.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="162" y="-357.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="162" y="-342.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="162" y="-326.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="162" y="-311.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="162" y="-263.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="162" y="-248.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="162" y="-233.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="162" y="-217.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="162" y="-186.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="162" y="-170.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="162" y="-155.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="162" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">local inverter = require &quot;invert/inverter&quot;</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162,-703.8472C162,-672.8091 162,-606.3832 162,-537.4686"/>
<polygon fill="#000000" stroke="#000000" points="165.5001,-537.2867 162,-527.2867 158.5001,-537.2868 165.5001,-537.2867"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1079,-643.0016 475,-643.0016 475,.0005 1079,.0005 1079,-643.0016"/>
<text text-anchor="middle" x="777" y="-627.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_dir(inverter, pwd, depth)</text>
<text text-anchor="middle" x="777" y="-612.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="777" y="-597.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="777" y="-581.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="777" y="-566.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="777" y="-534.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="777" y="-519.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="777" y="-504.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="777" y="-488.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="777" y="-473.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (inverter.extension == extension(f)) then</text>
<text text-anchor="middle" x="777" y="-457.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local org_dir = subLastFor(&quot;/src&quot;, &quot;/org&quot;, dirname(f))</text>
<text text-anchor="middle" x="777" y="-442.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(org_dir)</text>
<text text-anchor="middle" x="777" y="-427.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;(#inverter.extension + 1))</text>
<text text-anchor="middle" x="777" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = org_dir .. &quot;/&quot; .. bare_name .. &quot;.gm&quot;</text>
<text text-anchor="middle" x="777" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, inverter:invert(read(f)))</text>
<text text-anchor="middle" x="777" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. out_name .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="777" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, d in ipairs(subdirs) do</text>
<text text-anchor="middle" x="777" y="-319.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;invert_dir(inverter, d, depth)</text>
<text text-anchor="middle" x="777" y="-303.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-288.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-273.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-257.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="777" y="-226.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_all(inverter, pwd)</text>
<text text-anchor="middle" x="777" y="-210.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="777" y="-195.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="777" y="-180.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;src&quot;, dir) then</text>
<text text-anchor="middle" x="777" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return invert_dir(inverter, dir, 0)</text>
<text text-anchor="middle" x="777" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="777" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="777" y="-87.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="777" y="-55.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">inverter.invert_all = invert_all</text>
<text text-anchor="middle" x="777" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return inverter</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777,-703.8472C777,-691.7566 777,-674.2961 777,-653.4105"/>
<polygon fill="#000000" stroke="#000000" points="780.5001,-653.2374 777,-643.2374 773.5001,-653.2374 780.5001,-653.2374"/>
</g>
</g>
</svg>