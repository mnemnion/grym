<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="992pt" height="1005pt"
 viewBox="0.00 0.00 992.00 1005.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1001.2012)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1001.2012 988,-1001.2012 988,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="256" cy="-979.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="256" y="-975.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">80 &#160;</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="256" cy="-907.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="256" y="-903.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">80 &#160;</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M256,-961.0325C256,-953.3321 256,-944.1755 256,-935.6178"/>
<polygon fill="#000000" stroke="#000000" points="259.5001,-935.6144 256,-925.6145 252.5001,-935.6145 259.5001,-935.6144"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="148" cy="-835.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="148" y="-831.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">: &#160;&#160;</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.6918,-894.329C219.6445,-882.9642 194.5981,-866.2666 175.4656,-853.5116"/>
<polygon fill="#000000" stroke="#000000" points="177.4031,-850.5968 167.1411,-847.9619 173.5201,-856.4211 177.4031,-850.5968"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="220" cy="-835.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="220" y="-831.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">&#45;3 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M247.2854,-889.772C243.0403,-881.2818 237.8464,-870.894 233.1337,-861.4686"/>
<polygon fill="#000000" stroke="#000000" points="236.237,-859.8489 228.6343,-852.4699 229.976,-862.9794 236.237,-859.8489"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="292" cy="-835.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="292" y="-831.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">37 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M264.7146,-889.772C268.9597,-881.2818 274.1536,-870.894 278.8663,-861.4686"/>
<polygon fill="#000000" stroke="#000000" points="282.024,-862.9794 283.3657,-852.4699 275.763,-859.8489 282.024,-862.9794"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="682" cy="-835.2012" rx="27" ry="18"/>
<text text-anchor="middle" x="682" y="-831.0012" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">80 &#160;</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.3267,-902.7516C355.4774,-890.3881 561.3256,-855.5969 645.4685,-841.3755"/>
<polygon fill="#000000" stroke="#000000" points="646.3002,-844.7847 655.5771,-839.667 645.1336,-837.8826 646.3002,-844.7847"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="117,-750.1011 63,-750.1011 63,-710.1011 117,-710.1011 117,-750.1011"/>
</g>
<!-- block_3&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>block_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M198.4555,-824.2212C174.5143,-811.7798 137.6827,-791.8524 126,-781.2012 118.8151,-774.6507 112.2499,-766.4263 106.7507,-758.5021"/>
<polygon fill="#000000" stroke="#000000" points="109.6483,-756.5383 101.2229,-750.1146 103.8034,-760.3904 109.6483,-756.5383"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="162" cy="-730.1011" rx="27" ry="18"/>
<text text-anchor="middle" x="162" y="-725.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">31 &#160;</text>
</g>
<!-- block_4&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>block_4&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M270.4555,-824.2212C246.5143,-811.7798 209.6827,-791.8524 198,-781.2012 189.9405,-773.8533 182.6607,-764.3992 176.7906,-755.6251"/>
<polygon fill="#000000" stroke="#000000" points="179.7371,-753.7361 171.4137,-747.1808 173.8325,-757.4959 179.7371,-753.7361"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="636.5,-781.3014 207.5,-781.3014 207.5,-678.9008 636.5,-678.9008 636.5,-781.3014"/>
<text text-anchor="middle" x="422" y="-734.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> Walks a given directory, inverting the contents of =/src/=</text>
<text text-anchor="middle" x="422" y="-718.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> into =/org/=. </text>
<text text-anchor="middle" x="422" y="-703.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- block_4&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_4&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309.263,-821.2447C320.2026,-812.4004 335.1629,-800.3056 350.6092,-787.8179"/>
<polygon fill="#000000" stroke="#000000" points="353.1362,-790.2757 358.7122,-781.2669 348.7352,-784.8322 353.1362,-790.2757"/>
</g>
<!-- codeblock_10 -->
<g id="node11" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="682" cy="-730.1011" rx="27" ry="18"/>
<text text-anchor="middle" x="682" y="-725.9011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">80 &#160;</text>
</g>
<!-- block_5&#45;&gt;codeblock_10 -->
<g id="edge10" class="edge">
<title>block_5&#45;&gt;codeblock_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M682,-816.8942C682,-800.7686 682,-777.0233 682,-758.444"/>
<polygon fill="#000000" stroke="#000000" points="685.5001,-758.1983 682,-748.1984 678.5001,-758.1984 685.5001,-758.1983"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="781,-748.1011 727,-748.1011 727,-712.1011 781,-712.1011 781,-748.1011"/>
</g>
<!-- block_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>block_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.25,-818.7793C704.6369,-802.1576 722.4269,-776.1891 735.8183,-756.6414"/>
<polygon fill="#000000" stroke="#000000" points="738.8585,-758.3964 741.6228,-748.1685 733.0837,-754.4402 738.8585,-758.3964"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-527.4014 0,-527.4014 0,-115.5997 324,-115.5997 324,-527.4014"/>
<text text-anchor="middle" x="162" y="-512.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="162" y="-480.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="162" y="-465.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="162" y="-449.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="162" y="-434.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="162" y="-419.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="162" y="-403.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="162" y="-388.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="162" y="-372.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="162" y="-357.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="162" y="-342.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="162" y="-326.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="162" y="-311.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="162" y="-263.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="162" y="-248.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="162" y="-233.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="162" y="-217.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="162" y="-186.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="162" y="-170.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="162" y="-155.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="162" y="-124.0002" font-family="Inconsolata" font-size="14.00" fill="#000000">local inverter = require &quot;invert/inverter&quot;</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>codeblock_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M162,-712.0169C162,-679.9707 162,-609.763 162,-537.5872"/>
<polygon fill="#000000" stroke="#000000" points="165.5001,-537.3936 162,-527.3936 158.5001,-537.3936 165.5001,-537.3936"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="984,-643.0016 380,-643.0016 380,.0005 984,.0005 984,-643.0016"/>
<text text-anchor="middle" x="682" y="-627.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_dir(inverter, pwd, depth)</text>
<text text-anchor="middle" x="682" y="-612.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="682" y="-597.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="682" y="-581.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="682" y="-566.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="682" y="-534.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="682" y="-519.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="682" y="-504.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="682" y="-488.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="682" y="-473.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (inverter.extension == extension(f)) then</text>
<text text-anchor="middle" x="682" y="-457.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local org_dir = subLastFor(&quot;/src&quot;, &quot;/org&quot;, dirname(f))</text>
<text text-anchor="middle" x="682" y="-442.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(org_dir)</text>
<text text-anchor="middle" x="682" y="-427.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;(#inverter.extension + 1))</text>
<text text-anchor="middle" x="682" y="-411.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_name = org_dir .. &quot;/&quot; .. bare_name .. &quot;.gm&quot;</text>
<text text-anchor="middle" x="682" y="-396.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;write(out_name, inverter:invert(read(f)))</text>
<text text-anchor="middle" x="682" y="-380.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;io.write((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. out_name .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="682" y="-365.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-350.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-334.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, d in ipairs(subdirs) do</text>
<text text-anchor="middle" x="682" y="-319.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;invert_dir(inverter, d, depth)</text>
<text text-anchor="middle" x="682" y="-303.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-288.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-273.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-257.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="682" y="-226.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert_all(inverter, pwd)</text>
<text text-anchor="middle" x="682" y="-210.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="682" y="-195.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="682" y="-180.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;src&quot;, dir) then</text>
<text text-anchor="middle" x="682" y="-148.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return invert_dir(inverter, dir, 0)</text>
<text text-anchor="middle" x="682" y="-133.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-117.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="682" y="-102.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="682" y="-87.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="682" y="-55.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">inverter.invert_all = invert_all</text>
<text text-anchor="middle" x="682" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return inverter</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>codeblock_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M682,-712.0169C682,-698.3821 682,-677.8392 682,-653.1758"/>
<polygon fill="#000000" stroke="#000000" points="685.5001,-653.1427 682,-643.1427 678.5001,-653.1428 685.5001,-653.1427"/>
</g>
</g>
</svg>