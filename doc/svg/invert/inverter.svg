<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="6683pt" height="2426pt"
 viewBox="0.00 0.00 6683.00 2425.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2421.8037)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2421.8037 6679,-2421.8037 6679,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1438" cy="-2399.8037" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1438" y="-2395.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 290</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1438" cy="-2327.8037" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1438" y="-2323.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;205</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1438,-2381.635C1438,-2373.9346 1438,-2364.778 1438,-2356.2203"/>
<polygon fill="#000000" stroke="#000000" points="1441.5001,-2356.2169 1438,-2346.2169 1434.5001,-2356.217 1441.5001,-2356.2169"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1038" cy="-2255.8037" rx="83.677" ry="18"/>
<text text-anchor="middle" x="1038" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Inverter module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1382.2085,-2318.2846C1320.6502,-2307.7131 1218.6744,-2289.9978 1131,-2273.8037 1124.2634,-2272.5593 1117.2567,-2271.2434 1110.2462,-2269.912"/>
<polygon fill="#000000" stroke="#000000" points="1110.4822,-2266.394 1100.0033,-2267.957 1109.1698,-2273.2698 1110.4822,-2266.394"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1172" cy="-2255.8037" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1172" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1383.5927,-2317.5812C1337.5423,-2308.2588 1270.1105,-2293.0226 1213,-2273.8037 1210.762,-2273.0505 1208.4779,-2272.2227 1206.1901,-2271.3485"/>
<polygon fill="#000000" stroke="#000000" points="1207.4555,-2268.0848 1196.8733,-2267.5664 1204.8225,-2274.5708 1207.4555,-2268.0848"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1254" cy="-2255.8037" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1254" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1398.3292,-2313.4601C1369.5071,-2302.8846 1329.6453,-2287.9387 1295,-2273.8037 1292.9531,-2272.9685 1290.8551,-2272.0968 1288.7425,-2271.207"/>
<polygon fill="#000000" stroke="#000000" points="1290.0709,-2267.9685 1279.5007,-2267.2467 1287.3137,-2274.4026 1290.0709,-2267.9685"/>
</g>
<!-- codeblock_5 -->
<g id="node6" class="node">
<title>codeblock_5</title>
<ellipse fill="none" stroke="#000000" cx="1377" cy="-2255.8037" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="1377" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 9&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;codeblock_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1422.9213,-2310.0059C1415.5895,-2301.3519 1406.6443,-2290.7936 1398.6032,-2281.3025"/>
<polygon fill="#000000" stroke="#000000" points="1401.2513,-2279.0136 1392.1166,-2273.6462 1395.9104,-2283.5385 1401.2513,-2279.0136"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1500" cy="-2255.8037" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1500" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1453.3258,-2310.0059C1461.058,-2301.0266 1470.5557,-2289.9971 1478.9604,-2280.2368"/>
<polygon fill="#000000" stroke="#000000" points="1481.8275,-2282.271 1485.7005,-2272.4095 1476.5231,-2277.7034 1481.8275,-2282.271"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1751" cy="-2255.8037" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1751" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 29&#45;64</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1488.6367,-2316.1556C1542.2835,-2303.8151 1627.1734,-2284.2877 1685.791,-2270.8038"/>
<polygon fill="#000000" stroke="#000000" points="1686.7285,-2274.1796 1695.6894,-2268.5269 1685.1592,-2267.3578 1686.7285,-2274.1796"/>
</g>
<!-- section_8 -->
<g id="node9" class="node">
<title>section_8</title>
<ellipse fill="none" stroke="#000000" cx="2501" cy="-2255.8037" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2501" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 66&#45;205</text>
</g>
<!-- section_1&#45;&gt;section_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;section_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1502.1015,-2323.4619C1686.9641,-2310.9406 2220.7339,-2274.7869 2422.498,-2261.1208"/>
<polygon fill="#000000" stroke="#000000" points="2422.977,-2264.5965 2432.7176,-2260.4286 2422.5039,-2257.6125 2422.977,-2264.5965"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="4696" cy="-2255.8037" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4696" y="-2251.6037" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 206&#45;245</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1503.4474,-2326.3573C1915.1712,-2317.2584 4144.8916,-2267.9828 4610.6793,-2257.6892"/>
<polygon fill="#000000" stroke="#000000" points="4610.7797,-2261.1879 4620.6999,-2257.4677 4610.625,-2254.1896 4610.7797,-2261.1879"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="450,-1953.5038 0,-1953.5038 0,-1914.9026 450,-1914.9026 450,-1953.5038"/>
<text text-anchor="middle" x="225" y="-1938.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;A work in progress, which also works well enough to invert,</text>
<text text-anchor="middle" x="225" y="-1923.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> I may hope, the whole of grym including this file.</text>
</g>
<!-- prose_3&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148.2197,-2243.6494C1142.6961,-2241.3133 1136.7476,-2239.1713 1131,-2237.8037 985.5145,-2203.1855 593.4702,-2267.2422 459,-2201.8037 350.1867,-2148.8508 270.7811,-2020.0198 239.5724,-1962.6155"/>
<polygon fill="#000000" stroke="#000000" points="242.6154,-1960.8838 234.8116,-1953.7179 236.4434,-1964.1863 242.6154,-1960.8838"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="939.5,-1961.5036 468.5,-1961.5036 468.5,-1906.9028 939.5,-1906.9028 939.5,-1961.5036"/>
<text text-anchor="middle" x="704" y="-1946.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> Hence I&#39;m eager to use it and then document it from the grimoire</text>
<text text-anchor="middle" x="704" y="-1931.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> side.</text>
</g>
<!-- prose_4&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>prose_4&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1229.6934,-2243.8094C1224.2994,-2241.5237 1218.5375,-2239.3622 1213,-2237.8037 1098.5858,-2205.6014 1053.2484,-2257.0339 948,-2201.8037 843.9462,-2147.2003 761.7687,-2029.6858 724.9891,-1970.2288"/>
<polygon fill="#000000" stroke="#000000" points="727.8863,-1968.2574 719.687,-1961.5476 721.9123,-1971.9061 727.8863,-1968.2574"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1372.5,-2047.3038 957.5,-2047.3038 957.5,-1821.1026 1372.5,-1821.1026 1372.5,-2047.3038"/>
<text text-anchor="middle" x="1165" y="-2032.3034" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1165" y="-2000.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1165" y="-1969.5033" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1165" y="-1938.1033" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="1165" y="-1906.7032" font-family="Inconsolata" font-size="14.00" fill="#000000">local function isBlank(line)</text>
<text text-anchor="middle" x="1165" y="-1891.3032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local all_blanks = L.match((m.__TAB__ + m._)^0, line)</text>
<text text-anchor="middle" x="1165" y="-1875.9032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return (all_blanks == (#line + 1) or line == &quot;&quot;)</text>
<text text-anchor="middle" x="1165" y="-1860.5031" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1165" y="-1829.1031" font-family="Inconsolata" font-size="14.00" fill="#000000">local Inv, inv = u.inherit()</text>
</g>
<!-- codeblock_5&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_5&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1364.9945,-2237.5916C1342.1046,-2202.868 1290.481,-2124.5558 1245.4178,-2056.1957"/>
<polygon fill="#000000" stroke="#000000" points="1248.1006,-2053.9061 1239.6745,-2047.4832 1242.2562,-2057.7588 1248.1006,-2053.9061"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1609.5,-1952.2032 1390.5,-1952.2032 1390.5,-1916.2032 1609.5,-1916.2032 1609.5,-1952.2032"/>
<text text-anchor="middle" x="1500" y="-1930.7032" font-family="Inconsolata" font-size="14.00" fill="#000000"> The default language is Lua.</text>
</g>
<!-- prose_6&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>prose_6&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1500,-2237.5916C1500,-2184.082 1500,-2027.0614 1500,-1962.4613"/>
<polygon fill="#000000" stroke="#000000" points="1503.5001,-1962.2155 1500,-1952.2156 1496.5001,-1962.2156 1503.5001,-1962.2155"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="2120,-2201.9041 1628,-2201.9041 1628,-1666.5023 2120,-1666.5023 2120,-2201.9041"/>
<text text-anchor="middle" x="1874" y="-2186.6037" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.lang = &quot;lua&quot;</text>
<text text-anchor="middle" x="1874" y="-2171.2036" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.extension = &quot;.lua&quot;</text>
<text text-anchor="middle" x="1874" y="-2155.8036" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.comment = L.P&quot;&#45;&#45;&quot;</text>
<text text-anchor="middle" x="1874" y="-2140.4036" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.comment_len = 3</text>
<text text-anchor="middle" x="1874" y="-2125.0035" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.tab_to_space = &quot; &#160;&#160;&quot;</text>
<text text-anchor="middle" x="1874" y="-2093.6035" font-family="Inconsolata" font-size="14.00" fill="#000000">local lang_config = { lua = { lang = &quot;lua&quot;, </text>
<text text-anchor="middle" x="1874" y="-2078.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;extension = &quot;.lua&quot;,</text>
<text text-anchor="middle" x="1874" y="-2062.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment = L.P&quot;&#45;&#45;&quot;,</text>
<text text-anchor="middle" x="1874" y="-2047.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment_len = 3,</text>
<text text-anchor="middle" x="1874" y="-2032.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tab_to_space = &quot; &#160;&#160;&quot;}}</text>
<text text-anchor="middle" x="1874" y="-2000.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.write_header(inverter)</text>
<text text-anchor="middle" x="1874" y="-1985.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;#!&quot; .. inverter.lang .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1874" y="-1969.8033" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1874" y="-1938.4032" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.write_footer(inverter)</text>
<text text-anchor="middle" x="1874" y="-1923.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;#/&quot; .. inverter.lang .. &quot;\n&quot;</text>
<text text-anchor="middle" x="1874" y="-1907.6032" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1874" y="-1876.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.filter(inverter, line)</text>
<text text-anchor="middle" x="1874" y="-1860.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if isBlank(line) then</text>
<text text-anchor="middle" x="1874" y="-1845.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1874" y="-1830.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1874" y="-1814.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return line:gsub(&quot;\t&quot;, inverter.tab_to_space):gsub(&quot;\r&quot;, &quot;&quot;)</text>
<text text-anchor="middle" x="1874" y="-1799.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1874" y="-1783.803" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1874" y="-1752.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">local function cat_lines() end &#45;&#45;stub out</text>
<text text-anchor="middle" x="1874" y="-1721.0029" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.matchComment(inverter, line)</text>
<text text-anchor="middle" x="1874" y="-1705.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return (L.match(inverter.comment * m._, line) </text>
<text text-anchor="middle" x="1874" y="-1690.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or (L.match(inverter.comment, line) and #line == 2))</text>
<text text-anchor="middle" x="1874" y="-1674.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>codeblock_7&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1757.9654,-2237.5916C1760.6776,-2230.5003 1764.085,-2221.5912 1768.0132,-2211.3203"/>
<polygon fill="#000000" stroke="#000000" points="1771.2917,-2212.5457 1771.595,-2201.9552 1764.7536,-2210.045 1771.2917,-2212.5457"/>
</g>
<!-- header_15 -->
<g id="node16" class="node">
<title>header_15</title>
<ellipse fill="none" stroke="#000000" cx="2220" cy="-1934.2032" rx="82.2492" ry="18"/>
<text text-anchor="middle" x="2220" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : matchLineType</text>
</g>
<!-- section_8&#45;&gt;header_15 -->
<g id="edge15" class="edge">
<title>section_8&#45;&gt;header_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2443.032,-2245.3381C2394.751,-2235.5488 2330.9409,-2219.7693 2312,-2201.8037 2243.1396,-2136.4888 2225.8165,-2017.3561 2221.4612,-1962.8294"/>
<polygon fill="#000000" stroke="#000000" points="2224.9289,-1962.247 2220.7331,-1952.5185 2217.9463,-1962.7402 2224.9289,-1962.247"/>
</g>
<!-- prose_16 -->
<g id="node17" class="node">
<title>prose_16</title>
<ellipse fill="none" stroke="#000000" cx="2353" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2353" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_8&#45;&gt;prose_16 -->
<g id="edge16" class="edge">
<title>section_8&#45;&gt;prose_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2452.7175,-2242.5458C2431.4744,-2234.2584 2408.1759,-2221.3395 2394,-2201.8037 2341.0415,-2128.8213 2344.4328,-2014.9333 2349.4574,-1962.4413"/>
<polygon fill="#000000" stroke="#000000" points="2352.9684,-1962.5203 2350.5347,-1952.2088 2346.0069,-1961.7873 2352.9684,-1962.5203"/>
</g>
<!-- prose_17 -->
<g id="node18" class="node">
<title>prose_17</title>
<ellipse fill="none" stroke="#000000" cx="2435" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2435" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_8&#45;&gt;prose_17 -->
<g id="edge17" class="edge">
<title>section_8&#45;&gt;prose_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2491.1137,-2237.8125C2485.8722,-2227.5428 2479.7572,-2214.2666 2476,-2201.8037 2450.4599,-2117.0857 2440.3109,-2012.2497 2436.7281,-1962.7014"/>
<polygon fill="#000000" stroke="#000000" points="2440.2005,-1962.1776 2436.0241,-1952.4407 2433.2169,-1962.6568 2440.2005,-1962.1776"/>
</g>
<!-- codeblock_18 -->
<g id="node19" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="2567" cy="-1934.2032" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="2567" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 78&#45;112</text>
</g>
<!-- section_8&#45;&gt;codeblock_18 -->
<g id="edge18" class="edge">
<title>section_8&#45;&gt;codeblock_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2504.7375,-2237.5916C2515.7417,-2183.9714 2548.0766,-2026.4121 2561.2827,-1962.0621"/>
<polygon fill="#000000" stroke="#000000" points="2564.7216,-1962.715 2563.3034,-1952.2156 2557.8645,-1961.3078 2564.7216,-1962.715"/>
</g>
<!-- prose_19 -->
<g id="node20" class="node">
<title>prose_19</title>
<ellipse fill="none" stroke="#000000" cx="2699" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2699" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_8&#45;&gt;prose_19 -->
<g id="edge19" class="edge">
<title>section_8&#45;&gt;prose_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2553.9513,-2243.8218C2593.9903,-2233.6658 2644.3279,-2218.1755 2658,-2201.8037 2716.0606,-2132.2779 2709.9389,-2015.7728 2703.3654,-1962.4258"/>
<polygon fill="#000000" stroke="#000000" points="2706.8111,-1961.7856 2702.0211,-1952.3353 2699.8724,-1962.71 2706.8111,-1961.7856"/>
</g>
<!-- prose_20 -->
<g id="node21" class="node">
<title>prose_20</title>
<ellipse fill="none" stroke="#000000" cx="2973" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2973" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_8&#45;&gt;prose_20 -->
<g id="edge20" class="edge">
<title>section_8&#45;&gt;prose_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2561.7605,-2246.5002C2622.2953,-2236.4533 2710.3707,-2219.4963 2740,-2201.8037 2844.2436,-2139.5564 2926.0846,-2014.5347 2958.2271,-1960.2983"/>
<polygon fill="#000000" stroke="#000000" points="2961.2742,-1962.021 2963.3013,-1951.6219 2955.2317,-1958.4872 2961.2742,-1962.021"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="3409" cy="-1934.2032" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3409" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 125&#45;203</text>
</g>
<!-- section_8&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>section_8&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2570.7298,-2252.6579C2691.4946,-2246.5157 2934.2961,-2230.9123 3014,-2201.8037 3169.6259,-2144.9674 3323.1985,-2013.5842 3382.9214,-1958.8419"/>
<polygon fill="#000000" stroke="#000000" points="3385.4173,-1961.3011 3390.3898,-1951.9456 3380.6685,-1956.1583 3385.4173,-1961.3011"/>
</g>
<!-- header_28 -->
<g id="node29" class="node">
<title>header_28</title>
<ellipse fill="none" stroke="#000000" cx="4480" cy="-1934.2032" rx="83.6081" ry="18"/>
<text text-anchor="middle" x="4480" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Grym:invert(str)</text>
</g>
<!-- section_9&#45;&gt;header_28 -->
<g id="edge28" class="edge">
<title>section_9&#45;&gt;header_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4642.6573,-2242.9532C4618.5651,-2234.7373 4591.436,-2221.7611 4573,-2201.8037 4508.6807,-2132.1764 4488.4965,-2015.7226 4482.448,-1962.4072"/>
<polygon fill="#000000" stroke="#000000" points="4485.9143,-1961.9028 4481.3893,-1952.3229 4478.9526,-1962.6337 4485.9143,-1961.9028"/>
</g>
<!-- prose_29 -->
<g id="node30" class="node">
<title>prose_29</title>
<ellipse fill="none" stroke="#000000" cx="4614" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4614" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_29 -->
<g id="edge29" class="edge">
<title>section_9&#45;&gt;prose_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4679.0806,-2238.2581C4670.4909,-2228.3329 4660.6936,-2215.2435 4655,-2201.8037 4620.241,-2119.7548 4614.4789,-2012.4653 4613.8284,-1962.3212"/>
<polygon fill="#000000" stroke="#000000" points="4617.3279,-1962.2142 4613.7584,-1952.2388 4610.3281,-1962.2629 4617.3279,-1962.2142"/>
</g>
<!-- prose_30 -->
<g id="node31" class="node">
<title>prose_30</title>
<ellipse fill="none" stroke="#000000" cx="4696" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4696" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_30 -->
<g id="edge30" class="edge">
<title>section_9&#45;&gt;prose_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4696,-2237.5916C4696,-2184.082 4696,-2027.0614 4696,-1962.4613"/>
<polygon fill="#000000" stroke="#000000" points="4699.5001,-1962.2155 4696,-1952.2156 4692.5001,-1962.2156 4699.5001,-1962.2155"/>
</g>
<!-- prose_31 -->
<g id="node32" class="node">
<title>prose_31</title>
<ellipse fill="none" stroke="#000000" cx="4843" cy="-1934.2032" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4843" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_31 -->
<g id="edge31" class="edge">
<title>section_9&#45;&gt;prose_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4711.3463,-2238.1663C4719.6712,-2228.0073 4729.7172,-2214.724 4737,-2201.8037 4783.6173,-2119.1002 4819.4229,-2011.7664 4834.7892,-1961.9103"/>
<polygon fill="#000000" stroke="#000000" points="4838.1892,-1962.7595 4837.7545,-1952.1735 4831.4929,-1960.7201 4838.1892,-1962.7595"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="5186" cy="-1934.2032" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5186" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 215&#45;243</text>
</g>
<!-- section_9&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>section_9&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4757.5116,-2245.3541C4795.5883,-2237.1741 4844.5647,-2223.4699 4884,-2201.8037 5004.8848,-2135.3881 5118.4647,-2012.8401 5164.4689,-1959.7908"/>
<polygon fill="#000000" stroke="#000000" points="5167.1419,-1962.0505 5171.0114,-1952.1875 5161.8358,-1957.4847 5167.1419,-1962.0505"/>
</g>
<!-- section_33 -->
<g id="node34" class="node">
<title>section_33</title>
<ellipse fill="none" stroke="#000000" cx="5830" cy="-1934.2032" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5830" y="-1930.0032" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 246&#45;290</text>
</g>
<!-- section_9&#45;&gt;section_33 -->
<g id="edge33" class="edge">
<title>section_9&#45;&gt;section_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4770.1183,-2252.3123C4905.5195,-2245.3822 5187.6153,-2228.2382 5282,-2201.8037 5488.5746,-2143.9477 5711.4363,-2010.0417 5795.399,-1956.7115"/>
<polygon fill="#000000" stroke="#000000" points="5797.4707,-1959.5414 5804.0163,-1951.2104 5793.7041,-1953.6411 5797.4707,-1959.5414"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1571.5,-1089.4026 1114.5,-1089.4026 1114.5,-972.6008 1571.5,-972.6008 1571.5,-1089.4026"/>
<text text-anchor="middle" x="1343" y="-1058.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Matches a line by type (comment, code, or blank) and either</text>
<text text-anchor="middle" x="1343" y="-1042.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> concatenates to an existing block of this type or starts a new</text>
<text text-anchor="middle" x="1343" y="-1027.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> one if the latest is different.</text>
<text text-anchor="middle" x="1343" y="-1011.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="1343" y="-996.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; latest: the latest block.</text>
<text text-anchor="middle" x="1343" y="-981.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; line: line to be matched and added.</text>
</g>
<!-- prose_16&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>prose_16&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2356.8634,-1916.0519C2366.0923,-1867.129 2383.5743,-1731.8338 2311,-1666.6028 2250.5193,-1612.2416 1646.1003,-1677.9716 1580,-1630.6028 1404.6018,-1504.9087 1358.9719,-1228.502 1347.1318,-1099.6471"/>
<polygon fill="#000000" stroke="#000000" points="1350.603,-1099.1649 1346.2423,-1089.5091 1343.6298,-1099.7767 1350.603,-1099.1649"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2004.5,-1050.9038 1589.5,-1050.9038 1589.5,-1011.0996 2004.5,-1011.0996 2004.5,-1050.9038"/>
<text text-anchor="middle" x="1797" y="-1035.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return : the latest block, which may be created here.</text>
</g>
<!-- prose_17&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>prose_17&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2438.7791,-1916.2368C2447.8076,-1867.7795 2464.9178,-1733.5506 2394,-1666.6028 2332.3198,-1608.3755 2081.0609,-1682.5422 2014,-1630.6028 1825.8748,-1484.8979 1800.6802,-1161.1716 1797.4378,-1061.0802"/>
<polygon fill="#000000" stroke="#000000" points="1800.9285,-1060.6889 1797.1582,-1050.7877 1793.9311,-1060.879 1800.9285,-1060.6889"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2473,-1289.9028 2023,-1289.9028 2023,-772.1006 2473,-772.1006 2473,-1289.9028"/>
<text text-anchor="middle" x="2248" y="-1274.5022" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.sortLine(inverter, latest, line)</text>
<text text-anchor="middle" x="2248" y="-1259.1022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local block = latest or {}</text>
<text text-anchor="middle" x="2248" y="-1227.7021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if inverter:matchComment(line) then</text>
<text text-anchor="middle" x="2248" y="-1212.3021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; prose</text>
<text text-anchor="middle" x="2248" y="-1196.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;prose&quot; then</text>
<text text-anchor="middle" x="2248" y="-1181.502" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new prose block</text>
<text text-anchor="middle" x="2248" y="-1166.102" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;prose&quot;}</text>
<text text-anchor="middle" x="2248" y="-1150.702" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line:sub(inverter.comment_len)</text>
<text text-anchor="middle" x="2248" y="-1135.302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2248" y="-1119.9019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line:sub(inverter.comment_len)</text>
<text text-anchor="middle" x="2248" y="-1104.5019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2248" y="-1089.1019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif isBlank(line) then</text>
<text text-anchor="middle" x="2248" y="-1073.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; blank line</text>
<text text-anchor="middle" x="2248" y="-1058.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;blank&quot; then</text>
<text text-anchor="middle" x="2248" y="-1042.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;blank&quot;}</text>
<text text-anchor="middle" x="2248" y="-1027.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="2248" y="-1012.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2248" y="-996.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="2248" y="-981.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2248" y="-965.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2248" y="-950.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code line</text>
<text text-anchor="middle" x="2248" y="-935.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;code&quot; then</text>
<text text-anchor="middle" x="2248" y="-919.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new code block</text>
<text text-anchor="middle" x="2248" y="-904.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;code&quot; }</text>
<text text-anchor="middle" x="2248" y="-888.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="2248" y="-873.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2248" y="-858.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="2248" y="-842.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2248" y="-827.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2248" y="-795.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="2248" y="-780.5013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>codeblock_18&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2560.925,-1915.9971C2546.4504,-1872.694 2508.6922,-1760.1802 2476,-1666.6028 2433.8327,-1545.9042 2386.2141,-1412.6909 2345.4416,-1299.5308"/>
<polygon fill="#000000" stroke="#000000" points="2348.7028,-1298.2564 2342.0195,-1290.0354 2342.1174,-1300.6298 2348.7028,-1298.2564"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2906.5,-1049.0017 2491.5,-1049.0017 2491.5,-1013.0017 2906.5,-1013.0017 2906.5,-1049.0017"/>
<text text-anchor="middle" x="2699" y="-1027.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> Takes blocks and concatenates them into a single string.</text>
</g>
<!-- prose_19&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>prose_19&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2699,-1916.1614C2699,-1803.598 2699,-1197.9898 2699,-1059.3072"/>
<polygon fill="#000000" stroke="#000000" points="2702.5001,-1059.0864 2699,-1049.0865 2695.5001,-1059.0865 2702.5001,-1059.0864"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="3403,-1050.3023 2925,-1050.3023 2925,-1011.7011 3403,-1011.7011 3403,-1050.3023"/>
<text text-anchor="middle" x="3164" y="-1035.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> Also writes headers and footers, while doing its best to get the </text>
<text text-anchor="middle" x="3164" y="-1019.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> spacing right.</text>
</g>
<!-- prose_20&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>prose_20&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2976.8153,-1916.1614C3000.5405,-1803.9698 3127.8423,-1201.9843 3157.7205,-1060.6964"/>
<polygon fill="#000000" stroke="#000000" points="3161.209,-1061.1165 3159.8537,-1050.6087 3154.3604,-1059.6682 3161.209,-1061.1165"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="3990.5,-1630.7039 3421.5,-1630.7039 3421.5,-431.2996 3990.5,-431.2996 3990.5,-1630.7039"/>
<text text-anchor="middle" x="3706" y="-1615.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.catBlocks(inverter, blocks)</text>
<text text-anchor="middle" x="3706" y="-1600.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local linum = 0</text>
<text text-anchor="middle" x="3706" y="-1584.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local function toLines(block) </text>
<text text-anchor="middle" x="3706" y="-1569.2027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="3706" y="-1553.8027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for j = 1, #block do</text>
<text text-anchor="middle" x="3706" y="-1538.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;linum = linum + 1</text>
<text text-anchor="middle" x="3706" y="-1523.0026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. block[j] .. &quot;\n&quot;</text>
<text text-anchor="middle" x="3706" y="-1507.6026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-1492.2025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="3706" y="-1476.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-1461.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="3706" y="-1446.0024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if blocks[1].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="3706" y="-1430.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_header()</text>
<text text-anchor="middle" x="3706" y="-1415.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-1399.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;phrase = phrase .. toLines(blocks[1]) </text>
<text text-anchor="middle" x="3706" y="-1384.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i = 2, #blocks do</text>
<text text-anchor="middle" x="3706" y="-1369.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="3706" y="-1337.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is</text>
<text text-anchor="middle" x="3706" y="-1322.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code, write blanks and code</text>
<text text-anchor="middle" x="3706" y="-1306.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="3706" y="-1291.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i &gt; 2 and blocks[i &#45; 2].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="3706" y="-1276.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-1244.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is </text>
<text text-anchor="middle" x="3706" y="-1229.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; prose or nothing, write blanks, header, and code</text>
<text text-anchor="middle" x="3706" y="-1213.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="3706" y="-1198.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[i &#45; 2] == nil or blocks[i &#45; 2].id == &quot;prose&quot;) then</text>
<text text-anchor="middle" x="3706" y="-1183.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1])</text>
<text text-anchor="middle" x="3706" y="-1167.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. inverter:write_header()</text>
<text text-anchor="middle" x="3706" y="-1152.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-1120.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is prose, write a blank line, </text>
<text text-anchor="middle" x="3706" y="-1105.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; header, and code. </text>
<text text-anchor="middle" x="3706" y="-1090.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;prose&quot; then</text>
<text text-anchor="middle" x="3706" y="-1074.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. &quot;\n&quot; .. inverter:write_header() </text>
<text text-anchor="middle" x="3706" y="-1059.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-1043.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3706" y="-1028.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;Reached a bad state on code in catLines&quot;)</text>
<text text-anchor="middle" x="3706" y="-1013.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-997.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i].id == &quot;prose&quot; then</text>
<text text-anchor="middle" x="3706" y="-966.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is</text>
<text text-anchor="middle" x="3706" y="-950.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code, write footer, blanks, and prose</text>
<text text-anchor="middle" x="3706" y="-935.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="3706" y="-920.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i &gt; 2 and blocks[i &#45; 2].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="3706" y="-904.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer() </text>
<text text-anchor="middle" x="3706" y="-889.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-857.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is code, write a footer, newline,</text>
<text text-anchor="middle" x="3706" y="-842.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; and prose</text>
<text text-anchor="middle" x="3706" y="-827.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif (blocks[i &#45; 1].id == &quot;code&quot;) then</text>
<text text-anchor="middle" x="3706" y="-811.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer()</text>
<text text-anchor="middle" x="3706" y="-796.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot; .. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-764.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding line is blank and before that is </text>
<text text-anchor="middle" x="3706" y="-749.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; nothing or more prose, write blanks, then prose.</text>
<text text-anchor="middle" x="3706" y="-734.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="3706" y="-718.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[i &#45; 2] == nil or blocks[i &#45; 2].id == &quot;prose&quot;) then</text>
<text text-anchor="middle" x="3706" y="-703.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="3706" y="-671.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3706" y="-656.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;Reached a bad state on prose in catLines&quot;)</text>
<text text-anchor="middle" x="3706" y="-641.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end </text>
<text text-anchor="middle" x="3706" y="-594.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-578.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if blocks[#blocks].id == &quot;code&quot; or</text>
<text text-anchor="middle" x="3706" y="-563.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[#blocks].id == &quot;blank&quot; </text>
<text text-anchor="middle" x="3706" y="-548.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and blocks[#blocks &#45; 1].id == &quot;code&quot;) then</text>
<text text-anchor="middle" x="3706" y="-532.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer()</text>
<text text-anchor="middle" x="3706" y="-517.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3706" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Note that there may be a final block of blank lines which we are</text>
<text text-anchor="middle" x="3706" y="-470.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; happy to simply drop. </text>
<text text-anchor="middle" x="3706" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase, linum</text>
<text text-anchor="middle" x="3706" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>codeblock_21&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3414.9327,-1916.1614C3428.5218,-1874.8357 3463.9637,-1767.0542 3505.6375,-1640.3206"/>
<polygon fill="#000000" stroke="#000000" points="3508.9787,-1641.3641 3508.7776,-1630.7712 3502.329,-1639.1774 3508.9787,-1641.3641"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="4459,-1050.9038 4009,-1050.9038 4009,-1011.0996 4459,-1011.0996 4459,-1050.9038"/>
<text text-anchor="middle" x="4234" y="-1019.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> This takes a source file and inverts it into Grimoire format.</text>
</g>
<!-- prose_29&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>prose_29&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4617.0253,-1916.0676C4623.805,-1868.8976 4635.0969,-1740.8881 4573,-1666.6028 4541.3597,-1628.7521 4503.6051,-1664.7504 4468,-1630.6028 4295.4303,-1465.0971 4247.8622,-1157.3565 4236.8957,-1060.7868"/>
<polygon fill="#000000" stroke="#000000" points="4240.3741,-1060.3976 4235.812,-1050.8353 4233.4152,-1061.1554 4240.3741,-1060.3976"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="4787,-1049.0017 4477,-1049.0017 4477,-1013.0017 4787,-1013.0017 4787,-1049.0017"/>
<text text-anchor="middle" x="4632" y="-1027.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; str: The source file as a single string</text>
</g>
<!-- prose_30&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>prose_30&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4694.7216,-1916.1614C4686.7454,-1803.598 4643.8326,-1197.9898 4634.0057,-1059.3072"/>
<polygon fill="#000000" stroke="#000000" points="4637.4796,-1058.814 4633.2815,-1049.0865 4630.4971,-1059.3089 4637.4796,-1058.814"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="5136.5,-1050.9038 4805.5,-1050.9038 4805.5,-1011.0996 5136.5,-1011.0996 5136.5,-1050.9038"/>
<text text-anchor="middle" x="4971" y="-1035.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return: The Grimoire document as a string</text>
</g>
<!-- prose_31&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>prose_31&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4845.5568,-1916.1614C4861.4393,-1804.0909 4946.5845,-1203.2839 4966.7266,-1061.1557"/>
<polygon fill="#000000" stroke="#000000" points="4970.2283,-1061.3904 4968.1661,-1050.9982 4963.2975,-1060.4081 4970.2283,-1061.3904"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="5625.5,-1243.4027 5154.5,-1243.4027 5154.5,-818.6007 5625.5,-818.6007 5625.5,-1243.4027"/>
<text text-anchor="middle" x="5390" y="-1228.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert(inverter, str)</text>
<text text-anchor="middle" x="5390" y="-1212.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local blocks = {}</text>
<text text-anchor="middle" x="5390" y="-1197.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local linum = 0</text>
<text text-anchor="middle" x="5390" y="-1181.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local latest = nil</text>
<text text-anchor="middle" x="5390" y="-1166.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, line in ipairs(epeg.split(str, &quot;\n&quot;)) do</text>
<text text-anchor="middle" x="5390" y="-1151.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;linum = linum + 1</text>
<text text-anchor="middle" x="5390" y="-1135.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;line = inverter:filter(line)</text>
<text text-anchor="middle" x="5390" y="-1120.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; each line is either comment, blank or code.</text>
<text text-anchor="middle" x="5390" y="-1104.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local this_block = inverter:sortLine(latest, line)</text>
<text text-anchor="middle" x="5390" y="-1089.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if this_block ~= latest then</text>
<text text-anchor="middle" x="5390" y="-1074.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;blocks[#blocks + 1] = this_block</text>
<text text-anchor="middle" x="5390" y="-1058.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest = this_block</text>
<text text-anchor="middle" x="5390" y="-1043.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5390" y="-1027.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5390" y="-1012.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local new_linum = 0</text>
<text text-anchor="middle" x="5390" y="-997.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45;&#45;[[ This entire check should be wrapped in a utility assert</text>
<text text-anchor="middle" x="5390" y="-981.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(blocks) do</text>
<text text-anchor="middle" x="5390" y="-966.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for __, line in ipairs(v) do</text>
<text text-anchor="middle" x="5390" y="-950.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;new_linum = new_linum + 1</text>
<text text-anchor="middle" x="5390" y="-935.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5390" y="-920.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="5390" y="-904.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="5390" y="-889.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(linum == new_linum)</text>
<text text-anchor="middle" x="5390" y="-857.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase, cat_linum = inverter:catBlocks(blocks)</text>
<text text-anchor="middle" x="5390" y="-842.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="5390" y="-827.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>codeblock_32&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5190.075,-1916.1614C5208.6761,-1833.8055 5286.8884,-1487.5241 5339.7944,-1253.2847"/>
<polygon fill="#000000" stroke="#000000" points="5343.2691,-1253.7871 5342.0583,-1243.2616 5336.4411,-1252.2448 5343.2691,-1253.7871"/>
</g>
<!-- header_38 -->
<g id="node39" class="node">
<title>header_38</title>
<ellipse fill="none" stroke="#000000" cx="5712" cy="-1031.0017" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="5712" y="-1026.8017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Constructor</text>
</g>
<!-- section_33&#45;&gt;header_38 -->
<g id="edge38" class="edge">
<title>section_33&#45;&gt;header_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5827.5095,-1916.072C5821.0515,-1868.9901 5803.2747,-1738.9656 5789,-1630.6028 5760.0156,-1410.5757 5726.3782,-1144.9398 5715.5499,-1059.1602"/>
<polygon fill="#000000" stroke="#000000" points="5719.0123,-1058.6416 5714.2878,-1049.1585 5712.0674,-1059.518 5719.0123,-1058.6416"/>
</g>
<!-- prose_39 -->
<g id="node40" class="node">
<title>prose_39</title>
<ellipse fill="none" stroke="#000000" cx="5830" cy="-1031.0017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5830" y="-1026.8017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_33&#45;&gt;prose_39 -->
<g id="edge39" class="edge">
<title>section_33&#45;&gt;prose_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5830,-1916.1614C5830,-1803.598 5830,-1197.9898 5830,-1059.3072"/>
<polygon fill="#000000" stroke="#000000" points="5833.5001,-1059.0864 5830,-1049.0865 5826.5001,-1059.0865 5833.5001,-1059.0864"/>
</g>
<!-- prose_40 -->
<g id="node41" class="node">
<title>prose_40</title>
<ellipse fill="none" stroke="#000000" cx="5912" cy="-1031.0017" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5912" y="-1026.8017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_33&#45;&gt;prose_40 -->
<g id="edge40" class="edge">
<title>section_33&#45;&gt;prose_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5832.8672,-1916.116C5840.2215,-1869.1386 5859.952,-1739.342 5871,-1630.6028 5893.3018,-1411.0985 5906.7343,-1145.1218 5910.7337,-1059.2077"/>
<polygon fill="#000000" stroke="#000000" points="5914.2312,-1059.3404 5911.195,-1049.1899 5907.2386,-1059.0183 5914.2312,-1059.3404"/>
</g>
<!-- codeblock_41 -->
<g id="node42" class="node">
<title>codeblock_41</title>
<ellipse fill="none" stroke="#000000" cx="6240" cy="-1031.0017" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6240" y="-1026.8017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 263&#45;289</text>
</g>
<!-- section_33&#45;&gt;codeblock_41 -->
<g id="edge41" class="edge">
<title>section_33&#45;&gt;codeblock_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5838.1899,-1916.1614C5889.3895,-1803.3722 6165.3011,-1195.5581 6227.5273,-1058.4782"/>
<polygon fill="#000000" stroke="#000000" points="6230.8441,-1059.639 6231.7906,-1049.0865 6224.4701,-1056.7455 6230.8441,-1059.639"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="5640.5,-225.0008 5421.5,-225.0008 5421.5,-170.3999 5640.5,-170.3999 5640.5,-225.0008"/>
<text text-anchor="middle" x="5531" y="-209.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="5531" y="-194.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;Currently minimum&#45;viable. </text>
</g>
<!-- prose_39&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>prose_39&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5831.4757,-1012.8722C5838.4321,-922.6113 5864.557,-522.4231 5789,-431.4007 5748.2399,-382.2976 5701.141,-433.5725 5650,-395.4007 5594.9325,-354.2981 5560.2349,-279.5201 5543.3323,-234.6461"/>
<polygon fill="#000000" stroke="#000000" points="5546.5271,-233.1917 5539.8015,-225.0053 5539.954,-235.599 5546.5271,-233.1917"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="6165,-286.7006 5659,-286.7006 5659,-108.7 6165,-108.7 6165,-286.7006"/>
<text text-anchor="middle" x="5912" y="-271.5005" font-family="Inconsolata" font-size="14.00" fill="#000000"> Long term, lang can be other than nil, which gets you lua.</text>
<text text-anchor="middle" x="5912" y="-256.1005" font-family="Inconsolata" font-size="14.00" fill="#000000"> A string will return an inverter.lang of that string if such</text>
<text text-anchor="middle" x="5912" y="-240.7004" font-family="Inconsolata" font-size="14.00" fill="#000000"> exists.</text>
<text text-anchor="middle" x="5912" y="-225.3004" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="5912" y="-209.9004" font-family="Inconsolata" font-size="14.00" fill="#000000"> A table will configure a lang, memoize it if it&#39;s new, and return</text>
<text text-anchor="middle" x="5912" y="-194.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> same. If one of that name already exists, memoization isn&#39;t repeated,</text>
<text text-anchor="middle" x="5912" y="-179.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> so for a default like lua or python, making a custom python inverter</text>
<text text-anchor="middle" x="5912" y="-163.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> wont affect the result of subsequent `invert(&quot;python&quot;)` calls. </text>
<text text-anchor="middle" x="5912" y="-148.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
<text text-anchor="middle" x="5912" y="-132.9002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#45; #return: an Inverter</text>
</g>
<!-- prose_40&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>prose_40&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5912,-1012.8221C5912,-919.7123 5912,-493.0284 5912,-296.8672"/>
<polygon fill="#000000" stroke="#000000" points="5915.5001,-296.8473 5912,-286.8473 5908.5001,-296.8473 5915.5001,-296.8473"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="6675,-395.6012 6183,-395.6012 6183,.2005 6675,.2005 6675,-395.6012"/>
<text text-anchor="middle" x="6429" y="-380.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Inverter, lang)</text>
<text text-anchor="middle" x="6429" y="-364.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local inverter = setmetatable({}, Inv)</text>
<text text-anchor="middle" x="6429" y="-349.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if lang and lang ~= &quot;lua&quot; then</text>
<text text-anchor="middle" x="6429" y="-334.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;configs not yet implemented&quot;)</text>
<text text-anchor="middle" x="6429" y="-318.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6429" y="-303.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return inverter</text>
<text text-anchor="middle" x="6429" y="-287.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6429" y="-256.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">local inv_lua = new()</text>
<text text-anchor="middle" x="6429" y="-225.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.getLang(inverter, key)</text>
<text text-anchor="middle" x="6429" y="-209.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if key == &quot;lua&quot; then</text>
<text text-anchor="middle" x="6429" y="-194.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return inv_lua</text>
<text text-anchor="middle" x="6429" y="-178.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6429" y="-163.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if inverter.langs[key] then </text>
<text text-anchor="middle" x="6429" y="-148.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return inverter.langs[key]</text>
<text text-anchor="middle" x="6429" y="-132.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6429" y="-117.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;No inverter found for language &quot; .. tostring(key))</text>
<text text-anchor="middle" x="6429" y="-101.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6429" y="-86.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6429" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.__call = invert</text>
<text text-anchor="middle" x="6429" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.invert = invert</text>
<text text-anchor="middle" x="6429" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(inv, new)</text>
</g>
<!-- codeblock_41&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_41&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6244.1233,-1012.8221C6261.894,-934.4708 6333.2386,-619.9123 6381.9203,-405.2749"/>
<polygon fill="#000000" stroke="#000000" points="6385.3499,-405.9769 6384.1486,-395.4504 6378.5233,-404.4285 6385.3499,-405.9769"/>
</g>
</g>
</svg>