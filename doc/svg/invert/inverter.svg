<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3677pt" height="1351pt"
 viewBox="0.00 0.00 3676.84 1351.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1347.2021)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1347.2021 3672.8384,-1347.2021 3672.8384,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="83.8384" cy="-1325.2021" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="83.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 290</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="83.8384" cy="-671.6011" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="83.8384" y="-667.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;205</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M83.8384,-1307.0389C83.8384,-1216.1529 83.8384,-810.7291 83.8384,-699.7602"/>
<polygon fill="#000000" stroke="#000000" points="87.3385,-699.6764 83.8384,-689.6765 80.3385,-699.6765 87.3385,-699.6764"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="83.8384" cy="-18" rx="83.677" ry="18"/>
<text text-anchor="middle" x="83.8384" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Inverter module</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M83.8384,-653.4379C83.8384,-562.5519 83.8384,-157.1281 83.8384,-46.1591"/>
<polygon fill="#000000" stroke="#000000" points="87.3385,-46.0754 83.8384,-36.0754 80.3385,-46.0755 87.3385,-46.0754"/>
</g>
<!-- codeblock_3 -->
<g id="node4" class="node">
<title>codeblock_3</title>
<ellipse fill="none" stroke="#000000" cx="374.8384" cy="-1325.2021" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="374.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_3</text>
</g>
<!-- leaf_7 -->
<g id="node5" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="582.3384,-784.7017 167.3384,-784.7017 167.3384,-558.5004 582.3384,-558.5004 582.3384,-784.7017"/>
<text text-anchor="middle" x="374.8384" y="-769.7012" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="374.8384" y="-738.3012" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="374.8384" y="-706.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="374.8384" y="-675.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="374.8384" y="-644.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function isBlank(line)</text>
<text text-anchor="middle" x="374.8384" y="-628.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local all_blanks = L.match((m.__TAB__ + m._)^0, line)</text>
<text text-anchor="middle" x="374.8384" y="-613.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return (all_blanks == (#line + 1) or line == &quot;&quot;)</text>
<text text-anchor="middle" x="374.8384" y="-597.901" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="374.8384" y="-566.501" font-family="Inconsolata" font-size="14.00" fill="#000000">local Inv, inv = u.inherit()</text>
</g>
<!-- codeblock_3&#45;&gt;leaf_7 -->
<g id="edge3" class="edge">
<title>codeblock_3&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M374.8384,-1307.0389C374.8384,-1234.0353 374.8384,-958.092 374.8384,-794.8208"/>
<polygon fill="#000000" stroke="#000000" points="378.3385,-794.7166 374.8384,-784.7166 371.3385,-794.7166 378.3385,-794.7166"/>
</g>
<!-- codeblock_4 -->
<g id="node6" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="846.8384" cy="-1325.2021" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="846.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_4</text>
</g>
<!-- leaf_8 -->
<g id="node7" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="1092.8384,-939.302 600.8384,-939.302 600.8384,-403.9001 1092.8384,-403.9001 1092.8384,-939.302"/>
<text text-anchor="middle" x="846.8384" y="-924.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.lang = &quot;lua&quot;</text>
<text text-anchor="middle" x="846.8384" y="-908.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.extension = &quot;.lua&quot;</text>
<text text-anchor="middle" x="846.8384" y="-893.2014" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.comment = L.P&quot;&#45;&#45;&quot;</text>
<text text-anchor="middle" x="846.8384" y="-877.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.comment_len = 3</text>
<text text-anchor="middle" x="846.8384" y="-862.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.tab_to_space = &quot; &#160;&#160;&quot;</text>
<text text-anchor="middle" x="846.8384" y="-831.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">local lang_config = { lua = { lang = &quot;lua&quot;, </text>
<text text-anchor="middle" x="846.8384" y="-815.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;extension = &quot;.lua&quot;,</text>
<text text-anchor="middle" x="846.8384" y="-800.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment = L.P&quot;&#45;&#45;&quot;,</text>
<text text-anchor="middle" x="846.8384" y="-784.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment_len = 3,</text>
<text text-anchor="middle" x="846.8384" y="-769.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tab_to_space = &quot; &#160;&#160;&quot;}}</text>
<text text-anchor="middle" x="846.8384" y="-738.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.write_header(inverter)</text>
<text text-anchor="middle" x="846.8384" y="-722.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;#!&quot; .. inverter.lang .. &quot;\n&quot;</text>
<text text-anchor="middle" x="846.8384" y="-707.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="846.8384" y="-675.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.write_footer(inverter)</text>
<text text-anchor="middle" x="846.8384" y="-660.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;#/&quot; .. inverter.lang .. &quot;\n&quot;</text>
<text text-anchor="middle" x="846.8384" y="-645.001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="846.8384" y="-613.601" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.filter(inverter, line)</text>
<text text-anchor="middle" x="846.8384" y="-598.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if isBlank(line) then</text>
<text text-anchor="middle" x="846.8384" y="-582.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="846.8384" y="-567.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="846.8384" y="-552.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return line:gsub(&quot;\t&quot;, inverter.tab_to_space):gsub(&quot;\r&quot;, &quot;&quot;)</text>
<text text-anchor="middle" x="846.8384" y="-536.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="846.8384" y="-521.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="846.8384" y="-489.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function cat_lines() end &#45;&#45;stub out</text>
<text text-anchor="middle" x="846.8384" y="-458.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.matchComment(inverter, line)</text>
<text text-anchor="middle" x="846.8384" y="-443.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return (L.match(inverter.comment * m._, line) </text>
<text text-anchor="middle" x="846.8384" y="-427.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or (L.match(inverter.comment, line) and #line == 2))</text>
<text text-anchor="middle" x="846.8384" y="-412.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_8 -->
<g id="edge4" class="edge">
<title>codeblock_4&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M846.8384,-1307.0389C846.8384,-1254.2345 846.8384,-1095.2557 846.8384,-949.5378"/>
<polygon fill="#000000" stroke="#000000" points="850.3385,-949.5157 846.8384,-939.5157 843.3385,-949.5158 850.3385,-949.5157"/>
</g>
<!-- section_5 -->
<g id="node8" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1192.8384" cy="-1325.2021" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="1192.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_5</text>
</g>
<!-- header_9 -->
<g id="node9" class="node">
<title>header_9</title>
<ellipse fill="none" stroke="#000000" cx="1192.8384" cy="-671.6011" rx="82.2492" ry="18"/>
<text text-anchor="middle" x="1192.8384" y="-667.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : matchLineType</text>
</g>
<!-- section_5&#45;&gt;header_9 -->
<g id="edge5" class="edge">
<title>section_5&#45;&gt;header_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1192.8384,-1307.0389C1192.8384,-1216.1529 1192.8384,-810.7291 1192.8384,-699.7602"/>
<polygon fill="#000000" stroke="#000000" points="1196.3385,-699.6764 1192.8384,-689.6765 1189.3385,-699.6765 1196.3385,-699.6764"/>
</g>
<!-- codeblock_10 -->
<g id="node10" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="1517.8384" cy="-1325.2021" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="1517.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_10</text>
</g>
<!-- leaf_12 -->
<g id="node11" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1742.8384,-930.5022 1292.8384,-930.5022 1292.8384,-412.6999 1742.8384,-412.6999 1742.8384,-930.5022"/>
<text text-anchor="middle" x="1517.8384" y="-915.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.sortLine(inverter, latest, line)</text>
<text text-anchor="middle" x="1517.8384" y="-899.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local block = latest or {}</text>
<text text-anchor="middle" x="1517.8384" y="-868.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if inverter:matchComment(line) then</text>
<text text-anchor="middle" x="1517.8384" y="-852.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; prose</text>
<text text-anchor="middle" x="1517.8384" y="-837.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;prose&quot; then</text>
<text text-anchor="middle" x="1517.8384" y="-822.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new prose block</text>
<text text-anchor="middle" x="1517.8384" y="-806.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;prose&quot;}</text>
<text text-anchor="middle" x="1517.8384" y="-791.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line:sub(inverter.comment_len)</text>
<text text-anchor="middle" x="1517.8384" y="-775.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1517.8384" y="-760.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line:sub(inverter.comment_len)</text>
<text text-anchor="middle" x="1517.8384" y="-745.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1517.8384" y="-729.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;elseif isBlank(line) then</text>
<text text-anchor="middle" x="1517.8384" y="-714.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; blank line</text>
<text text-anchor="middle" x="1517.8384" y="-698.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;blank&quot; then</text>
<text text-anchor="middle" x="1517.8384" y="-683.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;blank&quot;}</text>
<text text-anchor="middle" x="1517.8384" y="-668.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="1517.8384" y="-652.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1517.8384" y="-637.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="1517.8384" y="-621.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1517.8384" y="-606.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1517.8384" y="-591.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code line</text>
<text text-anchor="middle" x="1517.8384" y="-575.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not block.id or block.id ~= &quot;code&quot; then</text>
<text text-anchor="middle" x="1517.8384" y="-560.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; new code block</text>
<text text-anchor="middle" x="1517.8384" y="-544.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block = { id = &quot;code&quot; }</text>
<text text-anchor="middle" x="1517.8384" y="-529.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="1517.8384" y="-514.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1517.8384" y="-498.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;block[#block + 1] = line</text>
<text text-anchor="middle" x="1517.8384" y="-483.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1517.8384" y="-467.9007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1517.8384" y="-436.5006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return block</text>
<text text-anchor="middle" x="1517.8384" y="-421.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_12 -->
<g id="edge6" class="edge">
<title>codeblock_10&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1517.8384,-1307.0389C1517.8384,-1253.1764 1517.8384,-1088.8418 1517.8384,-940.795"/>
<polygon fill="#000000" stroke="#000000" points="1521.3385,-940.6172 1517.8384,-930.6173 1514.3385,-940.6173 1521.3385,-940.6172"/>
</g>
<!-- codeblock_11 -->
<g id="node12" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="2045.8384" cy="-1325.2021" rx="64.0625" ry="18"/>
<text text-anchor="middle" x="2045.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_11</text>
</g>
<!-- leaf_13 -->
<g id="node13" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="2330.3384,-1271.3032 1761.3384,-1271.3032 1761.3384,-71.8989 2330.3384,-71.8989 2330.3384,-1271.3032"/>
<text text-anchor="middle" x="2045.8384" y="-1256.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.catBlocks(inverter, blocks)</text>
<text text-anchor="middle" x="2045.8384" y="-1240.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local linum = 0</text>
<text text-anchor="middle" x="2045.8384" y="-1225.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local function toLines(block) </text>
<text text-anchor="middle" x="2045.8384" y="-1209.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2045.8384" y="-1194.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for j = 1, #block do</text>
<text text-anchor="middle" x="2045.8384" y="-1179.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;linum = linum + 1</text>
<text text-anchor="middle" x="2045.8384" y="-1163.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. block[j] .. &quot;\n&quot;</text>
<text text-anchor="middle" x="2045.8384" y="-1148.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-1132.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="2045.8384" y="-1117.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-1102.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="2045.8384" y="-1086.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if blocks[1].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-1071.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_header()</text>
<text text-anchor="middle" x="2045.8384" y="-1055.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-1040.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;phrase = phrase .. toLines(blocks[1]) </text>
<text text-anchor="middle" x="2045.8384" y="-1025.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for i = 2, #blocks do</text>
<text text-anchor="middle" x="2045.8384" y="-1009.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-978.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is</text>
<text text-anchor="middle" x="2045.8384" y="-962.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code, write blanks and code</text>
<text text-anchor="middle" x="2045.8384" y="-947.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="2045.8384" y="-932.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i &gt; 2 and blocks[i &#45; 2].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-916.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-885.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is </text>
<text text-anchor="middle" x="2045.8384" y="-869.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; prose or nothing, write blanks, header, and code</text>
<text text-anchor="middle" x="2045.8384" y="-854.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="2045.8384" y="-839.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[i &#45; 2] == nil or blocks[i &#45; 2].id == &quot;prose&quot;) then</text>
<text text-anchor="middle" x="2045.8384" y="-823.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1])</text>
<text text-anchor="middle" x="2045.8384" y="-808.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. inverter:write_header()</text>
<text text-anchor="middle" x="2045.8384" y="-792.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-761.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is prose, write a blank line, </text>
<text text-anchor="middle" x="2045.8384" y="-746.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; header, and code. </text>
<text text-anchor="middle" x="2045.8384" y="-730.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;prose&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-715.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. &quot;\n&quot; .. inverter:write_header() </text>
<text text-anchor="middle" x="2045.8384" y="-699.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-684.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2045.8384" y="-669.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;Reached a bad state on code in catLines&quot;)</text>
<text text-anchor="middle" x="2045.8384" y="-653.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-638.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i].id == &quot;prose&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-606.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is blank and before that is</text>
<text text-anchor="middle" x="2045.8384" y="-591.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; code, write footer, blanks, and prose</text>
<text text-anchor="middle" x="2045.8384" y="-576.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="2045.8384" y="-560.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;i &gt; 2 and blocks[i &#45; 2].id == &quot;code&quot; then</text>
<text text-anchor="middle" x="2045.8384" y="-545.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer() </text>
<text text-anchor="middle" x="2045.8384" y="-529.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-498.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding block is code, write a footer, newline,</text>
<text text-anchor="middle" x="2045.8384" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; and prose</text>
<text text-anchor="middle" x="2045.8384" y="-467.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif (blocks[i &#45; 1].id == &quot;code&quot;) then</text>
<text text-anchor="middle" x="2045.8384" y="-452.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer()</text>
<text text-anchor="middle" x="2045.8384" y="-436.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot; .. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-405.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; if preceding line is blank and before that is </text>
<text text-anchor="middle" x="2045.8384" y="-390.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; nothing or more prose, write blanks, then prose.</text>
<text text-anchor="middle" x="2045.8384" y="-374.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif blocks[i &#45; 1].id == &quot;blank&quot; and </text>
<text text-anchor="middle" x="2045.8384" y="-359.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[i &#45; 2] == nil or blocks[i &#45; 2].id == &quot;prose&quot;) then</text>
<text text-anchor="middle" x="2045.8384" y="-343.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. toLines(blocks[i &#45; 1]) .. toLines(blocks[i])</text>
<text text-anchor="middle" x="2045.8384" y="-312.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2045.8384" y="-297.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;Reached a bad state on prose in catLines&quot;)</text>
<text text-anchor="middle" x="2045.8384" y="-281.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-266.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end </text>
<text text-anchor="middle" x="2045.8384" y="-234.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-219.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if blocks[#blocks].id == &quot;code&quot; or</text>
<text text-anchor="middle" x="2045.8384" y="-204.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;(blocks[#blocks].id == &quot;blank&quot; </text>
<text text-anchor="middle" x="2045.8384" y="-188.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and blocks[#blocks &#45; 1].id == &quot;code&quot;) then</text>
<text text-anchor="middle" x="2045.8384" y="-173.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;phrase = phrase .. inverter:write_footer()</text>
<text text-anchor="middle" x="2045.8384" y="-157.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2045.8384" y="-126.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Note that there may be a final block of blank lines which we are</text>
<text text-anchor="middle" x="2045.8384" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; happy to simply drop. </text>
<text text-anchor="middle" x="2045.8384" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase, linum</text>
<text text-anchor="middle" x="2045.8384" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_13 -->
<g id="edge7" class="edge">
<title>codeblock_11&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2045.8384,-1307.0389C2045.8384,-1300.2424 2045.8384,-1291.687 2045.8384,-1281.6272"/>
<polygon fill="#000000" stroke="#000000" points="2049.3385,-1281.5297 2045.8384,-1271.5298 2042.3385,-1281.5298 2049.3385,-1281.5297"/>
</g>
<!-- section_6 -->
<g id="node14" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2431.8384" cy="-1325.2021" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="2431.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_6</text>
</g>
<!-- header_14 -->
<g id="node15" class="node">
<title>header_14</title>
<ellipse fill="none" stroke="#000000" cx="2431.8384" cy="-671.6011" rx="83.6081" ry="18"/>
<text text-anchor="middle" x="2431.8384" y="-667.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Grym:invert(str)</text>
</g>
<!-- section_6&#45;&gt;header_14 -->
<g id="edge8" class="edge">
<title>section_6&#45;&gt;header_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2431.8384,-1307.0389C2431.8384,-1216.1529 2431.8384,-810.7291 2431.8384,-699.7602"/>
<polygon fill="#000000" stroke="#000000" points="2435.3385,-699.6764 2431.8384,-689.6765 2428.3385,-699.6765 2435.3385,-699.6764"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="2768.8384" cy="-1325.2021" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="2768.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_15</text>
</g>
<!-- leaf_17 -->
<g id="node17" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="3004.3384,-884.0021 2533.3384,-884.0021 2533.3384,-459.2001 3004.3384,-459.2001 3004.3384,-884.0021"/>
<text text-anchor="middle" x="2768.8384" y="-868.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function invert(inverter, str)</text>
<text text-anchor="middle" x="2768.8384" y="-853.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local blocks = {}</text>
<text text-anchor="middle" x="2768.8384" y="-837.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local linum = 0</text>
<text text-anchor="middle" x="2768.8384" y="-822.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local latest = nil</text>
<text text-anchor="middle" x="2768.8384" y="-807.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, line in ipairs(epeg.split(str, &quot;\n&quot;)) do</text>
<text text-anchor="middle" x="2768.8384" y="-791.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;linum = linum + 1</text>
<text text-anchor="middle" x="2768.8384" y="-776.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;line = inverter:filter(line)</text>
<text text-anchor="middle" x="2768.8384" y="-760.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; each line is either comment, blank or code.</text>
<text text-anchor="middle" x="2768.8384" y="-745.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;local this_block = inverter:sortLine(latest, line)</text>
<text text-anchor="middle" x="2768.8384" y="-730.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if this_block ~= latest then</text>
<text text-anchor="middle" x="2768.8384" y="-714.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;blocks[#blocks + 1] = this_block</text>
<text text-anchor="middle" x="2768.8384" y="-699.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;latest = this_block</text>
<text text-anchor="middle" x="2768.8384" y="-683.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2768.8384" y="-668.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2768.8384" y="-653.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local new_linum = 0</text>
<text text-anchor="middle" x="2768.8384" y="-637.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45;&#45;[[ This entire check should be wrapped in a utility assert</text>
<text text-anchor="middle" x="2768.8384" y="-622.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for _, v in ipairs(blocks) do</text>
<text text-anchor="middle" x="2768.8384" y="-606.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;for __, line in ipairs(v) do</text>
<text text-anchor="middle" x="2768.8384" y="-591.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;new_linum = new_linum + 1</text>
<text text-anchor="middle" x="2768.8384" y="-576.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2768.8384" y="-560.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2768.8384" y="-545.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="2768.8384" y="-529.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;assert(linum == new_linum)</text>
<text text-anchor="middle" x="2768.8384" y="-498.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local phrase, cat_linum = inverter:catBlocks(blocks)</text>
<text text-anchor="middle" x="2768.8384" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return phrase</text>
<text text-anchor="middle" x="2768.8384" y="-467.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_17 -->
<g id="edge9" class="edge">
<title>codeblock_15&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2768.8384,-1307.0389C2768.8384,-1247.4737 2768.8384,-1052.8058 2768.8384,-894.47"/>
<polygon fill="#000000" stroke="#000000" points="2772.3385,-894.095 2768.8384,-884.095 2765.3385,-894.0951 2772.3385,-894.095"/>
</g>
<!-- section_16 -->
<g id="node18" class="node">
<title>section_16</title>
<ellipse fill="none" stroke="#000000" cx="3090.8384" cy="-1325.2021" rx="52.7641" ry="18"/>
<text text-anchor="middle" x="3090.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_16</text>
</g>
<!-- header_18 -->
<g id="node19" class="node">
<title>header_18</title>
<ellipse fill="none" stroke="#000000" cx="3090.8384" cy="-671.6011" rx="68.2066" ry="18"/>
<text text-anchor="middle" x="3090.8384" y="-667.4011" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Constructor</text>
</g>
<!-- section_16&#45;&gt;header_18 -->
<g id="edge10" class="edge">
<title>section_16&#45;&gt;header_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3090.8384,-1307.0389C3090.8384,-1216.1529 3090.8384,-810.7291 3090.8384,-699.7602"/>
<polygon fill="#000000" stroke="#000000" points="3094.3385,-699.6764 3090.8384,-689.6765 3087.3385,-699.6765 3094.3385,-699.6764"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="3422.8384" cy="-1325.2021" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="3422.8384" y="-1321.0021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_19</text>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="3668.8384,-869.5019 3176.8384,-869.5019 3176.8384,-473.7002 3668.8384,-473.7002 3668.8384,-869.5019"/>
<text text-anchor="middle" x="3422.8384" y="-854.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Inverter, lang)</text>
<text text-anchor="middle" x="3422.8384" y="-838.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local inverter = setmetatable({}, Inv)</text>
<text text-anchor="middle" x="3422.8384" y="-823.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if lang and lang ~= &quot;lua&quot; then</text>
<text text-anchor="middle" x="3422.8384" y="-807.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;configs not yet implemented&quot;)</text>
<text text-anchor="middle" x="3422.8384" y="-792.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3422.8384" y="-777.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return inverter</text>
<text text-anchor="middle" x="3422.8384" y="-761.7012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3422.8384" y="-730.3012" font-family="Inconsolata" font-size="14.00" fill="#000000">local inv_lua = new()</text>
<text text-anchor="middle" x="3422.8384" y="-698.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Inv.getLang(inverter, key)</text>
<text text-anchor="middle" x="3422.8384" y="-683.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if key == &quot;lua&quot; then</text>
<text text-anchor="middle" x="3422.8384" y="-668.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return inv_lua</text>
<text text-anchor="middle" x="3422.8384" y="-652.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3422.8384" y="-637.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if inverter.langs[key] then </text>
<text text-anchor="middle" x="3422.8384" y="-621.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return inverter.langs[key]</text>
<text text-anchor="middle" x="3422.8384" y="-606.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="3422.8384" y="-591.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;u.freeze(&quot;No inverter found for language &quot; .. tostring(key))</text>
<text text-anchor="middle" x="3422.8384" y="-575.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3422.8384" y="-560.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3422.8384" y="-528.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.__call = invert</text>
<text text-anchor="middle" x="3422.8384" y="-513.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">Inv.invert = invert</text>
<text text-anchor="middle" x="3422.8384" y="-482.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">return u.export(inv, new)</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_20 -->
<g id="edge11" class="edge">
<title>codeblock_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3422.8384,-1307.0389C3422.8384,-1245.5968 3422.8384,-1040.4033 3422.8384,-879.6156"/>
<polygon fill="#000000" stroke="#000000" points="3426.3385,-879.5763 3422.8384,-869.5764 3419.3385,-879.5764 3426.3385,-879.5763"/>
</g>
</g>
</svg>