<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="3235pt" height="4124pt"
 viewBox="0.00 0.00 3234.50 4124.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4120.0062)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4120.0062 3230.5,-4120.0062 3230.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="924" cy="-4098.0062" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="924" y="-4093.8062" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 152</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="924" cy="-4026.0062" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="924" y="-4021.8062" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;55</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M924,-4079.8376C924,-4072.1372 924,-4062.9806 924,-4054.4229"/>
<polygon fill="#000000" stroke="#000000" points="927.5001,-4054.4195 924,-4044.4195 920.5001,-4054.4195 927.5001,-4054.4195"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="523" cy="-3531.4056" rx="49.5296" ry="18"/>
<text text-anchor="middle" x="523" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Weave</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866.0251,-4020.6236C773.6824,-4011.4997 601.5574,-3992.0285 582,-3972.0062 469.7201,-3857.0579 501.0498,-3637.642 516.6612,-3559.7223"/>
<polygon fill="#000000" stroke="#000000" points="520.1376,-3560.1948 518.7431,-3549.6922 513.2837,-3558.7721 520.1376,-3560.1948"/>
</g>
<!-- block_3 -->
<g id="node4" class="node">
<title>block_3</title>
<ellipse fill="none" stroke="#000000" cx="637" cy="-3531.4056" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="637" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 1&#45;5</text>
</g>
<!-- section_1&#45;&gt;block_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;block_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866.3802,-4020.0996C805.4271,-4012.5995 714.9356,-3997.4731 692,-3972.0062 584.5913,-3852.7432 615.5145,-3636.0309 630.8043,-3559.2711"/>
<polygon fill="#000000" stroke="#000000" points="634.2494,-3559.8945 632.842,-3549.3935 627.3937,-3558.4801 634.2494,-3559.8945"/>
</g>
<!-- block_4 -->
<g id="node5" class="node">
<title>block_4</title>
<ellipse fill="none" stroke="#000000" cx="747" cy="-3531.4056" rx="45.9804" ry="18"/>
<text text-anchor="middle" x="747" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 6&#45;7</text>
</g>
<!-- section_1&#45;&gt;block_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;block_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873.1887,-4015.9408C847.822,-4008.2317 818.9945,-3994.8726 802,-3972.0062 706.8947,-3844.0405 729.5642,-3635.2505 741.7816,-3559.7639"/>
<polygon fill="#000000" stroke="#000000" points="745.2806,-3560.0622 743.493,-3549.6193 738.3782,-3558.8977 745.2806,-3560.0622"/>
</g>
<!-- block_5 -->
<g id="node6" class="node">
<title>block_5</title>
<ellipse fill="none" stroke="#000000" cx="862" cy="-3531.4056" rx="50.8172" ry="18"/>
<text text-anchor="middle" x="862" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 8&#45;10</text>
</g>
<!-- section_1&#45;&gt;block_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;block_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M921.7199,-4007.8166C912.3672,-3933.2067 876.9038,-3650.2998 865.5321,-3559.5825"/>
<polygon fill="#000000" stroke="#000000" points="868.9848,-3558.9861 864.2681,-3549.4991 862.0391,-3559.8568 868.9848,-3558.9861"/>
</g>
<!-- block_6 -->
<g id="node7" class="node">
<title>block_6</title>
<ellipse fill="none" stroke="#000000" cx="986" cy="-3531.4056" rx="55.3502" ry="18"/>
<text text-anchor="middle" x="986" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 11&#45;48</text>
</g>
<!-- section_1&#45;&gt;block_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;block_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M926.2801,-4007.8166C935.6328,-3933.2067 971.0962,-3650.2998 982.4679,-3559.5825"/>
<polygon fill="#000000" stroke="#000000" points="985.9609,-3559.8568 983.7319,-3549.4991 979.0152,-3558.9861 985.9609,-3559.8568"/>
</g>
<!-- block_7 -->
<g id="node8" class="node">
<title>block_7</title>
<ellipse fill="none" stroke="#000000" cx="1173" cy="-3531.4056" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1173" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 49&#45;55</text>
</g>
<!-- section_1&#45;&gt;block_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;block_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973.821,-4015.6412C999.9047,-4007.7893 1030.4047,-3994.39 1050,-3972.0062 1158.4439,-3848.1302 1171.9128,-3635.956 1173.1131,-3559.7202"/>
<polygon fill="#000000" stroke="#000000" points="1176.6151,-3559.5184 1173.211,-3549.4853 1169.6154,-3559.4514 1176.6151,-3559.5184"/>
</g>
<!-- section_8 -->
<g id="node9" class="node">
<title>section_8</title>
<ellipse fill="none" stroke="#000000" cx="1852" cy="-3531.4056" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1852" y="-3527.2056" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 56&#45;152</text>
</g>
<!-- section_1&#45;&gt;section_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;section_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M980.713,-4019.3557C1058.1436,-4009.7475 1192.5235,-3991.0392 1238,-3972.0062 1494.8409,-3864.5125 1747.7817,-3632.4689 1826.797,-3556.2331"/>
<polygon fill="#000000" stroke="#000000" points="1829.5738,-3558.4157 1834.3156,-3548.9411 1824.7004,-3553.3907 1829.5738,-3558.4157"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="2391,-3972.1069 1941,-3972.1069 1941,-3090.7044 2391,-3090.7044 2391,-3972.1069"/>
<text text-anchor="middle" x="2166" y="-3956.8062" font-family="Inconsolata" font-size="14.00" fill="#000000">* Weave</text>
<text text-anchor="middle" x="2166" y="-3909.4062" font-family="Inconsolata" font-size="14.00" fill="#000000">Our weaver is currently somewhat narrowly focused on markdown.</text>
<text text-anchor="middle" x="2166" y="-3878.0062" font-family="Inconsolata" font-size="14.00" fill="#000000">This will change in time.</text>
<text text-anchor="middle" x="2166" y="-3846.6061" font-family="Inconsolata" font-size="14.00" fill="#000000">Now to activate dot!</text>
<text text-anchor="middle" x="2166" y="-3799.2061" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2166" y="-3783.8061" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="2166" y="-3752.4061" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="2166" y="-3737.006" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="2166" y="-3721.606" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="2166" y="-3706.206" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="2166" y="-3690.8059" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="2166" y="-3675.4059" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="2166" y="-3660.0059" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="2166" y="-3644.6058" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="2166" y="-3629.2058" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="2166" y="-3613.8058" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="2166" y="-3598.4057" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="2166" y="-3583.0057" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="2166" y="-3551.6057" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="2166" y="-3536.2056" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="2166" y="-3488.8056" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;lib/status&quot;</text>
<text text-anchor="middle" x="2166" y="-3457.4056" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="2166" y="-3426.0056" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="2166" y="-3410.6055" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="2166" y="-3395.2055" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="2166" y="-3379.8055" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="2166" y="-3364.4054" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="2166" y="-3349.0054" font-family="Inconsolata" font-size="14.00" fill="#000000">local writeOnChange = walk.writeOnChange</text>
<text text-anchor="middle" x="2166" y="-3317.6054" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="2166" y="-3286.2053" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
<text text-anchor="middle" x="2166" y="-3254.8053" font-family="Inconsolata" font-size="14.00" fill="#000000">local W, w = u.inherit(Node)</text>
<text text-anchor="middle" x="2166" y="-3239.4053" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="2166" y="-3208.0052" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2166" y="-3192.6052" font-family="Inconsolata" font-size="14.00" fill="#000000">function W.weaveMd(weaver, doc)</text>
<text text-anchor="middle" x="2166" y="-3177.2052" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return doc:toMarkdown()</text>
<text text-anchor="middle" x="2166" y="-3161.8051" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2166" y="-3146.4051" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="2166" y="-3099.0051" font-family="Inconsolata" font-size="14.00" fill="#000000">*</text>
</g>
<!-- section_1&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>section_1&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M984.6305,-4024.3989C1196.3236,-4018.5744 1891.9519,-3997.5659 1932,-3972.0062 1932.1882,-3971.8861 1932.3763,-3971.7658 1932.5643,-3971.6452"/>
<polygon fill="#000000" stroke="#000000" points="1934.5373,-3974.5364 1940.9264,-3966.0848 1930.6613,-3968.7075 1934.5373,-3974.5364"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="450,-2327.3053 0,-2327.3053 0,-2271.5023 450,-2271.5023 450,-2327.3053"/>
<text text-anchor="middle" x="225" y="-2279.9038" font-family="Inconsolata" font-size="14.00" fill="#000000">Our weaver is currently somewhat narrowly focused on markdown.</text>
</g>
<!-- block_3&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>block_3&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641.0156,-3513.1708C654.3863,-3447.2505 690.668,-3218.486 582,-3090.8051 545.0825,-3047.4283 499.591,-3094.7652 459,-3054.8051 249.85,-2848.9059 226.8309,-2460.1421 224.9278,-2337.482"/>
<polygon fill="#000000" stroke="#000000" points="228.4273,-2337.4048 224.8111,-2327.4462 221.4277,-2337.4862 228.4273,-2337.4048"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="659.5,-2317.4038 468.5,-2317.4038 468.5,-2281.4038 659.5,-2281.4038 659.5,-2317.4038"/>
<text text-anchor="middle" x="564" y="-2295.9038" font-family="Inconsolata" font-size="14.00" fill="#000000">This will change in time.</text>
</g>
<!-- block_4&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>block_4&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M747.5491,-3513.1175C748.8153,-3451.5122 748.263,-3246.6996 692,-3090.8051 685.5545,-3072.9459 675.5697,-3072.6189 669,-3054.8051 569.5411,-2785.1186 563.2587,-2429.6029 563.6467,-2327.7616"/>
<polygon fill="#000000" stroke="#000000" points="567.1472,-2327.6782 563.7114,-2317.6559 560.1473,-2327.6332 567.1472,-2327.6782"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="834,-2319.3059 678,-2319.3059 678,-2279.5017 834,-2279.5017 834,-2319.3059"/>
<text text-anchor="middle" x="756" y="-2303.9038" font-family="Inconsolata" font-size="14.00" fill="#000000">Now to activate dot!</text>
</g>
<!-- block_5&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>block_5&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.4193,-3513.0338C848.5565,-3375.156 773.5244,-2503.0838 758.5851,-2329.4492"/>
<polygon fill="#000000" stroke="#000000" points="762.0525,-2328.9187 757.708,-2319.2556 755.0782,-2329.5188 762.0525,-2328.9187"/>
</g>
<!-- codeblock_12 -->
<g id="node13" class="node">
<title>codeblock_12</title>
<ellipse fill="none" stroke="#000000" cx="929" cy="-2299.4038" rx="76.6175" ry="18"/>
<text text-anchor="middle" x="929" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 11&#45;47</text>
</g>
<!-- block_6&#45;&gt;codeblock_12 -->
<g id="edge12" class="edge">
<title>block_6&#45;&gt;codeblock_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M985.15,-3513.0338C978.747,-3374.6389 938.1204,-2496.5331 930.3011,-2327.5254"/>
<polygon fill="#000000" stroke="#000000" points="933.7927,-2327.2615 929.8342,-2317.434 926.8002,-2327.5851 933.7927,-2327.2615"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="1078,-2317.4038 1024,-2317.4038 1024,-2281.4038 1078,-2281.4038 1078,-2317.4038"/>
</g>
<!-- block_6&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>block_6&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M987.1924,-3513.2297C991.3234,-3449.9765 1005.3005,-3233.5979 1015,-3054.8051 1030.3901,-2771.1156 1045.4838,-2427.297 1049.7864,-2327.6886"/>
<polygon fill="#000000" stroke="#000000" points="1053.2902,-2327.6735 1050.2242,-2317.532 1046.2967,-2327.372 1053.2902,-2327.6735"/>
</g>
<!-- codeblock_15 -->
<g id="node16" class="node">
<title>codeblock_15</title>
<ellipse fill="none" stroke="#000000" cx="1173" cy="-2299.4038" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1173" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 49&#45;53</text>
</g>
<!-- block_7&#45;&gt;codeblock_15 -->
<g id="edge15" class="edge">
<title>block_7&#45;&gt;codeblock_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-3513.0338C1173,-3374.6389 1173,-2496.5331 1173,-2327.5254"/>
<polygon fill="#000000" stroke="#000000" points="1176.5001,-2327.434 1173,-2317.434 1169.5001,-2327.434 1176.5001,-2327.434"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1322,-2317.4038 1268,-2317.4038 1268,-2281.4038 1322,-2281.4038 1322,-2317.4038"/>
</g>
<!-- block_7&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>block_7&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1177.1419,-3513.3512C1191.3718,-3450.4949 1238.5085,-3235.2569 1259,-3054.8051 1291.0561,-2772.5127 1294.6414,-2427.7293 1294.9835,-2327.7889"/>
<polygon fill="#000000" stroke="#000000" points="1298.4838,-2327.6068 1295.0096,-2317.5979 1291.4839,-2327.5888 1298.4838,-2327.6068"/>
</g>
<!-- header_18 -->
<g id="node19" class="node">
<title>header_18</title>
<ellipse fill="none" stroke="#000000" cx="1583" cy="-2299.4038" rx="65.81" ry="18"/>
<text text-anchor="middle" x="1583" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : .dot to .svg</text>
</g>
<!-- section_8&#45;&gt;header_18 -->
<g id="edge18" class="edge">
<title>section_8&#45;&gt;header_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1842.3835,-3513.4352C1809.8494,-3451.7022 1703.3584,-3241.8035 1657,-3054.8051 1588.3114,-2777.7318 1582.8835,-2428.6634 1582.8385,-2327.8486"/>
<polygon fill="#000000" stroke="#000000" points="1586.3388,-2327.5792 1582.8531,-2317.5742 1579.3388,-2327.5692 1586.3388,-2327.5792"/>
</g>
<!-- block_19 -->
<g id="node20" class="node">
<title>block_19</title>
<ellipse fill="none" stroke="#000000" cx="1722" cy="-2299.4038" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1722" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 56&#45;60</text>
</g>
<!-- section_8&#45;&gt;block_19 -->
<g id="edge19" class="edge">
<title>section_8&#45;&gt;block_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.1946,-3513.2651C1839.5012,-3450.1274 1806.9256,-3234.0809 1787,-3054.8051 1755.5359,-2771.715 1730.822,-2427.4825 1723.9272,-2327.7316"/>
<polygon fill="#000000" stroke="#000000" points="1727.4056,-2327.2965 1723.2275,-2317.5603 1720.4221,-2327.7769 1727.4056,-2327.2965"/>
</g>
<!-- block_20 -->
<g id="node21" class="node">
<title>block_20</title>
<ellipse fill="none" stroke="#000000" cx="1852" cy="-2299.4038" rx="55.6542" ry="18"/>
<text text-anchor="middle" x="1852" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 61&#45;77</text>
</g>
<!-- section_8&#45;&gt;block_20 -->
<g id="edge20" class="edge">
<title>section_8&#45;&gt;block_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852,-3513.0338C1852,-3374.6389 1852,-2496.5331 1852,-2327.5254"/>
<polygon fill="#000000" stroke="#000000" points="1855.5001,-2327.434 1852,-2317.434 1848.5001,-2327.434 1855.5001,-2327.434"/>
</g>
<!-- block_21 -->
<g id="node22" class="node">
<title>block_21</title>
<ellipse fill="none" stroke="#000000" cx="1987" cy="-2299.4038" rx="60.9913" ry="18"/>
<text text-anchor="middle" x="1987" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 78&#45;140</text>
</g>
<!-- section_8&#45;&gt;block_21 -->
<g id="edge21" class="edge">
<title>section_8&#45;&gt;block_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1854.7623,-3513.2602C1864.3149,-3450.1067 1896.4858,-3234.0145 1917,-3054.8051 1949.4124,-2771.6538 1977.0438,-2427.4635 1984.8188,-2327.7272"/>
<polygon fill="#000000" stroke="#000000" points="1988.3238,-2327.7984 1985.6087,-2317.5574 1981.3448,-2327.2563 1988.3238,-2327.7984"/>
</g>
<!-- block_22 -->
<g id="node23" class="node">
<title>block_22</title>
<ellipse fill="none" stroke="#000000" cx="2242" cy="-2299.4038" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="2242" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 141&#45;149</text>
</g>
<!-- section_8&#45;&gt;block_22 -->
<g id="edge22" class="edge">
<title>section_8&#45;&gt;block_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.1901,-3513.0186C1840.1471,-3446.576 1818.6086,-3216.2434 1932,-3090.8051 1970.7691,-3047.9171 2016.9502,-3096.4996 2057,-3054.8051 2262.5003,-2840.8654 2251.5317,-2437.755 2244.2907,-2327.7503"/>
<polygon fill="#000000" stroke="#000000" points="2247.7609,-2327.2024 2243.5668,-2317.4731 2240.7782,-2327.6944 2247.7609,-2327.2024"/>
</g>
<!-- block_23 -->
<g id="node24" class="node">
<title>block_23</title>
<ellipse fill="none" stroke="#000000" cx="2448" cy="-2299.4038" rx="65.8274" ry="18"/>
<text text-anchor="middle" x="2448" y="-2295.2038" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">block 150&#45;152</text>
</g>
<!-- section_8&#45;&gt;block_23 -->
<g id="edge23" class="edge">
<title>section_8&#45;&gt;block_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1848.588,-3513.2039C1837.044,-3445.4159 1806.8095,-3205.6234 1932,-3090.8051 1995.3275,-3032.7243 2253.9025,-3113.1356 2317,-3054.8051 2532.4246,-2855.6556 2474.0056,-2439.4664 2453.599,-2327.5966"/>
<polygon fill="#000000" stroke="#000000" points="2456.9802,-2326.6369 2451.6984,-2317.4525 2450.0999,-2327.9261 2456.9802,-2326.6369"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="3226.5,-3054.7063 2531.5,-3054.7063 2531.5,-1544.1012 3226.5,-1544.1012 3226.5,-3054.7063"/>
<text text-anchor="middle" x="2879" y="-3039.6051" font-family="Inconsolata" font-size="14.00" fill="#000000">*** .dot to .svg</text>
<text text-anchor="middle" x="2879" y="-3008.205" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The sh&#45;lib monkeypatches the global metatable, and all we want is one</text>
<text text-anchor="middle" x="2879" y="-2992.805" font-family="Inconsolata" font-size="14.00" fill="#000000">command, so we do something odd here:</text>
<text text-anchor="middle" x="2879" y="-2961.405" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2879" y="-2946.0049" font-family="Inconsolata" font-size="14.00" fill="#000000">local dot_sh = (require &quot;sh&quot;):clear_G().command(&#39;dot&#39;, &#39;&#45;Tsvg&#39;)</text>
<text text-anchor="middle" x="2879" y="-2914.6049" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dotToSvg(dotted, out_file)</text>
<text text-anchor="middle" x="2879" y="-2899.2049" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local run_dot = dot_sh({__input = dotted})</text>
<text text-anchor="middle" x="2879" y="-2883.8048" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if run_dot.__exitcode == 0 then</text>
<text text-anchor="middle" x="2879" y="-2868.4048" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return tostring(run_dot)</text>
<text text-anchor="middle" x="2879" y="-2853.0048" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="2879" y="-2837.6047" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:complain(a.red(&quot;Dot returned &quot;) </text>
<text text-anchor="middle" x="2879" y="-2822.2047" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. tostring(run_dot.__exitcode)</text>
<text text-anchor="middle" x="2879" y="-2806.8047" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. a.red(&quot; for &quot; .. out_file ))</text>
<text text-anchor="middle" x="2879" y="-2791.4047" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2776.0046" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2760.6046" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2879" y="-2745.2046" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="2879" y="-2697.8045" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2879" y="-2682.4045" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_dir(weaver, pwd, depth)</text>
<text text-anchor="middle" x="2879" y="-2667.0045" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="2879" y="-2651.6044" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="2879" y="-2636.2044" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="2879" y="-2620.8044" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="2879" y="-2589.4043" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="2879" y="-2574.0043" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir)</text>
<text text-anchor="middle" x="2879" y="-2558.6043" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="2879" y="-2543.2042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="2879" y="-2527.8042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="2879" y="-2512.4042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Weave and prepare out directory</text>
<text text-anchor="middle" x="2879" y="-2497.0042" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:verb((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. f)</text>
<text text-anchor="middle" x="2879" y="-2481.6041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="2879" y="-2466.2041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc = Doc(orb_f)</text>
<text text-anchor="middle" x="2879" y="-2450.8041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_md_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/md&quot;, dirname(f))</text>
<text text-anchor="middle" x="2879" y="-2435.404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_dot_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/dot&quot;, dirname(f))</text>
<text text-anchor="middle" x="2879" y="-2420.004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_svg_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/svg&quot;, dirname(f))</text>
<text text-anchor="middle" x="2879" y="-2404.604" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_md_dir)</text>
<text text-anchor="middle" x="2879" y="-2389.2039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_dot_dir)</text>
<text text-anchor="middle" x="2879" y="-2373.8039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_svg_dir)</text>
<text text-anchor="middle" x="2879" y="-2358.4039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; &#160;== #&quot;.orb&quot;</text>
<text text-anchor="middle" x="2879" y="-2343.0038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_md_name = doc_md_dir .. &quot;/&quot; .. bare_name .. &quot;.md&quot;</text>
<text text-anchor="middle" x="2879" y="-2327.6038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_dot_name = doc_dot_dir .. &quot;/&quot; .. bare_name .. &quot;.dot&quot;</text>
<text text-anchor="middle" x="2879" y="-2312.2038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_svg_name = doc_svg_dir .. &quot;/&quot; .. bare_name .. &quot;.svg&quot;</text>
<text text-anchor="middle" x="2879" y="-2296.8037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_md = weaver:weaveMd(doc) or &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2281.4037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="2879" y="-2266.0037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Compare, report, and write out if necessary</text>
<text text-anchor="middle" x="2879" y="-2250.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_md = read(out_md_name) or &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2235.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local changed = writeOnChange(woven_md, last_md, out_md_name, depth)</text>
<text text-anchor="middle" x="2879" y="-2219.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_dot = doc:dot() or &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2204.4036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;changed = changed or writeOnChange(woven_dot, last_dot, out_dot_name, depth) </text>
<text text-anchor="middle" x="2879" y="-2189.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if changed then</text>
<text text-anchor="middle" x="2879" y="-2173.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_svg = dotToSvg(woven_dot, out_dot_name)</text>
<text text-anchor="middle" x="2879" y="-2158.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_dot = read(out_dot_name) or &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2142.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_svg = read(out_svg_name) or &quot;&quot;</text>
<text text-anchor="middle" x="2879" y="-2127.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_svg, last_svg, out_svg_name, depth)</text>
<text text-anchor="middle" x="2879" y="-2112.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2096.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2081.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2065.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2050.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-2019.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2879" y="-2003.6032" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2879" y="-1972.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_all(weaver, pwd)</text>
<text text-anchor="middle" x="2879" y="-1956.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="2879" y="-1941.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="2879" y="-1926.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="2879" y="-1910.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Weave: &quot; .. dir))</text>
<text text-anchor="middle" x="2879" y="-1895.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return weave_dir(weaver, dir, 0)</text>
<text text-anchor="middle" x="2879" y="-1879.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-1864.4029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2879" y="-1833.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="2879" y="-1817.6029" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2879" y="-1786.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">W.weave_all = weave_all</text>
<text text-anchor="middle" x="2879" y="-1770.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="2879" y="-1723.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2879" y="-1708.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Weaver, doc)</text>
<text text-anchor="middle" x="2879" y="-1692.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local weaver = setmetatable({}, W)</text>
<text text-anchor="middle" x="2879" y="-1645.2027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return weaver</text>
<text text-anchor="middle" x="2879" y="-1629.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2879" y="-1614.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
<text text-anchor="middle" x="2879" y="-1583.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">#!lua</text>
<text text-anchor="middle" x="2879" y="-1567.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">return W</text>
<text text-anchor="middle" x="2879" y="-1552.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">#/lua</text>
</g>
<!-- section_8&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>section_8&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1848.4694,-3513.0724C1836.5039,-3444.8174 1804.9661,-3203.5805 1932,-3090.8051 2030.3969,-3003.4524 2414.0804,-3128.6221 2523,-3054.8051 2523.0891,-3054.7447 2523.1781,-3054.6843 2523.2672,-3054.6239"/>
<polygon fill="#000000" stroke="#000000" points="2525.2632,-3057.4989 2531.4845,-3048.923 2521.2731,-3051.7475 2525.2632,-3057.4989"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="856,-1508.203 532,-1508.203 532,-955.4011 856,-955.4011 856,-1508.203"/>
<text text-anchor="middle" x="694" y="-1492.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="694" y="-1461.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="694" y="-1446.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="694" y="-1430.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="694" y="-1415.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="694" y="-1399.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="694" y="-1384.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="694" y="-1369.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="694" y="-1353.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="694" y="-1338.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="694" y="-1322.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="694" y="-1307.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="694" y="-1292.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="694" y="-1260.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="694" y="-1245.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="694" y="-1197.802" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;lib/status&quot;</text>
<text text-anchor="middle" x="694" y="-1166.402" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="694" y="-1135.002" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="694" y="-1119.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="694" y="-1104.2019" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="694" y="-1088.8019" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="694" y="-1073.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="694" y="-1058.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local writeOnChange = walk.writeOnChange</text>
<text text-anchor="middle" x="694" y="-1026.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="694" y="-995.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
<text text-anchor="middle" x="694" y="-963.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local W, w = u.inherit(Node)</text>
</g>
<!-- codeblock_12&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_12&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M929.1246,-2281.1304C929.2535,-2195.8544 924.7894,-1829.1595 843,-1544.0025 840.5072,-1535.3114 837.7923,-1526.5628 834.89,-1517.7936"/>
<polygon fill="#000000" stroke="#000000" points="838.1889,-1516.6227 831.6689,-1508.2716 831.558,-1518.8659 838.1889,-1516.6227"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1107.5,-1259.0026 874.5,-1259.0026 874.5,-1204.6016 1107.5,-1204.6016 1107.5,-1259.0026"/>
<text text-anchor="middle" x="991" y="-1243.7021" font-family="Inconsolata" font-size="14.00" fill="#000000">function W.weaveMd(weaver, doc)</text>
<text text-anchor="middle" x="991" y="-1228.3021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return doc:toMarkdown()</text>
<text text-anchor="middle" x="991" y="-1212.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.1789,-2281.3644C1168.0883,-2197.1326 1147.6327,-1834.3948 1087,-1544.0025 1065.7449,-1442.2042 1025.677,-1326.0396 1004.658,-1268.3333"/>
<polygon fill="#000000" stroke="#000000" points="1007.9354,-1267.1046 1001.2086,-1258.9192 1001.3627,-1269.5129 1007.9354,-1267.1046"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="1638.5,-1259.1025 1125.5,-1259.1025 1125.5,-1204.5017 1638.5,-1204.5017 1638.5,-1259.1025"/>
<text text-anchor="middle" x="1382" y="-1228.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The sh&#45;lib monkeypatches the global metatable, and all we want is one</text>
<text text-anchor="middle" x="1382" y="-1212.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">command, so we do something odd here:</text>
</g>
<!-- block_19&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>block_19&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1724.4619,-2281.4111C1735.4733,-2195.1492 1774.7313,-1816.8768 1658,-1544.0025 1606.5644,-1423.7651 1490.151,-1317.6655 1426.1716,-1265.6898"/>
<polygon fill="#000000" stroke="#000000" points="1428.244,-1262.8649 1418.2594,-1259.3209 1423.8547,-1268.3178 1428.244,-1262.8649"/>
</g>
<!-- codeblock_25 -->
<g id="node26" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="1734" cy="-1231.8021" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1734" y="-1227.6021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 61&#45;75</text>
</g>
<!-- block_20&#45;&gt;codeblock_25 -->
<g id="edge25" class="edge">
<title>block_20&#45;&gt;codeblock_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1850.9898,-2281.2213C1846.1989,-2197.0791 1824.4284,-1837.1335 1787,-1544.0025 1773.5524,-1438.6833 1750.2315,-1314.5919 1739.5872,-1259.9898"/>
<polygon fill="#000000" stroke="#000000" points="1742.9917,-1259.1624 1737.634,-1250.0221 1736.1224,-1260.5085 1742.9917,-1259.1624"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="1883,-1249.8021 1829,-1249.8021 1829,-1213.8021 1883,-1213.8021 1883,-1249.8021"/>
</g>
<!-- block_20&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>block_20&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.0677,-2281.3215C1852.538,-2155.8246 1855.3136,-1415.0138 1855.8937,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="1859.3941,-1260.0605 1855.9316,-1250.0474 1852.3941,-1260.0342 1859.3941,-1260.0605"/>
</g>
<!-- codeblock_28 -->
<g id="node29" class="node">
<title>codeblock_28</title>
<ellipse fill="none" stroke="#000000" cx="1983" cy="-1231.8021" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1983" y="-1227.6021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 78&#45;138</text>
</g>
<!-- block_21&#45;&gt;codeblock_28 -->
<g id="edge28" class="edge">
<title>block_21&#45;&gt;codeblock_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1986.9323,-2281.3215C1986.462,-2155.8246 1983.6864,-1415.0138 1983.1063,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="1986.6059,-1260.0342 1983.0684,-1250.0474 1979.6059,-1260.0605 1986.6059,-1260.0342"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2137,-1249.8021 2083,-1249.8021 2083,-1213.8021 2137,-1213.8021 2137,-1249.8021"/>
</g>
<!-- block_21&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>block_21&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1989.0833,-2281.3215C2003.542,-2155.8246 2088.8919,-1415.0138 2106.732,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="2110.2303,-1260.3823 2107.8979,-1250.0474 2103.2763,-1259.581 2110.2303,-1260.3823"/>
</g>
<!-- codeblock_31 -->
<g id="node32" class="node">
<title>codeblock_31</title>
<ellipse fill="none" stroke="#000000" cx="2242" cy="-1231.8021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2242" y="-1227.6021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 141&#45;148</text>
</g>
<!-- block_22&#45;&gt;codeblock_31 -->
<g id="edge31" class="edge">
<title>block_22&#45;&gt;codeblock_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2242,-2281.3215C2242,-2155.8246 2242,-1415.0138 2242,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="2245.5001,-1260.0473 2242,-1250.0474 2238.5001,-1260.0474 2245.5001,-1260.0473"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2401,-1249.8021 2347,-1249.8021 2347,-1213.8021 2401,-1213.8021 2401,-1249.8021"/>
</g>
<!-- block_22&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>block_22&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2244.2357,-2281.3215C2259.7524,-2155.8246 2351.3474,-1415.0138 2370.4929,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="2373.9905,-1260.4013 2371.7441,-1250.0474 2367.0434,-1259.5423 2373.9905,-1260.4013"/>
</g>
<!-- codeblock_34 -->
<g id="node35" class="node">
<title>codeblock_34</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-1231.8021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2506" y="-1227.6021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 150&#45;152</text>
</g>
<!-- block_23&#45;&gt;codeblock_34 -->
<g id="edge34" class="edge">
<title>block_23&#45;&gt;codeblock_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2448.9824,-2281.3215C2455.8003,-2155.8246 2496.0466,-1415.0138 2504.459,-1260.1672"/>
<polygon fill="#000000" stroke="#000000" points="2507.9611,-1260.2226 2505.0088,-1250.0474 2500.9714,-1259.8428 2507.9611,-1260.2226"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2665,-1249.8021 2611,-1249.8021 2611,-1213.8021 2665,-1213.8021 2665,-1249.8021"/>
</g>
<!-- block_23&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>block_23&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2443.8383,-2281.2935C2424.2552,-2191.2867 2349.2931,-1786.7615 2523,-1544.0025 2545.4533,-1512.6235 2579.0685,-1539.0337 2602,-1508.0025 2657.3871,-1433.052 2649.7836,-1314.416 2642.6408,-1260.3469"/>
<polygon fill="#000000" stroke="#000000" points="2646.0609,-1259.5363 2641.1918,-1250.1267 2639.1302,-1260.519 2646.0609,-1259.5363"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1527.5,-564.1013 1070.5,-564.1013 1070.5,-355.5004 1527.5,-355.5004 1527.5,-564.1013"/>
<text text-anchor="middle" x="1299" y="-549.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local dot_sh = (require &quot;sh&quot;):clear_G().command(&#39;dot&#39;, &#39;&#45;Tsvg&#39;)</text>
<text text-anchor="middle" x="1299" y="-517.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dotToSvg(dotted, out_file)</text>
<text text-anchor="middle" x="1299" y="-502.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local run_dot = dot_sh({__input = dotted})</text>
<text text-anchor="middle" x="1299" y="-486.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if run_dot.__exitcode == 0 then</text>
<text text-anchor="middle" x="1299" y="-471.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return tostring(run_dot)</text>
<text text-anchor="middle" x="1299" y="-456.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1299" y="-440.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:complain(a.red(&quot;Dot returned &quot;) </text>
<text text-anchor="middle" x="1299" y="-425.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. tostring(run_dot.__exitcode)</text>
<text text-anchor="middle" x="1299" y="-409.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. a.red(&quot; for &quot; .. out_file ))</text>
<text text-anchor="middle" x="1299" y="-394.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1299" y="-379.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1299" y="-363.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_25&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1733.7243,-1213.7942C1731.989,-1165.1295 1720.4513,-1029.6778 1647,-955.6017 1610.4829,-918.774 1575.5248,-953.1809 1536,-919.6017 1429.3107,-828.9612 1364.6762,-678.2197 1330.4391,-574.1786"/>
<polygon fill="#000000" stroke="#000000" points="1333.738,-573.005 1327.3211,-564.5744 1327.08,-575.1665 1333.738,-573.005"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="2240.5,-919.4026 1545.5,-919.4026 1545.5,-.1991 2240.5,-.1991 2240.5,-919.4026"/>
<text text-anchor="middle" x="1893" y="-904.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_dir(weaver, pwd, depth)</text>
<text text-anchor="middle" x="1893" y="-889.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="1893" y="-873.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1893" y="-858.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1893" y="-842.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1893" y="-811.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1893" y="-796.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir)</text>
<text text-anchor="middle" x="1893" y="-780.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1893" y="-765.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1893" y="-749.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1893" y="-734.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Weave and prepare out directory</text>
<text text-anchor="middle" x="1893" y="-719.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:verb((&quot; &#160;&quot;):rep(depth) .. &quot; &#160;&#45; &quot; .. f)</text>
<text text-anchor="middle" x="1893" y="-703.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1893" y="-688.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc = Doc(orb_f)</text>
<text text-anchor="middle" x="1893" y="-672.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_md_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/md&quot;, dirname(f))</text>
<text text-anchor="middle" x="1893" y="-657.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_dot_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/dot&quot;, dirname(f))</text>
<text text-anchor="middle" x="1893" y="-642.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_svg_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/svg&quot;, dirname(f))</text>
<text text-anchor="middle" x="1893" y="-626.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_md_dir)</text>
<text text-anchor="middle" x="1893" y="-611.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_dot_dir)</text>
<text text-anchor="middle" x="1893" y="-595.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_svg_dir)</text>
<text text-anchor="middle" x="1893" y="-580.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; &#160;== #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1893" y="-565.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_md_name = doc_md_dir .. &quot;/&quot; .. bare_name .. &quot;.md&quot;</text>
<text text-anchor="middle" x="1893" y="-549.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_dot_name = doc_dot_dir .. &quot;/&quot; .. bare_name .. &quot;.dot&quot;</text>
<text text-anchor="middle" x="1893" y="-534.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_svg_name = doc_svg_dir .. &quot;/&quot; .. bare_name .. &quot;.svg&quot;</text>
<text text-anchor="middle" x="1893" y="-518.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_md = weaver:weaveMd(doc) or &quot;&quot;</text>
<text text-anchor="middle" x="1893" y="-503.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="1893" y="-488.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Compare, report, and write out if necessary</text>
<text text-anchor="middle" x="1893" y="-472.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_md = read(out_md_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1893" y="-457.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local changed = writeOnChange(woven_md, last_md, out_md_name, depth)</text>
<text text-anchor="middle" x="1893" y="-441.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_dot = doc:dot() or &quot;&quot;</text>
<text text-anchor="middle" x="1893" y="-426.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;changed = changed or writeOnChange(woven_dot, last_dot, out_dot_name, depth) </text>
<text text-anchor="middle" x="1893" y="-411.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if changed then</text>
<text text-anchor="middle" x="1893" y="-395.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_svg = dotToSvg(woven_dot, out_dot_name)</text>
<text text-anchor="middle" x="1893" y="-380.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_dot = read(out_dot_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1893" y="-364.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_svg = read(out_svg_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1893" y="-349.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_svg, last_svg, out_svg_name, depth)</text>
<text text-anchor="middle" x="1893" y="-334.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-318.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-303.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-287.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-272.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-241.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1893" y="-225.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1893" y="-194.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_all(weaver, pwd)</text>
<text text-anchor="middle" x="1893" y="-178.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1893" y="-163.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1893" y="-148.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1893" y="-132.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Weave: &quot; .. dir))</text>
<text text-anchor="middle" x="1893" y="-117.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return weave_dir(weaver, dir, 0)</text>
<text text-anchor="middle" x="1893" y="-101.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-86.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1893" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="1893" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1893" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">W.weave_all = weave_all</text>
</g>
<!-- codeblock_28&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>codeblock_28&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1980.864,-1213.4803C1975.8361,-1170.3513 1962.5597,-1056.4695 1947.8052,-929.9082"/>
<polygon fill="#000000" stroke="#000000" points="1951.2378,-929.1266 1946.6033,-919.5991 1944.2849,-929.9372 1951.2378,-929.1266"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2541,-510.4018 2259,-510.4018 2259,-409.1999 2541,-409.1999 2541,-510.4018"/>
<text text-anchor="middle" x="2400" y="-495.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Weaver, doc)</text>
<text text-anchor="middle" x="2400" y="-480.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local weaver = setmetatable({}, W)</text>
<text text-anchor="middle" x="2400" y="-432.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return weaver</text>
<text text-anchor="middle" x="2400" y="-417.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>codeblock_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2245.7498,-1213.4803C2265.1462,-1118.7077 2354.4642,-682.2927 2387.5911,-520.4318"/>
<polygon fill="#000000" stroke="#000000" points="2391.0206,-521.1305 2389.5968,-510.6318 2384.1627,-519.7269 2391.0206,-521.1305"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="2631,-477.8008 2559,-477.8008 2559,-441.8008 2631,-441.8008 2631,-477.8008"/>
<text text-anchor="middle" x="2595" y="-456.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">return W</text>
</g>
<!-- codeblock_34&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>codeblock_34&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2508.8505,-1213.539C2516.2893,-1165.4942 2536.6374,-1031.5656 2550,-919.6017 2569.4382,-756.7308 2586.5368,-560.6574 2592.6294,-488.3624"/>
<polygon fill="#000000" stroke="#000000" points="2596.1312,-488.4861 2593.4795,-478.2285 2589.1557,-487.9009 2596.1312,-488.4861"/>
</g>
</g>
</svg>