<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2416pt" height="1056pt"
 viewBox="0.00 0.00 2416.42 1056.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1052.2017)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1052.2017 2412.4241,-1052.2017 2412.4241,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="60.7408" cy="-1030.2017" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="60.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 151</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="60.7408" cy="-524.1008" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="60.7408" y="-519.9008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;55</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M60.7408,-1012.1893C60.7408,-936.6377 60.7408,-644.95 60.7408,-552.4288"/>
<polygon fill="#000000" stroke="#000000" points="64.2409,-552.1609 60.7408,-542.161 57.2409,-552.161 64.2409,-552.1609"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="60.7408" cy="-18" rx="49.5296" ry="18"/>
<text text-anchor="middle" x="60.7408" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Weave</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M60.7408,-506.0884C60.7408,-430.5369 60.7408,-138.8492 60.7408,-46.328"/>
<polygon fill="#000000" stroke="#000000" points="64.2409,-46.0601 60.7408,-36.0601 57.2409,-46.0602 64.2409,-46.0601"/>
</g>
<!-- codeblock_3 -->
<g id="node4" class="node">
<title>codeblock_3</title>
<ellipse fill="none" stroke="#000000" cx="301.7408" cy="-1030.2017" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="301.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_3</text>
</g>
<!-- leaf_6 -->
<g id="node5" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="463.7408,-800.5018 139.7408,-800.5018 139.7408,-247.6999 463.7408,-247.6999 463.7408,-800.5018"/>
<text text-anchor="middle" x="301.7408" y="-785.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="301.7408" y="-753.7012" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="301.7408" y="-738.3012" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="301.7408" y="-722.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="301.7408" y="-707.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="301.7408" y="-692.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="301.7408" y="-676.701" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="301.7408" y="-661.301" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="301.7408" y="-645.901" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="301.7408" y="-630.501" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="301.7408" y="-615.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="301.7408" y="-599.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="301.7408" y="-584.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="301.7408" y="-552.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="301.7408" y="-537.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="301.7408" y="-490.1008" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;lib/status&quot;</text>
<text text-anchor="middle" x="301.7408" y="-458.7007" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="301.7408" y="-427.3007" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="301.7408" y="-411.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="301.7408" y="-396.5006" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="301.7408" y="-381.1006" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="301.7408" y="-365.7006" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="301.7408" y="-350.3005" font-family="Inconsolata" font-size="14.00" fill="#000000">local writeOnChange = walk.writeOnChange</text>
<text text-anchor="middle" x="301.7408" y="-318.9005" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="301.7408" y="-287.5005" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
<text text-anchor="middle" x="301.7408" y="-256.1005" font-family="Inconsolata" font-size="14.00" fill="#000000">local W, w = u.inherit(Node)</text>
</g>
<!-- codeblock_3&#45;&gt;leaf_6 -->
<g id="edge3" class="edge">
<title>codeblock_3&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M301.7408,-1012.1893C301.7408,-977.3816 301.7408,-896.6974 301.7408,-810.7492"/>
<polygon fill="#000000" stroke="#000000" points="305.2409,-810.5178 301.7408,-800.5178 298.2409,-810.5179 305.2409,-810.5178"/>
</g>
<!-- codeblock_4 -->
<g id="node6" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="598.7408" cy="-1030.2017" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="598.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_4</text>
</g>
<!-- leaf_7 -->
<g id="node7" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="715.2408,-551.3013 482.2408,-551.3013 482.2408,-496.9004 715.2408,-496.9004 715.2408,-551.3013"/>
<text text-anchor="middle" x="598.7408" y="-536.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">function W.weaveMd(weaver, doc)</text>
<text text-anchor="middle" x="598.7408" y="-520.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return doc:toMarkdown()</text>
<text text-anchor="middle" x="598.7408" y="-505.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_7 -->
<g id="edge4" class="edge">
<title>codeblock_4&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.7408,-1012.1893C598.7408,-938.9749 598.7408,-662.7899 598.7408,-561.5747"/>
<polygon fill="#000000" stroke="#000000" points="602.2409,-561.5031 598.7408,-551.5031 595.2409,-561.5031 602.2409,-561.5031"/>
</g>
<!-- section_5 -->
<g id="node8" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="798.7408" cy="-1030.2017" rx="47.9272" ry="18"/>
<text text-anchor="middle" x="798.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section_5</text>
</g>
<!-- header_8 -->
<g id="node9" class="node">
<title>header_8</title>
<ellipse fill="none" stroke="#000000" cx="798.7408" cy="-524.1008" rx="65.81" ry="18"/>
<text text-anchor="middle" x="798.7408" y="-519.9008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : .dot to .svg</text>
</g>
<!-- section_5&#45;&gt;header_8 -->
<g id="edge5" class="edge">
<title>section_5&#45;&gt;header_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M798.7408,-1012.1893C798.7408,-936.6377 798.7408,-644.95 798.7408,-552.4288"/>
<polygon fill="#000000" stroke="#000000" points="802.2409,-552.1609 798.7408,-542.161 795.2409,-552.161 802.2409,-552.1609"/>
</g>
<!-- codeblock_9 -->
<g id="node10" class="node">
<title>codeblock_9</title>
<ellipse fill="none" stroke="#000000" cx="1110.7408" cy="-1030.2017" rx="59.5308" ry="18"/>
<text text-anchor="middle" x="1110.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_9</text>
</g>
<!-- leaf_13 -->
<g id="node11" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1339.2408,-628.4013 882.2408,-628.4013 882.2408,-419.8004 1339.2408,-419.8004 1339.2408,-628.4013"/>
<text text-anchor="middle" x="1110.7408" y="-613.301" font-family="Inconsolata" font-size="14.00" fill="#000000">local dot_sh = (require &quot;sh&quot;):clear_G().command(&#39;dot&#39;, &#39;&#45;Tsvg&#39;)</text>
<text text-anchor="middle" x="1110.7408" y="-581.901" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dotToSvg(dotted, out_file)</text>
<text text-anchor="middle" x="1110.7408" y="-566.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local run_dot = dot_sh({__input = dotted})</text>
<text text-anchor="middle" x="1110.7408" y="-551.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if run_dot.__exitcode == 0 then</text>
<text text-anchor="middle" x="1110.7408" y="-535.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return tostring(run_dot)</text>
<text text-anchor="middle" x="1110.7408" y="-520.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1110.7408" y="-504.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:complain(a.red(&quot;Dot returned &quot;) </text>
<text text-anchor="middle" x="1110.7408" y="-489.5008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. tostring(run_dot.__exitcode)</text>
<text text-anchor="middle" x="1110.7408" y="-474.1008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. a.red(&quot; for &quot; .. out_file ))</text>
<text text-anchor="middle" x="1110.7408" y="-458.7007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1110.7408" y="-443.3007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1110.7408" y="-427.9007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_9&#45;&gt;leaf_13 -->
<g id="edge6" class="edge">
<title>codeblock_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1110.7408,-1012.1893C1110.7408,-953.4002 1110.7408,-763.7429 1110.7408,-638.8876"/>
<polygon fill="#000000" stroke="#000000" points="1114.2409,-638.5156 1110.7408,-628.5157 1107.2409,-638.5157 1114.2409,-638.5156"/>
</g>
<!-- codeblock_10 -->
<g id="node12" class="node">
<title>codeblock_10</title>
<ellipse fill="none" stroke="#000000" cx="1673.7408" cy="-1030.2017" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="1673.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_10</text>
</g>
<!-- leaf_14 -->
<g id="node13" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="1989.7408,-976.3025 1357.7408,-976.3025 1357.7408,-71.8992 1989.7408,-71.8992 1989.7408,-976.3025"/>
<text text-anchor="middle" x="1673.7408" y="-961.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_dir(weaver, pwd, depth)</text>
<text text-anchor="middle" x="1673.7408" y="-945.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="1673.7408" y="-930.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1673.7408" y="-914.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1673.7408" y="-899.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1673.7408" y="-868.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1673.7408" y="-852.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir)</text>
<text text-anchor="middle" x="1673.7408" y="-837.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1673.7408" y="-821.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1673.7408" y="-806.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1673.7408" y="-791.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Weave and prepare out directory</text>
<text text-anchor="middle" x="1673.7408" y="-775.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1673.7408" y="-760.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc = Doc(orb_f)</text>
<text text-anchor="middle" x="1673.7408" y="-744.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_md_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/md&quot;, dirname(f))</text>
<text text-anchor="middle" x="1673.7408" y="-729.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_dot_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/dot&quot;, dirname(f))</text>
<text text-anchor="middle" x="1673.7408" y="-714.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_svg_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/svg&quot;, dirname(f))</text>
<text text-anchor="middle" x="1673.7408" y="-698.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_md_dir)</text>
<text text-anchor="middle" x="1673.7408" y="-683.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_dot_dir)</text>
<text text-anchor="middle" x="1673.7408" y="-667.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_svg_dir)</text>
<text text-anchor="middle" x="1673.7408" y="-652.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; &#160;== #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-637.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_md_name = doc_md_dir .. &quot;/&quot; .. bare_name .. &quot;.md&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-621.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_dot_name = doc_dot_dir .. &quot;/&quot; .. bare_name .. &quot;.dot&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-606.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_svg_name = doc_svg_dir .. &quot;/&quot; .. bare_name .. &quot;.svg&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-590.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_md = weaver:weaveMd(doc) or &quot;&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-575.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="middle" x="1673.7408" y="-560.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Compare, report, and write out if necessary</text>
<text text-anchor="middle" x="1673.7408" y="-544.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_md = read(out_md_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-529.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local changed = writeOnChange(woven_md, last_md, out_md_name, depth)</text>
<text text-anchor="middle" x="1673.7408" y="-513.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if changed then</text>
<text text-anchor="middle" x="1673.7408" y="-498.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_dot = doc:dot() or &quot;&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-483.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_svg = dotToSvg(woven_dot, out_dot_name)</text>
<text text-anchor="middle" x="1673.7408" y="-467.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_dot = read(out_dot_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-452.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_svg = read(out_svg_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1673.7408" y="-436.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_dot, last_dot, out_dot_name, depth)</text>
<text text-anchor="middle" x="1673.7408" y="-421.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_svg, last_svg, out_svg_name, depth)</text>
<text text-anchor="middle" x="1673.7408" y="-406.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-390.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-375.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-359.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-344.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-313.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1673.7408" y="-297.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1673.7408" y="-266.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_all(weaver, pwd)</text>
<text text-anchor="middle" x="1673.7408" y="-250.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1673.7408" y="-235.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1673.7408" y="-220.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1673.7408" y="-204.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Weave: &quot; .. dir))</text>
<text text-anchor="middle" x="1673.7408" y="-189.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return weave_dir(weaver, dir, 0)</text>
<text text-anchor="middle" x="1673.7408" y="-173.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-158.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1673.7408" y="-127.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="1673.7408" y="-111.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1673.7408" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">W.weave_all = weave_all</text>
</g>
<!-- codeblock_10&#45;&gt;leaf_14 -->
<g id="edge7" class="edge">
<title>codeblock_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1673.7408,-1012.1893C1673.7408,-1005.3171 1673.7408,-996.6566 1673.7408,-986.5204"/>
<polygon fill="#000000" stroke="#000000" points="1677.2409,-986.3602 1673.7408,-976.3602 1670.2409,-986.3603 1677.2409,-986.3602"/>
</g>
<!-- codeblock_11 -->
<g id="node14" class="node">
<title>codeblock_11</title>
<ellipse fill="none" stroke="#000000" cx="2148.7408" cy="-1030.2017" rx="64.0625" ry="18"/>
<text text-anchor="middle" x="2148.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_11</text>
</g>
<!-- leaf_15 -->
<g id="node15" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="2289.7408,-574.7017 2007.7408,-574.7017 2007.7408,-473.4999 2289.7408,-473.4999 2289.7408,-574.7017"/>
<text text-anchor="middle" x="2148.7408" y="-559.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Weaver, doc)</text>
<text text-anchor="middle" x="2148.7408" y="-544.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local weaver = setmetatable({}, W)</text>
<text text-anchor="middle" x="2148.7408" y="-496.9008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return weaver</text>
<text text-anchor="middle" x="2148.7408" y="-481.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_11&#45;&gt;leaf_15 -->
<g id="edge8" class="edge">
<title>codeblock_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2148.7408,-1012.1893C2148.7408,-944.0744 2148.7408,-700.2791 2148.7408,-585.1432"/>
<polygon fill="#000000" stroke="#000000" points="2152.2409,-585.0784 2148.7408,-575.0784 2145.2409,-585.0784 2152.2409,-585.0784"/>
</g>
<!-- codeblock_12 -->
<g id="node16" class="node">
<title>codeblock_12</title>
<ellipse fill="none" stroke="#000000" cx="2343.7408" cy="-1030.2017" rx="64.8671" ry="18"/>
<text text-anchor="middle" x="2343.7408" y="-1026.0017" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">codeblock_12</text>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="2379.7408,-542.1008 2307.7408,-542.1008 2307.7408,-506.1008 2379.7408,-506.1008 2379.7408,-542.1008"/>
<text text-anchor="middle" x="2343.7408" y="-520.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">return W</text>
</g>
<!-- codeblock_12&#45;&gt;leaf_16 -->
<g id="edge9" class="edge">
<title>codeblock_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2343.7408,-1012.1893C2343.7408,-936.6377 2343.7408,-644.95 2343.7408,-552.4288"/>
<polygon fill="#000000" stroke="#000000" points="2347.2409,-552.1609 2343.7408,-542.161 2340.2409,-552.161 2347.2409,-552.1609"/>
</g>
</g>
</svg>