<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: hierarchy Pages: 1 -->
<svg width="2676pt" height="1670pt"
 viewBox="0.00 0.00 2676.30 1670.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1666.4024)">
<title>hierarchy</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1666.4024 2672.2972,-1666.4024 2672.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="789" cy="-1644.4024" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="789" y="-1640.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 148</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="789" cy="-1572.4024" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="789" y="-1568.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;55</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M789,-1626.2337C789,-1618.5333 789,-1609.3767 789,-1600.819"/>
<polygon fill="#000000" stroke="#000000" points="792.5001,-1600.8156 789,-1590.8156 785.5001,-1600.8157 792.5001,-1600.8156"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="525" cy="-1500.4024" rx="49.5296" ry="18"/>
<text text-anchor="middle" x="525" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Weave</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M742.453,-1560.6863C700.8117,-1550.0754 638.1665,-1533.793 584,-1518.4024 580.3881,-1517.3761 576.6588,-1516.2933 572.912,-1515.1887"/>
<polygon fill="#000000" stroke="#000000" points="573.6052,-1511.7431 563.022,-1512.2377 571.6037,-1518.4509 573.6052,-1511.7431"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="625" cy="-1500.4024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="625" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M754.6202,-1557.3088C726.8097,-1545.0993 687.8158,-1527.98 659.8739,-1515.7129"/>
<polygon fill="#000000" stroke="#000000" points="661.0513,-1512.4074 650.4879,-1511.5922 658.2374,-1518.8169 661.0513,-1512.4074"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="707" cy="-1500.4024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="707" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M769.5671,-1555.3394C758.3006,-1545.4468 743.9965,-1532.8871 731.9098,-1522.2744"/>
<polygon fill="#000000" stroke="#000000" points="734.1653,-1519.5971 724.3415,-1515.6291 729.5466,-1524.8572 734.1653,-1519.5971"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="789" cy="-1500.4024" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="789" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M789,-1554.2337C789,-1546.5333 789,-1537.3767 789,-1528.819"/>
<polygon fill="#000000" stroke="#000000" points="792.5001,-1528.8156 789,-1518.8156 785.5001,-1528.8157 792.5001,-1528.8156"/>
</g>
<!-- codeblock_6 -->
<g id="node7" class="node">
<title>codeblock_6</title>
<ellipse fill="none" stroke="#000000" cx="949" cy="-1500.4024" rx="76.6175" ry="18"/>
<text text-anchor="middle" x="949" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 11&#45;47</text>
</g>
<!-- section_1&#45;&gt;codeblock_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;codeblock_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M822.5412,-1557.3088C846.2089,-1546.6584 878.1786,-1532.272 904.0515,-1520.6292"/>
<polygon fill="#000000" stroke="#000000" points="905.5982,-1523.7713 913.2811,-1516.4759 902.7256,-1517.3878 905.5982,-1523.7713"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1216" cy="-1500.4024" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1216" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 49&#45;53</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M842.2165,-1563.4291C918.129,-1550.6289 1057.7521,-1527.0859 1143.1924,-1512.6791"/>
<polygon fill="#000000" stroke="#000000" points="1143.8001,-1516.1261 1153.079,-1511.012 1142.6362,-1509.2235 1143.8001,-1516.1261"/>
</g>
<!-- section_8 -->
<g id="node9" class="node">
<title>section_8</title>
<ellipse fill="none" stroke="#000000" cx="1755" cy="-1500.4024" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1755" y="-1496.2024" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 56&#45;148</text>
</g>
<!-- section_1&#45;&gt;section_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;section_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M847.9735,-1568.0068C1014.5989,-1555.5876 1488.9601,-1520.2314 1676.9169,-1506.2222"/>
<polygon fill="#000000" stroke="#000000" points="1677.2847,-1509.7046 1686.9969,-1505.4709 1676.7644,-1502.724 1677.2847,-1509.7046"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="450,-1198.1035 0,-1198.1035 0,-1142.3005 450,-1142.3005 450,-1198.1035"/>
<text text-anchor="middle" x="225" y="-1150.702" font-family="Inconsolata" font-size="14.00" fill="#000000">Our weaver is currently somewhat narrowly focused on markdown.</text>
</g>
<!-- prose_3&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M600.0625,-1488.8234C594.8094,-1486.5628 589.2635,-1484.3061 584,-1482.4024 529.6332,-1462.7385 507.5429,-1477.8031 459,-1446.4024 360.8738,-1382.928 281.836,-1265.9347 245.9302,-1206.6642"/>
<polygon fill="#000000" stroke="#000000" points="248.8862,-1204.7877 240.7448,-1198.0077 242.8811,-1208.3849 248.8862,-1204.7877"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="659.5,-1188.202 468.5,-1188.202 468.5,-1152.202 659.5,-1152.202 659.5,-1188.202"/>
<text text-anchor="middle" x="564" y="-1166.702" font-family="Inconsolata" font-size="14.00" fill="#000000">This will change in time.</text>
</g>
<!-- prose_4&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>prose_4&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.5256,-1483.6001C685.6805,-1473.2833 675.9905,-1459.5638 669,-1446.4024 623.0744,-1359.936 587.2671,-1248.8837 572.0165,-1197.961"/>
<polygon fill="#000000" stroke="#000000" points="575.3568,-1196.9142 569.1606,-1188.3202 568.6451,-1198.9024 575.3568,-1196.9142"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="834,-1190.104 678,-1190.104 678,-1150.2999 834,-1150.2999 834,-1190.104"/>
<text text-anchor="middle" x="756" y="-1174.702" font-family="Inconsolata" font-size="14.00" fill="#000000">Now to activate dot!</text>
</g>
<!-- prose_5&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>prose_5&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.1788,-1482.179C781.7646,-1428.0049 765.7287,-1267.5482 759.0123,-1200.3433"/>
<polygon fill="#000000" stroke="#000000" points="762.4579,-1199.6231 757.9807,-1190.0208 755.4926,-1200.3193 762.4579,-1199.6231"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1176,-1446.6029 852,-1446.6029 852,-893.801 1176,-893.801 1176,-1446.6029"/>
<text text-anchor="middle" x="1014" y="-1431.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1014" y="-1399.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_file = require &quot;pl.file&quot;</text>
<text text-anchor="middle" x="1014" y="-1384.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_dir = require &quot;pl.dir&quot;</text>
<text text-anchor="middle" x="1014" y="-1369.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local pl_path = require &quot;pl.path&quot;</text>
<text text-anchor="middle" x="1014" y="-1353.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">local getfiles = pl_dir.getfiles</text>
<text text-anchor="middle" x="1014" y="-1338.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local makepath = pl_dir.makepath</text>
<text text-anchor="middle" x="1014" y="-1322.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local getdirectories = pl_dir.getdirectories</text>
<text text-anchor="middle" x="1014" y="-1307.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">local extension = pl_path.extension</text>
<text text-anchor="middle" x="1014" y="-1292.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local dirname = pl_path.dirname</text>
<text text-anchor="middle" x="1014" y="-1276.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local basename = pl_path.basename</text>
<text text-anchor="middle" x="1014" y="-1261.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local read = pl_file.read</text>
<text text-anchor="middle" x="1014" y="-1245.802" font-family="Inconsolata" font-size="14.00" fill="#000000">local write = pl_file.write</text>
<text text-anchor="middle" x="1014" y="-1230.402" font-family="Inconsolata" font-size="14.00" fill="#000000">local isdir = pl_path.isdir</text>
<text text-anchor="middle" x="1014" y="-1199.002" font-family="Inconsolata" font-size="14.00" fill="#000000">local u = require &quot;lib/util&quot;</text>
<text text-anchor="middle" x="1014" y="-1183.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;lib/ansi&quot;</text>
<text text-anchor="middle" x="1014" y="-1136.2019" font-family="Inconsolata" font-size="14.00" fill="#000000">local s = require &quot;lib/status&quot;</text>
<text text-anchor="middle" x="1014" y="-1104.8019" font-family="Inconsolata" font-size="14.00" fill="#000000">local Node = require &quot;peg/node&quot;</text>
<text text-anchor="middle" x="1014" y="-1073.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">local m = require &quot;grym/morphemes&quot;</text>
<text text-anchor="middle" x="1014" y="-1058.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local walk = require &quot;walk&quot;</text>
<text text-anchor="middle" x="1014" y="-1042.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">local strHas = walk.strHas</text>
<text text-anchor="middle" x="1014" y="-1027.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local endsWith = walk.endsWith</text>
<text text-anchor="middle" x="1014" y="-1011.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local subLastFor = walk.subLastFor</text>
<text text-anchor="middle" x="1014" y="-996.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local writeOnChange = walk.writeOnChange</text>
<text text-anchor="middle" x="1014" y="-965.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">local epeg = require &quot;peg/epeg&quot;</text>
<text text-anchor="middle" x="1014" y="-933.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">local Doc = require &quot;grym/doc&quot;</text>
<text text-anchor="middle" x="1014" y="-902.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local W, w = u.inherit(Node)</text>
</g>
<!-- codeblock_6&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>codeblock_6&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M952.5873,-1482.179C953.9487,-1475.2632 955.651,-1466.6152 957.6126,-1456.6504"/>
<polygon fill="#000000" stroke="#000000" points="961.0726,-1457.1942 959.5701,-1446.7064 954.2044,-1455.8421 961.0726,-1457.1942"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1427.5,-1197.4024 1194.5,-1197.4024 1194.5,-1143.0015 1427.5,-1143.0015 1427.5,-1197.4024"/>
<text text-anchor="middle" x="1311" y="-1182.102" font-family="Inconsolata" font-size="14.00" fill="#000000">function W.weaveMd(weaver, doc)</text>
<text text-anchor="middle" x="1311" y="-1166.702" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return doc:toMarkdown()</text>
<text text-anchor="middle" x="1311" y="-1151.302" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>codeblock_7&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1221.2429,-1482.179C1236.2952,-1429.8605 1279.8665,-1278.4155 1300.2493,-1207.5692"/>
<polygon fill="#000000" stroke="#000000" points="1303.6808,-1208.3006 1303.0822,-1197.7227 1296.9537,-1206.3651 1303.6808,-1208.3006"/>
</g>
<!-- header_14 -->
<g id="node15" class="node">
<title>header_14</title>
<ellipse fill="none" stroke="#000000" cx="1511" cy="-1170.202" rx="65.81" ry="18"/>
<text text-anchor="middle" x="1511" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : .dot to .svg</text>
</g>
<!-- section_8&#45;&gt;header_14 -->
<g id="edge14" class="edge">
<title>section_8&#45;&gt;header_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1700.2851,-1488.8799C1657.2473,-1478.7644 1601.9707,-1463.0938 1586,-1446.4024 1519.3376,-1376.7317 1510.6442,-1253.9711 1510.3398,-1198.6472"/>
<polygon fill="#000000" stroke="#000000" points="1513.8401,-1198.5298 1510.3761,-1188.5173 1506.8402,-1198.5047 1513.8401,-1198.5298"/>
</g>
<!-- prose_15 -->
<g id="node16" class="node">
<title>prose_15</title>
<ellipse fill="none" stroke="#000000" cx="1627" cy="-1170.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1627" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_8&#45;&gt;prose_15 -->
<g id="edge15" class="edge">
<title>section_8&#45;&gt;prose_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1716.4763,-1485.1853C1699.2485,-1476.4119 1680.3128,-1463.6503 1669,-1446.4024 1617.8578,-1368.4292 1619.843,-1251.7956 1624.0026,-1198.5456"/>
<polygon fill="#000000" stroke="#000000" points="1627.4987,-1198.7409 1624.8766,-1188.4757 1620.5249,-1198.1356 1627.4987,-1198.7409"/>
</g>
<!-- codeblock_16 -->
<g id="node17" class="node">
<title>codeblock_16</title>
<ellipse fill="none" stroke="#000000" cx="1755" cy="-1170.202" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1755" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 61&#45;75</text>
</g>
<!-- section_8&#45;&gt;codeblock_16 -->
<g id="edge16" class="edge">
<title>section_8&#45;&gt;codeblock_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1755,-1482.179C1755,-1427.4926 1755,-1264.504 1755,-1198.4619"/>
<polygon fill="#000000" stroke="#000000" points="1758.5001,-1198.369 1755,-1188.369 1751.5001,-1198.369 1758.5001,-1198.369"/>
</g>
<!-- codeblock_17 -->
<g id="node18" class="node">
<title>codeblock_17</title>
<ellipse fill="none" stroke="#000000" cx="1933" cy="-1170.202" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1933" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 78&#45;134</text>
</g>
<!-- section_8&#45;&gt;codeblock_17 -->
<g id="edge17" class="edge">
<title>section_8&#45;&gt;codeblock_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1791.3935,-1484.7345C1808.5468,-1475.7292 1828.0408,-1462.9009 1841,-1446.4024 1901.1676,-1369.802 1922.8844,-1252.0002 1929.9442,-1198.4444"/>
<polygon fill="#000000" stroke="#000000" points="1933.4417,-1198.6802 1931.2024,-1188.3247 1926.4952,-1197.8165 1933.4417,-1198.6802"/>
</g>
<!-- codeblock_18 -->
<g id="node19" class="node">
<title>codeblock_18</title>
<ellipse fill="none" stroke="#000000" cx="2254" cy="-1170.202" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2254" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 137&#45;144</text>
</g>
<!-- section_8&#45;&gt;codeblock_18 -->
<g id="edge18" class="edge">
<title>section_8&#45;&gt;codeblock_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1818.7711,-1492.575C1887.0113,-1483.3346 1990.0346,-1466.6361 2024,-1446.4024 2129.6618,-1383.4581 2208.959,-1253.7149 2239.8557,-1197.3427"/>
<polygon fill="#000000" stroke="#000000" points="2243.0547,-1198.7848 2244.7278,-1188.3229 2236.8957,-1195.458 2243.0547,-1198.7848"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="2581" cy="-1170.202" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2581" y="-1166.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 146&#45;148</text>
</g>
<!-- section_8&#45;&gt;codeblock_19 -->
<g id="edge19" class="edge">
<title>section_8&#45;&gt;codeblock_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1824.3887,-1497.0814C1971.3649,-1489.6197 2304.3724,-1470.2956 2350,-1446.4024 2459.6724,-1388.9715 2537.904,-1255.1019 2567.7052,-1197.4308"/>
<polygon fill="#000000" stroke="#000000" points="2570.9775,-1198.717 2572.3877,-1188.2164 2564.7371,-1195.5457 2570.9775,-1198.717"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1144.5,-456.3012 631.5,-456.3012 631.5,-401.7004 1144.5,-401.7004 1144.5,-456.3012"/>
<text text-anchor="middle" x="888" y="-425.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;The sh&#45;lib monkeypatches the global metatable, and all we want is one</text>
<text text-anchor="middle" x="888" y="-409.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">command, so we do something odd here:</text>
</g>
<!-- prose_15&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>prose_15&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1630.9744,-1151.9865C1640.6507,-1102.1992 1659.558,-962.9675 1586,-894.0016 1515.5627,-827.9614 1235.3047,-908.4858 1153,-858.0016 1002.4386,-765.6498 924.5966,-552.3947 898.3704,-466.1758"/>
<polygon fill="#000000" stroke="#000000" points="901.7105,-465.1287 895.4966,-456.5475 895.0029,-467.1308 901.7105,-465.1287"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1619.5,-533.3013 1162.5,-533.3013 1162.5,-324.7003 1619.5,-324.7003 1619.5,-533.3013"/>
<text text-anchor="middle" x="1391" y="-518.201" font-family="Inconsolata" font-size="14.00" fill="#000000">local dot_sh = (require &quot;sh&quot;):clear_G().command(&#39;dot&#39;, &#39;&#45;Tsvg&#39;)</text>
<text text-anchor="middle" x="1391" y="-486.8009" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dotToSvg(dotted, out_file)</text>
<text text-anchor="middle" x="1391" y="-471.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local run_dot = dot_sh({__input = dotted})</text>
<text text-anchor="middle" x="1391" y="-456.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if run_dot.__exitcode == 0 then</text>
<text text-anchor="middle" x="1391" y="-440.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return tostring(run_dot)</text>
<text text-anchor="middle" x="1391" y="-425.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else </text>
<text text-anchor="middle" x="1391" y="-409.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s:complain(a.red(&quot;Dot returned &quot;) </text>
<text text-anchor="middle" x="1391" y="-394.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. tostring(run_dot.__exitcode)</text>
<text text-anchor="middle" x="1391" y="-379.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. a.red(&quot; for &quot; .. out_file ))</text>
<text text-anchor="middle" x="1391" y="-363.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1391" y="-348.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1391" y="-332.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_16&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_16&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1752.59,-1152.0462C1745.7841,-1105.7914 1723.2039,-981.0318 1668,-894.0016 1655.3648,-874.0818 1643.5733,-876.5505 1629,-858.0016 1551.6735,-759.5801 1484.6983,-632.7905 1441.6708,-542.6329"/>
<polygon fill="#000000" stroke="#000000" points="1444.7739,-541.0083 1437.3229,-533.4762 1438.4506,-544.0109 1444.7739,-541.0083"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2228,-858.0023 1638,-858.0023 1638,.0008 2228,.0008 2228,-858.0023"/>
<text text-anchor="middle" x="1933" y="-842.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_dir(weaver, pwd, depth)</text>
<text text-anchor="middle" x="1933" y="-827.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local depth = depth + 1</text>
<text text-anchor="middle" x="1933" y="-812.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1933" y="-796.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir)</text>
<text text-anchor="middle" x="1933" y="-781.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and not strHas(&quot;src/lib&quot;, dir) then</text>
<text text-anchor="middle" x="1933" y="-749.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local files = getfiles(dir)</text>
<text text-anchor="middle" x="1933" y="-734.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat((&quot; &#160;&quot;):rep(depth) .. &quot;* &quot; .. dir)</text>
<text text-anchor="middle" x="1933" y="-719.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local subdirs = getdirectories(dir)</text>
<text text-anchor="middle" x="1933" y="-703.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for _, f in ipairs(files) do</text>
<text text-anchor="middle" x="1933" y="-688.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if extension(f) == &quot;.orb&quot; then</text>
<text text-anchor="middle" x="1933" y="-672.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Weave and prepare out directory</text>
<text text-anchor="middle" x="1933" y="-657.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local orb_f = read(f)</text>
<text text-anchor="middle" x="1933" y="-642.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc = Doc(orb_f)</text>
<text text-anchor="middle" x="1933" y="-626.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_md_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/md&quot;, dirname(f))</text>
<text text-anchor="middle" x="1933" y="-611.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_dot_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/dot&quot;, dirname(f))</text>
<text text-anchor="middle" x="1933" y="-595.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local doc_svg_dir = subLastFor(&quot;/orb&quot;, &quot;/doc/svg&quot;, dirname(f))</text>
<text text-anchor="middle" x="1933" y="-580.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_md_dir)</text>
<text text-anchor="middle" x="1933" y="-565.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_dot_dir)</text>
<text text-anchor="middle" x="1933" y="-549.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;makepath(doc_svg_dir)</text>
<text text-anchor="middle" x="1933" y="-534.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local bare_name = basename(f):sub(1, &#45;5) &#45;&#45; &#160;== #&quot;.orb&quot;</text>
<text text-anchor="middle" x="1933" y="-518.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_md_name = doc_md_dir .. &quot;/&quot; .. bare_name .. &quot;.md&quot;</text>
<text text-anchor="middle" x="1933" y="-503.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_dot_name = doc_dot_dir .. &quot;/&quot; .. bare_name .. &quot;.dot&quot;</text>
<text text-anchor="middle" x="1933" y="-488.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local out_svg_name = doc_svg_dir .. &quot;/&quot; .. bare_name .. &quot;.svg&quot;</text>
<text text-anchor="middle" x="1933" y="-472.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_md = weaver:weaveMd(doc) or &quot;&quot;</text>
<text text-anchor="middle" x="1933" y="-457.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_dot = doc:dot() or &quot;&quot;</text>
<text text-anchor="middle" x="1933" y="-441.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local woven_svg = dotToSvg(woven_dot, out_dot_name)</text>
<text text-anchor="middle" x="1933" y="-426.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Compare, report, and write out if necessary</text>
<text text-anchor="middle" x="1933" y="-411.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_md = read(out_md_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1933" y="-395.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_dot = read(out_dot_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1933" y="-380.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local last_svg = read(out_svg_name) or &quot;&quot;</text>
<text text-anchor="middle" x="1933" y="-364.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_md, last_md, out_md_name, depth)</text>
<text text-anchor="middle" x="1933" y="-349.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_dot, last_dot, out_dot_name, depth)</text>
<text text-anchor="middle" x="1933" y="-334.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeOnChange(woven_svg, last_svg, out_svg_name, depth)</text>
<text text-anchor="middle" x="1933" y="-318.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-303.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-287.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-272.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-241.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="1933" y="-225.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1933" y="-194.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function weave_all(weaver, pwd)</text>
<text text-anchor="middle" x="1933" y="-178.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for dir in pl_dir.walk(pwd, false, false) do</text>
<text text-anchor="middle" x="1933" y="-163.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if not strHas(&quot;.git&quot;, dir) and isdir(dir) </text>
<text text-anchor="middle" x="1933" y="-148.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and endsWith(&quot;orb&quot;, dir) then</text>
<text text-anchor="middle" x="1933" y="-132.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s:chat(a.green(&quot;Weave: &quot; .. dir))</text>
<text text-anchor="middle" x="1933" y="-117.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return weave_dir(weaver, dir, 0)</text>
<text text-anchor="middle" x="1933" y="-101.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-86.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1933" y="-55.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="1933" y="-39.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1933" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">W.weave_all = weave_all</text>
</g>
<!-- codeblock_17&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_17&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1933,-1151.88C1933,-1108.5787 1933,-994.0918 1933,-868.6634"/>
<polygon fill="#000000" stroke="#000000" points="1936.5001,-868.4503 1933,-858.4503 1929.5001,-868.4503 1936.5001,-868.4503"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2528,-479.6017 2246,-479.6017 2246,-378.3999 2528,-378.3999 2528,-479.6017"/>
<text text-anchor="middle" x="2387" y="-464.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(Weaver, doc)</text>
<text text-anchor="middle" x="2387" y="-449.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local weaver = setmetatable({}, W)</text>
<text text-anchor="middle" x="2387" y="-401.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return weaver</text>
<text text-anchor="middle" x="2387" y="-386.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_18&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_18&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2257.2877,-1151.88C2273.7959,-1059.8804 2347.9645,-646.5433 2376.1159,-489.6572"/>
<polygon fill="#000000" stroke="#000000" points="2379.5813,-490.1613 2377.9025,-479.7004 2372.6913,-488.925 2379.5813,-490.1613"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="2618,-447.0008 2546,-447.0008 2546,-411.0008 2618,-411.0008 2618,-447.0008"/>
<text text-anchor="middle" x="2582" y="-425.5008" font-family="Inconsolata" font-size="14.00" fill="#000000">return W</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>codeblock_19&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2581.0247,-1151.88C2581.1587,-1052.546 2581.7982,-578.5968 2581.9618,-457.3178"/>
<polygon fill="#000000" stroke="#000000" points="2585.4621,-457.0174 2581.9757,-447.0126 2578.4621,-457.0078 2585.4621,-457.0174"/>
</g>
</g>
</svg>