digraph hierarchy {

node [fontname=Helvetica]
edge [style=dashed]

doc_0 [label="doc - 79"]


doc_0 -> { section_1}
{rank=same; section_1}

section_1 [label="section: 1-17"]


section_1 -> { header_2 block_3 codeblock_4 codeblock_5 section_6}
{rank=same; header_2 block_3 codeblock_4 codeblock_5 section_6}

header_2 [label="1 : Link module"]

block_3 [label="block 1-2"]

codeblock_4 [label="code block 3-10"]

codeblock_5 [label="code block 13-16"]

section_6 [label="section: 18-74"]


header_2 -> leaf_7
leaf_7  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
block_3 -> leaf_8
leaf_8  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
codeblock_4 -> leaf_9
leaf_9  [color=Gray,shape=rectangle,fontname=Inconsolata,label="local L = require \"lpeg\"

local m = require \"grym/morphemes\"
local u = require \"util\"

local Node = require \"node/node\""]
codeblock_5 -> leaf_10
leaf_10  [color=Gray,shape=rectangle,fontname=Inconsolata,label="local Li, li = u.inherit(Node)
Li.id = \"link\""]
section_6 -> { header_11 block_12 section_13 section_14 section_15}
{rank=same; header_11 block_12 section_13 section_14 section_15}

header_11 [label="2 : Transformers"]

block_12 [label="block 18-74"]

section_13 [label="section: 20-30"]

section_14 [label="section: 31-74"]

section_15 [label="section: 75-79"]


header_11 -> leaf_16
leaf_16  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
block_12 -> leaf_17
leaf_17  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
section_13 -> { header_18 block_19 codeblock_20}
{rank=same; header_18 block_19 codeblock_20}

header_18 [label="3 : toMarkdown"]

block_19 [label="block 20-21"]

codeblock_20 [label="code block 22-29"]


header_18 -> leaf_21
leaf_21  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
block_19 -> leaf_22
leaf_22  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
codeblock_20 -> leaf_23
leaf_23  [color=Gray,shape=rectangle,fontname=Inconsolata,label="function Li.toMarkdown(link)
  url = link.url or \"\"
  prose = link.prose or \"\"
  return \"[\" .. prose .. \"]\"
      .. \"(\" .. url .. \")\"
end"]
section_14 -> { header_24 block_25 codeblock_26 codeblock_27 codeblock_28 codeblock_29}
{rank=same; header_24 block_25 codeblock_26 codeblock_27 codeblock_28 codeblock_29}

header_24 [label="3 : dotLabel"]

block_25 [label="block 31-32"]

codeblock_26 [label="code block 33-37"]

codeblock_27 [label="code block 39-52"]

codeblock_28 [label="code block 56-64"]

codeblock_29 [label="code block 67-73"]


header_24 -> leaf_30
leaf_30  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
block_25 -> leaf_31
leaf_31  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
codeblock_26 -> leaf_32
leaf_32  [color=Gray,shape=rectangle,fontname=Inconsolata,label="function Li.dotLabel(link)
  return \"link: \" .. link.prose
end"]
codeblock_27 -> leaf_33
leaf_33  [color=Gray,shape=rectangle,fontname=Inconsolata,label="function Li.parse(link, line)
  -- This only parses double links, expand
  local WS, sel, ser = m.WS, m.sel, m.ser
  local link_content = L.match(L.Ct(sel * WS * sel * L.C(m.link_prose)
                * ser * WS * sel * L.C(m.url) * WS * ser * WS * ser),
                line)
  if link_content then
    link.prose = link_content[1] or \"\"
    link.url   = link_content[2] or \"\"
  end
  return link
end"]
codeblock_28 -> leaf_34
leaf_34  [color=Gray,shape=rectangle,fontname=Inconsolata,label="local function new(Link, line)
  local link = setmetatable({},Li)
  link.id = \"link\"
  link.val = line -- refine this
  link:parse(line)
  return link
end"]
codeblock_29 -> leaf_35
leaf_35  [color=Gray,shape=rectangle,fontname=Inconsolata,label="local function linkbuild(link, str)
  io.write(\"   ~~ built a link\\n\")
  setmetatable(link, Li)
  return Li.parse(link, str:sub(link.first, link.last))
end"]
section_15 -> { header_36 block_37 codeblock_38}
{rank=same; header_36 block_37 codeblock_38}

header_36 [label="3 : export"]

block_37 [label="block 75-76"]

codeblock_38 [label="code block 77-79"]


header_36 -> leaf_39
leaf_39  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
block_37 -> leaf_40
leaf_40  [color=Gray,shape=rectangle,fontname=Inconsolata,label=""]
codeblock_38 -> leaf_41
leaf_41  [color=Gray,shape=rectangle,fontname=Inconsolata,label="return linkbuild"]

}
